!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone-core",[],t):"object"==typeof exports?exports["cornerstone-core"]=t():e.cornerstone=t()}(window,function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&y[e]){for(var n in y[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--p&&0===v&&_()}}(e,n),t&&t(e,n)};var n,a=!0,r="f1fc9ee2018efa87b506",o={},i=[],s=[];function l(e){var t=O[e];if(!t)return S;var a=function(a){return t.hot.active?(O[a]?-1===O[a].parents.indexOf(e)&&O[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),S(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(t){S[e]=t}}};for(var o in S)Object.prototype.hasOwnProperty.call(S,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),v++,S.e(e).then(t,function(e){throw t(),e});function t(){v--,"prepare"===c&&(b[e]||T(e),0===v&&0===p&&_())}},a.t=function(e,t){return 1&t&&(e=a(e)),S.t(e,-2&t)},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:j,apply:E,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var h,m,g,p=0,v=0,b={},y={},x={};function w(e){return+e+""===e?+e:e}function j(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=S.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f("idle"),null;y={},b={},x=e.c,g=e.h,f("prepare");var t=new Promise(function(e,t){h={resolve:e,reject:t}});return m={},T("cornerstone"),"prepare"===c&&0===v&&0===p&&_(),t});var t}function T(e){x[e]?(y[e]=!0,p++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=S.p+""+e+"."+r+".hot-update.js",t.appendChild(n)}(e)):b[e]=!0}function _(){f("ready");var e=h;if(h=null,e)if(a)Promise.resolve().then(function(){return E(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(w(n));e.resolve(t)}}function E(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,s,l,u;function d(e){for(var t=[e],n={},a=t.slice().map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=O[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],d=O[u];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),h(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var p={},v=[],b={},y=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var j in m)if(Object.prototype.hasOwnProperty.call(m,j)){var T;u=w(j);var _=!1,E=!1,C=!1,I="";switch((T=m[j]?d(u):{type:"disposed",moduleId:j}).chain&&(I="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(_=new Error("Aborted because of self decline: "+T.moduleId+I));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(_=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+I));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(_=new Error("Aborted because "+u+" is not accepted"+I));break;case"accepted":t.onAccepted&&t.onAccepted(T),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),C=!0;break;default:throw new Error("Unexception type "+T.type)}if(_)return f("abort"),Promise.reject(_);if(E)for(u in b[u]=m[u],h(v,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,u)&&(p[u]||(p[u]=[]),h(p[u],T.outdatedDependencies[u]));C&&(h(v,[T.moduleId]),b[u]=y)}var M,P=[];for(a=0;a<v.length;a++)O[u=v[a]]&&O[u].hot._selfAccepted&&P.push({module:u,errorHandler:O[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var D,k=v.slice();k.length>0;)if(u=k.pop(),l=O[u]){var L={},A=l.hot._disposeHandlers;for(s=0;s<A.length;s++)(n=A[s])(L);for(o[u]=L,l.hot.active=!1,delete O[u],delete p[u],s=0;s<l.children.length;s++){var R=O[l.children[s]];R&&(M=R.parents.indexOf(u))>=0&&R.parents.splice(M,1)}}for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(l=O[u]))for(D=p[u],s=0;s<D.length;s++)(M=l.children.indexOf(D[s]))>=0&&l.children.splice(M,1);for(u in f("apply"),r=g,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(l=O[u])){D=p[u];var F=[];for(a=0;a<D.length;a++)if(n=l.hot._acceptedDependencies[D[a]]){if(-1!==F.indexOf(n))continue;F.push(n)}for(a=0;a<F.length;a++){n=F[a];try{n(D)}catch(H){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:D[a],error:H}),t.ignoreErrored||B||(B=H)}}}for(a=0;a<P.length;a++){var U=P[a];i=[u=U.module];try{S(u)}catch(H){if("function"==typeof U.errorHandler)try{U.errorHandler(H)}catch(N){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:N,originalError:H}),t.ignoreErrored||B||(B=N),B||(B=H)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:H}),t.ignoreErrored||B||(B=H)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise(function(e){e(v)}))}var O={};function S(t){if(O[t])return O[t].exports;var n=O[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return S.m=e,S.c=O,S.d=function(e,t,n){S.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,t){if(1&t&&(e=S(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(S.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)S.d(n,a,(function(t){return e[t]}).bind(null,a));return n},S.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(t,"a",t),t},S.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},S.p="",S.h=function(){return r},l("./index.js")(S.s="./index.js")}({"./canvasToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),o=Object(r.default)(n);return o.invert(),o.transformPoint(t.x,t.y)}},"./colors/colormap.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getColormapsList",function(){return l}),n.d(t,"getColormap",function(){return u});var a=n("./colors/lookupTable.js"),r=[0,0,0,0],o={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};function i(e,t){for(var n=0,a=e.length-1;n<=a;){var r=n+Math.floor((a-n)/2),o=e[r];if(o===t)return r;t<o?a=r-1:n=r+1}return n}function s(e,t,n){var a,r=[],o=[],s=[],l=[];for(n=null===n?1:n,a=0;a<t.length;a++){var u=t[a];r.push((e-1)*u[0]),o.push(u[1]),s.push(u[1])}var d=function(e,t,n){for(var a=(1-e)/((n=null===n?100:n)-1),r=[];n-- >0;)r.push(e),e+=a;return r[r.length-1]=1,r}(0,0,e);for(a=0;a<e;a++)d[a]=(e-1)*Math.pow(d[a],n);var c=function(e,t){var n,a=[],r=t.length;for(e.sort(function(e,t){return e-t}),n=0;n<r;n++)a[n]=i(e,t[n]);return a}(r,d);for(a=1;a<e-1;a++){var f=c[a];l[a]=(d[a]-r[f-1])/(r[f]-r[f-1])*(o[f]-s[f-1])+s[f-1]}return l[0]=s[0],l[e-1]=o[t.length-1],l}function l(){var e=[];return Object.keys(o).forEach(function(t){o.hasOwnProperty(t)&&e.push({id:t,name:o[t].name})}),e.sort(function(e,t){var n=e.name.toLowerCase(),a=t.name.toLowerCase();return n===a?0:n<a?-1:1}),e}function u(e,t){var n=o[e];return n||(n=o[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function(e,t,n){var a,r=[],o=s(t=null===t?256:t,e.red,n=null===n?1:n),i=s(t,e.green,n),l=s(t,e.blue,n);for(a=0;a<t;a++){var u=Math.round(255*o[a]),d=Math.round(255*i[a]),c=Math.round(255*l[a]);r.push([u,d,c,255])}return r}(n.segmentedData,n.numColors,n.gamma)),{getId:function(){return e},getColorSchemeName:function(){return n.name},setColorSchemeName:function(e){n.name=e},getNumberOfColors:function(){return n.colors.length},setNumberOfColors:function(e){for(;n.colors.length<e;)n.colors.push(r);n.colors.length=e},getColor:function(e){return this.isValidIndex(e)?n.colors[e]:r},getColorRepeating:function(e){var t=n.colors.length;return this.getColor(e=t?e%t:0)},setColor:function(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor:function(e){n.colors.push(e)},insertColor:function(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor:function(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors:function(){n.colors=[]},buildLookupTable:function(e){if(e){var t=n.colors.length;e.setNumberOfTableValues(t);for(var a=0;a<t;a++)e.setTableValue(a,n.colors[a])}},createLookupTable:function(){var e=new a.default;return this.buildLookupTable(e),e},isValidIndex:function(e){return e>=0&&e<n.colors.length}}}},"./colors/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/colormap.js"),r=n("./colors/lookupTable.js");t.default={getColormap:a.getColormap,getColormapsList:a.getColormapsList,LookupTable:r.default}},"./colors/lookupTable.js":function(e,t,n){"use strict";function a(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");var a=[];if(0===t)return a[0]=n,a[1]=n,a[2]=n,a;var r=Math.floor(6*e),o=6*e-r,i=n*(1-t),s=n*(1-t*o),l=n*(1-t*(1-o));switch(r){case 0:case 6:a[0]=n,a[1]=l,a[2]=i;break;case 1:a[0]=s,a[1]=n,a[2]=i;break;case 2:a[0]=i,a[1]=n,a[2]=l;break;case 3:a[0]=i,a[1]=s,a[2]=n;break;case 4:a[0]=l,a[1]=i,a[2]=n;break;case 5:a[0]=n,a[1]=i,a[2]=s}return a}n.r(t),t.default=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}var t;return(t=[{key:"setNumberOfTableValues",value:function(e){this.NumberOfColors=e}},{key:"setRamp",value:function(e){this.Ramp=e}},{key:"setTableRange",value:function(e,t){this.TableRange[0]=e,this.TableRange[1]=t}},{key:"setHueRange",value:function(e,t){this.HueRange[0]=e,this.HueRange[1]=t}},{key:"setSaturationRange",value:function(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t}},{key:"setValueRange",value:function(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t}},{key:"setRange",value:function(e,t){this.InputRange[0]=e,this.InputRange[1]=t}},{key:"setAlphaRange",value:function(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t}},{key:"getColor",value:function(e){return this.mapValue(e)}},{key:"build",value:function(e){if(!(this.Table.length>1)||e){this.Table=[];var t,n,r,o,i=this.NumberOfColors-1;i?(t=(this.HueRange[1]-this.HueRange[0])/i,n=(this.SaturationRange[1]-this.SaturationRange[0])/i,r=(this.ValueRange[1]-this.ValueRange[0])/i,o=(this.AlphaRange[1]-this.AlphaRange[0])/i):t=n=r=o=0;for(var s=0;s<=i;s++){var l=this.AlphaRange[0]+s*o,u=a(this.HueRange[0]+s*t,this.SaturationRange[0]+s*n,this.ValueRange[0]+s*r),d=[];switch(this.Ramp){case"scurve":d[0]=Math.floor(127.5*(1+Math.cos((1-u[0])*Math.PI))),d[1]=Math.floor(127.5*(1+Math.cos((1-u[1])*Math.PI))),d[2]=Math.floor(127.5*(1+Math.cos((1-u[2])*Math.PI))),d[3]=Math.floor(255*l);break;case"linear":d[0]=Math.floor(255*u[0]+.5),d[1]=Math.floor(255*u[1]+.5),d[2]=Math.floor(255*u[2]+.5),d[3]=Math.floor(255*l+.5);break;case"sqrt":d[0]=Math.floor(255*Math.sqrt(u[0])+.5),d[1]=Math.floor(255*Math.sqrt(u[1])+.5),d[2]=Math.floor(255*Math.sqrt(u[2])+.5),d[3]=Math.floor(255*Math.sqrt(l)+.5);break;default:throw new Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(d)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function(){var e=this.NumberOfColors,t=e+1,n=e+2;this.Table[e+0]=this.UseBelowRangeColor||0===e?this.BelowRangeColor:this.Table[0],this.Table[t]=this.UseAboveRangeColor||0===e?this.AboveRangeColor:this.Table[e-1],this.Table[n]=this.NaNColor}},{key:"mapValue",value:function(e){var t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]}},{key:"getIndex",value:function(e){var t={Range:[]};if(t.MaxIndex=this.NumberOfColors-1,t.Shift=-this.TableRange[0],t.Scale=this.TableRange[1]<=this.TableRange[0]?Number.MAX_VALUE:t.MaxIndex/(this.TableRange[1]-this.TableRange[0]),t.Range[0]=this.TableRange[0],t.Range[1]=this.TableRange[1],isNaN(e))return-1;var n=function(e,t){return Math.floor(e<t.Range[0]?t.MaxIndex+0+1.5:e>t.Range[1]?t.MaxIndex+1+1.5:(e+t.Shift)*t.Scale)}(e,t);return n===this.NumberOfColors+0?n=0:n===this.NumberOfColors+1&&(n=this.NumberOfColors-1),n}},{key:"setTableValue",value:function(e,t){if(5===arguments.length&&(t=Array.prototype.slice.call(arguments,1)),e<0)throw new Error("Can't set the table value for negative index (".concat(e,")"));e>=this.NumberOfColors&&new Error("Index ".concat(e," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[e]=t,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./disable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./triggerEvent.js"),o=n("./events.js");t.default=function(e){if(void 0===e)throw new Error("disable: element must not be undefined");for(var t=Object(a.getEnabledElements)(),n=0;n<t.length;n++)if(t[n].element===e){var i={element:e};Object(r.default)(e,o.default.ELEMENT_DISABLED,i),Object(r.default)(o.events,o.default.ELEMENT_DISABLED,i),t[n].element.removeChild(t[n].canvas),t[n].canvas=void 0,t.splice(n,1);break}}},"./displayImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js"),o=n("./updateImage.js"),i=n("./internal/now.js"),s=n("./layers.js"),l=n("./triggerEvent.js"),u=n("./events.js");t.default=function(e,t,n){if(void 0===e)throw new Error("displayImage: parameter element must not be undefined");if(void 0===t)throw new Error("displayImage: parameter image must not be undefined");var d,c=Object(a.getEnabledElement)(e),f=c.image;if(c.image=t,c.layers&&c.layers.length&&Object(s.setLayerImage)(e,t),void 0===c.viewport&&(c.viewport=Object(r.default)(c.canvas,t)),n)for(var h in n)null!==n[h]&&(c.viewport[h]=n[h]);void 0!==c.lastImageTimeStamp&&(d=(1e3/(Object(i.default)()-c.lastImageTimeStamp)).toFixed()),c.lastImageTimeStamp=Object(i.default)();var m={viewport:c.viewport,element:c.element,image:c.image,oldImage:f,enabledElement:c,frameRate:d};Object(l.default)(c.element,u.default.NEW_IMAGE,m),Object(o.default)(e)}},"./draw.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);if(void 0===t.image)throw new Error("draw: image has not been loaded yet");Object(r.default)(t)}},"./drawInvalidated.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(){for(var e=Object(a.getEnabledElements)(),t=0;t<e.length;t++){var n=e[t];!0===n.invalid&&Object(r.default)(n,!0)}}},"./enable.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./resize.js"),o=n("./internal/drawImageSync.js"),i=n("./internal/requestAnimationFrame.js"),s=n("./internal/tryEnableWebgl.js"),l=n("./triggerEvent.js"),u=n("./generateUUID.js"),d=n("./events.js"),c=n("./internal/getCanvas.js");t.default=function(e,t){if(void 0===e)throw new Error("enable: parameter element cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&Object(s.default)(t);var n={element:e,canvas:Object(c.default)(e),image:void 0,invalid:!1,needsRedraw:!0,options:t,layers:[],data:{},renderingTools:{},uuid:Object(u.default)()};Object(a.addEnabledElement)(n),Object(l.default)(d.events,d.default.ELEMENT_ENABLED,n),Object(r.default)(e,!0),function e(t){if(void 0!==n.canvas){var a={enabledElement:n,timestamp:t};Object(l.default)(n.element,d.default.PRE_RENDER,a),n.needsRedraw&&function(e){return void 0!==e.image||e.layers.length>0}(n)&&Object(o.default)(n,n.invalid),Object(i.default)(e)}}()}},"./enabledElementData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getElementData",function(){return r}),n.d(t,"removeElementData",function(){return o});var a=n("./enabledElements.js");function r(e,t){var n=Object(a.getEnabledElement)(e);return!1===n.data.hasOwnProperty(t)&&(n.data[t]={}),n.data[t]}function o(e,t){delete Object(a.getEnabledElement)(e).data[t]}},"./enabledElements.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getEnabledElement",function(){return r}),n.d(t,"addEnabledElement",function(){return o}),n.d(t,"getEnabledElementsByImageId",function(){return i}),n.d(t,"getEnabledElements",function(){return s});var a=[];function r(e){if(void 0===e)throw new Error("getEnabledElement: parameter element must not be undefined");for(var t=0;t<a.length;t++)if(a[t].element===e)return a[t];throw new Error("element not enabled")}function o(e){if(void 0===e)throw new Error("getEnabledElement: enabledElement element must not be undefined");a.push(e)}function i(e){var t=[];return a.forEach(function(n){n.image&&n.image.imageId===e&&t.push(n)}),t}function s(){return a}},"./events.js":function(e,t,n){"use strict";n.r(t),n.d(t,"events",function(){return a}),t.default={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},this.namespaces={}}var t;return(t=[{key:"addEventNamespaceListener",value:function(e,t){e.indexOf(".")<=0||(this.namespaces[e]=t,this.addEventListener(e.split(".")[0],t))}},{key:"removeEventNamespaceListener",value:function(e){e.indexOf(".")<=0||!this.namespaces[e]||(this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e])}},{key:"addEventListener",value:function(e,t){e.indexOf(".")>0?this.addEventNamespaceListener(e,t):(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}},{key:"removeEventListener",value:function(e,t){if(e.indexOf(".")>0)this.removeEventNamespaceListener(e);else if(e in this.listeners)for(var n=this.listeners[e],a=0,r=n.length;a<r;a++)if(n[a]===t)return void n.splice(a,1)}},{key:"dispatchEvent",value:function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type],n=0,a=t.length;n<a;n++)t[n].call(this,e);return!e.defaultPrevented}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}())},"./falseColorMapping.js":function(e,t,n){"use strict";n.r(t),n.d(t,"convertImageToFalseColorImage",function(){return s}),n.d(t,"convertToFalseColorImage",function(){return l}),n.d(t,"restoreImage",function(){return i});var a=n("./enabledElements.js"),r=n("./pixelDataToFalseColorData.js"),o=n("./colors/colormap.js");function i(e){return!(!e.restore||"function"!=typeof e.restore||(e.restore(),0))}function s(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n=(t=function(e){return e&&"string"==typeof e&&(e=Object(o.getColormap)(e)),e}(t)).getId();if(e.colormapId===n)return!1;if(i(e),n){var a=e.minPixelValue||0,s=e.maxPixelValue||255;e.restore=function(e){if(e.restore)return e.restore;var t=e.color,n=e.rgba,a=e.cachedLut,r=e.slope,o=e.windowWidth,i=e.windowCenter,s=e.minPixelValue,l=e.maxPixelValue;return function(){if(e.color=t,e.rgba=n,e.cachedLut=a,e.slope=r,e.windowWidth=o,e.windowCenter=i,e.minPixelValue=s,e.maxPixelValue=l,e.origPixelData){var u=e.origPixelData;e.getPixelData=function(){return u}}e.origPixelData=void 0,e.colormapId=void 0,e.falseColor=void 0}}(e);var l=t.createLookupTable();l.setTableRange(a,s),Object(r.default)(e,l);var u=function(e){for(var t,n=Number.MAX_VALUE,a=Number.MIN_VALUE,r=e.length,o=0;o<r;o++)n=n<(t=e[o])?n:t,a=a>t?a:t;return{minPixelValue:n,maxPixelValue:a}}(e.getPixelData());e.minPixelValue=u.minPixelValue,e.maxPixelValue=u.maxPixelValue,e.windowWidth=255,e.windowCenter=128,e.colormapId=n}return!0}function l(e,t){return s(Object(a.getEnabledElement)(e).image,t)}},"./fitToWindow.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./updateImage.js"),o=n("./internal/getImageFitScale.js");t.default=function(e){var t=Object(a.getEnabledElement)(e),n=t.image;t.viewport.scale=Object(o.default)(t.canvas,n,t.viewport.rotation).scaleFactor,t.viewport.translation.x=0,t.viewport.translation.y=0,Object(r.default)(e)}},"./generateUUID.js":function(e,t,n){"use strict";n.r(t),t.default=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}},"./getDefaultViewportForImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getDefaultViewport.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(r.default)(n.canvas,t)}},"./getImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){return Object(a.getEnabledElement)(e).image}},"./getPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./getStoredPixels.js"),o=n("./internal/getModalityLUT.js");t.default=function(e,t,n,i,s){var l=Object(r.default)(e,t,n,i,s),u=Object(a.getEnabledElement)(e),d=Object(o.default)(u.image.slope,u.image.intercept,u.viewport.modalityLUT);return l.map(d)}},"./getStoredPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e,t,n,r,o){if(void 0===e)throw new Error("getStoredPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);for(var i=Object(a.getEnabledElement)(e),s=[],l=0,u=i.image.getPixelData(),d=0;d<o;d++)for(var c=0;c<r;c++)s[l++]=u[(d+n)*i.image.columns+(c+t)];return s}},"./getViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js");t.default=function(e){var t=Object(a.getEnabledElement)(e).viewport;if(void 0!==t)return Object.assign({},t)}},"./imageCache.js":function(e,t,n){"use strict";n.r(t),n.d(t,"cachedImages",function(){return l}),n.d(t,"setMaximumSizeBytes",function(){return u}),n.d(t,"putImageLoadObject",function(){return c}),n.d(t,"getImageLoadObject",function(){return f}),n.d(t,"removeImageLoadObject",function(){return h}),n.d(t,"getCacheInfo",function(){return m}),n.d(t,"purgeCache",function(){return g}),n.d(t,"changeImageIdCacheSize",function(){return p});var a=n("./events.js"),r=n("./triggerEvent.js"),o=1073741824,i=0,s={},l=[];function u(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");o=e,Object(r.default)(a.events,a.default.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),d()}function d(){if(!(i<=o)){for(l.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});i>o;){var e=l[l.length-1].imageId;h(e),Object(r.default)(a.events,a.default.IMAGE_CACHE_PROMISE_REMOVED,{imageId:e})}var t=m();Object(r.default)(a.events,a.default.IMAGE_CACHE_FULL,t)}}function c(e,t){if(void 0===e)throw new Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(!0===s.hasOwnProperty(e))throw new Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};s[e]=n,l.push(n),t.promise.then(function(e){if(-1!==l.indexOf(n)){if(n.loaded=!0,n.image=e,void 0===e.sizeInBytes)throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw new Error("putImageLoadObject: image.sizeInBytes is not a number");n.sizeInBytes=e.sizeInBytes,i+=n.sizeInBytes;var t={action:"addImage",image:n};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,t),n.sharedCacheKey=e.sharedCacheKey,d()}},function(){l.splice(l.indexOf(s[e]),1),delete s[e]})}function f(e){if(void 0===e)throw new Error("getImageLoadObject: imageId must not be undefined");var t=s[e];if(void 0!==t)return t.timeStamp=Date.now(),t.imageLoadObject}function h(e){if(void 0===e)throw new Error("removeImageLoadObject: imageId must not be undefined");var t=s[e];if(void 0===t)throw new Error("removeImageLoadObject: imageId was not present in imageCache");l.splice(l.indexOf(t),1),i-=t.sizeInBytes;var n,o={action:"deleteImage",image:t};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,o),(n=t.imageLoadObject).promise.then(function(){n.decache&&n.decache()},function(){n.decache&&n.decache()}),delete s[e]}function m(){return{maximumSizeInBytes:o,cacheSizeInBytes:i,numberOfImagesCached:l.length}}function g(){for(;l.length>0;)h(l[0].imageId)}function p(e,t){var n=s[e];n&&n.imageLoadObject.promise.then(function(e){var o=t-e.sizeInBytes;e.sizeInBytes=t,n.sizeInBytes=t,i+=o;var s={action:"changeImageSize",image:e};Object(r.default)(a.events,a.default.IMAGE_CACHE_CHANGED,s)})}t.default={imageCache:s,cachedImages:l,setMaximumSizeBytes:u,putImageLoadObject:c,getImageLoadObject:f,removeImageLoadObject:h,getCacheInfo:m,purgeCache:g,changeImageIdCacheSize:p}},"./imageLoader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"loadImage",function(){return u}),n.d(t,"loadAndCacheImage",function(){return d}),n.d(t,"registerImageLoader",function(){return c}),n.d(t,"registerUnknownImageLoader",function(){return f});var a,r=n("./imageCache.js"),o=n("./events.js"),i=n("./triggerEvent.js"),s={};function l(e,t){var n=e.indexOf(":"),r=e.substring(0,n),l=s[r];if(null==l){if(void 0!==a)return a(e);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var u=l(e,t);return u.promise.then(function(e){Object(i.default)(o.events,o.default.IMAGE_LOADED,{image:e})},function(t){var n={imageId:e,error:t};Object(i.default)(o.events,o.default.IMAGE_LOAD_FAILED,n)}),u}function u(e,t){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");var n=Object(r.getImageLoadObject)(e);return void 0!==n?n.promise:l(e,t).promise}function d(e,t){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var n=Object(r.getImageLoadObject)(e);return void 0!==n||(n=l(e,t),Object(r.putImageLoadObject)(e,n)),n.promise}function c(e,t){s[e]=t}function f(e){var t=a;return a=e,t}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js");n.d(t,"EVENTS",function(){return a.default}),n.d(t,"events",function(){return a.events});var r=n("./enabledElements.js");n.d(t,"getEnabledElement",function(){return r.getEnabledElement}),n.d(t,"addEnabledElement",function(){return r.addEnabledElement}),n.d(t,"getEnabledElementsByImageId",function(){return r.getEnabledElementsByImageId}),n.d(t,"getEnabledElements",function(){return r.getEnabledElements});var o=n("./layers.js");n.d(t,"addLayer",function(){return o.addLayer}),n.d(t,"removeLayer",function(){return o.removeLayer}),n.d(t,"getLayer",function(){return o.getLayer}),n.d(t,"getLayers",function(){return o.getLayers}),n.d(t,"getVisibleLayers",function(){return o.getVisibleLayers}),n.d(t,"setActiveLayer",function(){return o.setActiveLayer}),n.d(t,"getActiveLayer",function(){return o.getActiveLayer}),n.d(t,"purgeLayers",function(){return o.purgeLayers}),n.d(t,"setLayerImage",function(){return o.setLayerImage});var i=n("./falseColorMapping.js");n.d(t,"convertImageToFalseColorImage",function(){return i.convertImageToFalseColorImage}),n.d(t,"convertToFalseColorImage",function(){return i.convertToFalseColorImage}),n.d(t,"restoreImage",function(){return i.restoreImage});var s=n("./enabledElementData.js");n.d(t,"getElementData",function(){return s.getElementData}),n.d(t,"removeElementData",function(){return s.removeElementData});var l=n("./imageLoader.js");n.d(t,"loadImage",function(){return l.loadImage}),n.d(t,"loadAndCacheImage",function(){return l.loadAndCacheImage}),n.d(t,"registerImageLoader",function(){return l.registerImageLoader}),n.d(t,"registerUnknownImageLoader",function(){return l.registerUnknownImageLoader});var u=n("./canvasToPixel.js");n.d(t,"canvasToPixel",function(){return u.default});var d=n("./colors/index.js");n.d(t,"colors",function(){return d.default});var c=n("./disable.js");n.d(t,"disable",function(){return c.default});var f=n("./displayImage.js");n.d(t,"displayImage",function(){return f.default});var h=n("./draw.js");n.d(t,"draw",function(){return h.default});var m=n("./internal/drawImage.js");n.d(t,"drawImage",function(){return m.default});var g=n("./drawInvalidated.js");n.d(t,"drawInvalidated",function(){return g.default});var p=n("./enable.js");n.d(t,"enable",function(){return p.default});var v=n("./fitToWindow.js");n.d(t,"fitToWindow",function(){return v.default});var b=n("./internal/generateLut.js");n.d(t,"generateLut",function(){return b.default});var y=n("./internal/getDefaultViewport.js");n.d(t,"getDefaultViewport",function(){return y.default});var x=n("./getDefaultViewportForImage.js");n.d(t,"getDefaultViewportForImage",function(){return x.default});var w=n("./getImage.js");n.d(t,"getImage",function(){return w.default});var j=n("./getPixels.js");n.d(t,"getPixels",function(){return j.default});var T=n("./getStoredPixels.js");n.d(t,"getStoredPixels",function(){return T.default});var _=n("./getViewport.js");n.d(t,"getViewport",function(){return _.default});var E=n("./imageCache.js");n.d(t,"imageCache",function(){return E.default});var O=n("./internal/index.js");n.d(t,"internal",function(){return O.default});var S=n("./invalidate.js");n.d(t,"invalidate",function(){return S.default});var C=n("./invalidateImageId.js");n.d(t,"invalidateImageId",function(){return C.default});var I=n("./metaData.js");n.d(t,"metaData",function(){return I.default});var M=n("./pageToPixel.js");n.d(t,"pageToPixel",function(){return M.default});var P=n("./pixelDataToFalseColorData.js");n.d(t,"pixelDataToFalseColorData",function(){return P.default});var D=n("./pixelToCanvas.js");n.d(t,"pixelToCanvas",function(){return D.default});var k=n("./rendering/renderColorImage.js");n.d(t,"renderColorImage",function(){return k.renderColorImage});var L=n("./rendering/renderGrayscaleImage.js");n.d(t,"renderGrayscaleImage",function(){return L.renderGrayscaleImage});var A=n("./rendering/renderLabelMapImage.js");n.d(t,"renderLabelMapImage",function(){return A.renderLabelMapImage});var R=n("./rendering/renderPseudoColorImage.js");n.d(t,"renderPseudoColorImage",function(){return R.renderPseudoColorImage});var B=n("./rendering/renderToCanvas.js");n.d(t,"renderToCanvas",function(){return B.default});var F=n("./rendering/renderWebImage.js");n.d(t,"renderWebImage",function(){return F.renderWebImage});var U=n("./rendering/index.js");n.d(t,"rendering",function(){return U.default});var H=n("./internal/requestAnimationFrame.js");n.d(t,"requestAnimationFrame",function(){return H.default});var N=n("./reset.js");n.d(t,"reset",function(){return N.default});var z=n("./resize.js");n.d(t,"resize",function(){return z.default});var V=n("./internal/setDefaultViewport.js");n.d(t,"setDefaultViewport",function(){return V.default});var q=n("./setToPixelCoordinateSystem.js");n.d(t,"setToPixelCoordinateSystem",function(){return q.default});var W=n("./setViewport.js");n.d(t,"setViewport",function(){return W.default});var G=n("./internal/storedColorPixelDataToCanvasImageData.js");n.d(t,"storedColorPixelDataToCanvasImageData",function(){return G.default});var Z=n("./internal/storedPixelDataToCanvasImageData.js");n.d(t,"storedPixelDataToCanvasImageData",function(){return Z.default});var Y=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataColorLUT",function(){return Y.default});var X=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataPseudocolorLUT",function(){return X.default});var J=n("./triggerEvent.js");n.d(t,"triggerEvent",function(){return J.default});var K=n("./updateImage.js");n.d(t,"updateImage",function(){return K.default});var $=n("./webgl/index.js");n.d(t,"webGL",function(){return $.default}),t.default={drawImage:m.default,generateLut:b.default,getDefaultViewport:y.default,requestAnimationFrame:H.default,storedPixelDataToCanvasImageData:Z.default,storedColorPixelDataToCanvasImageData:G.default,storedPixelDataToCanvasImageDataColorLUT:Y.default,storedPixelDataToCanvasImageDataPseudocolorLUT:X.default,internal:O.default,renderLabelMapImage:A.renderLabelMapImage,renderPseudoColorImage:R.renderPseudoColorImage,renderColorImage:k.renderColorImage,renderGrayscaleImage:L.renderGrayscaleImage,renderWebImage:F.renderWebImage,renderToCanvas:B.default,canvasToPixel:u.default,disable:c.default,displayImage:f.default,draw:h.default,drawInvalidated:g.default,enable:p.default,getElementData:s.getElementData,removeElementData:s.removeElementData,getEnabledElement:r.getEnabledElement,addEnabledElement:r.addEnabledElement,getEnabledElementsByImageId:r.getEnabledElementsByImageId,getEnabledElements:r.getEnabledElements,addLayer:o.addLayer,removeLayer:o.removeLayer,getLayer:o.getLayer,getLayers:o.getLayers,getVisibleLayers:o.getVisibleLayers,setActiveLayer:o.setActiveLayer,getActiveLayer:o.getActiveLayer,purgeLayers:o.purgeLayers,setLayerImage:o.setLayerImage,fitToWindow:v.default,getDefaultViewportForImage:x.default,setDefaultViewport:V.default,getImage:w.default,getPixels:j.default,getStoredPixels:T.default,getViewport:_.default,loadImage:l.loadImage,loadAndCacheImage:l.loadAndCacheImage,registerImageLoader:l.registerImageLoader,registerUnknownImageLoader:l.registerUnknownImageLoader,invalidate:S.default,invalidateImageId:C.default,pageToPixel:M.default,pixelToCanvas:D.default,reset:N.default,resize:z.default,setToPixelCoordinateSystem:q.default,setViewport:W.default,updateImage:K.default,pixelDataToFalseColorData:P.default,rendering:U.default,imageCache:E.default,metaData:I.default,webGL:$.default,colors:d.default,convertImageToFalseColorImage:i.convertImageToFalseColorImage,convertToFalseColorImage:i.convertToFalseColorImage,restoreImage:i.restoreImage,EVENTS:a.default,events:a.events,triggerEvent:J.default}},"./internal/calculateTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js");t.default=function(e,t){var n=new a.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var r=e.viewport.rotation;0!==r&&n.rotate(r*Math.PI/180);var o=e.viewport.scale,i=e.viewport.scale,s=e.viewport.displayedArea.brhc.x-(e.viewport.displayedArea.tlhc.x-1),l=e.viewport.displayedArea.brhc.y-(e.viewport.displayedArea.tlhc.y-1);return"NONE"===e.viewport.displayedArea.presentationSizeMode?e.image.rowPixelSpacing<e.image.columnPixelSpacing?o*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(i*=e.image.rowPixelSpacing/e.image.columnPixelSpacing):(o=e.viewport.displayedArea.columnPixelSpacing,i=e.viewport.displayedArea.rowPixelSpacing,"SCALE TO FIT"===e.viewport.displayedArea.presentationSizeMode&&(o=i=Math.min(e.canvas.width/(s*o),e.canvas.height/(l*i)),e.viewport.displayedArea.rowPixelSpacing<e.viewport.displayedArea.columnPixelSpacing?o*=e.viewport.displayedArea.columnPixelSpacing/e.viewport.displayedArea.rowPixelSpacing:e.viewport.displayedArea.columnPixelSpacing<e.viewport.displayedArea.rowPixelSpacing&&(i*=e.viewport.displayedArea.rowPixelSpacing/e.viewport.displayedArea.columnPixelSpacing))),n.scale(o,i),0!==r&&n.rotate(-r*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==r&&n.rotate(r*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-s/2,-l/2),n}},"./internal/computeAutoVoi.js":function(e,t,n){"use strict";function a(e,t){if(!function(e){return e.voiLUT&&e.voiLUT.lut&&e.voiLUT.lut.length>0||void 0!==e.voi.windowWidth&&void 0!==e.voi.windowCenter}(e)){var n=t.maxPixelValue*t.slope+t.intercept,a=t.minPixelValue*t.slope+t.intercept,r=n-a,o=(n+a)/2;void 0===e.voi?e.voi={windowWidth:r,windowCenter:o}:(e.voi.windowWidth=r,e.voi.windowCenter=o)}}n.r(t),n.d(t,"default",function(){return a})},"./internal/createViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/setDefaultViewport.js");t.default=function(){return Object.assign({},{scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:{tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"}},a.state.viewport)}},"./internal/drawCompositeImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./layers.js"),r=n("./rendering/renderGrayscaleImage.js"),o=n("./rendering/renderColorImage.js"),i=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),l=n("./setToPixelCoordinateSystem.js");function u(e){var t=e.syncProps||{};t.originalScale=e.viewport.scale,e.syncProps=t}t.default=function(e,t){var n=e.element,d=Object(a.getLayers)(n),c=Object(a.getActiveLayer)(n),f=Object(a.getVisibleLayers)(n),h=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,h&&d.forEach(function(e){e.viewport&&u(e)}),!0===e.syncViewports&&function(e,t){e.forEach(function(e){if(e!==t&&e.viewport&&t.viewport){e.syncProps||u(e);var n,a,r=(a=e,(n=t).syncProps||u(n),a.syncProps||u(a),a.syncProps.originalScale/n.syncProps.originalScale);e.viewport.scale=t.viewport.scale*r,e.viewport.rotation=t.viewport.rotation,e.viewport.translation={x:t.viewport.translation.x/r,y:t.viewport.translation.y/r},e.viewport.hflip=t.viewport.hflip,e.viewport.vflip=t.viewport.vflip}})}(f,c);var m=e.canvas.getContext("2d");m.setTransform(1,0,0,1,0,0),m.fillStyle="black",m.fillRect(0,0,e.canvas.width,e.canvas.height),function(e,t,n){t.forEach(function(t,a){if(t.image){e.save(),t.canvas=e.canvas,Object(l.default)(t,e);var u=t.viewport.colormap||t.options.colormap,d=t.invalid||n;if(u&&""!==u&&!0===t.viewport.labelmap)Object(s.addLabelMapLayer)(t,d);else if(u&&""!==u)Object(i.addPseudoColorLayer)(t,d);else if(!0===t.image.color)Object(o.addColorLayer)(t,d);else{var c=0===a;Object(r.addGrayscaleLayer)(t,d,c)}e.globalAlpha=t.options&&t.options.opacity?t.options.opacity:1,t.options&&t.options.fillStyle&&(e.fillStyle=t.options.fillStyle),e.imageSmoothingEnabled=!t.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled;var f=t.viewport.displayedArea.tlhc.x-1,h=t.viewport.displayedArea.tlhc.y-1,m=t.viewport.displayedArea.brhc.x-f,g=t.viewport.displayedArea.brhc.y-h;e.drawImage(t.canvas,f,h,m,g,0,0,m,g),e.restore(),t.invalid=!1}})}(m,f,t)}},"./internal/drawImage.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.needsRedraw=!0,t&&(e.invalid=!0)}},"./internal/drawImageSync.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js"),r=n("./internal/drawCompositeImage.js"),o=n("./rendering/renderColorImage.js"),i=n("./rendering/renderGrayscaleImage.js"),s=n("./rendering/renderPseudoColorImage.js"),l=n("./rendering/renderLabelMapImage.js"),u=n("./triggerEvent.js"),d=n("./events.js");t.default=function(e,t){var n=e.image,c=e.element,f=e.layers||[];if(e.canvas&&(e.image||f.length)){var h=Object(a.default)();if(n.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},f&&f.length)Object(r.default)(e,t);else if(n){var m=n.render;m||(m=e.viewport.colormap&&""!==e.viewport.colormap&&!0===e.image.labelmap?l.renderLabelMapImage:e.viewport.colormap&&""!==e.viewport.colormap?s.renderPseudoColorImage:n.color?o.renderColorImage:i.renderGrayscaleImage),m(e,t)}var g=Object(a.default)()-h,p={viewport:e.viewport,element:c,image:n,enabledElement:e,canvasContext:e.canvas.getContext("2d"),renderTimeInMs:g};n.stats.lastRenderTime=g,e.invalid=!1,e.needsRedraw=!1,Object(u.default)(c,d.default.IMAGE_RENDERED,p)}}},"./internal/generateColorLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getVOILut.js");t.default=function(e,t,n,r,o){var i=e.maxPixelValue,s=e.minPixelValue,l=Math.min(s,0);if(void 0===e.cachedLut){var u=i-l+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(u)}var d=e.cachedLut.lutArray,c=Object(a.default)(t,n,o);if(!0===r)for(var f=s;f<=i;f++)d[f+-l]=255-c(f);else for(var h=s;h<=i;h++)d[h+-l]=c(h);return d}},"./internal/generateLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getModalityLUT.js"),r=n("./internal/getVOILut.js");t.default=function(e,t,n,o,i,s){var l=e.maxPixelValue,u=e.minPixelValue,d=Math.min(u,0);if(void 0===e.cachedLut){var c=l-d+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(c)}var f=e.cachedLut.lutArray,h=Object(a.default)(e.slope,e.intercept,i),m=Object(r.default)(t,n,s);if(!0===o)for(var g=u;g<=l;g++)f[g+-d]=255-m(h(g));else for(var p=u;p<=l;p++)f[p+-d]=m(h(p));return f}},"./internal/getCanvas.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a="cornerstone-canvas";function r(e){var t="canvas.".concat(a);return e.querySelector(t)||function(e){var t=document.createElement("canvas");return t.style.display="block",t.classList.add(a),e.appendChild(t),t}(e)}},"./internal/getDefaultViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/createViewport.js"),r=n("./internal/getImageFitScale.js");t.default=function(e,t){if(void 0===e)throw new Error("getDefaultViewport: parameter canvas must not be undefined");return void 0===t?Object(a.default)():{scale:Object(r.default)(e,t,0).scaleFactor,translation:{x:0,y:0},voi:{windowWidth:t.windowWidth,windowCenter:t.windowCenter},invert:t.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap,labelmap:Boolean(t.labelmap),displayedArea:{tlhc:{x:1,y:1},brhc:{x:t.columns,y:t.rows},rowPixelSpacing:void 0===t.rowPixelSpacing?1:t.rowPixelSpacing,columnPixelSpacing:void 0===t.columnPixelSpacing?1:t.columnPixelSpacing,presentationSizeMode:"NONE"}}}},"./internal/getImageFitScale.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js"),r=n("./internal/getImageSize.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(a.validateParameterUndefinedOrNull)(e,"getImageScale: parameter windowSize must not be undefined"),Object(a.validateParameterUndefinedOrNull)(t,"getImageScale: parameter image must not be undefined");var o=Object(r.default)(t,n),i=t.rowPixelSpacing||1,s=t.columnPixelSpacing||1,l=1,u=1;i<s?u=s/i:l=i/s;var d=e.height/o.height/l,c=e.width/o.width/u;return{verticalScale:d,horizontalScale:c,scaleFactor:Math.min(c,d)}}},"./internal/getImageSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/validator.js");function r(e){return!(null==e||0===e||180===e)}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(a.validateParameterUndefinedOrNull)(e,"getImageSize: parameter image must not be undefined"),Object(a.validateParameterUndefinedOrNull)(e.width,"getImageSize: parameter image must have width"),Object(a.validateParameterUndefinedOrNull)(e.height,"getImageSize: parameter image must have height"),r(t)?{height:e.width,width:e.height}:{width:e.width,height:e.height}}},"./internal/getModalityLUT.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return n?function(e){var t=e.lut[0],n=e.lut[e.lut.length-1],a=e.firstValueMapped+e.lut.length;return function(r){return r<e.firstValueMapped?t:r>=a?n:e.lut[r]}}(n):function(e,t){return function(n){return n*e+t}}(e,t)}},"./internal/getTransform.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e){return Object(a.default)(e)}},"./internal/getVOILut.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return n?function(e){var t,n=Math.max.apply(Math,(t=e.lut,function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(t)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}())).toString(2).length-8,a=e.lut[0]>>n,r=e.lut[e.lut.length-1]>>n,o=e.firstValueMapped+e.lut.length-1;return function(t){return t<e.firstValueMapped?a:t>=o?r:e.lut[t-e.firstValueMapped]>>n}}(n):function(e,t){return function(n){return 255*((n-t)/e+.5)}}(e,t)}},"./internal/guid.js":function(e,t,n){"use strict";function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.r(t),t.default=function(){return"".concat(a()+a(),"-").concat(a(),"-").concat(a(),"-").concat(a(),"-").concat(a()).concat(a()).concat(a())}},"./internal/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/transform.js"),r=n("./internal/calculateTransform.js"),o=n("./internal/drawImage.js"),i=n("./internal/generateLut.js"),s=n("./internal/getDefaultViewport.js"),l=n("./internal/getTransform.js"),u=n("./internal/requestAnimationFrame.js"),d=n("./internal/setDefaultViewport.js"),c=n("./internal/storedColorPixelDataToCanvasImageData.js"),f=n("./internal/storedPixelDataToCanvasImageData.js"),h=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),m=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),g=n("./internal/storedPixelDataToCanvasImageDataRGBA.js");t.default={drawImage:o.default,generateLut:i.default,getDefaultViewport:s.default,requestAnimationFrame:u.default,setDefaultViewport:d.default,storedPixelDataToCanvasImageData:f.default,storedPixelDataToCanvasImageDataRGBA:g.default,storedPixelDataToCanvasImageDataColorLUT:h.default,storedPixelDataToCanvasImageDataPseudocolorLUT:m.default,storedColorPixelDataToCanvasImageData:c.default,getTransform:l.default,calculateTransform:r.default,Transform:a.Transform}},"./internal/now.js":function(e,t,n){"use strict";n.r(t),t.default=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||function(e){window.setTimeout(e,1e3/60)}(e)}},"./internal/setDefaultViewport.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",function(){return a});var a={viewport:{}};t.default=function(e){a.viewport=e||{}}},"./internal/storedColorPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=e.minPixelValue,s=0,l=0,u=o.length;if(r=Object(a.default)(),i<0)for(;l<u;)n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s]=t[o[l]+-i],l+=2,s+=2;else for(;l<u;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s]=t[o[l]],l+=2,s+=2;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=o.length,s=e.minPixelValue,l=3,u=0;if(r=Object(a.default)(),o instanceof Int16Array)if(s<0)for(;u<i;)n[l]=t[o[u++]+-s],l+=4;else for(;u<i;)n[l]=t[o[u++]],l+=4;else if(o instanceof Uint16Array)for(;u<i;)n[l]=t[o[u++]],l+=4;else if(s<0)for(;u<i;)n[l]=t[o[u++]+-s],l+=4;else for(;u<i;)n[l]=t[o[u++]],l+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),r=n("./internal/now.js");t.default=function(e,t,n){var o=Object(r.default)(),i=e.getPixelData();e.stats.lastGetPixelDataTime=Object(r.default)()-o;var s,l,u=i.length,d=e.minPixelValue,c=0,f=0;if(o=Object(r.default)(),l=t instanceof a.default.LookupTable?t.Table:t,d<0)for(;f<u;)s=l[i[f++]+-d],n[c++]=s[0],n[c++]=s[1],n[c++]=s[2],n[c++]=s[3];else for(;f<u;)s=l[i[f++]],n[c++]=s[0],n[c++]=s[1],n[c++]=s[2],n[c++]=s[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-o}},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(e,t,n){"use strict";n.r(t);var a=n("./colors/index.js"),r=n("./internal/now.js");t.default=function(e,t,n,o){var i=Object(r.default)(),s=e.getPixelData();e.stats.lastGetPixelDataTime=Object(r.default)()-i;var l,u,d,c=s.length,f=e.minPixelValue,h=0,m=0;if(i=Object(r.default)(),d=n instanceof a.default.LookupTable?n.Table:n,f<0)for(;m<c;)l=t[s[m++]+-f],o[h++]=(u=d[l])[0],o[h++]=u[1],o[h++]=u[2],o[h++]=u[3];else for(;m<c;)l=t[s[m++]],o[h++]=(u=d[l])[0],o[h++]=u[1],o[h++]=u[2],o[h++]=u[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-i}},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i,s=o.length,l=e.minPixelValue,u=0,d=0;if(r=Object(a.default)(),o instanceof Int16Array)if(l<0)for(;d<s;)i=t[o[d++]+-l],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;d<s;)i=t[o[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(o instanceof Uint16Array)for(;d<s;)i=t[o[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else if(l<0)for(;d<s;)i=t[o[d++]+-l],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;else for(;d<s;)i=t[o[d++]],n[u++]=i,n[u++]=i,n[u++]=i,n[u++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/now.js");t.default=function(e,t,n){var r=Object(a.default)(),o=e.getPixelData();e.stats.lastGetPixelDataTime=Object(a.default)()-r;var i=e.minPixelValue,s=0,l=0,u=o.length;if(r=Object(a.default)(),i<0)for(;l<u;)n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s++]=t[o[l++]+-i],n[s++]=o[l++];else for(;l<u;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=o[l++];e.stats.lastStoredPixelDataToCanvasImageDataTime=Object(a.default)()-r}},"./internal/transform.js":function(e,t,n){"use strict";n.r(t),n.d(t,"Transform",function(){return a});var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}var t;return(t=[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var t=new e;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function(e){var t=this.m[1]*e.m[0]+this.m[3]*e.m[1],n=this.m[0]*e.m[2]+this.m[2]*e.m[3],a=this.m[1]*e.m[2]+this.m[3]*e.m[3],r=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],o=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];this.m[0]=this.m[0]*e.m[0]+this.m[2]*e.m[1],this.m[1]=t,this.m[2]=n,this.m[3]=a,this.m[4]=r,this.m[5]=o}},{key:"invert",value:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=-this.m[1]*e,n=-this.m[2]*e,a=this.m[0]*e,r=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*e,this.m[1]=t,this.m[2]=n,this.m[3]=a,this.m[4]=r,this.m[5]=o}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),a=this.m[1]*t+this.m[3]*n,r=this.m[0]*-n+this.m[2]*t,o=this.m[1]*-n+this.m[3]*t;this.m[0]=this.m[0]*t+this.m[2]*n,this.m[1]=a,this.m[2]=r,this.m[3]=o}},{key:"translate",value:function(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}},{key:"scale",value:function(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}},{key:"transformPoint",value:function(e,t){var n=e;return{x:e=n*this.m[0]+t*this.m[2]+this.m[4],y:t=n*this.m[1]+t*this.m[3]+this.m[5]}}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}()},"./internal/tryEnableWebgl.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/index.js");t.default=function(e){return a.default.renderer.isWebGLAvailable()?(a.default.renderer.initRenderer(),e.renderer="webgl",!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete e.renderer,!1)}},"./internal/validator.js":function(e,t,n){"use strict";function a(e,t){if(void 0===e)throw new Error(t)}function r(e,t){if(null==e)throw new Error(t)}n.r(t),n.d(t,"validateParameterUndefined",function(){return a}),n.d(t,"validateParameterUndefinedOrNull",function(){return r})},"./invalidate.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./triggerEvent.js"),o=n("./events.js");t.default=function(e){var t=Object(a.getEnabledElement)(e);t.invalid=!0,t.needsRedraw=!0;var n={element:e};Object(r.default)(e,o.default.INVALIDATED,n)}},"./invalidateImageId.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){Object(a.getEnabledElementsByImageId)(e).forEach(function(e){Object(r.default)(e,!0)})}},"./layers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rescaleImage",function(){return d}),n.d(t,"addLayer",function(){return c}),n.d(t,"removeLayer",function(){return f}),n.d(t,"getLayer",function(){return h}),n.d(t,"getLayers",function(){return m}),n.d(t,"getVisibleLayers",function(){return g}),n.d(t,"setActiveLayer",function(){return p}),n.d(t,"setLayerImage",function(){return v}),n.d(t,"getActiveLayer",function(){return b}),n.d(t,"purgeLayers",function(){return y});var a=n("./internal/guid.js"),r=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js"),i=n("./updateImage.js"),s=n("./triggerEvent.js"),l=n("./events.js");function u(e,t,n){var a=t.element,r={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};Object(s.default)(a,e,r)}function d(e,t){if(e.layerId===t.layerId)throw new Error("rescaleImage: both arguments represent the same layer");var n=e.image,a=t.image;n.imageId&&a.imageId&&(t.viewport.scale=e.viewport.scale*(t.viewport.scale/e.viewport.scale*(t.viewport.displayedArea.columnPixelSpacing*a.width/(e.viewport.displayedArea.columnPixelSpacing*n.width))))}function c(e,t,n){var i,s=Object(a.default)(),c=Object(r.getEnabledElement)(e),f=c.layers;t&&(i=Object(o.default)(c.canvas,t),n&&n.viewport&&(i=Object.assign(i,n.viewport))),!1!==c.syncViewports&&(c.syncViewports=!0);var h={image:t,layerId:s,viewport:i,options:n||{},renderingTools:{}};return f.length&&t&&d(f[0],h),f.push(h),u(l.default.LAYER_ADDED,c,s),1===f.length&&t&&p(e,s),s}function f(e,t){var n=Object(r.getEnabledElement)(e),a=n.layers,o=n.layers.findIndex(function(e){return e.layerId===t});-1!==o&&(a.splice(o,1),t===n.activeLayerId&&a.length&&p(e,a[0].layerId),u(l.default.LAYER_REMOVED,n,t))}function h(e,t){return Object(r.getEnabledElement)(e).layers.find(function(e){return e.layerId===t})}function m(e){return Object(r.getEnabledElement)(e).layers}function g(e){return Object(r.getEnabledElement)(e).layers.filter(function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity})}function p(e,t){var n=Object(r.getEnabledElement)(e);if(n.activeLayerId!==t){var a=n.layers.findIndex(function(e){return e.layerId===t});if(-1===a)throw new Error("setActiveLayer: layer not found in layers array");var o=n.layers[a];if(!o.image)throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");n.activeLayerId=t,n.image=o.image,n.viewport=o.viewport,Object(i.default)(e),u(l.default.ACTIVE_LAYER_CHANGED,n,t)}}function v(e,t,n){var a,i=Object(r.getEnabledElement)(e),s=i.layers[0];if(!(a=n?h(e,n):b(e)))throw new Error("setLayerImage: Layer not found");if(a.image=t,t){if(!a.viewport){var l=Object(o.default)(i.canvas,t);a.options&&a.options.viewport&&(a.viewport=Object.assign(l,a.options.viewport)),s.layerId!==n&&d(s,a)}}else a.viewport=void 0}function b(e){var t=Object(r.getEnabledElement)(e);return t.layers.find(function(e){return e.layerId===t.activeLayerId})}function y(e){var t=Object(r.getEnabledElement)(e);t.layers=[],delete t.activeLayerId,delete t.lastSyncViewportsState}},"./metaData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addProvider",function(){return r}),n.d(t,"removeProvider",function(){return o});var a=[];function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(t=0;t<a.length&&!(a[t].priority<=n);t++);a.splice(t,0,{priority:n,provider:e})}function o(e){for(var t=0;t<a.length;t++)if(a[t].provider===e){a.splice(t,1);break}}t.default={addProvider:r,removeProvider:o,get:function(e,t){for(var n=0;n<a.length;n++){var r=a[n].provider(e,t);if(void 0!==r)return r}}}},"./pageToPixel.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t,n){var o=Object(a.getEnabledElement)(e);if(void 0===o.image)throw new Error("image has not been loaded yet");var i=e.getBoundingClientRect(),s={x:t-i.left-window.pageXOffset,y:n-i.top-window.pageYOffset},l=Object(r.default)(o);return l.invert(),l.transformPoint(s.x,s.y)}},"./pixelDataToFalseColorData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./colors/index.js");function r(e,t){if(e.color&&!e.falseColor)throw new Error("Color transforms are not implemented yet");var n,r,o=e.minPixelValue,i=0,s=0,l=e.width*e.height,u=e.origPixelData||e.getPixelData(),d=new Uint8Array(4*l);if(e.color=!0,e.falseColor=!0,e.origPixelData=u,t instanceof a.default.LookupTable)for(t.build();s<l;)n=u[s++],r=t.mapValue(n),d[i++]=r[0],d[i++]=r[1],d[i++]=r[2],d[i++]=r[3];else if(o<0)for(;s<l;)n=u[s++],d[i++]=t[n+-o][0],d[i++]=t[n+-o][1],d[i++]=t[n+-o][2],d[i++]=t[n+-o][3];else for(;s<l;)n=u[s++],d[i++]=t[n][0],d[i++]=t[n][1],d[i++]=t[n][2],d[i++]=t[n][3];e.rgba=!0,e.cachedLut=void 0,e.render=void 0,e.slope=1,e.intercept=0,e.minPixelValue=0,e.maxPixelValue=255,e.windowWidth=255,e.windowCenter=128,e.getPixelData=function(){return d}}},"./pixelToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/getTransform.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e);return Object(r.default)(n).transformPoint(t.x,t.y)}},"./rendering/doesImageNeedToBeRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.lastRenderedViewport;return t.imageId!==e.renderingTools.lastRenderedImageId||!n||n.windowCenter!==e.viewport.voi.windowCenter||n.windowWidth!==e.viewport.voi.windowWidth||n.invert!==e.viewport.invert||n.rotation!==e.viewport.rotation||n.hflip!==e.viewport.hflip||n.vflip!==e.viewport.vflip||n.modalityLUT!==e.viewport.modalityLUT||n.voiLUT!==e.viewport.voiLUT||n.colormap!==e.viewport.colormap}},"./rendering/getLut.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/computeAutoVoi.js"),r=n("./rendering/lutMatches.js"),o=n("./internal/generateLut.js");t.default=function(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&Object(r.default)(e.cachedLut.modalityLUT,t.modalityLUT)&&Object(r.default)(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!0!==n||(Object(a.default)(t,e),Object(o.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT),e.cachedLut.lutArray}},"./rendering/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./rendering/renderColorImage.js"),r=n("./rendering/renderGrayscaleImage.js"),o=n("./rendering/renderWebImage.js"),i=n("./rendering/renderPseudoColorImage.js"),s=n("./rendering/renderLabelMapImage.js"),l=n("./rendering/renderToCanvas.js");t.default={colorImage:a.renderColorImage,grayscaleImage:r.renderGrayscaleImage,webImage:o.renderWebImage,pseudoColorImage:i.renderPseudoColorImage,labelMapImage:s.renderLabelMapImage,toCanvas:l.default}},"./rendering/initializeRenderCanvas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.renderingTools.renderCanvas;n.width=t.width,n.height=t.height;var a=n.getContext("2d");a.fillStyle="white",a.fillRect(0,0,n.width,n.height);var r=a.getImageData(0,0,t.width,t.height);e.renderingTools.renderCanvasContext=a,e.renderingTools.renderCanvasData=r}},"./rendering/lutMatches.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return!e&&!t||!(!e||!t)&&e.id===t.id}},"./rendering/renderColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderColorImage",function(){return h}),n.d(t,"addColorLayer",function(){return m});var a=n("./internal/now.js"),r=n("./internal/generateColorLut.js"),o=n("./internal/storedColorPixelDataToCanvasImageData.js"),i=n("./internal/storedRGBAPixelDataToCanvasImageData.js"),s=n("./setToPixelCoordinateSystem.js"),l=n("./webgl/index.js"),u=n("./rendering/doesImageNeedToBeRendered.js"),d=n("./rendering/initializeRenderCanvas.js"),c=n("./rendering/saveLastRendered.js");function f(e,t,n){e.renderingTools.renderCanvas&&!0===e.renderingTools.lastRenderedIsColor||(e.renderingTools.renderCanvas=document.createElement("canvas"));var s=e.renderingTools.renderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!1===Object(u.default)(e,t)&&!0!==n)return s;s.width===t.width&&s.height===t.height||Object(d.default)(e,t);var l=Object(a.default)(),c=function(e,t){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&e.cachedLut.invert===t.invert||(Object(r.default)(e,t.voi.windowWidth,t.voi.windowCenter,t.invert),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert),e.cachedLut.lutArray}(t,e.viewport);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(a.default)()-l;var f=e.renderingTools.renderCanvasData,h=e.renderingTools.renderCanvasContext;return t.rgba?Object(i.default)(t,c,f.data):Object(o.default)(t,c,f.data),l=Object(a.default)(),h.putImageData(f,0,0),t.stats.lastPutImageDataTime=Object(a.default)()-l,s}function h(e,t){if(void 0===e)throw new Error("renderColorImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderColorImage: image must be loaded before it can be drawn");var a,r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(s.default)(e,r),a=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?l.default.renderer.render(e):f(e,n,t);var o=e.viewport.displayedArea.tlhc.x-1,i=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-o,d=e.viewport.displayedArea.brhc.y-i;r.drawImage(a,o,i,u,d,0,0,u,d),e.renderingTools=Object(c.default)(e)}function m(e,t){if(void 0===e)throw new Error("addColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addColorLayer: image must be loaded before it can be drawn");n.rgba=!0,e.canvas=f(e,n,t);var a=e.canvas.getContext("2d");a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(c.default)(e)}},"./rendering/renderGrayscaleImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderGrayscaleImage",function(){return h}),n.d(t,"addGrayscaleLayer",function(){return m});var a=n("./internal/storedPixelDataToCanvasImageData.js"),r=n("./internal/storedPixelDataToCanvasImageDataRGBA.js"),o=n("./setToPixelCoordinateSystem.js"),i=n("./internal/now.js"),s=n("./webgl/index.js"),l=n("./rendering/getLut.js"),u=n("./rendering/doesImageNeedToBeRendered.js"),d=n("./rendering/initializeRenderCanvas.js"),c=n("./rendering/saveLastRendered.js");function f(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&!s||(e.renderingTools.renderCanvas=document.createElement("canvas"),Object(d.default)(e,t));var c=e.renderingTools.renderCanvas;if(!1===Object(u.default)(e,t)&&!0!==n)return c;c.width===t.width&&c.height===t.height||Object(d.default)(e,t);var f=Object(i.default)(),h=Object(l.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(i.default)()-f;var m=e.renderingTools.renderCanvasData,g=e.renderingTools.renderCanvasContext;return o?Object(a.default)(t,h,m.data):Object(r.default)(t,h,m.data),f=Object(i.default)(),g.putImageData(m,0,0),t.stats.lastPutImageDataTime=Object(i.default)()-f,c}function h(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var a,r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(o.default)(e,r),a=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?s.default.renderer.render(e):f(e,n,t);var i=e.viewport.displayedArea.tlhc.x-1,l=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-i,d=e.viewport.displayedArea.brhc.y-l;r.drawImage(a,i,l,u,d,0,0,u,d),e.renderingTools=Object(c.default)(e)}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var a=e.image;if(void 0===a)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.canvas=f(e,a,t,n);var r=e.canvas.getContext("2d");r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,e.renderingTools=Object(c.default)(e)}},"./rendering/renderLabelMapImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderLabelMapImage",function(){return c}),n.d(t,"addLabelMapLayer",function(){return f});var a=n("./setToPixelCoordinateSystem.js"),r=n("./internal/now.js"),o=n("./rendering/initializeRenderCanvas.js"),i=n("./rendering/saveLastRendered.js"),s=n("./rendering/doesImageNeedToBeRendered.js"),l=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),u=n("./colors/index.js");function d(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,i=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),i&&"string"==typeof i&&(i=u.default.getColormap(i)),!i)throw new Error("renderLabelMapImage: colormap not found.");var d=i.getId();if(!1===Object(s.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===d)return a;a.width===t.width&&a.height===t.height||Object(o.default)(e,t);var c=Object(r.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===d||(e.renderingTools.colorLut=i.createLookupTable(),e.renderingTools.colormapId=d),t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(r.default)()-c;var f=e.renderingTools.colorLut,h=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return Object(l.default)(t,f,h.data),c=Object(r.default)(),m.putImageData(h,0,0),t.stats.lastPutImageDataTime=Object(r.default)()-c,a}function c(e,t){if(void 0===e)throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(a.default)(e,r);var o=d(e,n,t),s=e.viewport.displayedArea.tlhc.x-1,l=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-s,c=e.viewport.displayedArea.brhc.y-l;r.drawImage(o,s,l,u,c,0,0,u,c),e.renderingTools=Object(i.default)(e)}function f(e,t){if(void 0===e)throw new Error("addLabelMapLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");e.canvas=d(e,n,t);var a=e.canvas.getContext("2d");a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(i.default)(e)}},"./rendering/renderPseudoColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderPseudoColorImage",function(){return f}),n.d(t,"addPseudoColorLayer",function(){return h});var a=n("./setToPixelCoordinateSystem.js"),r=n("./internal/now.js"),o=n("./rendering/initializeRenderCanvas.js"),i=n("./rendering/getLut.js"),s=n("./rendering/saveLastRendered.js"),l=n("./rendering/doesImageNeedToBeRendered.js"),u=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),d=n("./colors/index.js");function c(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var a=e.renderingTools.renderCanvas,s=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),s&&"string"==typeof s&&(s=d.default.getColormap(s)),!s)throw new Error("renderPseudoColorImage: colormap not found.");var c=s.getId();if(!1===Object(l.default)(e,t)&&!0!==n&&e.renderingTools.colormapId===c)return a;a.width===t.width&&a.height===t.height||Object(o.default)(e,t);var f=Object(r.default)();e.renderingTools.colorLut&&!n&&e.renderingTools.colormapId===c||(s.setNumberOfColors(256),e.renderingTools.colorLut=s.createLookupTable(),e.renderingTools.colormapId=c);var h=Object(i.default)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=Object(r.default)()-f;var m=e.renderingTools.colorLut,g=e.renderingTools.renderCanvasData,p=e.renderingTools.renderCanvasContext;return Object(u.default)(t,h,m,g.data),f=Object(r.default)(),p.putImageData(g,0,0),t.stats.lastPutImageDataTime=Object(r.default)()-f,a}function f(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");var r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(a.default)(e,r);var o=c(e,n,t),i=e.viewport.displayedArea.tlhc.x-1,l=e.viewport.displayedArea.tlhc.y-1,u=e.viewport.displayedArea.brhc.x-i,d=e.viewport.displayedArea.brhc.y-l;r.drawImage(o,i,l,u,d,0,0,u,d),e.renderingTools=Object(s.default)(e)}function h(e,t){if(void 0===e)throw new Error("addPseudoColorLayer: layer parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");e.canvas=c(e,n,t);var a=e.canvas.getContext("2d");a.imageSmoothingEnabled=!e.viewport.pixelReplication,a.mozImageSmoothingEnabled=a.imageSmoothingEnabled,e.renderingTools=Object(s.default)(e)}},"./rendering/renderToCanvas.js":function(e,t,n){"use strict";n.r(t);var a=n("./triggerEvent.js"),r=n("./events.js"),o=n("./internal/drawImageSync.js"),i=n("./internal/getDefaultViewport.js"),s=n("./internal/tryEnableWebgl.js");function l(e,t,n,a){return{element:e,canvas:e,image:t,invalid:!0,needsRedraw:!0,options:n,layers:[],data:{},renderingTools:{},viewport:a}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===e)throw new Error("renderToCanvas: parameter canvas cannot be undefined");u&&u.renderer&&"webgl"===u.renderer.toLowerCase()&&Object(s.default)(u);var d=Object(i.default)(e,t);n&&Object.assign(d,n);var c=l(e,t,u,d),f={enabledElement:c,timestamp:Date.now()};Object(a.default)(c.element,r.default.PRE_RENDER,f),Object(o.default)(c,c.invalid)}},"./rendering/renderWebImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderWebImage",function(){return o});var a=n("./setToPixelCoordinateSystem.js"),r=n("./rendering/renderColorImage.js");function o(e,t){if(void 0===e)throw new Error("renderWebImage: enabledElement parameter must not be undefined");var n=e.image;if(void 0===n)throw new Error("renderWebImage: image must be loaded before it can be drawn");if(e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert){var o=e.canvas.getContext("2d");o.setTransform(1,0,0,1,0,0),o.fillStyle="black",o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(a.default)(e,o);var i=e.viewport.displayedArea.tlhc.x-1,s=e.viewport.displayedArea.tlhc.y-1,l=e.viewport.displayedArea.brhc.x-i,u=e.viewport.displayedArea.brhc.y-s;o.drawImage(n.getImage(),i,s,l,u,0,0,l,u)}else Object(r.renderColorImage)(e,t)}},"./rendering/saveLastRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.viewport,n=e.image.color;return e.renderingTools.lastRenderedImageId=e.image.imageId,e.renderingTools.lastRenderedIsColor=n,e.renderingTools.lastRenderedViewport={windowCenter:t.voi.windowCenter,windowWidth:t.voi.windowWidth,invert:t.invert,rotation:t.rotation,hflip:t.hflip,vflip:t.vflip,modalityLUT:t.modalityLUT,voiLUT:t.voiLUT,colormap:t.colormap},e.renderingTools}},"./reset.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),r=n("./enabledElements.js"),o=n("./updateImage.js");t.default=function(e){var t=Object(r.getEnabledElement)(e);t.viewport=Object(a.default)(t.canvas,t.image),Object(o.default)(e)}},"./resize.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./fitToWindow.js"),o=n("./updateImage.js"),i=n("./triggerEvent.js"),s=n("./internal/getImageSize.js"),l=n("./events.js");t.default=function(e,t){var n=Object(a.getEnabledElement)(e),u=n.canvas.width,d=n.canvas.height;!function(e,t){t.width!==e.clientWidth&&(t.width=e.clientWidth,t.style.width="".concat(e.clientWidth,"px")),t.height!==e.clientHeight&&(t.height=e.clientHeight,t.style.height="".concat(e.clientHeight,"px"))}(e,n.canvas);var c={element:e};Object(i.default)(e,l.default.ELEMENT_RESIZED,c),void 0!==n.image&&(t||function(e,t,n){var a=e.viewport.scale,r=Object(s.default)(e.image,e.viewport.rotation),o=Math.round(r.width*a),i=Math.round(r.height*a);return o===t&&i<=n||o<=t&&i===n&&0===e.viewport.translation.x&&0===e.viewport.translation.y}(n,u,d)?Object(r.default)(e):(function(e,t,n){var a=e.viewport.scale,r=Math.sqrt(e.canvas.width/t*(e.canvas.height/n));e.viewport.scale=r*a}(n,u,d),Object(o.default)(e)))}},"./setToPixelCoordinateSystem.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/calculateTransform.js");t.default=function(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var r=Object(a.default)(e,n);t.setTransform(r.m[0],r.m[1],r.m[2],r.m[3],r.m[4],r.m[5])}},"./setViewport.js":function(e,t,n){"use strict";n.r(t);var a=n("./internal/getDefaultViewport.js"),r=n("./enabledElements.js"),o=n("./updateImage.js");t.default=function(e,t){var n=Object(r.getEnabledElement)(e);if(void 0===n.viewport&&(n.viewport=Object(a.default)(n.canvas)),t)for(var i in t)null!==t[i]&&(n.viewport[i]=t[i]);n.viewport.voi.windowWidth&&(n.viewport.voi.windowWidth=Math.max(t.voi.windowWidth,1e-6)),n.viewport.scale&&(n.viewport.scale=Math.max(t.scale,1e-4)),n.viewport.rotation%=360,n.viewport.rotation<0&&(n.viewport.rotation+=360),n.image&&Object(o.default)(e)}},"./triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./updateImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./enabledElements.js"),r=n("./internal/drawImage.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.getEnabledElement)(e);if(void 0===n.image&&!n.layers.length)throw new Error("updateImage: image has not been loaded yet");Object(r.default)(n,t)}},"./webgl/createProgramFromString.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.createShader(n);if(e.shaderSource(a,t),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS)&&!e.isContextLost()){var r=e.getShaderInfoLog(a);console.error("Could not compile shader:\n".concat(r))}return a}n.r(t),t.default=function(e,t,n){return function(e,t,n){var a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS)&&!e.isContextLost()){var r=e.getProgramInfoLog(a);console.error("WebGL program filed to link:\n".concat(r))}return a}(e,a(e,t,e.VERTEX_SHADER),a(e,n,e.FRAGMENT_SHADER))}},"./webgl/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./webgl/renderer.js"),r=n("./webgl/createProgramFromString.js"),o=n("./webgl/textureCache.js"),i={createProgramFromString:r.default,renderer:{render:a.render,initRenderer:a.initRenderer,getRenderCanvas:a.getRenderCanvas,isWebGLAvailable:a.isWebGLAvailable},textureCache:o.default};Object.defineProperty(i,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function(){return a.isWebGLInitialized}}),t.default=i},"./webgl/renderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isWebGLInitialized",function(){return c}),n.d(t,"getRenderCanvas",function(){return f}),n.d(t,"initRenderer",function(){return h}),n.d(t,"render",function(){return v}),n.d(t,"isWebGLAvailable",function(){return b});var a,r,o,i=n("./webgl/shaders/index.js"),s=n("./webgl/vertexShader.js"),l=n("./webgl/textureCache.js"),u=n("./webgl/createProgramFromString.js"),d=document.createElement("canvas"),c=!1;function f(){return d}function h(){!0!==c&&function(e){a=null;try{var t={preserveDrawingBuffer:!0};a=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),e.removeEventListener("webglcontextlost",m,!1),e.addEventListener("webglcontextlost",m,!1),e.removeEventListener("webglcontextrestored",g,!1),e.addEventListener("webglcontextrestored",g,!1)}catch(n){throw new Error("Error creating WebGL context")}return a||(console.error("Unable to initialize WebGL. Your browser may not support it."),a=null),a}(d)&&(o=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,o),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),r=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,r),a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),a.STATIC_DRAW),function(){for(var e in i.shaders){var t=i.shaders[e];t.attributes={},t.uniforms={},t.vert=s.vertexShader,t.program=Object(u.default)(a,t.vert,t.frag),t.attributes.texCoordLocation=a.getAttribLocation(t.program,"a_texCoord"),a.enableVertexAttribArray(t.attributes.texCoordLocation),t.attributes.positionLocation=a.getAttribLocation(t.program,"a_position"),a.enableVertexAttribArray(t.attributes.positionLocation),t.uniforms.resolutionLocation=a.getUniformLocation(t.program,"u_resolution")}}(),c=!0)}function m(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function g(e){e.preventDefault(),c=!1,l.default.purgeCache(),h()}function p(e){if(e.color)return"rgb";var t=e.getPixelData();return t instanceof Int16Array?"int16":t instanceof Uint16Array?"uint16":t instanceof Int8Array?"int8":"uint8"}function v(e){var t=e.image;d.width=t.width,d.height=t.height;var n=e.viewport,s=function(e){var t=p(e);return i.shaders.hasOwnProperty(t)?i.shaders[t]:i.shaders.rgb}(t),u=function(e){var t=l.default.getImageTexture(e.imageId);return t||(t=function(e){var t={uint8:a.LUMINANCE,int8:a.LUMINANCE_ALPHA,uint16:a.LUMINANCE_ALPHA,int16:a.RGB,rgb:a.RGB},n=p(e),r=t[n],o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_ALIGNMENT,1);var s=i.dataUtilities[n].storedPixelDataToImageData(e,e.width,e.height);return a.texImage2D(a.TEXTURE_2D,0,r,e.width,e.height,0,r,a.UNSIGNED_BYTE,s),{texture:o,sizeInBytes:e.width*e.height*{int8:1,uint16:2,int16:3,rgb:3}[n]}}(e),l.default.putImageTexture(e,t)),t.texture}(t);return function(e,t,n,i,s){for(var l in a.clearColor(1,0,0,1),a.viewport(0,0,i,s),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(e.program),a.bindBuffer(a.ARRAY_BUFFER,r),a.vertexAttribPointer(e.attributes.texCoordLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,o),a.vertexAttribPointer(e.attributes.positionLocation,2,a.FLOAT,!1,0,0),t){var u=a.getUniformLocation(e.program,l);if(u){var d=t[l],c=d.type,f=d.value;"i"===c?a.uniform1i(u,f):"f"===c?a.uniform1f(u,f):"2f"===c&&a.uniform2f(u,f[0],f[1])}}!function(e,t,n){e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,0,n,t,0,0,0]),e.STATIC_DRAW)}(a,i,s),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,n),a.drawArrays(a.TRIANGLE_STRIP,0,4)}(s,{u_resolution:{type:"2f",value:[t.width,t.height]},wc:{type:"f",value:n.voi.windowCenter},ww:{type:"f",value:n.voi.windowWidth},slope:{type:"f",value:t.slope},intercept:{type:"f",value:t.intercept},minPixelValue:{type:"f",value:t.minPixelValue},invert:{type:"i",value:n.invert?1:0}},u,t.width,t.height),d}function b(){var e={failIfMajorPerformanceCaveat:!0};try{var t=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(t.getContext("webgl",e)||t.getContext("experimental-webgl",e))}catch(n){return!1}}},"./webgl/shaders/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"shaders",function(){return l}),n.d(t,"dataUtilities",function(){return u});var a=n("./webgl/shaders/int16.js"),r=n("./webgl/shaders/int8.js"),o=n("./webgl/shaders/rgb.js"),i=n("./webgl/shaders/uint16.js"),s=n("./webgl/shaders/uint8.js"),l={int16:a.int16Shader,int8:r.int8Shader,rgb:o.rgbShader,uint16:i.uint16Shader,uint8:s.uint8Shader},u={int16:a.int16DataUtilities,int8:r.int8DataUtilities,rgb:o.rgbDataUtilities,uint16:i.uint16DataUtilities,uint8:s.uint8DataUtilities}},"./webgl/shaders/int16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int16DataUtilities",function(){return r}),n.d(t,"int16Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*3),a=0,r=0;r<t.length;r++){var o=Math.abs(t[r]);n[a++]=255&o,n[a++]=o>>8,n[a++]=t[r]<0?0:1}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int8DataUtilities",function(){return r}),n.d(t,"int8Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,r=0;r<t.length;r++)n[a++]=t[r],n[a++]=t[r]<0?0:1;return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rgbDataUtilities",function(){return r}),n.d(t,"rgbShader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){var t=e.minPixelValue,n=0,a=0,r=e.width*e.height*4,o=e.width*e.height*3,i=e.getPixelData(),s=new Uint8Array(o);if(t<0)for(;a<r;)s[n++]=i[a++]+-t,s[n++]=i[a++]+-t,s[n++]=i[a++]+-t,a+=1;else for(;a<r;)s[n++]=i[a++],s[n++]=i[a++],s[n++]=i[a++],a+=1;return s}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint16DataUtilities",function(){return r}),n.d(t,"uint16Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){for(var t=e.getPixelData(),n=new Uint8Array(e.width*e.height*2),a=0,r=0;r<t.length;r++){var o=t[r];n[a++]=255&o,n[a++]=o>>8}return n}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint8DataUtilities",function(){return r}),n.d(t,"uint8Shader",function(){return a});var a={},r={storedPixelDataToImageData:function(e){return e.getPixelData()}};a.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./triggerEvent.js"),o={},i=[],s=268435456,l=0;function u(){if(!(l<=s)){for(i.sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0});l>s;){var e=i[i.length-1];l-=e.sizeInBytes,delete o[e.imageId],i.pop(),Object(r.default)(a.events,a.default.WEBGL_TEXTURE_REMOVED,{imageId:e.imageId})}var t={maximumSizeInBytes:s,cacheSizeInBytes:l,numberOfImagesCached:i.length};Object(r.default)(a.events,a.default.WEBGL_TEXTURE_CACHE_FULL,t)}}t.default={purgeCache:function(){for(;i.length>0;){var e=i.pop();delete o[e.imageId]}l=0},getImageTexture:function(e){if(void 0===e)throw new Error("getImageTexture: imageId must not be undefined");var t=o[e];if(void 0!==t)return t.timeStamp=new Date,t.imageTexture},putImageTexture:function(e,t){var n=e.imageId;if(void 0===e)throw new Error("putImageTexture: image must not be undefined");if(void 0===n)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===t)throw new Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(o,n))throw new Error("putImageTexture: imageId already in cache");var a={imageId:n,imageTexture:t,timeStamp:new Date,sizeInBytes:t.sizeInBytes};if(o[n]=a,i.push(a),void 0===t.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");l+=a.sizeInBytes,u()},removeImageTexture:function(e){if(void 0===e)throw new Error("removeImageTexture: imageId must not be undefined");var t=o[e];if(void 0===t)throw new Error("removeImageTexture: imageId must not be undefined");return i.splice(i.indexOf(t),1),l-=t.sizeInBytes,delete o[e],t.imageTexture},setMaximumSizeBytes:function(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");s=e,u()}}},"./webgl/vertexShader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"vertexShader",function(){return a});var a="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone-math",[],t):"object"==typeof exports?exports["cornerstone-math"]=t():e.cornerstoneMath=t()}(window,function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(w[e]&&x[e]){for(var n in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--v&&0===b&&E()}}(e,n),t&&t(e,n)};var n,a=!0,r="a93104d9ec79cc46b114",o={},i=[],s=[];function l(e){var t=M[e];if(!t)return P;var a=function(a){return t.hot.active?(M[a]?-1===M[a].parents.indexOf(e)&&M[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),P(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return P[e]},set:function(t){P[e]=t}}};for(var o in P)Object.prototype.hasOwnProperty.call(P,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),b++,P.e(e).then(t,function(e){throw t(),e});function t(){b--,"prepare"===c&&(y[e]||_(e),0===b&&0===v&&E())}},a.t=function(e,t){return 1&t&&(e=a(e)),P.t(e,-2&t)},a}function u(t){var a={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:n!==t,active:!0,accept:function(e,t){if(void 0===e)a._selfAccepted=!0;else if("function"==typeof e)a._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)a._acceptedDependencies[e[n]]=t||function(){};else a._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)a._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)a._declinedDependencies[e[t]]=!0;else a._declinedDependencies[e]=!0},dispose:function(e){a._disposeHandlers.push(e)},addDisposeHandler:function(e){a._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=a._disposeHandlers.indexOf(e);t>=0&&a._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":(m={})[t]=e[t],f("ready");break;case"ready":I(t);break;case"prepare":case"check":case"dispose":case"apply":(p=p||[]).push(t)}},check:T,apply:O,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[t]};return n=void 0,a}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var h,m,g,p,v=0,b=0,y={},x={},w={};function j(e){return+e+""===e?+e:e}function T(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=P.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f(C()?"ready":"idle"),null;x={},y={},w=e.c,g=e.h,f("prepare");var t=new Promise(function(e,t){h={resolve:e,reject:t}});return m={},_("cornerstoneMath"),"prepare"===c&&0===b&&0===v&&E(),t});var t}function _(e){w[e]?(x[e]=!0,v++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=P.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):y[e]=!0}function E(){f("ready");var e=h;if(h=null,e)if(a)Promise.resolve().then(function(){return O(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(j(n));e.resolve(t)}}function O(e){if("ready"!==c)throw new Error("apply() is only allowed in ready status");return S(e=e||{})}function S(t){var a,s,l,u,d;function c(e){for(var t=[e],n={},a=t.map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((u=M[o])&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(u.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<u.parents.length;s++){var l=u.parents[s],d=M[l];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([l]),moduleId:o,parentId:l};-1===t.indexOf(l)&&(d.hot._acceptedDependencies[o]?(n[l]||(n[l]=[]),h(n[l],[o])):(delete n[l],t.push(l),a.push({chain:i.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}C();var v={},b=[],y={},x=function(){console.warn("[HMR] unexpected require("+_.moduleId+") to disposed module")};for(var T in m)if(Object.prototype.hasOwnProperty.call(m,T)){var _;d=j(T);var E=!1,O=!1,I=!1,D="";switch((_=m[T]?c(d):{type:"disposed",moduleId:T}).chain&&(D="\nUpdate propagation: "+_.chain.join(" -> ")),_.type){case"self-declined":t.onDeclined&&t.onDeclined(_),t.ignoreDeclined||(E=new Error("Aborted because of self decline: "+_.moduleId+D));break;case"declined":t.onDeclined&&t.onDeclined(_),t.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+_.moduleId+" in "+_.parentId+D));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(_),t.ignoreUnaccepted||(E=new Error("Aborted because "+d+" is not accepted"+D));break;case"accepted":t.onAccepted&&t.onAccepted(_),O=!0;break;case"disposed":t.onDisposed&&t.onDisposed(_),I=!0;break;default:throw new Error("Unexception type "+_.type)}if(E)return f("abort"),Promise.reject(E);if(O)for(d in y[d]=m[d],h(b,_.outdatedModules),_.outdatedDependencies)Object.prototype.hasOwnProperty.call(_.outdatedDependencies,d)&&(v[d]||(v[d]=[]),h(v[d],_.outdatedDependencies[d]));I&&(h(b,[_.moduleId]),y[d]=x)}var k,L=[];for(s=0;s<b.length;s++)M[d=b[s]]&&M[d].hot._selfAccepted&&y[d]!==x&&!M[d].hot._selfInvalidated&&L.push({module:d,parents:M[d].parents.slice(),errorHandler:M[d].hot._selfAccepted});f("dispose"),Object.keys(w).forEach(function(e){!1===w[e]&&function(e){delete installedChunks[e]}(e)});for(var A,R=b.slice();R.length>0;)if(d=R.pop(),u=M[d]){var B={},F=u.hot._disposeHandlers;for(l=0;l<F.length;l++)(a=F[l])(B);for(o[d]=B,u.hot.active=!1,delete M[d],delete v[d],l=0;l<u.children.length;l++){var U=M[u.children[l]];U&&(k=U.parents.indexOf(d))>=0&&U.parents.splice(k,1)}}for(d in v)if(Object.prototype.hasOwnProperty.call(v,d)&&(u=M[d]))for(A=v[d],l=0;l<A.length;l++)(k=u.children.indexOf(A[l]))>=0&&u.children.splice(k,1);for(d in f("apply"),void 0!==g&&(r=g,g=void 0),m=void 0,y)Object.prototype.hasOwnProperty.call(y,d)&&(e[d]=y[d]);var H=null;for(d in v)if(Object.prototype.hasOwnProperty.call(v,d)&&(u=M[d])){A=v[d];var N=[];for(s=0;s<A.length;s++)if(a=u.hot._acceptedDependencies[A[s]]){if(-1!==N.indexOf(a))continue;N.push(a)}for(s=0;s<N.length;s++){a=N[s];try{a(A)}catch(V){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:A[s],error:V}),t.ignoreErrored||H||(H=V)}}}for(s=0;s<L.length;s++){var z=L[s];i=z.parents,n=d=z.module;try{P(d)}catch(V){if("function"==typeof z.errorHandler)try{z.errorHandler(V)}catch(q){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:q,originalError:V}),t.ignoreErrored||H||(H=q),H||(H=V)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:V}),t.ignoreErrored||H||(H=V)}}return H?(f("fail"),Promise.reject(H)):p?S(t).then(function(e){return b.forEach(function(t){e.indexOf(t)<0&&e.push(t)}),e}):(f("idle"),new Promise(function(e){e(b)}))}function C(){if(p)return m||(m={}),p.forEach(I),p=void 0,!0}function I(t){Object.prototype.hasOwnProperty.call(m,t)||(m[t]=e[t])}var M={};function P(t){if(M[t])return M[t].exports;var n=M[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return P.m=e,P.c=M,P.d=function(e,t,n){P.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},P.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},P.t=function(e,t){if(1&t&&(e=P(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(P.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)P.d(n,a,(function(t){return e[t]}).bind(null,a));return n},P.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return P.d(t,"a",t),t},P.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},P.p="",P.h=function(){return r},l("./index.js")(P.s="./index.js")}({"./Line3.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=(a=n("./vector3.js"))&&a.__esModule?a:{default:a},i=n("./math.js"),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=void 0!==t?t:new o.default,this.end=void 0!==n?n:new o.default}return r(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"center",value:function(e){return(e||new o.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return(e||new o.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){var n=t||new o.default;return this.delta(n).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){var n=new o.default,a=new o.default;n.subVectors(e,this.start),a.subVectors(this.end,this.start);var r=a.dot(a),s=a.dot(n)/r;return t&&(s=(0,i.clamp)(s,0,1)),s}},{key:"closestPointToPoint",value:function(e,t,n){var a=this.closestPointToPointParameter(e,t),r=n||new o.default;return this.delta(r).multiplyScalar(a).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"intersectLine",value:function(e){var t=this.end.clone().sub(this.start),n=e.end.clone().sub(e.start),a=e.start.clone().sub(this.start),r=t.clone().cross(n),o=a.clone().cross(n),s=a.dot(r);if((0,i.approximatelyEquals)(s,0)){var l=o.dot(r)/r.lengthSq();if(!(l>1||isNaN(l))){var u=this.start.clone().add(t.clone().multiplyScalar(l));return u.clone().sub(e.start).lengthSq()+u.clone().sub(e.end).lengthSq()<=e.distanceSq()?u:void 0}}}}]),e}();t.default=s},"./index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector3=t.rect=t.quaternion=t.point=t.Plane=t.Matrix4=t.sign=t.radToDeg=t.degToRad=t.clamp=t.lineSegment=t.Line3=void 0;var a=f(n("./Line3.js")),r=f(n("./lineSegment.js")),o=n("./math.js"),i=f(n("./matrix4.js")),s=f(n("./plane.js")),l=f(n("./point.js")),u=f(n("./quaternion.js")),d=f(n("./rect.js")),c=f(n("./vector3.js"));function f(e){return e&&e.__esModule?e:{default:e}}var h={Line3:a.default,lineSegment:r.default,clamp:o.clamp,degToRad:o.degToRad,radToDeg:o.radToDeg,sign:o.sign,Matrix4:i.default,Plane:s.default,point:l.default,quaternion:u.default,rect:d.default,Vector3:c.default};t.Line3=a.default,t.lineSegment=r.default,t.clamp=o.clamp,t.degToRad=o.degToRad,t.radToDeg=o.radToDeg,t.sign=o.sign,t.Matrix4=i.default,t.Plane=s.default,t.point=l.default,t.quaternion=u.default,t.rect=d.default,t.Vector3=c.default,t.default=h},"./lineSegment.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./math.js");function r(e){return e*e}function o(e,t){return r(e.x-t.x)+r(e.y-t.y)}t.default={distanceToPoint:function(e,t){return Math.sqrt(function(e,t){var n=o(e.start,e.end);if(0===n)return o(t,e.start);var a=((t.x-e.start.x)*(e.end.x-e.start.x)+(t.y-e.start.y)*(e.end.y-e.start.y))/n;return o(t,a<0?e.start:a>1?e.end:{x:e.start.x+a*(e.end.x-e.start.x),y:e.start.y+a*(e.end.y-e.start.y)})}(e,t))},intersectLine:function(e,t){var n,r,o,i,s,l,u,d,c,f,h,m={},g=e.start.x,p=e.start.y,v=e.end.x,b=e.end.y,y=t.start.x,x=t.start.y,w=t.end.x,j=t.end.y,T=void 0;if(f=(n=b-p)*w+(o=g-v)*j+(s=v*p-g*b),(0===(c=n*y+o*x+s)||0===f||(0,a.sign)(c)!==(0,a.sign)(f))&&(d=(r=j-x)*v+(i=y-w)*b+(l=w*x-y*j),0===(u=r*g+i*p+l)||0===d||(0,a.sign)(u)!==(0,a.sign)(d))){h=n*i-r*o,T=o*l-i*s;var _=parseFloat(T/h);T=r*s-n*l;var E=parseFloat(T/h);return m.x=_,m.y=E,m}}}},"./math.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.degToRad=function(e){return e*(Math.PI/180)},t.approximatelyEquals=function(e,t,n){var a=n||1e-4;return Math.abs(e-t)<=a*Math.max(1,Math.abs(e),Math.abs(t))},t.radToDeg=function(e){return e*(180/Math.PI)},t.sign=function(e){return"number"==typeof e?e?e<0?-1:1:e==e?0:NaN:NaN}},"./matrix4.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=(a=n("./vector3.js"))&&a.__esModule?a:{default:a},i=function(){function e(t,n,a,r,o,i,s,l,u,d,c,f,h,m,g,p){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements=new Float32Array(16);var v=this.elements;v[0]=void 0!==t?t:1,v[4]=n||0,v[8]=a||0,v[12]=r||0,v[1]=o||0,v[5]=void 0!==i?i:1,v[9]=s||0,v[13]=l||0,v[2]=u||0,v[6]=d||0,v[10]=void 0!==c?c:1,v[14]=f||0,v[3]=h||0,v[7]=m||0,v[11]=g||0,v[15]=void 0!==p?p:1}return r(e,[{key:"makeRotationFromQuaternion",value:function(e){var t=this.elements,n=e.x,a=e.y,r=e.z,o=e.w,i=n+n,s=a+a,l=r+r,u=n*i,d=n*s,c=n*l,f=a*s,h=a*l,m=r*l,g=o*i,p=o*s,v=o*l;return t[0]=1-(f+m),t[4]=d-v,t[8]=c+p,t[1]=d+v,t[5]=1-(u+m),t[9]=h-g,t[2]=c-p,t[6]=h+g,t[10]=1-(u+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,a=t.elements,r=this.elements,o=n[0],i=n[4],s=n[8],l=n[12],u=n[1],d=n[5],c=n[9],f=n[13],h=n[2],m=n[6],g=n[10],p=n[14],v=n[3],b=n[7],y=n[11],x=n[15],w=a[0],j=a[4],T=a[8],_=a[12],E=a[1],O=a[5],S=a[9],C=a[13],I=a[2],M=a[6],P=a[10],D=a[14],k=a[3],L=a[7],A=a[11],R=a[15];return r[0]=o*w+i*E+s*I+l*k,r[4]=o*j+i*O+s*M+l*L,r[8]=o*T+i*S+s*P+l*A,r[12]=o*_+i*C+s*D+l*R,r[1]=u*w+d*E+c*I+f*k,r[5]=u*j+d*O+c*M+f*L,r[9]=u*T+d*S+c*P+f*A,r[13]=u*_+d*C+c*D+f*R,r[2]=h*w+m*E+g*I+p*k,r[6]=h*j+m*O+g*M+p*L,r[10]=h*T+m*S+g*P+p*A,r[14]=h*_+m*C+g*D+p*R,r[3]=v*w+b*E+y*I+x*k,r[7]=v*j+b*O+y*M+x*L,r[11]=v*T+b*S+y*P+x*A,r[15]=v*_+b*C+y*D+x*R,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"getInverse",value:function(e,t){var n=this.elements,a=e.elements,r=a[0],o=a[4],i=a[8],s=a[12],l=a[1],u=a[5],d=a[9],c=a[13],f=a[2],h=a[6],m=a[10],g=a[14],p=a[3],v=a[7],b=a[11],y=a[15];n[0]=d*g*v-c*m*v+c*h*b-u*g*b-d*h*y+u*m*y,n[4]=s*m*v-i*g*v-s*h*b+o*g*b+i*h*y-o*m*y,n[8]=i*c*v-s*d*v+s*u*b-o*c*b-i*u*y+o*d*y,n[12]=s*d*h-i*c*h-s*u*m+o*c*m+i*u*g-o*d*g,n[1]=c*m*p-d*g*p-c*f*b+l*g*b+d*f*y-l*m*y,n[5]=i*g*p-s*m*p+s*f*b-r*g*b-i*f*y+r*m*y,n[9]=s*d*p-i*c*p-s*l*b+r*c*b+i*l*y-r*d*y,n[13]=i*c*f-s*d*f+s*l*m-r*c*m-i*l*g+r*d*g,n[2]=u*g*p-c*h*p+c*f*v-l*g*v-u*f*y+l*h*y,n[6]=s*h*p-o*g*p-s*f*v+r*g*v+o*f*y-r*h*y,n[10]=o*c*p-s*u*p+s*l*v-r*c*v-o*l*y+r*u*y,n[14]=s*u*f-o*c*f-s*l*h+r*c*h+o*l*g-r*u*g,n[3]=d*h*p-u*m*p-d*f*v+l*m*v+u*f*b-l*h*b,n[7]=o*m*p-i*h*p+i*f*v-r*m*v-o*f*b+r*h*b,n[11]=i*u*p-o*d*p-i*l*v+r*d*v+o*l*b-r*u*b,n[15]=o*d*f-i*u*f+i*l*h-r*d*h-o*l*m+r*u*m;var x=r*n[0]+l*n[4]+f*n[8]+p*n[12];if(0===x){var w="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(w);return console.warn(w),this.identity(),this}return this.multiplyScalar(1/x),this}},{key:"applyToVector3Array",value:function(){var e=new o.default;return function(t,n,a){void 0===n&&(n=0),void 0===a&&(a=t.length);for(var r=0,o=n;r<a;r+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"set",value:function(e,t,n,a,r,o,i,s,l,u,d,c,f,h,m,g){var p=this.elements;return p[0]=e,p[4]=t,p[8]=n,p[12]=a,p[1]=r,p[5]=o,p[9]=i,p[13]=s,p[2]=l,p[6]=u,p[10]=d,p[14]=c,p[3]=f,p[7]=h,p[11]=m,p[15]=g,this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}}]),e}();t.default=i},"./plane.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=(a=n("./vector3.js"))&&a.__esModule?a:{default:a},l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.normal=void 0!==t?t:new s.default(1,0,0),this.constant=void 0!==n?n:0}return i(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,a){return this.normal.set(e,t,n),this.constant=a,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return this.orthoPoint(e,t).sub(e).negate()}},{key:"orthoPoint",value:function(e,t){var n=this.distanceToPoint(e);return(t||new s.default).copy(this.normal).multiplyScalar(n)}},{key:"isIntersectionLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectPlane",value:function(e){var t=this.normal.clone().cross(e.normal),n={origin:new s.default,direction:t};if(this.normal.clone().cross(e.normal).length<1e-10)return n.direction=new s.default,n;var a=this.constant,r=e.constant,o=this.normal.clone().dot(e.normal),i=-(a-r*o)/(1-o*o),l=-(r-a*o)/(1-o*o);return n.origin=this.normal.clone().multiplyScalar(i).add(e.normal.clone().multiplyScalar(l)),n}},{key:"coplanarPoint",value:function(e){return(e||new s.default).copy(this.normal).multiplyScalar(-this.constant)}},{key:"translate",value:function(e){return this.constant=this.constant-e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new e).copy(this)}}]),e}();l.prototype.setFromCoplanarPoints=(r=new s.default,o=new s.default,function(e,t,n){var a=r.subVectors(n,t).cross(o.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}),l.prototype.intersectLine=function(){var e=new s.default;return function(t,n){var a=n||new s.default,r=t.delta(e),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(t.start)?a.copy(t.start):void 0;var i=-(t.start.dot(this.normal)+this.constant)/o;return i<0||i>1?void 0:a.copy(r).multiplyScalar(i).add(t.start)}}(),t.default=l},"./point.js":function(e,t,n){"use strict";function a(e,t){return{x:e.x-t.x,y:e.y-t.y}}function r(e,t){return Math.sqrt(o(e,t))}function o(e,t){var n=a(e,t);return n.x*n.x+n.y*n.y}Object.defineProperty(t,"__esModule",{value:!0}),t.default={subtract:a,copy:function(e){return{x:e.x,y:e.y}},pageToPoint:function(e){return{x:e.pageX,y:e.pageY}},distance:r,distanceSquared:o,insideRect:function(e,t){return!(e.x<t.left||e.x>t.left+t.width||e.y<t.top||e.y>t.top+t.height)},findClosestPoint:function(e,t){var n=[],a=void 0;return e.forEach(function(e,o){var i=r(e,t);n.push(i),a=0===o?i:Math.min(i,a)}),e[n.indexOf(a)]}}},"./quaternion.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=function(){function e(t,n,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t||0,this.y=n||0,this.z=a||0,this.w=void 0!==r?r:1}return a(e,[{key:"setFromAxisAngle",value:function(e,t){var n=t/2,a=Math.sin(n);return this.x=e.x*a,this.y=e.y*a,this.z=e.z*a,this.w=Math.cos(n),this}},{key:"multiplyQuaternions",value:function(e,t){var n=e.x,a=e.y,r=e.z,o=e.w,i=t.x,s=t.y,l=t.z,u=t.w;return this.x=n*u+o*i+a*l-r*s,this.y=a*u+o*s+r*i-n*l,this.z=r*u+o*l+n*s-a*i,this.w=o*u-n*i-a*s-r*l,this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],a=t[4],r=t[8],o=t[1],i=t[5],s=t[9],l=t[2],u=t[6],d=t[10],c=n+i+d,f=void 0;return c>0?(f=.5/Math.sqrt(c+1),this.w=.25/f,this.x=(u-s)*f,this.y=(r-l)*f,this.z=(o-a)*f):n>i&&n>d?(f=2*Math.sqrt(1+n-i-d),this.w=(u-s)/f,this.x=.25*f,this.y=(a+o)/f,this.z=(r+l)/f):i>d?(f=2*Math.sqrt(1+i-n-d),this.w=(r-l)/f,this.x=(a+o)/f,this.y=.25*f,this.z=(s+u)/f):(f=2*Math.sqrt(1+d-n-i),this.w=(o-a)/f,this.x=(r+l)/f,this.y=(s+u)/f,this.z=.25*f),this}}]),e}();t.default=r},"./rect.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./lineSegment.js"))&&a.__esModule?a:{default:a};function o(e){return{topLeft:{x:e.left,y:e.top},bottomRight:{x:e.left+e.width,y:e.top+e.height}}}t.default={distanceToPoint:function(e,t){var n=655535;return function(e){return[{start:{x:e.left,y:e.top},end:{x:e.left+e.width,y:e.top}},{start:{x:e.left+e.width,y:e.top},end:{x:e.left+e.width,y:e.top+e.height}},{start:{x:e.left+e.width,y:e.top+e.height},end:{x:e.left,y:e.top+e.height}},{start:{x:e.left,y:e.top+e.height},end:{x:e.left,y:e.top}}]}(e).forEach(function(e){var a=r.default.distanceToPoint(e,t);a<n&&(n=a)}),n},getIntersectionRect:function(e,t){var n={topLeft:{},bottomRight:{}};if(function(e,t){var n=o(e),a=o(t);return!((e.width>=0?t.width>=0?n.bottomRight.x<=a.topLeft.x||a.bottomRight.x<=n.topLeft.x:n.bottomRight.x<=a.bottomRight.x||a.topLeft.x<=n.topLeft.x:t.width>=0?n.topLeft.x<=a.topLeft.x||a.bottomRight.x<=n.bottomRight.x:n.topLeft.x<=a.bottomRight.x||a.topLeft.x<=n.bottomRight.x)||(e.height>=0?t.height>=0?n.bottomRight.y<=a.topLeft.y||a.bottomRight.y<=n.topLeft.y:n.bottomRight.y<=a.bottomRight.y||a.topLeft.y<=n.topLeft.y:t.height>=0?n.topLeft.y<=a.topLeft.y||a.bottomRight.y<=n.bottomRight.y:n.topLeft.y<=a.bottomRight.y||a.top<=n.bottomRight.y))}(e,t)){var a=o(e),r=o(t);return e.width>=0?t.width>=0?(n.topLeft.x=Math.max(a.topLeft.x,r.topLeft.x),n.bottomRight.x=Math.min(a.bottomRight.x,r.bottomRight.x)):(n.topLeft.x=Math.max(a.topLeft.x,r.bottomRight.x),n.bottomRight.x=Math.min(a.bottomRight.x,r.topLeft.x)):t.width>=0?(n.topLeft.x=Math.min(a.topLeft.x,r.bottomRight.x),n.bottomRight.x=Math.max(a.bottomRight.x,r.topLeft.x)):(n.topLeft.x=Math.min(a.topLeft.x,r.topLeft.x),n.bottomRight.x=Math.max(a.bottomRight.x,r.bottomRight.x)),e.height>=0?t.height>=0?(n.topLeft.y=Math.max(a.topLeft.y,r.topLeft.y),n.bottomRight.y=Math.min(a.bottomRight.y,r.bottomRight.y)):(n.topLeft.y=Math.max(a.topLeft.y,r.bottomRight.y),n.bottomRight.y=Math.min(a.bottomRight.y,r.topLeft.y)):t.height>=0?(n.topLeft.y=Math.min(a.topLeft.y,r.bottomRight.y),n.bottomRight.y=Math.max(a.bottomRight.y,r.topLeft.y)):(n.topLeft.y=Math.min(a.topLeft.y,r.topLeft.y),n.bottomRight.y=Math.max(a.bottomRight.y,r.bottomRight.y)),n}}}},"./vector3.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,o,i,s,l,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=(a=n("./quaternion.js"))&&a.__esModule?a:{default:a},c=n("./math.js"),f=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t||0,this.y=n||0,this.z=a||0}return u(e,[{key:"set",value:function(e,t,n){return this.x=e,this.y=t,this.z=n,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*a,this.y=r[1]*t+r[4]*n+r[7]*a,this.z=r[2]*t+r[5]*n+r[8]*a,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a+r[12],this.y=r[1]*t+r[5]*n+r[9]*a+r[13],this.z=r[2]*t+r[6]*n+r[10]*a+r[14],this}},{key:"applyProjection",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*a+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*a+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*a+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*a+r[14])*o,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.x,o=e.y,i=e.z,s=e.w,l=s*t+o*a-i*n,u=s*n+i*t-r*a,d=s*a+r*n-o*t,c=-r*t-o*n-i*a;return this.x=l*s+c*-r+u*-i-d*-o,this.y=u*s+c*-o+d*-r-l*-i,this.z=d*s+c*-i+l*-o-u*-r,this}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,a=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*a,this.y=r[1]*t+r[5]*n+r[9]*a,this.z=r[2]*t+r[6]*n+r[10]*a,this.normalize(),this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this}},{key:"min",value:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this}},{key:"max",value:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this}},{key:"clamp",value:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.multiplyScalar(-1)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"lengthManhattan",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"cross",value:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,a=this.y,r=this.z;return this.x=a*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-a*e.x,this}},{key:"crossVectors",value:function(e,t){var n=e.x,a=e.y,r=e.z,o=t.x,i=t.y,s=t.z;return this.x=a*s-r*i,this.y=r*o-n*s,this.z=n*i-a*o,this}},{key:"angleTo",value:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos((0,c.clamp)(t,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,a=this.z-e.z;return t*t+n*n+a*a}},{key:"setFromMatrixPosition",value:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),a=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=a,this}},{key:"setFromMatrixColumn",value:function(e,t){var n=4*e,a=t.elements;return this.x=a[n],this.y=a[n+1],this.z=a[n+2],this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}();f.prototype.projectOnVector=(r=void 0,o=void 0,function(e){return void 0===r&&(r=new f),r.copy(e).normalize(),o=this.dot(r),this.copy(r).multiplyScalar(o)}),f.prototype.projectOnPlane=function(){var e=void 0;return function(t){return void 0===e&&(e=new f),e.copy(this).projectOnVector(t),this.sub(e)}}(),f.prototype.reflect=function(){var e=void 0;return function(t){return void 0===e&&(e=new f),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),f.prototype.clampScalar=(i=void 0,s=void 0,function(e,t){return void 0===i&&(i=new f,s=new f),i.set(e,e,e),s.set(t,t,t),this.clamp(i,s)}),f.prototype.applyAxisAngle=(l=void 0,function(e,t){return void 0===l&&(l=new d.default),this.applyQuaternion(l.setFromAxisAngle(e.normalize(),t)),this}),t.default=f}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstone-tools",[],t):"object"==typeof exports?exports["cornerstone-tools"]=t():e.cornerstoneTools=t()}(window,function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&y[e]){for(var n in y[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--p&&0===v&&_()}}(e,n),t&&t(e,n)};var n,a=!0,r="0916b8a46ccddd4eea62",o={},i=[],s=[];function l(e){var t=O[e];if(!t)return S;var a=function(a){return t.hot.active?(O[a]?-1===O[a].parents.indexOf(e)&&O[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),S(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(t){S[e]=t}}};for(var o in S)Object.prototype.hasOwnProperty.call(S,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),v++,S.e(e).then(t,function(e){throw t(),e});function t(){v--,"prepare"===c&&(b[e]||T(e),0===v&&0===p&&_())}},a.t=function(e,t){return 1&t&&(e=a(e)),S.t(e,-2&t)},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:j,apply:E,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var h,m,g,p=0,v=0,b={},y={},x={};function w(e){return+e+""===e?+e:e}function j(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=S.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f("idle"),null;y={},b={},x=e.c,g=e.h,f("prepare");var t=new Promise(function(e,t){h={resolve:e,reject:t}});return m={},T("cornerstoneTools"),"prepare"===c&&0===v&&0===p&&_(),t});var t}function T(e){x[e]?(y[e]=!0,p++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=S.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):b[e]=!0}function _(){f("ready");var e=h;if(h=null,e)if(a)Promise.resolve().then(function(){return E(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(w(n));e.resolve(t)}}function E(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,s,l,u;function d(e){for(var t=[e],n={},a=t.map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=O[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],d=O[u];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),h(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var p={},v=[],b={},y=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var j in m)if(Object.prototype.hasOwnProperty.call(m,j)){var T;u=w(j);var _=!1,E=!1,C=!1,I="";switch((T=m[j]?d(u):{type:"disposed",moduleId:j}).chain&&(I="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(_=new Error("Aborted because of self decline: "+T.moduleId+I));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(_=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+I));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(_=new Error("Aborted because "+u+" is not accepted"+I));break;case"accepted":t.onAccepted&&t.onAccepted(T),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),C=!0;break;default:throw new Error("Unexception type "+T.type)}if(_)return f("abort"),Promise.reject(_);if(E)for(u in b[u]=m[u],h(v,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,u)&&(p[u]||(p[u]=[]),h(p[u],T.outdatedDependencies[u]));C&&(h(v,[T.moduleId]),b[u]=y)}var M,P=[];for(a=0;a<v.length;a++)O[u=v[a]]&&O[u].hot._selfAccepted&&b[u]!==y&&P.push({module:u,errorHandler:O[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var D,k=v.slice();k.length>0;)if(u=k.pop(),l=O[u]){var L={},A=l.hot._disposeHandlers;for(s=0;s<A.length;s++)(n=A[s])(L);for(o[u]=L,l.hot.active=!1,delete O[u],delete p[u],s=0;s<l.children.length;s++){var R=O[l.children[s]];R&&(M=R.parents.indexOf(u))>=0&&R.parents.splice(M,1)}}for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(l=O[u]))for(D=p[u],s=0;s<D.length;s++)(M=l.children.indexOf(D[s]))>=0&&l.children.splice(M,1);for(u in f("apply"),r=g,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(l=O[u])){D=p[u];var F=[];for(a=0;a<D.length;a++)if(n=l.hot._acceptedDependencies[D[a]]){if(-1!==F.indexOf(n))continue;F.push(n)}for(a=0;a<F.length;a++){n=F[a];try{n(D)}catch(H){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:D[a],error:H}),t.ignoreErrored||B||(B=H)}}}for(a=0;a<P.length;a++){var U=P[a];i=[u=U.module];try{S(u)}catch(H){if("function"==typeof U.errorHandler)try{U.errorHandler(H)}catch(N){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:N,originalError:H}),t.ignoreErrored||B||(B=N),B||(B=H)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:H}),t.ignoreErrored||B||(B=H)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise(function(e){e(v)}))}var O={};function S(t){if(O[t])return O[t].exports;var n=O[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return S.m=e,S.c=O,S.d=function(e,t,n){S.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,t){if(1&t&&(e=S(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(S.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)S.d(n,a,(function(t){return e[t]}).bind(null,a));return n},S.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(t,"a",t),t},S.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},S.p="",S.h=function(){return r},l("./index.js")(S.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(e,t){function n(e,t,n,a,r,o,i){try{var s=e[o](i),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(a,r)}e.exports=function(e){return function(){var t=this,a=arguments;return new Promise(function(r,o){var i=e.apply(t,a);function s(e){n(i,r,o,s,l,"next",e)}function l(e){n(i,r,o,s,l,"throw",e)}s(void 0)})}}},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"../node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}e.exports=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}},"../node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},"../node_modules/@babel/runtime/helpers/inherits.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},"../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(e,t){e.exports=function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(l){r=!0,o=l}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}},"../node_modules/@babel/runtime/helpers/nonIterableRest.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?r(e):t}},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,a)}e.exports=n},"../node_modules/@babel/runtime/helpers/slicedToArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithHoles.js"),r=n("../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),o=n("../node_modules/@babel/runtime/helpers/nonIterableRest.js");e.exports=function(e,t){return a(e)||r(e,t)||o()}},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,n){var a=n("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),r=n("../node_modules/@babel/runtime/helpers/iterableToArray.js"),o=n("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function(e){return a(e)||r(e)||o()}},"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){return e.exports=a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(t)}e.exports=a},"../node_modules/@babel/runtime/regenerator/index.js":function(e,t,n){e.exports=n("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/ms/index.js":function(e,t){var n=1e3,a=60*n,r=60*a,o=24*r;function i(e,t,n,a){var r=t>=1.5*n;return Math.round(e/n)+" "+a+(r?"s":"")}e.exports=function(e,t){t=t||{};var s,l,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*r;case"minutes":case"minute":case"mins":case"min":case"m":return i*a;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?(s=e,(l=Math.abs(s))>=o?i(s,l,o,"day"):l>=r?i(s,l,r,"hour"):l>=a?i(s,l,a,"minute"):l>=n?i(s,l,n,"second"):s+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=r?Math.round(e/r)+"h":t>=a?Math.round(e/a)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../node_modules/process/browser.js":function(e,t){var n,a,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var l,u=[],d=!1,c=-1;function f(){d&&l&&(d=!1,l.length?u=l.concat(u):c=-1,u.length&&h())}function h(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(l=u,u=[];++c<t;)l&&l[c].run();c=-1,t=u.length}l=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||s(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(e,t,n){var a=function(){return this||"object"==typeof self&&self}()||Function("return this")(),r=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,o=r&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=n("../node_modules/regenerator-runtime/runtime.js"),r)a.regeneratorRuntime=o;else try{delete a.regeneratorRuntime}catch(i){a.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(e,t){!function(t){"use strict";var n,a=Object.prototype,r=a.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",u="object"==typeof e,d=t.regeneratorRuntime;if(d)u&&(e.exports=d);else{(d=t.regeneratorRuntime=u?e.exports:{}).wrap=x;var c="suspendedStart",f="suspendedYield",h="executing",m="completed",g={},p={};p[i]=function(){return this};var v=Object.getPrototypeOf,b=v&&v(v(P([])));b&&b!==a&&r.call(b,i)&&(p=b);var y=_.prototype=j.prototype=Object.create(p);T.prototype=y.constructor=_,_.constructor=T,_[l]=T.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(y),e},d.awrap=function(e){return{__await:e}},E(O.prototype),O.prototype[s]=function(){return this},d.AsyncIterator=O,d.async=function(e,t,n,a){var r=new O(x(e,t,n,a));return d.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},E(y),y[l]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},d.values=P,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,r){return s.type="throw",s.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:P(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),g}}}function x(e,t,n,a){var r=Object.create((t&&t.prototype instanceof j?t:j).prototype),o=new M(a||[]);return r._invoke=function(e,t,n){var a=c;return function(r,o){if(a===h)throw new Error("Generator is already running");if(a===m){if("throw"===r)throw o;return D()}for(n.method=r,n.arg=o;;){var i=n.delegate;if(i){var s=S(i,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===c)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=h;var l=w(e,t,n);if("normal"===l.type){if(a=n.done?m:f,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=m,n.method="throw",n.arg=l.arg)}}}(e,n,o),r}function w(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(a){return{type:"throw",arg:a}}}function j(){}function T(){}function _(){}function E(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(e){function t(n,a,o,i){var s=w(e[n],e,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,i)},function(e){t("throw",e,o,i)}):Promise.resolve(u).then(function(e){l.value=e,o(l)},function(e){return t("throw",e,o,i)})}i(s.arg)}var n;this._invoke=function(e,a){function r(){return new Promise(function(n,r){t(e,a,n,r)})}return n=n?n.then(r,r):r()}}function S(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,S(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=w(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,g;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){for(;++a<e.length;)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:D}}function D(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.save(),t(e),e.restore()}},"./drawing/drawArrow.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/drawLine.js"),r=n("./drawing/drawJoinedLines.js");t.default=function(e,t,n,o,i,s){var l=Math.atan2(n.y-t.y,n.x-t.x),u={color:o,lineWidth:i};s&&(u.lineDash=s),Object(a.default)(e,void 0,t,n,u,"canvas"),u={color:o,lineWidth:i,fillStyle:o};var d=[{x:n.x-10*Math.cos(l-Math.PI/7),y:n.y-10*Math.sin(l-Math.PI/7)},{x:n.x-10*Math.cos(l+Math.PI/7),y:n.y-10*Math.sin(l+Math.PI/7)},n];Object(r.default)(e,void 0,n,d,u,"canvas")}},"./drawing/drawCircle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n)),Object(r.default)(e,i,function(e){e.arc(n.x,n.y,o,0,2*Math.PI)})}},"./drawing/drawEllipse.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js"),o=n("./util/pointProjector.js");t.default=function(e,t,n,i,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;"pixel"===l&&(n=a.default.cornerstone.pixelToCanvas(t,n),i=a.default.cornerstone.pixelToCanvas(t,i));var d=a.default.cornerstone.getViewport(t),c=t.clientWidth,f=t.clientHeight,h=d.scale,m=d.translation,g=d.rotation-u,p={x:c/2+m.x*h,y:f/2+m.y*h};Math.abs(g)>.05&&(n=Object(o.rotatePoint)(n,p,-g),i=Object(o.rotatePoint)(i,p,-g));var v=Math.abs(n.x-i.x),b=Math.abs(n.y-i.y),y=Math.min(n.x,i.x),x=Math.min(n.y,i.y),w={x:y+v/2,y:x+b/2};Math.abs(g)>.05&&(w=Object(o.rotatePoint)(w,p,g));var j=g*Math.PI/180;Object(r.default)(e,s,function(e){e.ellipse(w.x,w.y,v/2,b/2,j,0,2*Math.PI),e.closePath()})}},"./drawing/drawHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolStyle.js"),o=n("./stateManagement/toolColors.js"),i=n("./drawing/path.js"),s=n("./store/index.js");t.default=function(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=t.element,d=o.default.getToolColor();e.strokeStyle=l.color||d;for(var c=Object.keys(n),f=function(t){var o=n[c[t]];if(!0===o.drawnIndependently)return"continue";if(!0===l.drawHandlesIfActive&&!o.active)return"continue";if(l.hideHandlesIfMoving&&o.moving)return"continue";var d={lineWidth:o.active?r.default.getActiveWidth():r.default.getToolWidth(),fillStyle:l.fill};l.lineDash&&(d.lineDash=l.lineDash),Object(i.default)(e,d,function(e){var t=a.default.cornerstone.pixelToCanvas(u,o);e.arc(t.x,t.y,o.radius||l.handleRadius||s.state.handleRadius,0,2*Math.PI)})},h=0;h<c.length;h++)f(h)}},"./drawing/drawJoinedLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(r.default)(e,i,function(e){"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=o.map(function(e){return a.default.cornerstone.pixelToCanvas(t,e)})),e.moveTo(n.x,n.y),o.forEach(function(t){e.lineTo(t.x,t.y)})})}},"./drawing/drawLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./externalModules.js"),r=n("./drawing/path.js");function o(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(r.default)(e,i,function(e){"pixel"===s&&(n=a.default.cornerstone.pixelToCanvas(t,n),o=a.default.cornerstone.pixelToCanvas(t,o)),e.moveTo(n.x,n.y),e.lineTo(o.x,o.y)})}},"./drawing/drawLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";Object(r.default)(e,o,function(e){n.forEach(function(n){var r=n.start,o=n.end;if("pixel"===i){var s=a.default.cornerstone;r=s.pixelToCanvas(t,r),o=s.pixelToCanvas(t,o)}e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)})})}},"./drawing/drawLink.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/drawLine.js");t.default=function(e,t,n,o,i,s){var l=e.length>0?a.default.cornerstoneMath.point.findClosestPoint(e,t):t,u=a.default.cornerstoneMath.point.findClosestPoint([{x:n.left+n.width/2,y:n.top},{x:n.left,y:n.top+n.height/2},{x:n.left+n.width/2,y:n.top+n.height},{x:n.left+n.width,y:n.top+n.height/2}],l),d={color:i,lineWidth:s,lineDash:[2,3]};Object(r.default)(o,void 0,l,u,d,"canvas")}},"./drawing/drawLinkedTextBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/drawTextBox.js"),o=n("./drawing/drawLink.js");t.default=function(e,t,n,i,s,l,u,d,c,f){var h=a.default.cornerstone,m=h.pixelToCanvas(t,n);c&&(m.x+=c);var g={centering:{x:!1,y:f}};if(n.boundingBox=Object(r.default)(e,i,m.x,m.y,u,g),n.hasMoved){var p=l(s).map(function(e){return h.pixelToCanvas(t,e)});Object(o.default)(p,m,n.boundingBox,e,u,d)}}},"./drawing/drawRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js"),o=n("./util/pointProjector.js");t.default=function(e,t,n,i,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if("pixel"===l){var d=a.default.cornerstone;n=d.pixelToCanvas(t,n),i=d.pixelToCanvas(t,i)}var c=a.default.cornerstone.getViewport(t),f=t.clientWidth,h=t.clientHeight,m=c.scale,g=c.translation,p=c.rotation-u,v={x:f/2+g.x*m,y:h/2+g.y*m};Math.abs(p)>.05&&(n=Object(o.rotatePoint)(n,v,-p),i=Object(o.rotatePoint)(i,v,-p));var b=Math.abs(n.x-i.x),y=Math.abs(n.y-i.y);n={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)},i={x:n.x+b,y:n.y+y};var x={x:n.x+b,y:n.y},w={x:n.x,y:n.y+y};Math.abs(p)>.05&&(n=Object(o.rotatePoint)(n,v,p),i=Object(o.rotatePoint)(i,v,p),x=Object(o.rotatePoint)(x,v,p),w=Object(o.rotatePoint)(w,v,p)),Object(r.default)(e,s,function(e){e.moveTo(n.x,n.y),e.lineTo(x.x,x.y),e.lineTo(i.x,i.y),e.lineTo(w.x,w.y),e.lineTo(n.x,n.y)})}},"./drawing/drawTextBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"textBoxWidth",function(){return s});var a=n("./stateManagement/textStyle.js"),r=n("./drawing/draw.js"),o=n("./drawing/fillTextLines.js"),i=n("./drawing/fillBox.js");function s(e,t,n){var r=a.default.getFont(),o=e.font;r&&r!==o&&(e.font=r);var i=e.measureText(t).width;return r&&r!==o&&(e.font=o),i+2*n}t.default=function(e,t,n,l,u,d){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var c=a.default.getFontSize(),f=a.default.getBackgroundColor(),h=0;t.forEach(function(t){var n=s(e,t,5);h=Math.max(h,n)});var m={width:h,height:5+t.length*(c+5)};return Object(r.default)(e,function(e){e.strokeStyle=u,d&&d.centering&&!0===d.centering.x&&(n-=m.width/2),d&&d.centering&&!0===d.centering.y&&(l-=m.height/2),m.left=n,m.top=l;var a=d&&!0===d.debug?"#FF0000":f;Object(i.default)(e,m,a),Object(o.default)(e,m,t,u,5)}),m}},"./drawing/fillBox.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){e.fillStyle=n,e.fillRect(t.left,t.top,t.width,t.height)}},"./drawing/fillOutsideRect.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./drawing/path.js");t.default=function(e,t,n,o,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===s){var l=a.default.cornerstone;n=l.pixelToCanvas(t,n),o=l.pixelToCanvas(t,o)}var u=Math.min(n.x,o.x),d=Math.min(n.y,o.y),c=Math.abs(n.x-o.x),f=Math.abs(n.y-o.y);Object(r.default)(e,i,function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(u+c,d,-c,f)})}},"./drawing/fillTextLines.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/textStyle.js");t.default=function(e,t,n,r,o){var i=a.default.getFontSize();e.font=a.default.getFont(),e.textBaseline="top",e.fillStyle=r,n.forEach(function(n,a){e.fillText(n,t.left+o,t.top+o+a*(i+o))})}},"./drawing/getNewContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.getContext("2d");return t.setTransform(1,0,0,1,0,0),t}},"./drawing/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/draw.js");n.d(t,"draw",function(){return a.default});var r=n("./drawing/drawArrow.js");n.d(t,"drawArrow",function(){return r.default});var o=n("./drawing/drawCircle.js");n.d(t,"drawCircle",function(){return o.default});var i=n("./drawing/drawEllipse.js");n.d(t,"drawEllipse",function(){return i.default});var s=n("./drawing/drawHandles.js");n.d(t,"drawHandles",function(){return s.default});var l=n("./drawing/drawJoinedLines.js");n.d(t,"drawJoinedLines",function(){return l.default});var u=n("./drawing/drawLine.js");n.d(t,"drawLine",function(){return u.default});var d=n("./drawing/drawLines.js");n.d(t,"drawLines",function(){return d.default});var c=n("./drawing/drawLink.js");n.d(t,"drawLink",function(){return c.default});var f=n("./drawing/drawLinkedTextBox.js");n.d(t,"drawLinkedTextBox",function(){return f.default});var h=n("./drawing/drawRect.js");n.d(t,"drawRect",function(){return h.default});var m=n("./drawing/drawTextBox.js");n.d(t,"drawTextBox",function(){return m.default});var g=n("./drawing/fillBox.js");n.d(t,"fillBox",function(){return g.default});var p=n("./drawing/fillOutsideRect.js");n.d(t,"fillOutsideRect",function(){return p.default});var v=n("./drawing/fillTextLines.js");n.d(t,"fillTextLines",function(){return v.default});var b=n("./drawing/getNewContext.js");n.d(t,"getNewContext",function(){return b.default});var y=n("./drawing/path.js");n.d(t,"path",function(){return y.default});var x=n("./drawing/setShadow.js");n.d(t,"setShadow",function(){return x.default});var w=n("./drawing/transformCanvasContext.js");n.d(t,"transformCanvasContext",function(){return w.default});var j=n("./drawing/resetCanvasContextTransform.js");n.d(t,"resetCanvasContextTransform",function(){return j.default})},"./drawing/path.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolStyle.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.color,o=t.lineWidth,i=t.fillStyle,s=t.lineDash,l=t.shouldDrawLines,u=void 0===l||l;e.beginPath(),e.strokeStyle=r||e.strokeStyle,e.lineWidth=o||void 0===o&&a.default.getToolWidth()||e.lineWidth,s&&e.setLineDash(s),n(e),i&&(e.fillStyle=i,e.fill()),u&&e.stroke(),s&&e.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){e.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/getDefault.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.shadow&&(e.shadowColor=Object(a.default)(t.shadowColor,"#000000"),e.shadowBlur=Object(a.default)(t.shadowBlur,0),e.shadowOffsetX=Object(a.default)(t.shadowOffsetX,1),e.shadowOffsetY=Object(a.default)(t.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){if(n.hflip||n.vflip||n.rotation){var a={x:t.width/2+n.translation.x*n.scale,y:t.height/2+n.translation.y*n.scale};e.translate(a.x,a.y),n.rotation&&e.rotate(n.rotation*Math.PI/180),n.vflip&&e.scale(1,-1),n.hflip&&e.scale(-1,1),e.translate(-a.x,-a.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./eventListeners/onImageRenderedBrushEventHandler.js"),i=n("./externalModules.js"),s=Object(a.getModule)("segmentation"),l=function(e){var t=e.detail,n=t.element,i=a.state.tools.filter(function(e){return e.element===n&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)}),l=Object(r.getToolState)(n,"stack"),u=s.configuration;l&&(u.renderFill||u.renderOutline)&&Object(o.default)(e);var d=t.canvasContext.canvas.getContext("2d");i.forEach(function(t){t.renderToolData&&(d.save(),t.renderToolData(e),d.restore())})};t.default={enable:function(e){e.addEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,l)},disable:function(e){e.removeEventListener(i.default.cornerstone.EVENTS.IMAGE_RENDERED,l)}}},"./eventDispatchers/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/imageRenderedEventDispatcher.js");n.d(t,"imageRenderedEventDispatcher",function(){return a.default});var r=n("./eventDispatchers/mouseToolEventDispatcher.js");n.d(t,"mouseToolEventDispatcher",function(){return r.default});var o=n("./eventDispatchers/newImageEventDispatcher.js");n.d(t,"newImageEventDispatcher",function(){return o.default});var i=n("./eventDispatchers/touchToolEventDispatcher.js");n.d(t,"touchToolEventDispatcher",function(){return i.default})},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),i=n("./manipulators/index.js"),s=n("./util/logger.js"),l=n("./util/triggerEvent.js"),u=Object(s.getLogger)("eventDispatchers:mouseEventHandlers");t.default=function(e,t){u.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,s=n.element,d=t.createNewMeasurement(n);d&&(Object(o.addToolState)(s,t.name,d),r.default.cornerstone.updateImage(s),(1===Object.keys(d.handles).length?i.moveHandle:i.moveNewHandle)(n,t.name,d,d.handles.end,t.options,"mouse",function(e){if(!d.cancelled)if(e){var n=a.default.MEASUREMENT_COMPLETED,r={toolName:t.name,toolType:t.name,element:s,measurementData:d};Object(l.default)(s,n,r)}else Object(o.removeToolState)(s,t.name,d)}))}},"./eventDispatchers/mouseEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"mouseClick",function(){return l}),n.d(t,"mouseDoubleClick",function(){return u}),n.d(t,"mouseUp",function(){return d}),n.d(t,"mouseWheel",function(){return c});var a=n("./eventDispatchers/shared/customCallbackHandler.js"),r=n("./eventDispatchers/mouseEventHandlers/mouseDown.js");n.d(t,"mouseDown",function(){return r.default});var o=n("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");n.d(t,"mouseDownActivate",function(){return o.default});var i=n("./eventDispatchers/mouseEventHandlers/mouseDrag.js");n.d(t,"mouseDrag",function(){return i.default});var s=n("./eventDispatchers/mouseEventHandlers/mouseMove.js");n.d(t,"mouseMove",function(){return s.default});var l=a.default.bind(null,"Mouse","mouseClickCallback"),u=a.default.bind(null,"Mouse","doubleClickCallback"),d=a.default.bind(null,"Mouse","mouseUpCallback"),c=a.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./store/getToolsWithMoveableHandles.js"),i=n("./util/findAndMoveHelpers.js"),s=n("./store/getInteractiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=e.detail.element,d=e.detail.currentPoints.canvas,c=Object(s.default)(n,a.getters.mouseTools()),f=c.filter(function(e){return"active"===e.mode&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var h=f.find(function(e){return"function"==typeof e.preMouseDownCallback});if(h&&h.preMouseDownCallback(e))return}if(!a.state.isMultiPartToolActive){var m=Object(l.default)(n,c),g=Object(o.default)(n,m,d,"mouse");if(g.length>0){var p=g[0],v=Object(r.getToolState)(n,p.name),b=Object(i.findHandleDataNearImagePoint)(n,v,p.name,d);p.handleSelectedCallback(e,b.data,b.handle,"mouse")}else{var y=c.filter(function(e){var t=Object(r.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,d,"mouse")})});if(y.length>0){var x=y[0],w=Object(r.getToolState)(n,x.name).data.find(function(e){return x.pointNearTool(n,e,d)});x.toolSelectedCallback(e,w,"mouse")}else if(f.length>0){var j=f.find(function(e){return"function"==typeof e.postMouseDownCallback});if(j&&j.postMouseDownCallback(e))return}}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),r=n("./store/index.js"),o=n("./tools/base/BaseAnnotationTool.js"),i=n("./util/getActiveTool.js");t.default=function(e){if(!r.state.isToolLocked){var t=e.detail,n=t.element,s=t.buttons,l=Object(i.default)(n,s,"mouse");if(l){if("function"==typeof l.preMouseDownActivateCallback&&l.preMouseDownActivateCallback(e))return;r.state.isMultiPartToolActive||(l.addNewMeasurement?l.addNewMeasurement(e,"mouse"):l instanceof o.default&&Object(a.default)(e,l))}}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t,n=e.detail,i=n.element;t=(t=(t=Object(r.default)(i,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(n.buttons)&&e.options.isMouseActive})).filter(function(e){return"function"==typeof e.mouseDragCallback}),a.state.isMultiPartToolActive&&(t=Object(o.default)(t)),0!==t.length&&t[0].mouseDragCallback(e)}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./store/getInteractiveToolsForElement.js"),i=n("./store/getToolsWithDataForElement.js");t.default=function(e){if(!r.state.isToolLocked&&!r.state.isMultiPartToolActive){var t,n=e.detail,s=n.element;r.state.mousePositionImage=n.currentPoints.image;var l=(t=Object(o.default)(s,r.getters.mouseTools())).filter(function(e){return"active"===e.mode&&e.options.isMouseActive}),u=!1;l.length>0&&(u=l.some(function(e){return e.updateOnMouseMove})),t=Object(i.default)(s,t);for(var d=0;d<t.length;d++){var c=t[d];"function"==typeof c.mouseMoveCallback&&(u=c.mouseMoveCallback(e)||u)}!0===u&&a.default.cornerstone.updateImage(s)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./eventDispatchers/mouseEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.MOUSE_CLICK,r.mouseClick),e.addEventListener(a.default.MOUSE_DOWN,r.mouseDown),e.addEventListener(a.default.MOUSE_DOWN_ACTIVATE,r.mouseDownActivate),e.addEventListener(a.default.MOUSE_DOUBLE_CLICK,r.mouseDoubleClick),e.addEventListener(a.default.MOUSE_DRAG,r.mouseDrag),e.addEventListener(a.default.MOUSE_MOVE,r.mouseMove),e.addEventListener(a.default.MOUSE_UP,r.mouseUp),e.addEventListener(a.default.MOUSE_WHEEL,r.mouseWheel)},disable:function(e){e.removeEventListener(a.default.MOUSE_CLICK,r.mouseClick),e.removeEventListener(a.default.MOUSE_DOWN,r.mouseDown),e.removeEventListener(a.default.MOUSE_DOWN_ACTIVATE,r.mouseDownActivate),e.removeEventListener(a.default.MOUSE_DOUBLE_CLICK,r.mouseDoubleClick),e.removeEventListener(a.default.MOUSE_DRAG,r.mouseDrag),e.removeEventListener(a.default.MOUSE_MOVE,r.mouseMove),e.removeEventListener(a.default.MOUSE_UP,r.mouseUp),e.removeEventListener(a.default.MOUSE_WHEEL,r.mouseWheel)}}},"./eventDispatchers/newImageEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./externalModules.js"),o=function(e){if(a.state.isToolLocked)return!1;var t=e.detail.element,n=a.state.tools.filter(function(e){return e.element===t&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)});if(0===n.length)return!1;n.forEach(function(t){t.newImageCallback&&t.newImageCallback(e)})};t.default={enable:function(e){e.addEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,o)},disable:function(e){e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,o)}}},"./eventDispatchers/shared/customCallbackHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e,t,n){if(a.state.isToolLocked)return!1;var i=n.detail.element,s=a.state.tools.filter(function(t){return t.supportedInteractionTypes.includes(e)});if(s=(s=Object(r.default)(i,s,e)).filter(function(e){return"function"==typeof e[t]}),a.state.isMultiPartToolActive&&(s=Object(o.default)(s)),0===s.length)return!1;s[0][t](n)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./store/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),s=n("./manipulators/index.js"),l=n("./stateManagement/toolState.js"),u=n("./util/triggerEvent.js"),d=n("./util/logger.js"),c=Object(d.getLogger)("eventDispatchers:touchEventHandlers");t.default=function(e,t){c.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,d=n.element,f=t.createNewMeasurement(n);if(f){if(Object(l.addToolState)(d,t.name,f),1===Object.keys(f.handles).length&&n.type===a.default.TAP)return f.active=!1,f.handles.end.active=!1,f.handles.end.highlight=!1,f.invalidated=!0,(o.state.deleteIfHandleOutsideImage||t.options.deleteIfHandleOutsideImage)&&Object(i.default)(n,f.handles)&&Object(l.removeToolState)(d,t.name,f),void r.default.cornerstone.updateImage(d);r.default.cornerstone.updateImage(d),Object(s.moveNewHandle)(n,t.name,f,f.handles.end,t.options,"touch",function(){var e=a.default.MEASUREMENT_COMPLETED,n={toolName:t.name,toolType:t.name,element:d,measurementData:f};Object(u.default)(d,e,n)})}}},"./eventDispatchers/touchEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"doubleTap",function(){return l}),n.d(t,"touchDrag",function(){return u}),n.d(t,"touchEnd",function(){return d}),n.d(t,"touchPinch",function(){return c}),n.d(t,"touchPress",function(){return f}),n.d(t,"touchRotate",function(){return h});var a=n("./eventDispatchers/shared/customCallbackHandler.js"),r=n("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");n.d(t,"multiTouchDrag",function(){return r.default});var o=n("./eventDispatchers/touchEventHandlers/tap.js");n.d(t,"tap",function(){return o.default});var i=n("./eventDispatchers/touchEventHandlers/touchStart.js");n.d(t,"touchStart",function(){return i.default});var s=n("./eventDispatchers/touchEventHandlers/touchStartActive.js");n.d(t,"touchStartActive",function(){return s.default});var l=a.default.bind(null,"DoubleTap","doubleTapCallback"),u=a.default.bind(null,"Touch","touchDragCallback"),d=a.default.bind(null,"Touch","touchEndCallback"),c=a.default.bind(null,"TouchPinch","touchPinchCallback"),f=a.default.bind(null,"Touch","touchPressCallback"),h=a.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(a.state.isToolLocked)return!1;var t=e.detail,n=t.element,i=t.numPointers,s=a.state.tools.filter(function(e){return e.supportedInteractionTypes.includes("MultiTouch")});if(s=(s=Object(r.default)(n,s,"MultiTouch")).filter(function(e){return"function"==typeof e.multiTouchDragCallback&&i===e.configuration.touchPointers}),a.state.isMultiPartToolActive&&(s=Object(o.default)(s)),0===s.length)return!1;s[0].multiTouchDragCallback(e)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(e,t,n){"use strict";function a(e){Object.keys(e).forEach(function(t){e[t].active=!1})}n.r(t),t.default=function(e){if(e)for(var t=0;t<e.data.length;t++){var n=e.data[t];n.active=!1,n.handles&&a(n.handles)}}},"./eventDispatchers/touchEventHandlers/tap.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./eventDispatchers/touchEventHandlers/touchStartActive.js"),o=n("./store/index.js"),i=n("./store/getActiveToolsForElement.js"),s=n("./store/getToolsWithDataForElement.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),c=n("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");t.default=function(e){if(!o.state.isToolLocked&&!o.state.isMultiPartToolActive){var t,n=e.detail.element,f=e.detail.currentPoints.canvas;t=Object(i.default)(n,o.getters.touchTools());var h=(t=Object(s.default)(n,t)).filter(function(e){for(var t=Object(l.getToolState)(n,e.name),a=0;a<t.data.length;a++)if(void 0!==Object(u.default)(n,t.data[a].handles,f,28))return!0;return!1});if(h.length>0){var m=h[0],g=Object(l.getToolState)(n,m.name),p=g.data.find(function(e){return void 0!==Object(u.default)(n,e.handles,f,28)});return g.data.active=!0,p.active=!0,a.default.cornerstone.updateImage(n),Object(d.moveHandle)(e.detail,m.name,g.data,p,m.options,"touch",function(){return Object(c.default)(g)}),e.stopImmediatePropagation(),void e.preventDefault()}var v=t.filter(function(e){var t=Object(l.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,f)})});if(v.length>0){var b=v[0],y=Object(l.getToolState)(n,b.name),x=y.data.find(function(e){return b.pointNearTool(n,e,f)});return x.active=!0,a.default.cornerstone.updateImage(n),Object(d.moveAllHandles)(e.detail,b.name,x,null,b.options,"touch",function(){return Object(c.default)(y)}),e.stopImmediatePropagation(),void e.preventDefault()}var w=Object(i.default)(n,o.getters.touchTools());return w.length>0&&w[0].touchStartActiveCallback?w[0].touchStartActiveCallback(e):Object(r.default)(e),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./util/findAndMoveHelpers.js"),o=n("./store/getToolsWithMoveableHandles.js"),i=n("./stateManagement/toolState.js"),s=n("./store/getInteractiveToolsForElement.js"),l=n("./store/getToolsWithDataForElement.js"),u=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!a.state.isToolLocked){var t=e.detail,n=t.element,d=t.startPoints.canvas,c=Object(s.default)(n,a.getters.touchTools()),f=c.filter(function(e){return"active"===e.mode&&e.options.isTouchActive});if(a.state.isMultiPartToolActive&&(f=Object(u.default)(f)),f.length>0){var h=f.find(function(e){return"function"==typeof e.preTouchStartCallback});if(h&&h.preTouchStartCallback(e))return}if(!a.state.isMultiPartToolActive){var m=Object(l.default)(n,c),g=Object(o.default)(n,m,d,"touch");if(g.length>0){var p=g[0],v=Object(i.getToolState)(n,p.name),b=Object(r.findHandleDataNearImagePoint)(n,v,p.name,d,"touch");p.handleSelectedCallback(e,b.data,b.handle,"touch")}else{var y=m.filter(function(e){var t=Object(i.getToolState)(n,e.name);return t&&t.data&&e.pointNearTool&&t.data.some(function(t){return e.pointNearTool(n,t,d,"touch")})});if(y.length>0){var x=y[0],w=Object(i.getToolState)(n,x.name).data.find(function(e){return x.pointNearTool(n,e,d)});x.toolSelectedCallback(e,w,"touch")}else if(f.length>0){var j=f.find(function(e){return"function"==typeof e.postTouchStartCallback});if(j&&j.postTouchStartCallback(e))return}}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),o=n("./tools/base/BaseAnnotationTool.js"),i=n("./util/getActiveTool.js");t.default=function(e){if(!a.state.isToolLocked&&!a.state.isMultiPartToolActive){var t=e.detail.element,n=Object(i.default)(t,null,"touch");n&&n.addNewMeasurement?n.addNewMeasurement(e,"touch"):n instanceof o.default&&Object(r.default)(e,n)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./eventDispatchers/touchEventHandlers/index.js");t.default={enable:function(e){e.addEventListener(a.default.TAP,r.tap),e.addEventListener(a.default.TOUCH_START,r.touchStart,{passive:!1}),e.addEventListener(a.default.TOUCH_DRAG,r.touchDrag,{passive:!1}),e.addEventListener(a.default.TOUCH_END,r.touchEnd),e.addEventListener(a.default.TOUCH_START_ACTIVE,r.touchStartActive),e.addEventListener(a.default.TOUCH_PRESS,r.touchPress),e.addEventListener(a.default.DOUBLE_TAP,r.doubleTap),e.addEventListener(a.default.TOUCH_PINCH,r.touchPinch),e.addEventListener(a.default.TOUCH_ROTATE,r.touchRotate),e.addEventListener(a.default.MULTI_TOUCH_DRAG,r.multiTouchDrag)},disable:function(e){e.removeEventListener(a.default.TAP,r.tap),e.removeEventListener(a.default.TOUCH_START,r.touchStart),e.removeEventListener(a.default.TOUCH_DRAG,r.touchDrag),e.removeEventListener(a.default.TOUCH_END,r.touchEnd),e.removeEventListener(a.default.TOUCH_START_ACTIVE,r.touchStartActive),e.removeEventListener(a.default.TOUCH_PRESS,r.touchPress),e.removeEventListener(a.default.DOUBLE_TAP,r.doubleTap),e.removeEventListener(a.default.TOUCH_PINCH,r.touchPinch),e.removeEventListener(a.default.TOUCH_ROTATE,r.touchRotate),e.removeEventListener(a.default.MULTI_TOUCH_DRAG,r.multiTouchDrag)}}},"./eventListeners/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/mouseEventListeners.js");n.d(t,"mouseEventListeners",function(){return a.default});var r=n("./eventListeners/wheelEventListener.js");n.d(t,"wheelEventListener",function(){return r.default});var o=n("./eventListeners/touchEventListeners.js");n.d(t,"touchEventListeners",function(){return o.default})},"./eventListeners/internals/normalizeWheel.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=0,n=0,a=0,r=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),a=10*t,r=10*n,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||r)&&e.deltaMode&&(1===e.deltaMode?(a*=40,r*=40):(a*=800,r*=800)),a&&!t&&(t=a<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:t,spinY:n,pixelX:a,pixelY:r}}},"./eventListeners/internals/renderSegmentation.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/index.js"),r=n("./eventListeners/internals/renderSegmentationFill.js"),o=n("./eventListeners/internals/renderSegmentationOutline.js"),i=Object(a.getModule)("segmentation");function s(e,t,n,a,s){(function(e){var t=i.configuration;return t.renderFill&&(e&&0!==t.fillAlpha||!e&&0!==t.fillAlphaInactive)})(s)&&Object(r.default)(e,t,a,n,s),function(e){var t=i.configuration;return t.renderOutline&&(e&&0!==t.outlineAlpha||!e&&0!==t.outlineAlphaInactive)}(s)&&Object(o.default)(e,t,a,n,s)}},"./eventListeners/internals/renderSegmentationFill.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s}),n.d(t,"getLabelmapCanvas",function(){return l}),n.d(t,"renderFill",function(){return u});var a=n("./store/index.js"),r=n("./drawing/index.js"),o=n("./externalModules.js"),i=Object(a.getModule)("segmentation");function s(e,t,n,a,r){u(e,l(e,t,n),r)}function l(e,t,n){var a=e.detail.image,o=a.width,s=a.height,l=t.segmentsHidden,u=n.pixelData,d=i.state.colorLutTables[t.colorLUTIndex],c=document.createElement("canvas");c.width=o,c.height=s;for(var f=Object(r.getNewContext)(c),h=new ImageData(o,s),m=h.data,g=0;g<u.length;g++){var p=u[g];if(0!==p&&!l[p]){var v=d[u[g]];m[4*g]=v[0],m[4*g+1]=v[1],m[4*g+2]=v[2],m[4*g+3]=v[3]}}return f.putImageData(h,0,0),c}function u(e,t,n){var a=i.configuration,s=e.detail,l=Object(r.getNewContext)(s.canvasContext.canvas),u=o.default.cornerstone.pixelToCanvas(s.element,{x:0,y:0}),d=o.default.cornerstone.pixelToCanvas(s.element,{x:s.image.width,y:0}),c=o.default.cornerstone.pixelToCanvas(s.element,{x:s.image.width,y:s.image.height}),f=o.default.cornerstoneMath.point.distance(u,d),h=o.default.cornerstoneMath.point.distance(d,c),m=s.canvasContext.canvas,g=s.viewport,p=l.imageSmoothingEnabled,v=l.globalAlpha;l.imageSmoothingEnabled=!1,l.globalAlpha=n?a.fillAlpha:a.fillAlphaInactive,Object(r.transformCanvasContext)(l,m,g);var b=function(e){var t=e.viewport,n=e.image,a=t.scale,r=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?a*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(r*=n.rowPixelSpacing/n.columnPixelSpacing),{x:t.translation.x*a,y:t.translation.y*r}}(s);l.drawImage(t,m.width/2-f/2+b.x,m.height/2-h/2+b.y,f,h),l.globalAlpha=v,l.imageSmoothingEnabled=p,Object(r.resetCanvasContextTransform)(l)}},"./eventListeners/internals/renderSegmentationOutline.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s}),n.d(t,"renderOutline",function(){return l}),n.d(t,"getOutline",function(){return u}),n.d(t,"_addTopRightCorner",function(){return f});var a=n("./store/index.js"),r=n("./externalModules.js"),o=n("./drawing/index.js"),i=(n("./index.js"),Object(a.getModule)("segmentation"));function s(e,t,n,a,r){l(e,u(e,t,n,i.configuration.outlineWidth),t.colorLUTIndex,r)}function l(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=i.configuration,s=i.state,l=e.detail,u=l.element,d=l.canvasContext,c=r.outlineWidth||1,f=Object(o.getNewContext)(d.canvas),h=s.colorLutTables[n],m=f.globalAlpha;f.globalAlpha=a?r.outlineAlpha:r.outlineAlphaInactive,Object(o.draw)(f,function(e){for(var n=1;n<t.length;n++)if(t[n]){var a=h[n];Object(o.drawLines)(e,u,t[n],{color:"rgba(".concat(a[0],", ").concat(a[1],", ").concat(a[2],", 1.0 )"),lineWidth:c},"canvas")}}),f.globalAlpha=m}function u(e,t,n,a){var r=e.detail,o=r.element,i=r.image,s=r.viewport,l=i.width,u=i.height;a=a||1;var y=t.segmentsHidden,x=n.pixelData,w=t.activeSegmentIndex,j=[];n.segmentsOnLabelmap.forEach(function(e){!y[e]&&(j[e]=[])}),j[w]||(j[w]=[]);for(var T,_=function(e,t){var n=t/2,a=e.rotation;a*=Math.PI/180;var r=Math.cos(a),o=Math.sin(a),i=[r,o],s=[-o,r],l={x:n*i[0],y:n*i[1]},u={x:n*s[0],y:n*s[1]};return e.hflip&&(l.x*=-1,l.y*=-1),e.vflip&&(u.x*=-1,u.y*=-1),{i:l,j:u}}(s,a),E=0;E<x.length;E++){var O=x[E];if(0!==O&&!y[O]){var S={x:(T=E)%l,y:Math.floor(T/l)},C=d(S,u,l);void 0!==C.top&&x[C.top]===O||g(j[O],o,S,_),void 0!==C.bottom&&x[C.bottom]===O||p(j[O],o,S,_),void 0!==C.left&&x[C.left]===O||v(j[O],o,S,_),void 0!==C.right&&x[C.right]===O||b(j[O],o,S,_),void 0!==C.topLeft&&x[C.topLeft]!==O&&x[C.top]===O&&x[C.left]===O&&c(j[O],o,S,_),void 0!==C.topRight&&x[C.topRight]!==O&&x[C.top]===O&&x[C.right]===O&&f(j[O],o,S,_),void 0!==C.bottomLeft&&x[C.bottomLeft]!==O&&x[C.bottom]===O&&x[C.left]===O&&h(j[O],o,S,_),void 0!==C.bottomRight&&x[C.bottomRight]!==O&&x[C.bottom]===O&&x[C.right]===O&&m(j[O],o,S,_)}}return j}function d(e,t,n){var a=e.y*n+e.x,r={},o=e.y+1<t,i=e.x-1>=0,s=e.x+1<n;return e.y-1>=0&&(r.top=a-n,s&&(r.topRight=r.top+1),i&&(r.topLeft=r.top-1)),o&&(r.bottom=a+n,s&&(r.bottomRight=r.bottom+1),i&&(r.bottomLeft=r.bottom-1)),i&&(r.left=a-1),s&&(r.right=a+1),r}function c(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,n);o.x+=a.j.x,o.y+=a.j.y;var i={x:o.x,y:o.y};i.x+=2*a.i.x,i.y+=2*a.i.y,e.push({start:o,end:i})}function f(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,{x:n.x+1,y:n.y});o.x+=a.j.x,o.y+=a.j.y;var i={x:o.x,y:o.y};i.x-=2*a.i.x,i.y-=2*a.i.y,e.push({start:o,end:i})}function h(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,{x:n.x,y:n.y+1});o.x-=a.j.x,o.y-=a.j.y;var i={x:o.x,y:o.y};i.x+=2*a.i.x,i.y+=2*a.i.y,e.push({start:o,end:i})}function m(e,t,n,a){var o=(0,r.default.cornerstone.pixelToCanvas)(t,{x:n.x+1,y:n.y+1});o.x-=a.j.x,o.y-=a.j.y;var i={x:o.x,y:o.y};i.x-=2*a.i.x,i.y-=2*a.i.y,e.push({start:o,end:i})}function g(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,n),s=o(t,{x:n.x+1,y:n.y});i.x+=a.j.x,i.y+=a.j.y,s.x+=a.j.x,s.y+=a.j.y,e.push({start:i,end:s})}function p(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,{x:n.x,y:n.y+1}),s=o(t,{x:n.x+1,y:n.y+1});i.x-=a.j.x,i.y-=a.j.y,s.x-=a.j.x,s.y-=a.j.y,e.push({start:i,end:s})}function v(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,n),s=o(t,{x:n.x,y:n.y+1});i.x+=a.i.x,i.y+=a.i.y,s.x+=a.i.x,s.y+=a.i.y,e.push({start:i,end:s})}function b(e,t,n,a){var o=r.default.cornerstone.pixelToCanvas,i=o(t,{x:n.x+1,y:n.y}),s=o(t,{x:n.x+1,y:n.y+1});i.x-=a.i.x,i.y-=a.i.y,s.x-=a.i.x,s.y-=a.i.y,e.push({start:i,end:s})}},"./eventListeners/mouseEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,r=n("./events.js"),o=n("./externalModules.js"),i=n("./util/copyPoints.js"),s=n("./util/triggerEvent.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("eventListeners:mouseEventListeners"),d=!0;function c(e){if("number"==typeof e.buttons)return e.buttons;switch(e.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function f(){d=!1}function h(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){var a=r.default.MOUSE_DOUBLE_CLICK,l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var d=Object(i.default)(l);u.log("double-click: %o",c(e));var f={event:e,buttons:c(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:d,currentPoints:l,deltaPoints:{x:0,y:0},type:a};Object(s.default)(t,a,f)}}function m(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){a=setTimeout(f,200),t.removeEventListener("mousemove",g);var l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var h=Object(i.default)(l),m={event:e,buttons:c(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:h,currentPoints:l,deltaPoints:{x:0,y:0},type:r.default.MOUSE_DOWN};Object(s.default)(m.element,r.default.MOUSE_DOWN,m)&&(m.type=r.default.MOUSE_DOWN_ACTIVATE,Object(s.default)(m.element,r.default.MOUSE_DOWN_ACTIVATE,m)),document.addEventListener("mousemove",p),document.addEventListener("mouseup",function e(i){clearTimeout(a);var f=r.default.MOUSE_UP;d&&(f=r.default.MOUSE_CLICK);var m={page:o.default.cornerstoneMath.point.pageToPoint(i),image:o.default.cornerstone.pageToPixel(t,i.pageX,i.pageY),client:{x:i.clientX,y:i.clientY}};m.canvas=o.default.cornerstone.pixelToCanvas(t,m.image);var v={page:o.default.cornerstoneMath.point.subtract(m.page,h.page),image:o.default.cornerstoneMath.point.subtract(m.image,h.image),client:o.default.cornerstoneMath.point.subtract(m.client,h.client),canvas:o.default.cornerstoneMath.point.subtract(m.canvas,h.canvas)};u.log("mouseup: %o",c(i));var b={event:i,buttons:c(i),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:h,currentPoints:m,deltaPoints:v,type:f};Object(s.default)(b.element,f,b),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",e),t.addEventListener("mousemove",g),d=!0})}function p(e){var a=r.default.MOUSE_DRAG,d={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=o.default.cornerstone.pixelToCanvas(t,d.image);var f={page:o.default.cornerstoneMath.point.subtract(d.page,h.page),image:o.default.cornerstoneMath.point.subtract(d.image,h.image),client:o.default.cornerstoneMath.point.subtract(d.client,h.client),canvas:o.default.cornerstoneMath.point.subtract(d.canvas,h.canvas)};u.log("mousemove: %o",c(e));var m={buttons:c(e),viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:h,currentPoints:d,deltaPoints:f,type:a,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(s.default)(m.element,a,m),h=Object(i.default)(d)}}function g(e){var t=e.currentTarget,n=o.default.cornerstone.getEnabledElement(t);if(n.image){var a=r.default.MOUSE_MOVE,l={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};l.canvas=o.default.cornerstone.pixelToCanvas(t,l.image);var u=Object(i.default)(l),d={page:o.default.cornerstoneMath.point.pageToPoint(e),image:o.default.cornerstone.pageToPixel(t,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};d.canvas=o.default.cornerstone.pixelToCanvas(t,d.image);var c={page:o.default.cornerstoneMath.point.subtract(d.page,u.page),image:o.default.cornerstoneMath.point.subtract(d.image,u.image),client:o.default.cornerstoneMath.point.subtract(d.client,u.client),canvas:o.default.cornerstoneMath.point.subtract(d.canvas,u.canvas)},f={viewport:o.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:l,lastPoints:u,currentPoints:d,deltaPoints:c,type:a};Object(s.default)(t,a,f),u=Object(i.default)(d)}}function p(e){e.removeEventListener("mousedown",m),e.removeEventListener("mousemove",g),e.removeEventListener("dblclick",h)}t.default={enable:function(e){p(e),e.addEventListener("mousedown",m),e.addEventListener("mousemove",g),e.addEventListener("dblclick",h)},disable:p}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./eventListeners/internals/renderSegmentation.js"),o=Object(a.getModule)("segmentation");t.default=function(e){var t=o.configuration,n=o.getters.labelmaps3D(e.detail.element),a=n.activeLabelmapIndex,i=n.labelmaps3D,s=n.currentImageIdIndex;i&&(t.shouldRenderInactiveLabelmaps&&function(e,t,n,a){for(var o=0;o<t.length;o++){var i=t[o];if(o!==n&&i){var s=i.labelmaps2D[a];s&&Object(r.default)(e,i,o,s,!1)}}}(e,i,a,s),function(e,t,n,a){var o=t[n];if(o){var i=o.labelmaps2D[a];i&&Object(r.default)(e,o,n,i,!0)}}(e,i,a,s))}},"./eventListeners/preventGhostClick.js":function(e,t,n){"use strict";var a,r;function o(e,t){var n=Date.now();if(e!==a){if(n-r<=2e3)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;a=e}r=n}n.r(t);var i=o.bind(null,0),s=o.bind(null,1);function l(e,t,n){var a=n?i:s;t.forEach(function(t){e.addEventListener(t,a,{passive:!1})})}function u(e,t,n){var a=n?i:s;t.forEach(function(t){e.removeEventListener(t,a)})}var d=["mousedown","mouseup"],c=["touchstart","touchend"];function f(e){u(e,d,0),u(e,c,1)}t.default={enable:function(e){f(e),l(e,d,0),l(e,c,1)},disable:f}},"./eventListeners/touchEventListeners.js":function(e,t,n){"use strict";n.r(t);var a,r,o,i,s,l,u,d,c,f=n("./events.js"),h=n("./externalModules.js"),m=n("./util/copyPoints.js"),g=n("./eventListeners/preventGhostClick.js"),p=n("./util/triggerEvent.js"),v=n("./toolOptions.js"),b=1,y=0,x=!1,w=!1,j="touchInput";function T(e){var t=e.currentTarget||e.srcEvent.currentTarget,n=h.default.cornerstone.getEnabledElement(t);if(n.image){var g,v,j,T;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(w=!1,clearTimeout(u)),e.type){case"tap":w=!1,clearTimeout(u),(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),g=f.default.TAP,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:g,isTouchEvent:!0},Object(p.default)(t,g,s);break;case"doubletap":w=!1,clearTimeout(u),(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),g=f.default.DOUBLE_TAP,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:g,isTouchEvent:!0},Object(p.default)(t,g,s);break;case"pinchstart":w=!1,clearTimeout(u),b=1;break;case"pinchmove":if(w=!1,clearTimeout(u),!0===x){b=e.scale,x=!1;break}v=(e.scale-b)/b,(a={page:e.center,image:h.default.cornerstone.pageToPixel(t,e.center.x,e.center.y)}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),g=f.default.TOUCH_PINCH,s={event:e,startPoints:a,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,direction:e.scale<1?1:-1,scaleChange:v,type:g,isTouchEvent:!0},Object(p.default)(t,g,s),b=e.scale;break;case"touchstart":b=1,clearTimeout(u),clearTimeout(l),l=setTimeout(function(){(a={page:h.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:h.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),g=f.default.TOUCH_START,e.touches.length>1&&(g=f.default.MULTI_TOUCH_START),s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:g,isTouchEvent:!0},!0===Object(p.default)(t,g,s)&&(g=f.default.TOUCH_START_ACTIVE,e.touches.length>1&&(g=f.default.MULTI_TOUCH_START_ACTIVE),s.type=g,Object(p.default)(t,g,s)),o=Object(m.default)(a)},50),w=!0,d=0,u=setTimeout(function(){w&&((r={page:h.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:h.default.cornerstone.pageToPixel(t,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),g=f.default.TOUCH_PRESS,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,currentPoints:r,type:g,isTouchEvent:!0},Object(p.default)(t,g,s))},700);break;case"touchend":b=1,w=!1,clearTimeout(u),setTimeout(function(){(a={page:h.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:h.default.cornerstone.pageToPixel(t,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,a.image),g=f.default.TOUCH_END,s={event:e,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,currentPoints:a,type:g,isTouchEvent:!0},Object(p.default)(t,g,s)},50);break;case"panmove":j={x:e.deltaX-c.x,y:e.deltaY-c.y},c={x:e.deltaX,y:e.deltaY},(r={page:{x:o.page.x+j.x,y:o.page.y+j.y},image:h.default.cornerstone.pageToPixel(t,o.page.x+j.x,o.page.y+j.y),client:{x:o.client.x+j.x,y:o.client.y+j.y}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),i={page:h.default.cornerstoneMath.point.subtract(r.page,o.page),image:h.default.cornerstoneMath.point.subtract(r.image,o.image),client:h.default.cornerstoneMath.point.subtract(r.client,o.client),canvas:h.default.cornerstoneMath.point.subtract(r.canvas,o.canvas)},(d+=Math.sqrt(i.page.x*i.page.x+i.page.y*i.page.y))>5&&(w=!1,clearTimeout(u)),g=f.default.TOUCH_DRAG,e.pointers.length>1&&(g=f.default.MULTI_TOUCH_DRAG),s={viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:o,currentPoints:r,deltaPoints:i,numPointers:e.pointers.length,type:g,isTouchEvent:!0},Object(p.default)(t,g,s),o=Object(m.default)(r);break;case"panstart":c={x:e.deltaX,y:e.deltaY},(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),o=Object(m.default)(r);break;case"panend":if(w=!1,clearTimeout(u),!o)return!1;(r={page:h.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:h.default.cornerstone.pageToPixel(t,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=h.default.cornerstone.pixelToCanvas(t,r.image),i={page:h.default.cornerstoneMath.point.subtract(r.page,o.page),image:h.default.cornerstoneMath.point.subtract(r.image,o.image),client:h.default.cornerstoneMath.point.subtract(r.client,o.client),canvas:h.default.cornerstoneMath.point.subtract(r.canvas,o.canvas)},g=f.default.TOUCH_DRAG_END,s={event:e.srcEvent,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,startPoints:a,lastPoints:o,currentPoints:r,deltaPoints:i,type:g,isTouchEvent:!0},Object(p.default)(t,g,s),2==e.pointers.length-e.changedPointers.length&&(x=!0);break;case"rotatemove":w=!1,clearTimeout(u),T=e.rotation-y,y=e.rotation,g=f.default.TOUCH_ROTATE,s={event:e.srcEvent,viewport:h.default.cornerstone.getViewport(t),image:n.image,element:t,rotation:T,type:g},Object(p.default)(t,g,s)}return!1}}function _(e){g.default.disable(e),["touchstart","touchend"].forEach(function(t){e.removeEventListener(t,T)});var t=Object(v.getToolOptions)(j,e).hammer;t&&t.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",T)}t.default={enable:function(e){_(e);var t=h.default.Hammer,n=new t.Manager(e,{inputClass:t.SUPPORT_POINTER_EVENTS?t.PointerEventInput:t.TouchInput}),a=new t.Pan({pointers:0,direction:t.DIRECTION_ALL,threshold:0}),r=new t.Pinch({threshold:0}),o=new t.Rotate({threshold:0});r.recognizeWith(a),r.recognizeWith(o),o.recognizeWith(a);var i=new t.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});i.recognizeWith(a),n.add([i,a,o,r]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",T),g.default.enable(e),["touchstart","touchend"].forEach(function(t){e.addEventListener(t,T,{passive:!1})});var s=Object(v.getToolOptions)(j,e);s.hammer=n,Object(v.setToolOptions)(j,e,s)},disable:_}},"./eventListeners/wheelEventListener.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./util/triggerEvent.js"),i=n("./eventListeners/internals/normalizeWheel.js");function s(e){var t=e.currentTarget,n=r.default.cornerstone.getEnabledElement(t);if(n.image&&!(e.deltaY>-1&&e.deltaY<1)){e.preventDefault();var s=e.pageX,l=e.pageY,u=r.default.cornerstone.pageToPixel(t,s,l),d=Object(i.default)(e),c=d.spinX,f=d.spinY,h=d.pixelX,m=d.pixelY,g=f<0?-1:1,p={element:t,viewport:r.default.cornerstone.getViewport(t),detail:e,image:n.image,direction:g,spinX:c,spinY:f,pixelX:h,pixelY:m,pageX:s,pageY:l,imageX:u.x,imageY:u.y};Object(o.default)(t,a.default.MOUSE_WHEEL,p)}}function l(e){e.removeEventListener("wheel",s,{passive:!1})}t.default={enable:function(e){l(e),e.addEventListener("wheel",s,{passive:!1})},disable:l}},"./eventListeners/windowResizeHandler.js":function(e,t,n){"use strict";n.r(t),n.d(t,"forceEnabledElementResize",function(){return l});var a,r=n("./store/index.js"),o=n("./externalModules.js"),i=function(){window.removeEventListener("resize",s,!1)};function s(){a||(a=setTimeout(function(){a=null,l()},66))}var l=function(){r.state.enabledElements.forEach(function(e){o.default.cornerstone.resize(e)})};t.default={enable:function(){i(),window.addEventListener("resize",s,!1)},disable:i}},"./events.js":function(e,t,n){"use strict";n.r(t),t.default={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_COMPLETED:"cornerstonetoolsmeasurementcompleted",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll",STACK_PREFETCH_IMAGE_LOADED:"cornerstonetoolsstackprefetchimageloaded",STACK_PREFETCH_DONE:"cornerstonetoolsstackprefetchdone",LABELMAP_MODIFIED:"cornersontetoolslabelmapmodified"}},"./externalModules.js":function(e,t,n){"use strict";n.r(t);var a=window.cornerstone,r=window.cornerstoneMath,o=window.Hammer;t.default={set cornerstone(e){a=e},get cornerstone(){return a},set cornerstoneMath(e){r=e},get cornerstoneMath(){return r},set Hammer(e){o=e},get Hammer(){return o}}},"./importInternal.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js");t.default=function(e){return a.lib[e]}},"./index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/index.js");n.d(t,"AngleTool",function(){return a.AngleTool}),n.d(t,"ArrowAnnotateTool",function(){return a.ArrowAnnotateTool}),n.d(t,"BidirectionalTool",function(){return a.BidirectionalTool}),n.d(t,"CircleRoiTool",function(){return a.CircleRoiTool}),n.d(t,"CobbAngleTool",function(){return a.CobbAngleTool}),n.d(t,"EllipticalRoiTool",function(){return a.EllipticalRoiTool}),n.d(t,"FreehandRoiTool",function(){return a.FreehandRoiTool}),n.d(t,"LengthTool",function(){return a.LengthTool}),n.d(t,"ProbeTool",function(){return a.ProbeTool}),n.d(t,"RectangleRoiTool",function(){return a.RectangleRoiTool}),n.d(t,"TextMarkerTool",function(){return a.TextMarkerTool});var r=n("./tools/segmentation/index.js");n.d(t,"BrushTool",function(){return r.BrushTool}),n.d(t,"SphericalBrushTool",function(){return r.SphericalBrushTool}),n.d(t,"RectangleScissorsTool",function(){return r.RectangleScissorsTool}),n.d(t,"FreehandScissorsTool",function(){return r.FreehandScissorsTool}),n.d(t,"CircleScissorsTool",function(){return r.CircleScissorsTool}),n.d(t,"CorrectionScissorsTool",function(){return r.CorrectionScissorsTool});var o=n("./tools/index.js");n.d(t,"CrosshairsTool",function(){return o.CrosshairsTool}),n.d(t,"DoubleTapFitToWindowTool",function(){return o.DoubleTapFitToWindowTool}),n.d(t,"DragProbeTool",function(){return o.DragProbeTool}),n.d(t,"EraserTool",function(){return o.EraserTool}),n.d(t,"FreehandRoiSculptorTool",function(){return o.FreehandRoiSculptorTool}),n.d(t,"MagnifyTool",function(){return o.MagnifyTool}),n.d(t,"OverlayTool",function(){return o.OverlayTool}),n.d(t,"OrientationMarkersTool",function(){return o.OrientationMarkersTool}),n.d(t,"PanMultiTouchTool",function(){return o.PanMultiTouchTool}),n.d(t,"PanTool",function(){return o.PanTool}),n.d(t,"ReferenceLinesTool",function(){return o.ReferenceLinesTool}),n.d(t,"RotateTool",function(){return o.RotateTool}),n.d(t,"RotateTouchTool",function(){return o.RotateTouchTool}),n.d(t,"ScaleOverlayTool",function(){return o.ScaleOverlayTool}),n.d(t,"StackScrollMouseWheelTool",function(){return o.StackScrollMouseWheelTool}),n.d(t,"StackScrollMultiTouchTool",function(){return o.StackScrollMultiTouchTool}),n.d(t,"StackScrollTool",function(){return o.StackScrollTool}),n.d(t,"WwwcRegionTool",function(){return o.WwwcRegionTool}),n.d(t,"WwwcTool",function(){return o.WwwcTool}),n.d(t,"ZoomMouseWheelTool",function(){return o.ZoomMouseWheelTool}),n.d(t,"ZoomTool",function(){return o.ZoomTool}),n.d(t,"ZoomTouchPinchTool",function(){return o.ZoomTouchPinchTool});var i=n("./init.js");n.d(t,"init",function(){return i.default});var s=n("./stackTools/stackPrefetch.js");n.d(t,"stackPrefetch",function(){return s.default});var l=n("./stackTools/stackRenderers.js");n.d(t,"stackRenderers",function(){return l.default});var u=n("./stackTools/playClip.js");n.d(t,"playClip",function(){return u.playClip}),n.d(t,"stopClip",function(){return u.stopClip});var d=n("./store/index.js");n.d(t,"store",function(){return d.default}),n.d(t,"getModule",function(){return d.getModule});var c=n("./store/getToolForElement.js");n.d(t,"getToolForElement",function(){return c.default});var f=n("./store/addTool.js");n.d(t,"addTool",function(){return f.addTool}),n.d(t,"addToolForElement",function(){return f.addToolForElement});var h=n("./store/removeTool.js");n.d(t,"removeTool",function(){return h.removeTool}),n.d(t,"removeToolForElement",function(){return h.removeToolForElement});var m=n("./store/setToolOptions.js");n.d(t,"setToolOptions",function(){return m.setToolOptions}),n.d(t,"setToolOptionsForElement",function(){return m.setToolOptionsForElement});var g=n("./store/setToolMode.js");n.d(t,"setToolActive",function(){return g.setToolActive}),n.d(t,"setToolActiveForElement",function(){return g.setToolActiveForElement}),n.d(t,"setToolEnabled",function(){return g.setToolEnabled}),n.d(t,"setToolEnabledForElement",function(){return g.setToolEnabledForElement}),n.d(t,"setToolDisabled",function(){return g.setToolDisabled}),n.d(t,"setToolDisabledForElement",function(){return g.setToolDisabledForElement}),n.d(t,"setToolPassive",function(){return g.setToolPassive}),n.d(t,"setToolPassiveForElement",function(){return g.setToolPassiveForElement});var p=n("./store/isToolActiveForElement.js");n.d(t,"isToolActiveForElement",function(){return p.default});var v=n("./stateManagement/toolState.js");n.d(t,"addToolState",function(){return v.addToolState}),n.d(t,"getToolState",function(){return v.getToolState}),n.d(t,"removeToolState",function(){return v.removeToolState}),n.d(t,"clearToolState",function(){return v.clearToolState}),n.d(t,"setElementToolStateManager",function(){return v.setElementToolStateManager}),n.d(t,"getElementToolStateManager",function(){return v.getElementToolStateManager});var b=n("./stateManagement/textStyle.js");n.d(t,"textStyle",function(){return b.default});var y=n("./stateManagement/toolStyle.js");n.d(t,"toolStyle",function(){return y.default});var x=n("./stateManagement/toolColors.js");n.d(t,"toolColors",function(){return x.default});var w=n("./stateManagement/toolCoordinates.js");n.d(t,"toolCoordinates",function(){return w.default});var j=n("./stateManagement/stackSpecificStateManager.js");n.d(t,"stackSpecificStateManager",function(){return j.stackSpecificStateManager}),n.d(t,"newStackSpecificToolStateManager",function(){return j.newStackSpecificToolStateManager}),n.d(t,"addStackStateManager",function(){return j.addStackStateManager});var T=n("./stateManagement/loadHandlerManager.js");n.d(t,"loadHandlerManager",function(){return T.default});var _=n("./stateManagement/imageIdSpecificStateManager.js");n.d(t,"newImageIdSpecificToolStateManager",function(){return _.newImageIdSpecificToolStateManager}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return _.globalImageIdSpecificToolStateManager});var E=n("./stateManagement/frameOfReferenceStateManager.js");n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return E.newFrameOfReferenceSpecificToolStateManager}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return E.globalFrameOfReferenceSpecificToolStateManager});var O=n("./eventListeners/windowResizeHandler.js");n.d(t,"forceEnabledElementResize",function(){return O.forceEnabledElementResize});var S=n("./orientation/index.js");n.d(t,"orientation",function(){return S.default});var C=n("./util/SaveAs.js");n.d(t,"SaveAs",function(){return C.default});var I=n("./util/logger.js");n.d(t,"enableLogger",function(){return I.enable}),n.d(t,"disableLogger",function(){return I.disable});var M=n("./thirdParty/register.js");n.d(t,"register",function(){return M.default});var P=n("./thirdParty/registerSome.js");n.d(t,"registerSome",function(){return P.default});var D=n("./synchronization/wwwcSynchronizer.js");n.d(t,"wwwcSynchronizer",function(){return D.default});var k=n("./synchronization/updateImageSynchronizer.js");n.d(t,"updateImageSynchronizer",function(){return k.default});var L=n("./synchronization/Synchronizer.js");n.d(t,"Synchronizer",function(){return L.default});var A=n("./synchronization/stackScrollSynchronizer.js");n.d(t,"stackScrollSynchronizer",function(){return A.default});var R=n("./synchronization/stackImagePositionSynchronizer.js");n.d(t,"stackImagePositionSynchronizer",function(){return R.default});var B=n("./synchronization/stackImagePositionOffsetSynchronizer.js");n.d(t,"stackImagePositionOffsetSynchronizer",function(){return B.default});var F=n("./synchronization/stackImageIndexSynchronizer.js");n.d(t,"stackImageIndexSynchronizer",function(){return F.default});var U=n("./synchronization/panZoomSynchronizer.js");n.d(t,"panZoomSynchronizer",function(){return U.default});var H=n("./requestPool/requestPoolManager.js");n.d(t,"requestPoolManager",function(){return H.default});var N=n("./externalModules.js");n.d(t,"external",function(){return N.default});var z=n("./events.js");n.d(t,"EVENTS",function(){return z.default});var V=n("./version.js");n.d(t,"version",function(){return V.default});var q=n("./importInternal.js");n.d(t,"importInternal",function(){return q.default}),n.d(t,"import",function(){return q.default}),t.default={AngleTool:a.AngleTool,ArrowAnnotateTool:a.ArrowAnnotateTool,BidirectionalTool:a.BidirectionalTool,CircleRoiTool:a.CircleRoiTool,CobbAngleTool:a.CobbAngleTool,EllipticalRoiTool:a.EllipticalRoiTool,FreehandRoiTool:a.FreehandRoiTool,LengthTool:a.LengthTool,ProbeTool:a.ProbeTool,RectangleRoiTool:a.RectangleRoiTool,TextMarkerTool:a.TextMarkerTool,BrushTool:r.BrushTool,SphericalBrushTool:r.SphericalBrushTool,RectangleScissorsTool:r.RectangleScissorsTool,FreehandScissorsTool:r.FreehandScissorsTool,CircleScissorsTool:r.CircleScissorsTool,CorrectionScissorsTool:r.CorrectionScissorsTool,CrosshairsTool:o.CrosshairsTool,DoubleTapFitToWindowTool:o.DoubleTapFitToWindowTool,DragProbeTool:o.DragProbeTool,EraserTool:o.EraserTool,FreehandRoiSculptorTool:o.FreehandRoiSculptorTool,MagnifyTool:o.MagnifyTool,OverlayTool:o.OverlayTool,OrientationMarkersTool:o.OrientationMarkersTool,PanMultiTouchTool:o.PanMultiTouchTool,PanTool:o.PanTool,ReferenceLinesTool:o.ReferenceLinesTool,RotateTool:o.RotateTool,RotateTouchTool:o.RotateTouchTool,ScaleOverlayTool:o.ScaleOverlayTool,StackScrollMouseWheelTool:o.StackScrollMouseWheelTool,StackScrollMultiTouchTool:o.StackScrollMultiTouchTool,StackScrollTool:o.StackScrollTool,WwwcRegionTool:o.WwwcRegionTool,WwwcTool:o.WwwcTool,ZoomMouseWheelTool:o.ZoomMouseWheelTool,ZoomTool:o.ZoomTool,ZoomTouchPinchTool:o.ZoomTouchPinchTool,init:i.default,stackPrefetch:s.default,stackRenderers:l.default,playClip:u.playClip,stopClip:u.stopClip,store:d.default,getModule:d.getModule,getToolForElement:c.default,addTool:f.addTool,addToolForElement:f.addToolForElement,removeTool:h.removeTool,removeToolForElement:h.removeToolForElement,setToolOptions:m.setToolOptions,setToolOptionsForElement:m.setToolOptionsForElement,isToolActiveForElement:p.default,setToolActive:g.setToolActive,setToolActiveForElement:g.setToolActiveForElement,setToolEnabled:g.setToolEnabled,setToolEnabledForElement:g.setToolEnabledForElement,setToolDisabled:g.setToolDisabled,setToolDisabledForElement:g.setToolDisabledForElement,setToolPassive:g.setToolPassive,setToolPassiveForElement:g.setToolPassiveForElement,addToolState:v.addToolState,getToolState:v.getToolState,removeToolState:v.removeToolState,clearToolState:v.clearToolState,setElementToolStateManager:v.setElementToolStateManager,getElementToolStateManager:v.getElementToolStateManager,textStyle:b.default,toolStyle:y.default,toolColors:x.default,toolCoordinates:w.default,stackSpecificStateManager:j.stackSpecificStateManager,newStackSpecificToolStateManager:j.newStackSpecificToolStateManager,addStackStateManager:j.addStackStateManager,loadHandlerManager:T.default,newImageIdSpecificToolStateManager:_.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:_.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:E.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:E.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:O.forceEnabledElementResize,orientation:S.default,SaveAs:C.default,enableLogger:I.enable,disableLogger:I.disable,importInternal:q.default,import:q.default,register:M.default,registerSome:P.default,wwwcSynchronizer:D.default,updateImageSynchronizer:k.default,Synchronizer:L.default,stackScrollSynchronizer:A.default,stackImagePositionSynchronizer:R.default,stackImagePositionOffsetSynchronizer:B.default,stackImageIndexSynchronizer:F.default,panZoomSynchronizer:U.default,requestPoolManager:H.default,external:N.default,EVENTS:z.default,version:V.default}},"./init.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./store/internals/addEnabledElement.js"),i=n("./store/internals/removeEnabledElement.js"),s=n("./eventListeners/windowResizeHandler.js");function l(){!function(){var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_DISABLED;e.events.removeEventListener(e.EVENTS.ELEMENT_ENABLED,o.default),e.events.removeEventListener(t,i.default)}();var e=a.default.cornerstone,t=e.EVENTS.ELEMENT_DISABLED;e.events.addEventListener(e.EVENTS.ELEMENT_ENABLED,o.default),e.events.addEventListener(t,i.default)}function u(){var e=r.default.modules;Object.keys(e).forEach(function(t){"function"==typeof e[t].onRegisterCallback&&e[t].onRegisterCallback()})}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(),u();var t=Object(r.getModule)("globalConfiguration");Array.isArray(e)?e.forEach(function(e){var t=e.moduleName,n=e.configuration,a=Object(r.getModule)(t);a&&(a.configuration=Object.assign({},a.configuration,n))}):t.configuration=Object.assign({},t.configuration,e),t.configuration.autoResizeViewports&&s.default.enable()}},"./lib.js":function(e,t,n){"use strict";n.r(t),n.d(t,"lib",function(){return $});var a=n("./tools/base/BaseTool.js"),r=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseBrushTool.js"),i=n("./manipulators/index.js"),s=n("./util/findAndMoveHelpers.js"),l=n("./mixins/index.js"),u=n("./tools/cursors/index.js"),d=n("./drawing/index.js"),c=n("./util/clip.js"),f=n("./util/debounce.js"),h=n("./util/deepmerge.js"),m=n("./util/getDefault.js"),g=n("./util/getPixelSpacing.js"),p=n("./util/isEmptyObject.js"),v=n("./util/isObject.js"),b=n("./util/isPointInImage.js"),y=n("./util/isPointInPolygon.js"),x=n("./util/throttle.js"),w=n("./util/wait.js"),j=n("./util/getKeyPressData.js"),T=n("./drawing/drawTextBox.js"),_=n("./drawing/drawArrow.js"),E=n("./drawing/drawLink.js"),O=n("./drawing/drawLinkedTextBox.js"),S=n("./drawing/drawHandles.js"),C=n("./util/getLuminance.js"),I=n("./util/getROITextBoxCoords.js"),M=n("./util/copyPoints.js"),P=n("./util/calculateSUV.js"),D=n("./util/setContextToDisplayFontSize.js"),k=n("./util/scrollToIndex.js"),L=n("./util/scroll.js"),A=n("./util/roundToDecimal.js"),R=n("./util/pointProjector.js"),B=n("./util/lineSegDistance.js"),F=n("./util/logger.js"),U=n("./util/pointInsideBoundingBox.js"),H=n("./util/makeUnselectable.js"),N=n("./util/getRGBPixels.js"),z=n("./util/getMaxSimultaneousRequests.js"),V=n("./util/angleBetweenPoints.js"),q=n("./util/numbersWithCommas.js"),W=n("./tools/cursors/MouseCursor.js"),G=n("./util/ellipse/index.js"),Z=n("./util/freehand/index.js"),Y=n("./util/segmentation/index.js"),X=n("./util/zoom/index.js"),J=n("./util/triggerEvent.js"),K=n("./util/convertToVector3.js"),$={"base/BaseTool":a.default,"base/BaseAnnotationTool":r.default,"base/BaseBrushTool":o.default,"tools/cursors/MouseCursor":W.default,"tools/cursors":u,"manipulators/anyHandlesOutsideImage":i.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":i.getHandleNearImagePoint,"manipulators/handleActivator":i.handleActivator,"manipulators/moveAllHandles":i.moveAllHandles,"manipulators/moveHandle":i.moveHandle,"manipulators/moveNewHandle":i.moveNewHandle,"manipulators/moveHandleNearImagePoint":s.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":s.findHandleDataNearImagePoint,"manipulators/moveAnnotation":s.moveAnnotation,"mixins/activeOrDisabledBinaryTool":l.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":l.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":d.getNewContext,"drawing/draw":d.draw,"drawing/path":d.path,"drawing/setShadow":d.setShadow,"drawing/drawLine":d.drawLine,"drawing/drawLines":d.drawLines,"drawing/drawJoinedLines":d.drawJoinedLines,"drawing/drawCircle":d.drawCircle,"drawing/drawEllipse":d.drawEllipse,"drawing/drawRect":d.drawRect,"drawing/fillOutsideRect":d.fillOutsideRect,"drawing/drawTextBox":T.default,"drawing/drawArrow":_.default,"drawing/fillBox":d.fillBox,"drawing/fillTextLines":d.fillTextLines,"drawing/drawLink":E.default,"drawing/drawLinkedTextBox":O.default,"drawing/drawHandles":S.default,"drawing/textBoxWidth":T.textBoxWidth,"util/getLuminance":C.default,"util/getROITextBoxCoords":I.default,"util/copyPoints":M.default,"util/calculateSUV":P.default,"util/setContextToDisplayFontSize":D.default,"util/scrollToIndex":k.default,"util/scroll":L.default,"util/roundToDecimal":A.default,"util/projectPatientPointToImagePlane":R.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":R.imagePointToPatientPoint,"util/planePlaneIntersection":R.planePlaneIntersection,"util/pointInsideBoundingBox":U.default,"util/makeUnselectable":H.default,"util/getRGBPixels":N.default,"util/getDefaultSimultaneousRequests":z.getDefaultSimultaneousRequests,"util/getMaxSimultaneousRequests":z.getMaxSimultaneousRequests,"util/getBrowserInfo":z.getBrowserInfo,"util/isMobileDevice":z.isMobileDevice,"util/angleBetweenPoints":V.default,"util/numbersWithCommas":q.default,"util/lineSegDistance":B.default,"util/triggerEvent":J.default,"util/convertToVector3":K.default,"util/clip":c.clip,"util/clipToBox":c.clipToBox,"util/debounce":f.default,"util/deepmerge":h.default,"util/getDefault":m.default,"util/getPixelSpacing":g.default,"util/isEmptyObject":p.default,"util/isObject":v.default,"util/isPointInImage":b.default,"util/isPointInPolygon":y.default,"util/getLogger":F.getLogger,"util/throttle":x.default,"util/wait":w.wait,"util/waitForEnabledElementImageToLoad":w.waitForEnabledElementImageToLoad,"util/getKeyPressData":j.default,"util/ellipseUtils":G.default,"util/freehandUtils":Z.default,"util/segmentationUtils":Y,"util/zoomUtils":X.default}},"./manipulators/anyHandlesOutsideImage.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){var n=e.image,r={left:0,top:0,width:n.width,height:n.height},o=!1;return Object.keys(t).forEach(function(e){var n=t[e];!0!==n.allowedOutsideImage&&!1===a.default.cornerstoneMath.point.insideRect(n,r)&&(o=!0)}),o}},"./manipulators/getHandleNearImagePoint.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./util/pointInsideBoundingBox.js"),s=function(e,t,n,a){if(e.hasOwnProperty("pointNearHandle")){if(e.pointNearHandle(t,e,n))return!0}else if(!0===e.hasBoundingBox){if(Object(i.default)(e,n))return!0}else{var r=o.default.cornerstone.pixelToCanvas(t,e);if(o.default.cornerstoneMath.point.distance(r,n)<=a)return!0}return!1};t.default=function e(t,n,a,o){var i;if(n){if(Array.isArray(n))for(var l=Object.keys(n),u=0;u<l.length;u++){var d=n[l[u]];if(d.hasOwnProperty("x")&&d.hasOwnProperty("y")&&s(d,t,a,o)){i=d;break}}else if("object"===r()(n))for(var c=Object.keys(n),f=0;f<c.length;f++){var h=c[f];if(Array.isArray(n[h])){if(i=e(t,n[h],a,o))break}else{var m=n[h];if(s(m,t,a,o)){i=m;break}}}return i}}},"./manipulators/handleActivator.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n,r){r||(r=6);var o=function(e){var t;return Object.keys(e).forEach(function(n){var a=e[n];!0!==a.active||(t=a)}),t}(t),i=Object(a.default)(e,t,n,r);return o!==i&&(void 0!==i&&(i.active=!0),void 0!==o&&(o.active=!1),!0)}},"./manipulators/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./manipulators/anyHandlesOutsideImage.js");n.d(t,"anyHandlesOutsideImage",function(){return a.default});var r=n("./manipulators/getHandleNearImagePoint.js");n.d(t,"getHandleNearImagePoint",function(){return r.default});var o=n("./manipulators/handleActivator.js");n.d(t,"handleActivator",function(){return o.default});var i=n("./manipulators/moveAllHandles.js");n.d(t,"moveAllHandles",function(){return i.default});var s=n("./manipulators/moveHandle.js");n.d(t,"moveHandle",function(){return s.default});var l=n("./manipulators/moveNewHandle.js");n.d(t,"moveNewHandle",function(){return l.default})},"./manipulators/moveAllHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("manipulators:moveAllHandles"),m=Object(u.getModule)("manipulatorState"),g={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},p={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,u=i.detail,f=u.element,h=u.image,m=u.buttons,g=i.detail.deltaPoints.image,p=g.x,v=g.y;t.active=!0,t.invalidated=!0;for(var b=Object.keys(t.handles),y=0;y<b.length;y++){var x=b[y],w=t.handles[x];!0!==w.movesIndependently&&w.hasOwnProperty("x")&&w.hasOwnProperty("y")&&(w.x+=p,w.y+=v,n.preventHandleOutsideImage&&Object(l.clipToBox)(w,h))}r.default.cornerstone.updateImage(f);var j=Object(d.default)(f,m,o);j instanceof c.default&&j.updateCachedStats(h,f,t);var T=a.default.MEASUREMENT_MODIFIED,_={toolName:e,toolType:e,element:f,measurementData:t};Object(s.default)(f,T,_),i.preventDefault(),i.stopPropagation()}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=a.dragHandler,o=a.upOrEndHandler,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;x(e,t,n,{dragHandler:r,upOrEndHandler:o},i,s,!1)}function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=r.dragHandler,l=r.upOrEndHandler,u=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,c=u.detail,f=c.element;m.setters.removeActiveManipulatorForElement(f),n.deleteIfHandleOutsideImage&&Object(o.default)(c,t.handles)&&Object(i.removeToolState)(f,e,t),x(t,n,a,{dragHandler:s,upOrEndHandler:l},f,d,!0)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=a.dragHandler,i=a.upOrEndHandler,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,d=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];e.active=!1,e.invalidated=!0,u.state.isToolLocked=!1,g[n].forEach(function(e){s.removeEventListener(e,o)}),p[n].forEach(function(e){s.removeEventListener(e,i)}),"function"==typeof t.doneMovingCallback&&(h.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(d)),"function"==typeof l&&l(d),r.default.cornerstone.updateImage(s)}t.default=function(e,t,n,a){var r=e.element,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;o=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},o);var l=v.bind(this,t,n,o,i),d=function e(a){y(t,n,o,i,{dragHandler:l,upOrEndHandler:e},a,s)};m.setters.addActiveManipulatorForElement(r,b.bind(null,n,o,i,{dragHandler:l,upOrEndHandler:d},r,s)),n.active=!0,u.state.isToolLocked=!0,g[i].forEach(function(e){r.addEventListener(e,l)}),p[i].forEach(function(e){r.addEventListener(e,d)})}},"./manipulators/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("manipulators:moveHandle"),m=Object(u.getModule)("manipulatorState"),g={value:!1},p={mouse:[a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},v={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_DRAG_END,a.default.TOUCH_PINCH,a.default.TOUCH_PRESS,a.default.TAP]};function b(e,t,n,o,i,u){var f=u.detail,h=f.image,m=f.element,p=f.buttons,v=f.currentPoints.page,b=r.default.cornerstone.pageToPixel(m,v.x,"touch"===i?v.y+-57:v.y);g.value=!1,n.active=!0,n.hasMoved=!0,n.x=b.x,n.y=b.y,t.invalidated=!0,o.preventHandleOutsideImage&&Object(l.clipToBox)(n,h),r.default.cornerstone.updateImage(m);var y=Object(d.default)(m,p,i);y instanceof c.default&&y.updateCachedStats(h,m,t);var x=a.default.MEASUREMENT_MODIFIED,w={toolName:e,toolType:e,element:m,measurementData:t};Object(s.default)(m,x,w)}function y(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,s=i.dragHandler,l=i.upOrEndHandler,u=arguments.length>7?arguments[7]:void 0;w(e,t,n,a,r,o,{dragHandler:s,upOrEndHandler:l},u,!1)}function x(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,s=i.dragHandler,l=i.upOrEndHandler,u=arguments.length>7?arguments[7]:void 0,d=t.element;m.setters.removeActiveManipulatorForElement(d),w(e,t,n,a,r,o,{dragHandler:s,upOrEndHandler:l},u,!0)}function w(e,t,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,c=d.dragHandler,f=d.upOrEndHandler,m=arguments.length>7?arguments[7]:void 0,b=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],y=t.element;a.active=!1,a.moving=!1,n.active=!1,n.invalidated=!0,g.value=!1,u.state.isToolLocked=!1,p[l].forEach(function(e){y.removeEventListener(e,c)}),v[l].forEach(function(e){y.removeEventListener(e,f)}),s.deleteIfHandleOutsideImage&&Object(o.default)(t,n.handles)&&Object(i.removeToolState)(y,e,n),"function"==typeof s.doneMovingCallback&&(h.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),s.doneMovingCallback(b)),"function"==typeof m&&m(b),r.default.cornerstone.updateImage(y)}function j(e,t,n,a){if(t.value){var o=Math.abs(e.y-a.y),i=o/10;if(o<1)return e.y=a.y,void(t.value=!1);e.y>a.y?e.y-=i:e.y<a.y&&(e.y+=i),r.default.cornerstone.updateImage(n.element),r.default.cornerstone.requestAnimationFrame(function(){j(e,t,n,a)})}}t.default=function(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;o=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},o);var l=e.element,d=b.bind(this,t,n,a,o,i),c=function r(){x(t,e,n,a,o,i,{dragHandler:d,upOrEndHandler:r},s)};if(m.setters.addActiveManipulatorForElement(l,y.bind(null,t,e,n,a,o,i,{dragHandler:d,upOrEndHandler:c},s)),a.active=!0,a.moving=!0,n.active=!0,u.state.isToolLocked=!0,p[i].forEach(function(e){l.addEventListener(e,d)}),v[i].forEach(function(e){l.addEventListener(e,c)}),"touch"===i){g.value=!0;var f=r.default.cornerstone.getEnabledElement(l),h=-57,w={x:e.currentPoints.page.x,y:e.currentPoints.page.y+h},T=r.default.cornerstone.pageToPixel(l,w.x,w.y);j(a,g,f,T)}}},"./manipulators/moveNewHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./manipulators/anyHandlesOutsideImage.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l=n("./util/clip.js"),u=n("./store/index.js"),d=n("./util/getActiveTool.js"),c=n("./tools/base/BaseAnnotationTool.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("manipulators:moveNewHandle"),m=Object(u.getModule)("manipulatorState"),g={mouse:[a.default.MOUSE_MOVE,a.default.MOUSE_DRAG],touch:[a.default.TOUCH_DRAG]},p={mouse:[a.default.MOUSE_UP,a.default.MOUSE_CLICK],touch:[a.default.TOUCH_END,a.default.TOUCH_PINCH,a.default.TAP]};function v(e,t,n,o,i,u){var f=u.detail,h=f.currentPoints,m=f.image,g=f.element,p=f.buttons;o.hasMoved=!0;var v=h.page,b=r.default.cornerstone.pageToPixel(g,"touch"===i?v.x+-57:v.x,"touch"===i?v.y+-57:v.y);t.invalidated=!0,n.active=!0,n.x=b.x,n.y=b.y,o&&o.preventHandleOutsideImage&&Object(l.clipToBox)(n,m),r.default.cornerstone.updateImage(g);var y=Object(d.default)(g,p,i);y instanceof c.default&&y.updateCachedStats(m,g,t);var x=a.default.MEASUREMENT_MODIFIED,w={toolName:e,toolType:e,element:g,measurementData:t};Object(s.default)(g,x,w)}function b(e,t,n,o,i){var s=o.moveHandler,l=o.moveEndHandler,d=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];g[e].forEach(function(e){n.removeEventListener(e,s)}),p[e].forEach(function(e){n.removeEventListener(e,l)}),n.removeEventListener(a.default.TOUCH_START,w),u.state.isToolLocked=!1,"function"==typeof i&&i(d),"function"==typeof t.doneMovingCallback&&(h.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(d)),r.default.cornerstone.updateImage(n)}function y(e,t,n,a,s,u,d,c){var f=u.moveHandler,h=u.moveEndHandler,g=d.detail,p=g.element,v=!0;if(!1!==a.hasMoved){var y=g.currentPoints.page,x=r.default.cornerstone.pageToPixel(p,"touch"===s?y.x+-57:y.x,"touch"===s?y.y+-57:y.y);t.active=!1,t.invalidated=!0,n.active=!1,n.moving=!1,n.x=x.x,n.y=x.y,m.setters.removeActiveManipulatorForElement(p),a.preventHandleOutsideImage&&Object(l.clipToBox)(n,d.detail.image),a.deleteIfHandleOutsideImage&&Object(o.default)(d.detail,t.handles)&&(t.cancelled=!0,v=!1,Object(i.removeToolState)(p,e,t)),b(s,a,p,{moveHandler:f,moveEndHandler:h},c,v)}}function x(e,t,n,a,r,o,i){var s=r.moveHandler,l=r.moveEndHandler;e.active=!1,e.invalidated=!0,t.active=!1,b(a,n,o,{moveHandler:s,moveEndHandler:l},i,!1)}function w(e){return e.stopImmediatePropagation(),!1}t.default=function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",s=arguments.length>6?arguments[6]:void 0;(o=Object.assign({deleteIfHandleOutsideImage:u.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:u.state.preventHandleOutsideImage},o)).hasMoved=!1;var l=e.element;function d(e){v(t,n,r,o,i,e)}function c(e){y(t,n,r,o,i,{moveHandler:d,moveEndHandler:c},e,s)}n.active=!0,r.moving=!0,r.active=!0,u.state.isToolLocked=!0,g[i].forEach(function(e){l.addEventListener(e,d)}),l.addEventListener(a.default.TOUCH_START,w),p[i].forEach(function(e){l.addEventListener(e,c)}),m.setters.addActiveManipulatorForElement(l,x.bind(null,n,r,o,i,{moveHandler:d,moveEndHandler:c},l,s))}},"./mixins/activeOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},enabledCallback:function(e){Object(a.setToolActiveForElement)(e,this.name)}}},"./mixins/enabledOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/setToolMode.js");t.default={passiveCallback:function(e){Object(a.setToolDisabledForElement)(e,this.name)},activeCallback:function(e){Object(a.setToolEnabledForElement)(e,this.name)}}},"./mixins/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./mixins/activeOrDisabledBinaryTool.js"),r=n("./mixins/enabledOrDisabledBinaryTool.js"),o=n("./mixins/segmentation/circleSegmentationMixin.js"),i=n("./mixins/segmentation/polylineSegmentationMixin.js"),s=n("./mixins/segmentation/freehandSegmentationMixin.js"),l=n("./mixins/segmentation/rectangleSegmentationMixin.js"),u=n("./mixins/segmentation/renderBrushMixin.js");t.default={activeOrDisabledBinaryTool:a.default,enabledOrDisabledBinaryTool:r.default,circleSegmentationMixin:o.default,polylineSegmentationMixin:i.default,freehandSegmentationMixin:s.default,rectangleSegmentationMixin:l.default,renderBrushMixin:u.default}},"./mixins/segmentation/circleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/index.js"),r=n("./externalModules.js"),o=n("./util/isEmptyObject.js"),i=n("./store/index.js"),s=n("./util/segmentation/index.js"),l=Object(i.getModule)("segmentation"),u=l.getters,d=l.setters;function c(){this.handles={start:{},end:{}}}function f(e){var t=e.detail.element,n=e.detail.currentPoints.image;return Object(o.default)(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),r.default.cornerstone.updateImage(t),!0}function h(e){var t=e.detail,n=t.element;this.handles.end=t.currentPoints.image,r.default.cornerstone.updateImage(n)}function m(e){e.detail.handles=this.handles;var t=e.detail.element,n=u.labelmap2D(t),a=n.labelmap2D,o=n.labelmap3D,i=n.currentImageIdIndex,l=a.pixelData,c=l.slice();this.applyActiveStrategy(e,{points:{start:{x:this.handles.start.x,y:this.handles.start.y},end:{x:this.handles.end.x,y:this.handles.end.y}},pixelData:l,segmentIndex:o.activeSegmentIndex,segmentationMixinType:"circleSegmentationMixin"});var f={imageIdIndex:i,diff:Object(s.getDiffBetweenPixelData)(c,l)};d.pushState(this.element,[f]),d.updateSegmentsOnLabelmap2D(a),r.default.cornerstone.updateImage(t),this._resetHandles()}t.default={postTouchStartCallback:f,postMouseDownCallback:f,mouseClickCallback:f,touchDragCallback:h,mouseDragCallback:h,mouseMoveCallback:h,touchEndCallback:m,mouseUpCallback:m,initializeMixin:c,renderToolData:function(e){var t=this,n=e.detail,o=n.element,i=u.brushColor(o,!0),s=Object(a.getNewContext)(n.canvasContext.canvas),l=r.default.cornerstoneMath.point.distance;Object(a.draw)(s,function(e){if(!t.handles)return null;var n=r.default.cornerstone.pixelToCanvas(o,t.handles.start),s=r.default.cornerstone.pixelToCanvas(o,t.handles.end),u=l(n,s);Object(a.drawCircle)(e,o,t.handles.start,u,{color:i})})},_resetHandles:c,_applyStrategy:m}},"./mixins/segmentation/freehandSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./util/logger.js"),l=n("./drawing/index.js"),u=n("./util/segmentation/index.js"),d=Object(s.getLogger)("tools:ScissorsTool"),c=Object(i.getModule)("segmentation"),f=c.getters,h=c.setters;function m(e){var t=e.detail.element,n=e.detail.currentPoints.image,a=this.handles.points;if(!a.length)return d.warn("Something went wrong, empty handles detected."),null;a.push({x:n.x,y:n.y,lines:[]}),this.currentHandle+=1,o.default.cornerstone.updateImage(t)}function g(e){var t=e.detail.element;this._addPoint(e.detail),o.default.cornerstone.updateImage(t)}function p(e){var t=this.handles.points,n=e.detail.element,a=f.labelmap2D(n),r=a.labelmap2D,i=a.labelmap3D,s=a.currentImageIdIndex,l=r.pixelData,d=l.slice();this.applyActiveStrategy(e,{points:t,pixelData:l,segmentIndex:i.activeSegmentIndex,segmentationMixinType:"freehandSegmentationMixin"});var c={imageIdIndex:s,diff:Object(u.getDiffBetweenPixelData)(d,l)};h.pushState(this.element,[c]),h.updateSegmentsOnLabelmap2D(r),o.default.cornerstone.updateImage(n),this._resetHandles()}function v(){this.handles={points:[]},this.currentHandle=0}t.default={postTouchStartCallback:m,postMouseDownCallback:m,mouseClickCallback:m,touchDragCallback:g,mouseDragCallback:g,mouseMoveCallback:g,touchEndCallback:p,mouseUpCallback:p,initializeMixin:v,renderToolData:function(e){var t=e.detail,n=t.element,a=f.brushColor(n,!0),o=Object(l.getNewContext)(t.canvasContext.canvas),i=this.handles.points;i.length<2||Object(l.draw)(o,function(e){for(var t=0;t<i.length;t++){var o=r()(i[t].lines);t===i.length-1&&o.push(i[0]),Object(l.drawJoinedLines)(e,n,i[t],o,{color:a})}})},_resetHandles:v,_addPoint:function(e){var t=this.handles.points;t.length&&t[this.currentHandle-1].lines.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),t.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),this.currentHandle+=1,o.default.cornerstone.updateImage(e.element)},_applyStrategy:p}},"./mixins/segmentation/polylineSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./drawing/index.js"),i=n("./store/index.js"),s=n("./mixins/segmentation/freehandSegmentationMixin.js"),l=Object(i.getModule)("segmentation").getters,u=Object.assign({},s.default,{renderToolData:function(e){var t=this,n=e.detail,a=n.element,i=l.brushColor(a,!0),s=Object(o.getNewContext)(n.canvasContext.canvas),u=this.handles;Object(o.draw)(s,function(e){if(u.points.length>1)for(var n=0;n<u.points.length;n++){var s=r()(u.points[n].lines);Object(o.drawJoinedLines)(e,a,t.handles.points[n],s,{color:i})}})}});t.default=u},"./mixins/segmentation/rectangleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./drawing/index.js"),r=n("./externalModules.js"),o=n("./util/isEmptyObject.js"),i=n("./store/index.js"),s=n("./util/segmentation/index.js"),l=Object(i.getModule)("segmentation"),u=l.getters,d=l.setters;function c(e){var t=e.detail.element,n=e.detail.currentPoints.image;return Object(o.default)(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),r.default.cornerstone.updateImage(t),!0}function f(e){var t=e.detail,n=t.element;this.handles.end=t.currentPoints.image,r.default.cornerstone.updateImage(n)}function h(e){e.detail.handles=this.handles;var t=e.detail.element,n=u.labelmap2D(t),a=n.labelmap2D,o=n.labelmap3D,i=n.currentImageIdIndex,l=a.pixelData,c=l.slice();this.applyActiveStrategy(e,{points:[{x:this.handles.start.x,y:this.handles.start.y},{x:this.handles.end.x,y:this.handles.end.y}],pixelData:l,segmentIndex:o.activeSegmentIndex,segmentationMixinType:"rectangleSegmentationMixin"});var f={imageIdIndex:i,diff:Object(s.getDiffBetweenPixelData)(c,l)};d.pushState(this.element,[f]),d.updateSegmentsOnLabelmap2D(a),r.default.cornerstone.updateImage(t),this._resetHandles()}function m(){this.handles={start:{},end:{}}}t.default={postTouchStartCallback:c,postMouseDownCallback:c,mouseClickCallback:c,touchDragCallback:f,mouseDragCallback:f,mouseMoveCallback:f,touchEndCallback:h,mouseUpCallback:h,initializeMixin:m,renderToolData:function(e){var t=this,n=e.detail,r=n.element,o=u.brushColor(r,!0),i=Object(a.getNewContext)(n.canvasContext.canvas);Object(a.draw)(i,function(e){Object(a.drawRect)(e,r,t.handles.start,t.handles.end,{color:o})})},_resetHandles:m,_applyStrategy:h}},"./mixins/segmentation/renderBrushMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js");t.default={renderBrush:function(e){var t,n=a.default.cornerstone,o=Object(r.getModule)("segmentation"),i=o.getters,s=o.configuration,l=e.detail,u=l.viewport;if(this._drawing?t=this._lastImageCoords:this._mouseUpRender?(t=this._lastImageCoords,this._mouseUpRender=!1):t=r.default.state.mousePositionImage,t){var d=l.image,c=t.x,f=t.y;if(!(c<0||c>d.columns||f<0||f>d.rows)){var h=s.radius,m=l.canvasContext,g=l.element,p=i.brushColor(g,this._drawing);m.setTransform(1,0,0,1,0,0);var v=h*u.scale,b=n.pixelToCanvas(g,t);m.beginPath(),m.strokeStyle=p,m.ellipse(b.x,b.y,v,v,0,0,2*Math.PI),m.stroke()}}}}},"./orientation/getOrientationString.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/convertToVector3.js");t.default=function(e){for(var t=Object(r.default)(e),n="",o=t.x<0?"R":"L",i=t.y<0?"A":"P",s=t.z<0?"F":"H",l=new a.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),u=1e-4,d=0;d<3;d++)if(l.x>u&&l.x>l.y&&l.x>l.z)n+=o,l.x=0;else if(l.y>u&&l.y>l.x&&l.y>l.z)n+=i,l.y=0;else if(l.z>u&&l.z>l.x&&l.z>l.y)n+=s,l.z=0;else if(l.x>u&&l.y>u&&l.x===l.y)n+=o+i,l.x=0,l.y=0;else if(l.x>u&&l.z>u&&l.x===l.z)n+=o+s,l.x=0,l.z=0;else{if(!(l.y>u&&l.z>u&&l.y===l.z))break;n+=i+s,l.y=0,l.z=0}return n}},"./orientation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./orientation/getOrientationString.js"),r=n("./orientation/invertOrientationString.js");t.default={getOrientationString:a.default,invertOrientationString:r.default}},"./orientation/invertOrientationString.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.replace("H","f");return(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},"./requestPool/requestPoolManager.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/getMaxSimultaneousRequests.js"),o={interaction:[],thumbnail:[],prefetch:[]},i={interaction:0,thumbnail:0,prefetch:0},s={interaction:6,thumbnail:6,prefetch:5},l=!1;function u(){l&&setTimeout(function(){c()},20)}function d(e){var t=a.default.cornerstone,n=e.type;i[n]++,l=!0;var r=e.imageId,o=e.doneCallback,s=e.failCallback,d=t.imageCache.getImageLoadObject(r);if(d)d.promise.then(function(e){i[n]--,o(e),u()},function(e){i[n]--,s(e),u()});else{var c=function(e){return"prefetch"===e.type?-5:"interactive"===e.type?0:"thumbnail"===e.type?5:void 0}(e),f=Object.assign({},e.options,{priority:c,type:e.type});(!0===e.preventCache?t.loadImage(r,f):t.loadAndCacheImage(r,f)).then(function(e){i[n]--,o(e),u()},function(e){i[n]--,s(e),u()})}}function c(){var e=Object(r.getMaxSimultaneousRequests)();s={interaction:Math.max(e,1),thumbnail:Math.max(e-2,1),prefetch:Math.max(e-1,1)};for(var t=e-(i.interaction+i.thumbnail+i.prefetch),n=0;n<t;n++){var a=o.interaction.length&&i.interaction<s.interaction?o.interaction.shift():o.thumbnail.length&&i.thumbnail<s.thumbnail?o.thumbnail.shift():o.prefetch.length&&i.prefetch<s.prefetch?o.prefetch.shift():(o.interaction.length||o.thumbnail.length||o.prefetch.length||(l=!1),!1);a&&d(a)}}t.default={addRequest:function(e,t,n,r,i,s,u){var d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!o.hasOwnProperty(n))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");if(e&&t){var c={type:n,imageId:t,preventCache:r,doneCallback:i,failCallback:s,options:d},f=a.default.cornerstone.imageCache.getImageLoadObject(t);f?f.promise.then(function(e){i(e)},function(e){s(e)}):(u?o[n].unshift(c):o[n].push(c),l=!0)}},clearRequestStack:function(e){if(!o.hasOwnProperty(e))throw new Error("Request type must be one of interaction, thumbnail, or prefetch");o[e]=[]},startGrabbing:c,getRequestPool:function(){return o}}},"./stackTools/fusionRenderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./externalModules.js"),l=n("./stateManagement/toolState.js"),u=function(){function e(){r()(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return i()(e,[{key:"render",value:function(e,t){var n=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");t||(t=Object(l.getToolState)(e,"stack").data);var a=s.default.cornerstone,r=t[0],o=r.imageIds[this.currentImageIdIndex],i=t.slice(1,t.length);a.loadAndCacheImage(o).then(function(t){var s=n.layerIds[0];s?a.setLayerImage(e,t,s):(s=a.addLayer(e,t,r.options),n.layerIds.push(s)),a.displayImage(e,t),i.forEach(function(t,r){var i=n.findImageFn(t.imageIds,o),l=n.layerIds[r+1];l||(l=a.addLayer(e,void 0,t.options),n.layerIds.push(l)),i?a.loadAndCacheImage(i).then(function(t){a.setLayerImage(e,t,l),a.updateImage(e)}):(a.setLayerImage(e,void 0,l),a.setActiveLayer(e,s),a.updateImage(e))})})}}]),e}()},"./stackTools/playClip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"playClip",function(){return d}),n.d(t,"stopClip",function(){return c});var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./stateManagement/toolState.js"),s=n("./util/triggerEvent.js"),l="playClip";function u(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function d(e,t){var n,d;if(void 0===e)throw new Error("playClip: element must not be undefined");var c=Object(i.getToolState)(e,"stack");if(c&&c.data&&c.data.length){var f,h=r.default.cornerstone;if(c.data.length>1){var m=Object(i.getToolState)(e,"stackRenderer");m&&m.data&&m.data.length&&(f=m.data[0])}var g=c.data[0],p=Object(i.getToolState)(e,l);p&&p.data&&p.data.length?u(n=p.data[0]):(n={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(i.addToolState)(e,l,n)),(t<0||t>0)&&(n.framesPerSecond=Number(t),n.reverse=n.framesPerSecond<0,n.ignoreFrameTimeVector=!0),!0!==n.ignoreFrameTimeVector&&n.frameTimeVector&&n.frameTimeVector.length===g.imageIds.length&&(d=function(e,t){var n,a,r,o=0,i=e.length,s=[];for(s.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),n=1;n<i;n++)r=Number(e[n])/t|0,s.push(r),1===n?a=r:r!==a&&(s.isTimeVarying=!0),o+=r;return s.length>0&&s.push(r=s.isTimeVarying?o/s.length|0:s[0]),s}(n.frameTimeVector,n.speed));var v=function(){var t,r,i,l=g.currentImageIdIndex,d=g.imageIds.length;if(n.reverse?l--:l++,!n.loop&&(l<0||l>=d))return u(n),void function(e){var t={element:e};Object(s.default)(e,a.default.CLIP_STOPPED,t)}(e);l>=d&&(l=0),l<0&&(l=d-1),l!==g.currentImageIdIndex&&(t=o.default.getStartLoadHandler(e),r=o.default.getEndLoadHandler(e),i=o.default.getErrorLoadingHandler(e),t&&t(e),(!0===g.preventCache?h.loadImage(g.imageIds[l]):h.loadAndCacheImage(g.imageIds[l])).then(function(t){try{g.currentImageIdIndex=l,f?(f.currentImageIdIndex=l,f.render(e,c.data)):h.displayImage(e,t),r&&r(e,t)}catch(n){return}},function(t){i&&i(e,g.imageIds[l],t)}))};d&&d.length>0&&d.isTimeVarying?(n.usingFrameTimeVector=!0,n.intervalId=setTimeout(function e(){n.intervalId=setTimeout(e,d[g.currentImageIdIndex]),v()},0)):(n.usingFrameTimeVector=!1,n.intervalId=setInterval(v,1e3/Math.abs(n.framesPerSecond)))}}function c(e){var t=Object(i.getToolState)(e,l);t&&t.data&&t.data.length&&u(t.data[0])}},"./stackTools/stackPrefetch.js":function(e,t,n){"use strict";n.r(t);var a,r=n("./externalModules.js"),o=n("./requestPool/requestPoolManager.js"),i=n("./stateManagement/loadHandlerManager.js"),s=n("./stateManagement/toolState.js"),l=n("./util/getMaxSimultaneousRequests.js"),u=n("./util/logger.js"),d=n("./util/triggerEvent.js"),c=n("./events.js"),f=Object(u.getLogger)("stackTools:stackPrefetch"),h="stackPrefetch",m="prefetch",g={maxImagesToPrefetch:1/0,preserveExistingPool:!1};function p(e,t){e=Math.round(e)||0;var n=[],a=(t=Math.round(t)||0)-e+1;if(a<=0)return n;for(;a--;)n[a]=t--;return n}var v=function(e){return Math.max.apply(null,e)},b=function(e){return Math.min.apply(null,e)};function y(e){var t=Object(s.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0],a=Object(s.getToolState)(e,h);if(a){var l=a.data[0]||{};if(l.indicesToRequest&&l.indicesToRequest.length||(l.enabled=!1),!1!==l.enabled&&(a.data[0].indicesToRequest.sort(function(e,t){return e-t}),l.indicesToRequest.slice().forEach(function(e){var t=n.imageIds[e];t&&r.default.cornerstone.imageCache.getImageLoadObject(t)&&R(e)}),l.indicesToRequest.length)){g.preserveExistingPool||o.default.clearRequestStack(m);for(var u,p,y,x,w,j,T=(p=n.currentImageIdIndex,y=[],x=[],(u=l.indicesToRequest).forEach(function(e){e<p?y.push(e):e>p&&x.push(e)}),{low:u.indexOf(v(y)),high:u.indexOf(b(x))}),_=i.default.getErrorLoadingHandler(e),E=T.low,O=T.high,S=[];E>=0||O<l.indicesToRequest.length;){var C=n.currentImageIdIndex,I=!(C-l.indicesToRequest[E]>g.maxImagesToPrefetch)&&E>=0,M=!(l.indicesToRequest[O]-C>g.maxImagesToPrefetch)&&O<l.indicesToRequest.length;if(!M&&!I)break;I&&(j=l.indicesToRequest[E--],S.push(w=n.imageIds[j])),M&&(j=l.indicesToRequest[O++],S.push(w=n.imageIds[j]))}var P=!0,D=!1,k=void 0;try{for(var L,A=S.reverse()[Symbol.iterator]();!(P=(L=A.next()).done);P=!0)o.default.addRequest(e,L.value,m,!1,B,F,!0)}catch(U){D=!0,k=U}finally{try{P||null==A.return||A.return()}finally{if(D)throw k}}o.default.startGrabbing()}}}function R(e){var t=l.indicesToRequest.indexOf(e);t>-1&&l.indicesToRequest.splice(t,1)}function B(t){f.log("prefetch done: %s",t.imageId);var a=n.imageIds.indexOf(t.imageId);R(a),Object(d.default)(e,c.default.STACK_PREFETCH_IMAGE_LOADED,{element:e,imageId:t.imageId,imageIndex:a,stackPrefetch:l,stack:n}),l.indicesToRequest&&l.indicesToRequest.length>0||Object(d.default)(e,c.default.STACK_PREFETCH_DONE,{element:e,stackPrefetch:l,stack:n})}function F(t){f.log("prefetch errored: %o",t),_&&_(e,w,t,"stackPrefetch")}}function x(e){return function(t){var n,a=t.detail;try{n=Object(s.getToolState)(e,"stack")}catch(i){return}if(n&&n.data&&n.data.length){var r=n.data[0].imageIds.indexOf(a.imageId);if(!(r<0)){var o=Object(s.getToolState)(e,h);o&&o.data&&o.data.length&&o.data[0].indicesToRequest.push(r)}}}}function w(e){clearTimeout(a),a=setTimeout(function(){var t=e.target;try{y(t)}catch(n){return}},10)}t.default={enable:function(e){Object(s.getToolState)(e,h).data=[];var t=Object(s.getToolState)(e,"stack");if(t&&t.data&&t.data.length){var n=t.data[0];if(!0!==n.preventCache){var a={indicesToRequest:p(0,n.imageIds.length-1),enabled:!0,direction:1},o=a.indicesToRequest.indexOf(n.currentImageIdIndex);a.indicesToRequest.splice(o,1),Object(s.addToolState)(e,h,a),y(e),e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,w),e.addEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,w);var i=x(e);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,i),r.default.cornerstone.events.addEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,i)}else f.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(e){clearTimeout(a),e.removeEventListener(r.default.cornerstone.EVENTS.NEW_IMAGE,w);var t=x(e);r.default.cornerstone.events.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,t);var n=Object(s.getToolState)(e,h);n&&n.data.length&&(n.data[0].enabled=!1,o.default.clearRequestStack(m))},getConfiguration:function(){return g},setConfiguration:function(e){g=e,e.maxSimultaneousRequests&&Object(l.setMaxSimultaneousRequests)(e.maxSimultaneousRequests)}}},"./stackTools/stackRenderers.js":function(e,t,n){"use strict";n.r(t);var a=n("./stackTools/fusionRenderer.js"),r={};r.FusionRenderer=a.default,t.default=r},"./stateManagement/frameOfReferenceStateManager.js":function(e,t,n){"use strict";function a(){var e={};return{get:function(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}},add:function(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(a)},remove:function(t,n,a){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n)){for(var o=r[n],i=-1,s=0;s<o.data.length;s++)o.data[s]===a&&(i=s);-1!==i&&o.data.splice(i,1)}}}}}n.r(t),n.d(t,"newFrameOfReferenceSpecificToolStateManager",function(){return a}),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",function(){return r});var r=a()},"./stateManagement/imageIdSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"newImageIdSpecificToolStateManager",function(){return r}),n.d(t,"globalImageIdSpecificToolStateManager",function(){return o});var a=n("./externalModules.js");function r(){var e={};function t(t,n,a){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(a)}function n(t,n){if(!1!==e.hasOwnProperty(t)){var a=e[t];if(!1!==a.hasOwnProperty(n))return a[n]}}function r(t){!1!==e.hasOwnProperty(t)&&delete e[t]}return{get:function(e,t){var r=a.default.cornerstone.getEnabledElement(e);if(r.image)return n(r.image.imageId,t)},add:function(e,n,r){var o=a.default.cornerstone.getEnabledElement(e);o.image&&t(o.image.imageId,n,r)},clear:function(e){var t=a.default.cornerstone.getEnabledElement(e);t.image&&r(t.image.imageId)},getImageIdToolState:n,addImageIdToolState:t,clearImageIdToolState:r,saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,n){e[t]=n},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}var o=r()},"./stateManagement/loadHandlerManager.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r={},o={},i={};function s(e){if(!e)return"DEFAULT";var t=a.default.cornerstone.getEnabledElement(e).uuid;if(!t)throw new Error("Something went wrong when getting uuid from element");return t}t.default={setStartLoadHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=s(t);r[n]=e},getStartLoadHandler:function(e){var t=s(e);return r[t]||r.DEFAULT},setEndLoadHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=s(t);o[n]=e},getEndLoadHandler:function(e){var t=s(e);return o[t]||o.DEFAULT},setErrorLoadingHandler:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var n=s(t);i[n]=e},getErrorLoadingHandler:function(e){var t=s(e);return i[t]||i.DEFAULT},removeHandlers:function(e){var t=s(e);delete r[t],delete o[t],delete i[t]}}},"./stateManagement/stackSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"stackSpecificStateManager",function(){return l}),n.d(t,"newStackSpecificToolStateManager",function(){return o}),n.d(t,"addStackStateManager",function(){return s});var a=n("./stateManagement/imageIdSpecificStateManager.js"),r=n("./stateManagement/toolState.js");function o(e,t){var n={};return{get:function(a,r){return e.indexOf(r)>=0?(!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r]):t.get(a,r)},add:function(a,r,o){if(!(e.indexOf(r)>=0))return t.add(a,r,o);!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r].data.push(o)},saveToolState:function(){return n},restoreToolState:function(e){n=e},toolState:n}}var i=[];function s(e,t){var n=Object(r.getElementToolStateManager)(e);n||(n=a.globalImageIdSpecificToolStateManager);var s=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];t&&(s=s.concat(t));var l=o(s,n);i.push(l),Object(r.setElementToolStateManager)(e,l)}var l={newStackSpecificToolStateManager:o,addStackStateManager:s}},"./stateManagement/textStyle.js":function(e,t,n){"use strict";n.r(t);var a=15,r="".concat(a,"px Arial"),o="transparent";t.default={setFont:function(e){r=e},getFont:function(){return r},setFontSize:function(e){a=e},getFontSize:function(){return a},setBackgroundColor:function(e){o=e},getBackgroundColor:function(){return o}}},"./stateManagement/toolColors.js":function(e,t,n){"use strict";n.r(t);var a="white",r="greenyellow",o="transparent";t.default={setFillColor:function(e){o=e},getFillColor:function(){return o},setToolColor:function(e){a=e},getToolColor:function(){return a},setActiveColor:function(e){r=e},getActiveColor:function(){return r},getColorIfActive:function(e){return e.color?e.color:e.active?r:a}}},"./stateManagement/toolCoordinates.js":function(e,t,n){"use strict";var a;n.r(t),t.default={setCoords:function(e){a=e.currentPoints.canvas},getCoords:function(){return a}}},"./stateManagement/toolState.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addToolState",function(){return u}),n.d(t,"getToolState",function(){return d}),n.d(t,"removeToolState",function(){return c}),n.d(t,"clearToolState",function(){return f}),n.d(t,"setElementToolStateManager",function(){return h}),n.d(t,"getElementToolStateManager",function(){return l});var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/imageIdSpecificStateManager.js"),i=n("./util/triggerEvent.js"),s=n("./util/uuidv4.js");function l(e){var t=r.default.cornerstone.getEnabledElement(e);return void 0===t.toolStateManager&&(t.toolStateManager=o.globalImageIdSpecificToolStateManager),t.toolStateManager}function u(e,t,n){var r=l(e);n.uuid=n.uuid||Object(s.default)(),r.add(e,t,n);var o=a.default.MEASUREMENT_ADDED,u={toolName:t,toolType:t,element:e,measurementData:n};Object(i.default)(e,o,u)}function d(e,t){return l(e).get(e,t)}function c(e,t,n){var r=l(e).get(e,t);if(r&&r.data&&r.data.length){for(var o=-1,s=0;s<r.data.length;s++)r.data[s]===n&&(o=s);if(-1!==o){r.data.splice(o,1);var u=a.default.MEASUREMENT_REMOVED,d={toolName:t,toolType:t,element:e,measurementData:n};Object(i.default)(e,u,d)}}}function f(e,t){var n=l(e).get(e,t);void 0!==n&&(n.data=[])}function h(e,t){r.default.cornerstone.getEnabledElement(e).toolStateManager=t}},"./stateManagement/toolStyle.js":function(e,t,n){"use strict";n.r(t);var a=1,r=2;t.default={setToolWidth:function(e){a=e},getToolWidth:function(){return a},setActiveWidth:function(e){r=e},getActiveWidth:function(){return r}}},"./store/addTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addTool",function(){return l}),n.d(t,"addToolForElement",function(){return s});var a=n("./store/index.js"),r=n("./store/getToolForElement.js"),o=n("./util/logger.js"),i=Object(o.getLogger)("addTool"),s=function(e,t,n){var o=new t(n);Object(r.default)(e,o.name)?i.warn("%s has already been added to the target element",o.name):(o.element=e,a.default.state.tools.push(o))},l=function(e,t){u(e,t),a.default.state.enabledElements.forEach(function(n){s(n,e,t)})},u=function(e,t){if(Object(a.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var n=new e(t);void 0!==a.default.state.globalTools[n.name]?i.warn("%s has already been added globally",n.name):a.default.state.globalTools[n.name]={tool:e,props:t,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),r=n("./tools/base/BaseBrushTool.js");t.default=function(e){return e.filter(function(e){return!(e.isMultiPartTool||e instanceof a.default||e instanceof r.default)})}},"./store/getActiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return t.filter(function(t){return t.element===e&&"active"===t.mode&&(void 0===n||t.options["is".concat(n,"Active")])})}},"./store/getInteractiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return t.filter(function(t){return t.element===e&&("active"===t.mode||"passive"===t.mode)})}},"./store/getToolForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js");t.default=function(e,t){return a.state.tools.find(function(n){return n.element===e&&n.name===t})}},"./store/getToolsWithDataForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./stateManagement/toolState.js");t.default=function(e,t){return t.filter(function(t){var n=Object(a.getToolState)(e,t.name);return n&&n.data.length>0})}},"./store/getToolsWithMoveableHandles.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./stateManagement/toolState.js"),o=n("./manipulators/getHandleNearImagePoint.js");t.default=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",s="mouse"===i?a.state.clickProximity:a.state.touchProximity;return t.filter(function(t){for(var a=Object(r.getToolState)(e,t.name),i=0;i<a.data.length;i++)if(void 0!==Object(o.default)(e,a.data[i].handles,n,s))return!0;return!1})}},"./store/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",function(){return u}),n.d(t,"getters",function(){return d}),n.d(t,"modules",function(){return c}),n.d(t,"getModule",function(){return f});var a=n("./store/modules/segmentationModule/index.js"),r=n("./store/modules/manipulatorStateModule.js"),o=n("./store/modules/cursorModule.js"),i=n("./store/modules/globalConfigurationModule.js"),s=n("./externalModules.js"),l=n("./util/logger.js"),u=(Object(l.getLogger)("store:modules:storeLogger"),{globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,svgCursorUrl:null}),d={mouseTools:function(){return u.tools.filter(function(e){return e.supportedInteractionTypes.includes("Mouse")})},touchTools:function(){return u.tools.filter(function(e){return e.supportedInteractionTypes.includes("Touch")})},enabledElementByUID:function(e){return u.enabledElements.find(function(t){return s.default.cornerstone.getEnabledElement(t).uuid===e})}},c={segmentation:a.default,cursor:o.default,globalConfiguration:i.default,manipulatorState:r.default};function f(e){return c[e]}t.default={modules:c,state:u,getters:d}},"./store/internals/addEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),r=n("./eventDispatchers/index.js"),o=n("./store/addTool.js"),i=n("./store/setToolMode.js"),s=n("./store/index.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("internals:addEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_ENABLED");var t=e.detail.element;r.imageRenderedEventDispatcher.enable(t),r.newImageEventDispatcher.enable(t);var n=Object(s.getModule)("globalConfiguration").configuration;n.mouseEnabled&&(a.mouseEventListeners.enable(t),a.wheelEventListener.enable(t),r.mouseToolEventDispatcher.enable(t)),n.touchEnabled&&(a.touchEventListeners.enable(t),r.touchToolEventDispatcher.enable(t)),d(t)};var d=function(e){s.default.state.enabledElements.push(e),s.default.modules&&function(e){var t=s.default.modules;Object.keys(t).forEach(function(n){"function"==typeof t[n].enabledElementCallback&&t[n].enabledElementCallback(e)})}(e),function(e){Object(s.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&Object.keys(s.default.state.globalTools).forEach(function(t){var n=s.default.state.globalTools[t],a=n.tool,r=n.props;Object(o.addToolForElement)(e,a,r)})}(e),function(e){if(Object(s.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var t={active:i.setToolActiveForElement,passive:i.setToolPassiveForElement,enabled:i.setToolEnabledForElement,disabled:i.setToolDisabledForElement};s.default.state.globalToolChangeHistory.forEach(function(n){var a=n.args.slice(0);a.unshift(e),t[n.mode].apply(null,a)})}}(e)}},"./store/internals/removeEnabledElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./eventListeners/index.js"),r=n("./eventDispatchers/index.js"),o=n("./store/index.js"),i=n("./util/logger.js"),s=n("./stateManagement/loadHandlerManager.js"),l=n("./store/setToolMode.js"),u=Object(i.getLogger)("internals:removeEnabledElement");t.default=function(e){u.log("EVENT:ELEMENT_DISABLED");var t=e.detail.element,n=Object(o.getModule)("globalConfiguration").configuration;r.imageRenderedEventDispatcher.disable(t),r.newImageEventDispatcher.disable(t),n.mouseEnabled&&(a.mouseEventListeners.disable(t),a.wheelEventListener.disable(t),r.mouseToolEventDispatcher.disable(t)),n.touchEnabled&&(a.touchEventListeners.disable(t),r.touchToolEventDispatcher.disable(t)),d(t),c(t),f(t)};var d=function(e){o.default.state.tools.forEach(function(t){t.element===e&&Object(l.setToolDisabledForElement)(t.element,t.name)}),o.default.state.tools=o.default.state.tools.filter(function(t){return t.element!==e})},c=function(e){o.default.modules&&function(e){var t=o.default.modules;Object.keys(t).forEach(function(n){"function"==typeof t[n].removeEnabledElementCallback&&t[n].removeEnabledElementCallback(e)})}(e);var t=o.default.state.enabledElements.findIndex(function(t){return t===e});t>-1?o.default.state.enabledElements.splice(t,1):u.warn("unable to remove element")},f=function(e){s.default.removeHandlers(e)}},"./store/isToolActiveForElement.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/getToolForElement.js");t.default=function(e,t){return"active"===Object(a.default)(e,t).mode}},"./store/modules/cursorModule.js":function(e,t,n){"use strict";n.r(t),n("./externalModules.js");var a={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '};t.default={configuration:a,getters:{defaultOptions:function(){return a}},setters:{defaultOptions:function(e){Object.assign(a,e)}}}},"./store/modules/globalConfigurationModule.js":function(e,t,n){"use strict";n.r(t),t.default={configuration:{mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1,autoResizeViewports:!0,lineDash:[4,4]}}},"./store/modules/manipulatorStateModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r={activeManipulators:{}};function o(e){var t=a.default.cornerstone.getEnabledElement(e);delete r.activeManipulators[t.uuid]}function i(e){var t=r.activeManipulators,n=t[e];"function"==typeof n&&n(),delete t[e]}function s(e){o(e.detail.element)}t.default={setters:{addActiveManipulatorForElement:function(e,t){var n=a.default.cornerstone.getEnabledElement(e);r.activeManipulators[n.uuid]=t},removeActiveManipulatorForElement:o,cancelActiveManipulatorsForElement:function(e){i(a.default.cornerstone.getEnabledElement(e).uuid)},cancelActiveManipulators:function(){Object.keys(r.activeManipulators).forEach(function(e){return i(e)})}},state:r,enabledElementCallback:function(e){var t=a.default.cornerstone.EVENTS.NEW_IMAGE;e.removeEventListener(t,s),e.addEventListener(t,s)},removeEnabledElementCallback:function(e){e.removeEventListener(a.default.cornerstone.EVENTS.NEW_IMAGE,s),o(e)}}},"./store/modules/segmentationModule/activeLabelmapIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveLabelmapIndex",function(){return l}),n.d(t,"setActiveLabelmapIndex",function(){return u});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/addLabelmap3D.js"),i=n("./store/modules/segmentationModule/state.js"),s=n("./externalModules.js");function l(e){var t=Object(a.default)(e);if(t){var n=Object(r.getToolState)(t,"stack"),o=i.default.series[n.data[0].imageIds[0]];if(o)return o.activeLabelmapIndex}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(a.default)(e);if(n){var l=s.default.cornerstone,u=Object(r.getToolState)(n,"stack"),d=u.data[0],c=l.getEnabledElement(n),f=c.image,h=f.rows,m=f.columns,g=d.imageIds.length,p=h*m*g,v=d.imageIds[0],b=i.default.series[v];b?(b.activeLabelmapIndex=t,b.labelmaps3D[t]||Object(o.default)(b,t,p)):(i.default.series[v]={activeLabelmapIndex:t,labelmaps3D:[]},b=i.default.series[v],Object(o.default)(b,t,p)),l.updateImage(n)}}},"./store/modules/segmentationModule/activeSegmentIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveSegmentIndex",function(){return s}),n.d(t,"setActiveSegmentIndex",function(){return l}),n.d(t,"incrementActiveSegmentIndex",function(){return u}),n.d(t,"decrementActiveSegmentIndex",function(){return d});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./store/index.js");function s(e,t){var n=Object(a.default)(e);if(n){var i=Object(r.getToolState)(n,"stack"),s=o.default.series[i.data[0].imageIds[0]];if(s){var l=s.labelmaps3D[t=void 0===t?s.activeLabelmapIndex:t];if(l)return l.activeSegmentIndex}return 1}}function l(e,t){var n=Object(a.default)(e);if(n){var s=Object(r.getToolState)(n,"stack"),l=o.default.series[s.data[0].imageIds[0]];if(l){var u=l.labelmaps3D[l.activeLabelmapIndex],d=Object(i.getModule)("segmentation").configuration;t<=0?t=1:t>d.segmentsPerLabelmap&&(t=d.segmentsPerLabelmap),u.activeSegmentIndex=t}}}function u(e){var t=Object(a.default)(e);t&&c(t,"increase")}function d(e){var t=Object(a.default)(e);t&&c(t,"decrease")}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"increase",n=Object(i.getModule)("segmentation"),a=n.configuration,s=Object(r.getToolState)(e,"stack"),l=s.data[0],u=l.imageIds[0],d=o.default.series[u];if(d){var c=d.activeLabelmapIndex,f=d.labelmaps3D[c];switch(t){case"increase":f.activeSegmentIndex++,f.activeSegmentIndex>a.segmentsPerLabelmap&&(f.activeSegmentIndex=1);break;case"decrease":f.activeSegmentIndex--,f.activeSegmentIndex<=0&&(f.activeSegmentIndex=a.segmentsPerLabelmap)}}}},"./store/modules/segmentationModule/addLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/modules/segmentationModule/arrayTypes.js"),r=n("./store/index.js"),o=a.default.UINT_16_ARRAY,i=a.default.FLOAT_32_ARRAY;function s(e,t,n,a,s){var l,u=Object(r.getModule)("segmentation").configuration,d=a*s,c=d*n;switch(u.arrayType){case o:l=new Uint16Array(e.labelmaps3D[t].buffer,2*c,d);break;case i:l=new Float32Array(e.labelmaps3D[t].buffer,4*c,d);break;default:throw new Error("Unsupported Array Type ".concat(u.arrayType))}e.labelmaps3D[t].labelmaps2D[n]={pixelData:l,segmentsOnLabelmap:[]}}},"./store/modules/segmentationModule/addLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/modules/segmentationModule/arrayTypes.js"),r=n("./store/index.js"),o=a.default.UINT_16_ARRAY,i=a.default.FLOAT_32_ARRAY;function s(e,t,n){var a,s=Object(r.getModule)("segmentation").configuration;switch(s.arrayType){case o:a=2;break;case i:a=4;break;default:throw new Error("Unsupported Array Type ".concat(s.arrayType))}e.labelmaps3D[t]={buffer:new ArrayBuffer(n*a),labelmaps2D:[],metadata:[],activeSegmentIndex:1,colorLUTIndex:0,segmentsHidden:[],undo:[],redo:[]}}},"./store/modules/segmentationModule/arrayTypes.js":function(e,t,n){"use strict";n.r(t),t.default={UINT_16_ARRAY:0,FLOAT_32_ARRAY:1}},"./store/modules/segmentationModule/colorLUT.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u}),n.d(t,"setColorLUTIndexForLabelmap3D",function(){return d}),n.d(t,"getColorForSegmentIndexColorLUT",function(){return c}),n.d(t,"setColorForSegmentIndexOfColorLUT",function(){return f}),n.d(t,"getColorLUT",function(){return h});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./util/logger.js"),i=n("./store/modules/segmentationModule/state.js"),s=n("./store/index.js"),l=Object(o.getLogger)("store:modules:segmentationModule:setColorLUT");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(s.getModule)("segmentation"),a=n.configuration,o=a.segmentsPerLabelmap;t?(m(t,o),t.length<o&&(t=[].concat(r()(t),r()(g(o-t.length))))):t=t||g(o),t.unshift([0,0,0,0]),i.default.colorLutTables[e]=t}function d(e,t){e.colorLUTIndex=t}function c(e,t){return h(e)[t]}function f(e,t,n){h(e)[t]=n}function h(e){return"number"==typeof e?i.default.colorLutTables[e]:i.default.colorLutTables[e.colorLUTIndex]}function m(e,t){e.length<t?l.warn("The provided colorLUT only provides ".concat(e.length," labels, whereas segmentsPerLabelmap is set to ").concat(t,". Autogenerating the rest.")):e.length>t&&l.warn("segmentsPerLabelmap is set to ".concat(t,", and the provided colorLUT provides ").concat(e.length,". Using the first ").concat(t," colors from the LUT."))}function g(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255,t=[],n=0;n<e;n++)t.push(x(v(),y()));return t}var p=222.5;function v(){return(p+=137.5)>=360&&(p-=360),p}var b=.6;function y(){return(b+=.07)>.82&&(b=b-.82+.3),b}function x(e){var t,n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,s=(1-Math.abs(2*o-1))*r,l=s*(1-Math.abs(e/60%2-1)),u=o-s/2;return e<60?(t=s,n=l,a=0):e<120?(t=l,n=s,a=0):e<180?(t=0,n=s,a=l):e<240?(t=0,n=l,a=s):e<300?(t=l,n=0,a=s):e<360&&(t=s,n=0,a=l),[255*(t+u),255*(n+u),255*(a+u),i]}},"./store/modules/segmentationModule/defaultConfiguration.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/modules/segmentationModule/arrayTypes.js");t.default={renderOutline:!0,renderFill:!0,shouldRenderInactiveLabelmaps:!0,radius:10,minRadius:1,maxRadius:50,fillAlpha:.2,fillAlphaInactive:.1,outlineAlpha:.7,outlineAlphaInactive:.35,outlineWidth:3,storeHistory:!0,segmentsPerLabelmap:65535,arrayType:a.default.UINT_16_ARRAY}},"./store/modules/segmentationModule/deleteSegment.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./externalModules.js");function s(e,t,n){if(t){var s=Object(a.default)(e);if(s){var l=Object(r.getToolState)(s,"stack"),u=o.default.series[l.data[0].imageIds[0]];if(u){var d=u.labelmaps3D[n=void 0===n?u.activeLabelmapIndex:n];if(d){delete d.metadata[t];for(var c=d.labelmaps2D,f=0;f<c.length;f++){var h=c[f];if(h&&h.segmentsOnLabelmap.includes(t)){var m=h.pixelData,g=h.segmentsOnLabelmap.indexOf(t);h.segmentsOnLabelmap.splice(g,1);for(var p=0;p<m.length;p++)m[p]===t&&(m[p]=0)}}i.default.cornerstone.updateImage(s)}}}}}},"./store/modules/segmentationModule/getBrushColor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var a=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),o=n("./store/modules/segmentationModule/getElement.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:getBrushColor");function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(o.default)(e);if(n){var i=Object(a.getToolState)(n,"stack");if(i){var l,u=i.data[0],d=u.imageIds[0],c=r.default.series[d];if(c){var f=c.activeLabelmapIndex,h=c.labelmaps3D[f],m=h.activeSegmentIndex;l=r.default.colorLutTables[h.colorLUTIndex][m]}else l=r.default.colorLutTables[0][1];return t?"rgba(".concat(l[0],", ").concat(l[1],", ").concat(l[2],", 1.0 )"):"rgba(".concat(l[0],", ").concat(l[1],", ").concat(l[2],", 0.8 )")}s.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}},"./store/modules/segmentationModule/getElement.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./store/index.js");function r(e){return e instanceof HTMLElement?e:a.getters.enabledElementByUID(e)}},"./store/modules/segmentationModule/getLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p}),n.d(t,"getLabelmap2DByImageIdIndex",function(){return v});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),i=n("./store/modules/segmentationModule/addLabelmap3D.js"),s=n("./store/modules/segmentationModule/addLabelmap2D.js"),l=n("./externalModules.js"),u=n("./store/modules/segmentationModule/state.js"),d=n("./store/modules/segmentationModule/arrayTypes.js"),c=n("./store/index.js"),f=n("./util/logger.js"),h=d.default.UINT_16_ARRAY,m=d.default.FLOAT_32_ARRAY,g=Object(f.getLogger)("store:modules:segmentationModule:getLabelmap2D");function p(e){var t=Object(a.default)(e);if(t){var n=l.default.cornerstone,o=Object(r.getToolState)(t,"stack");if(o){var d,c=o.data[0],f=n.getEnabledElement(t),h=c.currentImageIdIndex,m=f.image,p=m.rows,v=m.columns,b=c.imageIds.length,y=c.imageIds[0],x=u.default.series[y];if(x){if(!x.labelmaps3D[d=x.activeLabelmapIndex]){var w=p*v*b;Object(i.default)(x,d,w)}x.labelmaps3D[d].labelmaps2D[h]||Object(s.default)(x,d,h,p,v)}else{u.default.series[y]={activeLabelmapIndex:d=0,labelmaps3D:[]},x=u.default.series[y];var j=p*v*b;Object(i.default)(x,d,j),Object(s.default)(x,d,h,p,v)}var T=x.labelmaps3D[d];return{labelmap2D:T.labelmaps2D[h],labelmap3D:T,currentImageIdIndex:h,activeLabelmapIndex:d}}g.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function v(e,t,n,a){if(!e.labelmaps2D[t]){var r,i=Object(c.getModule)("segmentation").configuration,s=n*a,l=s*t;switch(i.arrayType){case h:r=new Uint16Array(e.buffer,2*l,s);break;case m:r=new Float32Array(e.buffer,4*l,s);break;default:throw new Error("Unsupported Array Type ".concat(i.arrayType))}e.labelmaps2D[t]={pixelData:r,segmentsOnLabelmap:Object(o.default)(r)}}return e.labelmaps2D[t]}},"./store/modules/segmentationModule/getLabelmapBuffers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLabelmapBuffers",function(){return c}),n.d(t,"getActiveLabelmapBuffer",function(){return f});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/getLabelmaps3D.js"),i=n("./store/modules/segmentationModule/state.js"),s=n("./store/modules/segmentationModule/arrayTypes.js"),l=n("./store/index.js"),u=s.default.UINT_16_ARRAY,d=s.default.FLOAT_32_ARRAY;function c(e,t){var n=Object(a.default)(e);if(n){var r=Object(o.default)(n).labelmaps3D;if(!r)return[];var s,c,f=Object(l.getModule)("segmentation").configuration;switch(f.arrayType){case u:s="Uint16Array",c="2";break;case d:s="Float32Array",c="4";break;default:throw new Error("Unsupported Array Type ".concat(f.arrayType))}var h=i.default.colorLutTables;if(void 0!==t){var m=r[t];return m?{labelmapIndex:t,bytesPerVoxel:c,type:s,buffer:m.buffer,colorLUT:h[m.colorLUTIndex]}:void 0}for(var g=[],p=0;p<r.length;p++){var v=r[p];v&&g.push({labelmapIndex:p,bytesPerVoxel:2,buffer:v.buffer,colorLUT:h[v.colorLUTIndex]})}return g}}function f(e){var t=Object(a.default)(e);if(t){var n=Object(r.getToolState)(t,"stack"),o=i.default.series[n.data[0].imageIds[0]];if(o)return c(t,o.activeLabelmapIndex)}}},"./store/modules/segmentationModule/getLabelmapStats.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u}),n.d(t,"_calculateLabelmapStats",function(){return d});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./externalModules.js"),s=n("./util/logger.js"),l=Object(s.getLogger)("store:modules:segmentationModule:getLabelmapStats");function u(e,t,n){var s=i.default.cornerstone,u=Object(a.default)(e);if(!u)return null;var c=Object(r.getToolState)(u,"stack").data[0].imageIds,f=c[0];return new Promise(function(e){var a=o.default.series[f];a||e(null);var r=function(e){for(var t=[],n=i.default.cornerstone.metaData,a=!0,r=0;r<e.length;r++){var o=n.get("imagePlaneModule",e[r]);if(!o){a=!1;break}t.push(o)}return{sufficientMetadata:a,imagePlanes:t}}(c),u=r.imagePlanes;r.sufficientMetadata||(l.warn("Insufficient imagePlaneModule information to calculate volume statistics."),e(null));for(var h=a.labelmaps3D[n=void 0===n?a.activeLabelmapIndex:n],m=[],g=0;g<c.length;g++)m.push(s.loadAndCacheImage(c[g]));Promise.all(m).then(function(n){var a=d(h,n,u,t);e(a)})})}function d(e,t,n,a){for(var r=function(e,t,n,a){for(var r=t[0],o=r.rowPixelSpacing,i=r.columnPixelSpacing,s=e.labelmaps2D,l=[],u=0;u<s.length;u++){var d=s[u];if(d&&d.segmentsOnLabelmap.includes(a)){for(var f=c(t,n,u)*o*i,h=d.pixelData,m=t[u].getPixelData(),g=[],p=0;p<h.length;p++)h[p]===a&&g.push(m[p]);l.push({voxelInMM3:f,values:g})}}return l}(e,t,n,a),o=0,i=r[0].values[0],s=i,l=0,u=0;u<r.length;u++){var d=r[u];l+=(v=d.voxelInMM3)*(g=d.values).length;var f=0;g.forEach(function(e){e>i?i=e:e<s&&(s=e),f+=e}),o+=f*v}o/=l;for(var h=0,m=0;m<r.length;m++){var g,p=r[m],v=p.voxelInMM3,b=0;(g=p.values).forEach(function(e){b+=Math.pow(e-o,2)}),h+=b*v}return h/=l,h=Math.sqrt(h),{volume:l,mean:o,stdDev:h,max:i,min:s}}function c(e,t,n){var a=e.length,r=t[n].imagePositionPatient;if(0===n)return f(r,t[n+1].imagePositionPatient);if(n===a-1)return f(r,t[n-1].imagePositionPatient);var o=t[n+1].imagePositionPatient;return(f(r,t[n-1].imagePositionPatient)+f(r,o))/2}function f(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}},"./store/modules/segmentationModule/getLabelmaps3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l}),n.d(t,"getLabelmap3D",function(){return u});var a=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/getElement.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:getLabelmaps3D");function l(e){var t=Object(r.default)(e);if(t){var n=Object(a.getToolState)(t,"stack");if(n){var i,l,u=n.data[0],d=o.default.series[u.imageIds[0]];return d&&(i=d.labelmaps3D,l=d.activeLabelmapIndex),{labelmaps3D:i,activeLabelmapIndex:l,currentImageIdIndex:u.currentImageIdIndex}}s.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function u(e,t){var n=l(e);return n.labelmaps3D[t=void 0!==t?t:n.activeLabelmapIndex]}},"./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l});var a=n("./stateManagement/toolState.js"),r=n("./store/modules/segmentationModule/state.js"),o=n("./util/isPointInImage.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:getSegmentOfActiveLabelmapAtEvent");function l(e){var t=e.detail,n=t.element,i=t.image,l=t.currentPoints;if(l){var u=i.width,d=i.height;if(n){var c=Object(a.getToolState)(n,"stack").data[0],f=r.default.series[c.imageIds[0]],h=f.labelmaps3D[f.activeLabelmapIndex];if(h){var m=h.labelmaps2D[c.currentImageIdIndex];if(m){var g=m.pixelData,p=l.image,v=p.x,b=p.y;if(v=Math.floor(v),b=Math.floor(b),Object(o.default)({x:v,y:b},d,u)){var y=g[b*u+v];if(0===y)return;return{segmentIndex:y,metadata:h.metadata[y]}}}}}}else s.warn("Not a cornerstone input event.")}},"./store/modules/segmentationModule/getSegmentsOnPixeldata.js":function(e,t,n){"use strict";function a(e){for(var t=new Set(e).values(),n=[],a=!1;!a;){var r=t.next();(a=r.done)||n.push(r.value)}return n}n.r(t),n.d(t,"default",function(){return a})},"./store/modules/segmentationModule/history.js":function(e,t,n){"use strict";n.r(t),n.d(t,"pushState",function(){return s}),n.d(t,"undo",function(){return l}),n.d(t,"redo",function(){return u});var a=n("./store/modules/segmentationModule/getLabelmaps3D.js"),r=n("./util/logger.js"),o=n("./externalModules.js"),i=Object(r.getLogger)("util:segmentation:labelmap3DHistory");function s(e,t,n){var r=Object(a.getLabelmap3D)(e,n);r.undo.push(t),r.redo=[]}function l(e,t){var n=Object(a.getLabelmap3D)(e,t),r=n.undo,s=n.redo;if(r.length){var l=r.pop();d(n,l,1),s.push(l),o.default.cornerstone.updateImage(e)}else i.warn("No undos left.")}function u(e,t){var n=Object(a.getLabelmap3D)(e,t),r=n.undo,s=n.redo;if(s.length){var l=s.pop();d(n,l,2),r.push(l),o.default.cornerstone.updateImage(e)}else i.warn("No redos left.")}function d(e,t,n){var a=e.labelmaps2D;t.forEach(function(e){for(var t=e.diff,r=a[e.imageIdIndex].pixelData,o=0;o<t.length;o++){var i=t[o];r[i[0]]=i[n]}})}},"./store/modules/segmentationModule/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/modules/segmentationModule/metadata.js"),r=n("./store/modules/segmentationModule/activeLabelmapIndex.js"),o=n("./store/modules/segmentationModule/activeSegmentIndex.js"),i=n("./store/modules/segmentationModule/segmentVisibility.js"),s=n("./store/modules/segmentationModule/getLabelmapBuffers.js"),l=n("./store/modules/segmentationModule/setLabelmap3D.js"),u=n("./store/modules/segmentationModule/getLabelmapStats.js"),d=n("./store/modules/segmentationModule/getLabelmaps3D.js"),c=n("./store/modules/segmentationModule/getLabelmap2D.js"),f=n("./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js"),h=n("./store/modules/segmentationModule/colorLUT.js"),m=n("./store/modules/segmentationModule/getBrushColor.js"),g=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),p=n("./store/modules/segmentationModule/deleteSegment.js"),v=n("./store/modules/segmentationModule/state.js"),b=n("./store/modules/segmentationModule/defaultConfiguration.js"),y=n("./store/modules/segmentationModule/history.js"),x=n("./store/modules/segmentationModule/setRadius.js");t.default={state:v.default,configuration:b.default,onRegisterCallback:function(){Object(h.default)(0)},getters:{metadata:a.getMetadata,labelmap3D:d.getLabelmap3D,labelmaps3D:d.default,activeLabelmapIndex:r.getActiveLabelmapIndex,activeSegmentIndex:o.getActiveSegmentIndex,isSegmentVisible:i.isSegmentVisible,labelmap2D:c.default,labelmap2DByImageIdIndex:c.getLabelmap2DByImageIdIndex,labelmapStats:u.default,segmentOfActiveLabelmapAtEvent:f.default,brushColor:m.default,labelmapBuffers:s.getLabelmapBuffers,activeLabelmapBuffer:s.getActiveLabelmapBuffer,colorLUT:h.getColorLUT,colorForSegmentIndexColorLUT:h.getColorForSegmentIndexColorLUT},setters:{metadata:a.setMetadata,labelmap3DForElement:l.setLabelmap3DForElement,labelmap3DByFirstImageId:l.setLabelmap3DByFirstImageId,incrementActiveSegmentIndex:o.incrementActiveSegmentIndex,decrementActiveSegmentIndex:o.decrementActiveSegmentIndex,activeSegmentIndex:o.setActiveSegmentIndex,toggleSegmentVisibility:i.toggleSegmentVisibility,updateSegmentsOnLabelmap2D:function(e){e.segmentsOnLabelmap=Object(g.default)(e.pixelData)},deleteSegment:p.default,colorLUT:h.default,colorLUTIndexForLabelmap3D:h.setColorLUTIndexForLabelmap3D,colorForSegmentIndexOfColorLUT:h.setColorForSegmentIndexOfColorLUT,activeLabelmapIndex:r.setActiveLabelmapIndex,radius:x.default,pushState:y.pushState,undo:y.undo,redo:y.redo}}},"./store/modules/segmentationModule/metadata.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getMetadata",function(){return d}),n.d(t,"setMetadata",function(){return c});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./store/modules/segmentationModule/addLabelmap3D.js"),o=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),s=n("./util/logger.js"),l=n("./store/modules/segmentationModule/state.js"),u=Object(s.getLogger)("store:modules:segmentationModule:metadata");function d(e,t,n){var r=Object(a.default)(e);if(r){var i=Object(o.getToolState)(r,"stack"),s=l.default.series[i.data[0].imageIds[0]];if(s){if(s.labelmaps3D[t=void 0===t?s.activeLabelmapIndex:t]){var d=s.labelmaps3D[t];return void 0===n?d.metadata:d.metadata[n]}u.warn("No labelmap3D of labelmap index ".concat(t," on stack."))}else u.warn("brushStackState is undefined")}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,u=Object(a.default)(e);if(u){var d=i.default.cornerstone,c=Object(o.getToolState)(u,"stack"),f=c.data[0],h=f.imageIds[0],m=l.default.series[h];if(m||(l.default.series[h]={labelmapIndex:t,labelmaps3D:[]},m=l.default.series[h]),!m.labelmaps3D[t]){var g=d.getEnabledElement(u),p=g.image,v=p.rows,b=p.columns,y=f.imageIds.length,x=v*b*y;Object(r.default)(m,t,x)}var w=m.labelmaps3D[t];w.metadata[n]=s}}},"./store/modules/segmentationModule/segmentVisibility.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isSegmentVisible",function(){return l}),n.d(t,"toggleSegmentVisibility",function(){return u});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("store:modules:segmentationModule:segmentVisibility");function l(e,t,n){if(t){var i=Object(a.default)(e);if(i){var l=Object(r.getToolState)(i,"stack"),u=o.default.series[l.data[0].imageIds[0]];if(u){if(u.labelmaps3D[n=void 0===n?u.activeLabelmapIndex:n])return!u.labelmaps3D[n].segmentsHidden[t];s.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else s.warn("brushStackState is undefined")}}}function u(e,t,n){if(t){var i=Object(a.default)(e);if(i){var l=Object(r.getToolState)(i,"stack"),u=o.default.series[l.data[0].imageIds[0]];if(u){if(u.labelmaps3D[n=void 0===n?u.activeLabelmapIndex:n]){var d=u.labelmaps3D[n].segmentsHidden;return d[t]=!d[t],!d[t]}s.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else s.warn("brushStackState is undefined")}}}},"./store/modules/segmentationModule/setLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setLabelmap3DByFirstImageId",function(){return h}),n.d(t,"setLabelmap3DForElement",function(){return f});var a=n("./store/modules/segmentationModule/getElement.js"),r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),i=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),s=n("./util/segmentation/index.js"),l=n("./store/modules/segmentationModule/arrayTypes.js"),u=n("./store/index.js"),d=l.default.UINT_16_ARRAY,c=l.default.FLOAT_32_ARRAY;function f(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=Object(a.default)(e);if(u){var d=Object(r.getToolState)(u,"stack"),c=d.data[0].imageIds.length,f=d.data[0].imageIds[0];h(f,t,n,o,c,i,l),Object(s.triggerLabelmapModifiedEvent)(u,n)}}function h(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,f=Object(u.getModule)("segmentation"),h=f.configuration,m=o.default.series[e];m||(o.default.series[e]={activeLabelmapIndex:n,labelmaps3D:[]},m=o.default.series[e]),m.labelmaps3D[n]={buffer:t,labelmaps2D:[],metadata:a,activeSegmentIndex:1,colorLUTIndex:l,segmentsHidden:[],undo:[],redo:[]};for(var g=m.labelmaps3D[n].labelmaps2D,p=t.byteLength/r,v=0;v<r;v++){var b=void 0;switch(h.arrayType){case d:b=new Uint16Array(t,p*v,p/2);break;case c:b=new Float32Array(t,p*v,p/4);break;default:throw new Error("Unsupported Array Type ".concat(h.arrayType))}var y=s?s[v]:Object(i.default)(b);y&&y.some(function(e){return e})&&(g[v]={pixelData:b,segmentsOnLabelmap:y})}}},"./store/modules/segmentationModule/setRadius.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./store/index.js");function r(e){var t=Object(a.getModule)("segmentation").configuration;t.radius=Math.min(Math.max(e,t.minRadius),t.maxRadius)}},"./store/modules/segmentationModule/state.js":function(e,t,n){"use strict";n.r(t),t.default={series:{},colorLutTables:[]}},"./store/removeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"removeTool",function(){return o}),n.d(t,"removeToolForElement",function(){return r});var a=n("./store/index.js"),r=function(e,t){var n=a.default.state.tools.findIndex(function(n){return n.element===e&&n.name===t});n>=0&&a.default.state.tools.splice(n,1)},o=function(e){i(e),a.default.state.enabledElements.forEach(function(t){r(t,e)})},i=function(e){Object(a.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&a.default.state.globalTools[e]&&delete a.default.state.globalTools[e]}},"./store/setToolCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolCursor",function(){return o}),n.d(t,"resetToolCursor",function(){return i}),n.d(t,"hideToolCursor",function(){return s});var a=n("./store/index.js"),r=a.modules.globalConfiguration;function o(e,t){if(r.configuration.showSVGCursors){var n=t.getIconWithPointerSVG(),o=t.mousePoint,i=window.URL.createObjectURL(n);e.style.cursor="url('".concat(i,"') ").concat(o,", auto"),a.state.svgCursorUrl=i}}function i(e){l(e,"initial")}function s(e){r.configuration.showSVGCursors&&l(e,"none")}function l(e,t){a.state.svgCursorUrl&&window.URL.revokeObjectURL(a.state.svgCursorUrl),a.state.svgCursorUrl=null,e.style.cursor=t}},"./store/setToolMode.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolActive",function(){return f}),n.d(t,"setToolActiveForElement",function(){return c}),n.d(t,"setToolDisabled",function(){return m}),n.d(t,"setToolDisabledForElement",function(){return h}),n.d(t,"setToolEnabled",function(){return p}),n.d(t,"setToolEnabledForElement",function(){return g}),n.d(t,"setToolPassive",function(){return b}),n.d(t,"setToolPassiveForElement",function(){return v}),n.d(t,"setToolMode",function(){return x}),n.d(t,"setToolModeForElement",function(){return y}),n.d(t,"_getNormalizedOptions",function(){return _}),n.d(t,"_mergeMouseButtonMask",function(){return E});var a=n("./events.js"),r=n("./util/triggerEvent.js"),o=n("./store/getToolForElement.js"),i=n("./store/setToolCursor.js"),s=n("./util/logger.js"),l=n("./store/index.js"),u=Object(l.getModule)("globalConfiguration"),d=Object(s.getLogger)("store:setToolMode"),c=function(e,t,n,a){void 0===a&&Array.isArray(n)&&(a=n,n=null);var r=Object(o.default)(e,t);r&&(function(e,t,n,a){t.supportedInteractionTypes.forEach(function(r){if(void 0===a||a.includes(r)){var o=T[r];o?o(t,e,n):d.warn("Unable to resolve input conflicts for type %s",r)}}),l.default.state.tools.filter(function(t){return t.element===e&&"active"===t.mode&&t.supportedInteractionTypes.length>0}).forEach(function(t){var n=!1;t.supportedInteractionTypes.forEach(function(e){t.options["is".concat(e,"Active")]&&(n=!0)}),n||(d.log("Setting tool %s's to PASSIVE",t.name),v(e,t.name))})}(e,r,n,a),r.supportedInteractionTypes.forEach(function(e){void 0===a||a.includes(e)?n["is".concat(e,"Active")]=!0:n["is".concat(e,"Active")]=!1}),u.configuration.showSVGCursors&&r.supportedInteractionTypes.includes("Mouse")&&function(e,t,n){("number"==typeof t?[t]:t.mouseButtonMask).includes(1)&&(n.svgCursor?Object(i.setToolCursor)(n.element,n.svgCursor):n.hideDefaultCursor?Object(i.hideToolCursor)(e):Object(i.resetToolCursor)(e))}(e,n,r)),y("active",null,e,t,n)},f=function(e,t,n){j("active",e,t,n),l.default.state.enabledElements.forEach(function(a){c(a,e,t,n)})},h=y.bind(null,"disabled",null),m=x.bind(null,"disabled",null),g=y.bind(null,"enabled",null),p=x.bind(null,"enabled",null),v=y.bind(null,"passive",a.default.TOOL_DEACTIVATED),b=x.bind(null,"passive",a.default.TOOL_DEACTIVATED);function y(e,t,n,a,i){var s=Object(o.default)(n,a);if(s){if(i=_(i),Array.isArray(i.mouseButtonMask)&&0!==i.mouseButtonMask.length&&Array.isArray(s.options.mouseButtonMask)&&(i.mouseButtonMask=E(i.mouseButtonMask,s.options.mouseButtonMask)),s.mode=e,s.mergeOptions(i),s["".concat(e,"Callback")]&&s["".concat(e,"Callback")](n,i),t){var l={options:i,toolName:a,toolType:a,type:t};Object(r.default)(n,t,l)}}else d.warn('Unable to find tool "%s" for enabledElement',a)}function x(e,t,n,a){j(e,n,a),l.default.state.enabledElements.forEach(function(r){y(e,t,r,n,a)})}function w(e,t,n){var a="is".concat(e,"Active"),r=l.default.state.tools.find(function(e){return e.element===n&&"active"===e.mode&&!0===e.options[a]});r&&(d.log("Setting tool %s's %s to false",r.name,a),r.options[a]=!1)}function j(e,t,n,a){if(u.configuration.globalToolSyncEnabled){var r={mode:e,args:[t,n]};a&&r.push(a),l.default.state.globalToolChangeHistory.push(r),l.default.state.globalToolChangeHistory.length>50&&l.default.state.globalToolChangeHistory.shift();var o=l.default.state.globalTools[t];if(o)if("active"===e){var i=function(e,t,n){void 0===n&&Array.isArray(t)&&(n=t,t=null);var a=[],r=l.default.state.globalTools[e];if(r){var o=new r.tool(r.props);o.supportedInteractionTypes.forEach(function(e){if(void 0===n||n.includes(e))if("Mouse"===e){var r=_(t).mouseButtonMask;Array.isArray(r)&&r.length>0?r.forEach(function(t){return a.push("".concat(e,"-").concat(t))}):Array.isArray(r)&&0===r.length&&a.push("".concat(e,"-DELETE"))}else a.push("MultiTouch"===e?"".concat(e,"-").concat(o.configuration.touchPointers):e)})}return a}(t,n,a);Object.keys(l.default.state.globalTools).forEach(function(e){var t=l.default.state.globalTools[e];t.activeBindings=t.activeBindings.filter(function(e){return!i.includes(e)})}),i.some(function(e){return e.includes("Mouse-DELETE")})&&(o.activeBindings=o.activeBindings.filter(function(e){return!e.includes("Mouse")}),i=i.filter(function(e){return!e.includes("Mouse")})),o.activeBindings=o.activeBindings.concat(i)}else o.activeBindings=[];else d.warn("setToolMode call for tool not available globally: ".concat(t))}}var T={Mouse:function(e,t,n){var a=_(n).mouseButtonMask;if(Array.isArray(a)&&a.length>0){var r=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMouseActive&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.some(function(e){return a.includes(e)})});r&&(r.options.mouseButtonMask=r.options.mouseButtonMask.filter(function(e){return!a.includes(e)}),0===r.options.mouseButtonMask.length&&(r.options.isMouseActive=!1))}},MouseWheel:w.bind(void 0,"MouseWheel"),Touch:function(e,t){var n=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive}),a=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&1===e.configuration.touchPointers});n&&(d.log("Setting tool %s's isTouchActive to false",n.name),n.options.isTouchActive=!1),a&&(d.log("Setting tool %s's isTouchActive to false",a.name),a.options.isMultiTouchActive=!1)},TouchPinch:w.bind(void 0,"TouchPinch"),TouchRotate:w.bind(void 0,"TouchRotate"),DoubleTap:w.bind(void 0,"DoubleTap"),MultiTouch:function(e,t){var n,a=l.default.state.tools.find(function(n){return n.element===t&&"active"===n.mode&&!0===n.options.isMultiTouchActive&&n.configuration.touchPointers===e.configuration.touchPointers});1===e.configuration.touchPointers&&(n=l.default.state.tools.find(function(e){return e.element===t&&"active"===e.mode&&!0===e.options.isTouchActive})),a&&(d.log("Setting tool %s's isMultiTouchActive to false",a.name),a.options.isMultiTouchActive=!1),n&&(d.log("Setting tool %s's isTouchActive to false",n.name),n.options.isTouchActive=!1)}};function _(e){return Array.isArray(e)?e={mouseButtonMask:e}:e!==Object(e)&&(e={mouseButtonMask:[e]}),e.hasOwnProperty("mouseButtonMask")||(e.mouseButtonMask=[]),Array.isArray(e.mouseButtonMask)||(e.mouseButtonMask=[e.mouseButtonMask]),e.mouseButtonMask=e.mouseButtonMask.filter(function(e){return"number"==typeof e&&0!==e}),e}function E(e,t){return e.concat(t).reduce(function(e,t){return-1===e.indexOf(t)&&e.push(t),e},[])}},"./store/setToolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolOptions",function(){return i}),n.d(t,"setToolOptionsForElement",function(){return o});var a=n("./store/getToolForElement.js"),r=n("./store/index.js"),o=function(e,t,n){var r=Object(a.default)(e,t);r&&r.mergeOptions(n)},i=function(e,t){r.state.enabledElements.forEach(function(n){o(n,e,t)})}},"./synchronization/Synchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./util/convertToVector3.js"),o=n("./toolOptions.js");function i(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})}t.default=function(e,t){var n=this,s=[],l=[],u=!1,d={},c=t;function f(e){var t=e.detail.element;n.remove(t),Object(o.clearToolOptionsByElement)(t)}this.enabled=!0,this.setHandler=function(e){c=e},this.getHandler=function(){return c},this.getDistances=function(){if(s.length&&l.length){var e=a.default.cornerstone;d.distances={},d.imageIds={sourceElements:[],targetElements:[]},s.forEach(function(t){var n=e.getEnabledElement(t);if(n&&n.image){var a=n.image.imageId,o=e.metaData.get("imagePlaneModule",a);if(o&&o.imagePositionPatient){var i=Object(r.default)(o.imagePositionPatient);d.hasOwnProperty(n)||(d.distances[a]={},d.imageIds.sourceElements.push(a),l.forEach(function(n){var o=e.getEnabledElement(n);if(o&&o.image){var s=o.image.imageId;if(d.imageIds.targetElements.push(s),t!==n&&a!==s&&!d.distances[a].hasOwnProperty(s)){var l=e.metaData.get("imagePlaneModule",s);if(l&&l.imagePositionPatient){var u=Object(r.default)(l.imagePositionPatient);d.distances[a][s]=u.clone().sub(i)}}}}),Object.keys(d.distances[a]).length||delete d.distances[a])}}})}},this.fireEvent=function(e,t){!n.enabled||!s.length||!l.length||(u=!0,l.forEach(function(a){var r=l.indexOf(a);if(-1!==r){var o=d.imageIds.targetElements[r],i=s.indexOf(e);if(-1!==i){var u,f=d.imageIds.sourceElements[i];f===o?u=0:void 0!==d.distances[f]&&(u=d.distances[f][o]),c(n,e,a,t,u)}}}),u=!1)},this.onEvent=function(e){!0!==u&&n.fireEvent(e.currentTarget,e.detail)},this.addSource=function(t){-1===s.indexOf(t)&&(s.push(t),e.split(" ").forEach(function(e){t.addEventListener(e,n.onEvent)}),n.getDistances(),n.updateDisableHandlers())},this.addTarget=function(e){-1===l.indexOf(e)&&(l.push(e),n.getDistances(),c(n,e,e,0),n.updateDisableHandlers())},this.add=function(e){n.addSource(e),n.addTarget(e)},this.removeSource=function(t){var a=s.indexOf(t);-1!==a&&(s.splice(a,1),e.split(" ").forEach(function(e){t.removeEventListener(e,n.onEvent)}),n.getDistances(),n.fireEvent(t),n.updateDisableHandlers())},this.removeTarget=function(e){var t=l.indexOf(e);-1!==t&&(l.splice(t,1),n.getDistances(),c(n,e,e,0),n.updateDisableHandlers())},this.remove=function(e){n.removeTarget(e),n.removeSource(e)},this.getSourceElements=function(){return s},this.getTargetElements=function(){return l},this.displayImage=function(e,t,n){u=!0,a.default.cornerstone.displayImage(e,t,n),u=!1},this.setViewport=function(e,t){u=!0,a.default.cornerstone.setViewport(e,t),u=!1},this.updateDisableHandlers=function(){i(s.concat(l)).forEach(function(e){e.removeEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,f),e.addEventListener(a.default.cornerstone.EVENTS.ELEMENT_DISABLED,f)})},this.destroy=function(){i(s.concat(l)).forEach(function(e){n.remove(e)})}}},"./synchronization/panZoomSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var r=a.default.cornerstone,o=r.getViewport(t),i=r.getViewport(n);i.scale===o.scale&&i.translation.x===o.translation.x&&i.translation.y===o.translation.y||(i.scale=o.scale,i.translation.x=o.translation.x,i.translation.y=o.translation.y,e.setViewport(n,i))}}},"./synchronization/stackImageIndexSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n){if(n!==t){var s=a.default.cornerstone,l=Object(r.getToolState)(t,"stack").data[0],u=Object(r.getToolState)(n,"stack").data[0],d=l.currentImageIdIndex;if((d=Object(i.default)(d,0,u.imageIds.length-1))!==u.currentImageIdIndex){var c=o.default.getStartLoadHandler(n),f=o.default.getEndLoadHandler(n),h=o.default.getErrorLoadingHandler(n);c&&c(n),(!0===u.preventCache?s.loadImage(u.imageIds[d]):s.loadAndCacheImage(u.imageIds[d])).then(function(t){var a=s.getViewport(n);u.currentImageIdIndex=d,e.displayImage(n,t,a),f&&f(n,t)},function(e){h&&h(n,u.imageIds[d],e)})}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n,s,l){if(n!==t){var u=a.default.cornerstone,d=Object(r.getToolState)(t,"stack").data[0],c=u.metaData.get("imagePlaneModule",d.imageIds[d.currentImageIdIndex]);if(void 0!==c&&void 0!==c.imagePositionPatient){var f=Object(i.default)(c.imagePositionPatient),h=Object(r.getToolState)(n,"stack").data[0],m=Number.MAX_VALUE,g=-1;if(l){var p=f.clone().add(l);if(h.imageIds.forEach(function(e,t){var n=u.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient),r=p.distanceToSquared(a);r<m&&(m=r,g=t)}}),g!==h.currentImageIdIndex&&-1!==g){var v=o.default.getStartLoadHandler(n),b=o.default.getEndLoadHandler(n),y=o.default.getErrorLoadingHandler(n);h.currentImageIdIndex=g;var x=h.imageIds[g];v&&v(n),(!0===h.preventCache?u.loadImage(x):u.loadAndCacheImage(x)).then(function(t){var a=u.getViewport(n);h.currentImageIdIndex===g&&(e.displayImage(n,t,a),b&&b(n,t))},function(e){y&&y(n,h.imageIds[g],e)})}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/convertToVector3.js");t.default=function(e,t,n){if(n!==t){var s=a.default.cornerstone,l=Object(r.getToolState)(t,"stack").data[0],u=s.metaData.get("imagePlaneModule",l.imageIds[l.currentImageIdIndex]);if(void 0!==u&&void 0!==u.imagePositionPatient){var d=Object(i.default)(u.imagePositionPatient),c=Object(r.getToolState)(n,"stack").data[0],f=Number.MAX_VALUE,h=-1;if(c.imageIds.forEach(function(e,t){var n=s.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var a=Object(i.default)(n.imagePositionPatient).distanceToSquared(d);a<f&&(f=a,h=t)}}),h!==c.currentImageIdIndex){var m=o.default.getStartLoadHandler(n),g=o.default.getEndLoadHandler(n),p=o.default.getErrorLoadingHandler(n);c.currentImageIdIndex=h;var v=c.imageIds[h];m&&m(n),-1!==h&&(!0===c.preventCache?s.loadImage(v):s.loadAndCacheImage(v)).then(function(t){var a=s.getViewport(n);c.currentImageIdIndex===h&&(e.displayImage(n,t,a),g&&g(n,t))},function(e){p&&p(n,c.imageIds[h],e)})}}}}},"./synchronization/stackScrollSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolState.js"),o=n("./stateManagement/loadHandlerManager.js"),i=n("./util/clip.js");t.default=function(e,t,n,s){if(t!==n&&s&&s.direction){var l=a.default.cornerstone,u=Object(r.getToolState)(n,"stack").data[0],d=u.currentImageIdIndex+s.direction;if(d=Object(i.default)(d,0,u.imageIds.length-1),u.currentImageIdIndex!==d){var c=o.default.getStartLoadHandler(n),f=o.default.getEndLoadHandler(n),h=o.default.getErrorLoadingHandler(n);u.currentImageIdIndex=d;var m=u.imageIds[d];c&&c(n),(!0===u.preventCache?l.loadImage(m):l.loadAndCacheImage(m)).then(function(t){var a=l.getViewport(n);u.currentImageIdIndex===d&&(e.displayImage(n,t,a),f&&f(n,t))},function(e){h&&h(n,u.imageIds[d],e)})}}}},"./synchronization/updateImageSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){n!==t&&a.default.cornerstone.updateImage(n)}},"./synchronization/wwwcSynchronizer.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var r=a.default.cornerstone,o=r.getViewport(t),i=r.getViewport(n);i.voi.windowWidth===o.voi.windowWidth&&i.voi.windowCenter===o.voi.windowCenter&&i.invert===o.invert||(i.voi.windowWidth=o.voi.windowWidth,i.voi.windowCenter=o.voi.windowCenter,i.invert=o.invert,e.setViewport(n,i))}}},"./thirdParty/register.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./thirdParty/registerModule.js"),i=n("./thirdParty/registerMixin.js"),s=n("./thirdParty/registerItem.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("thirdParty:register");function d(e,t,n){return e?t?"object"===r()(n)||"function"==typeof n||(u.warn("The %s is a %s, it should be an Object or a function.",n,r()(n)),!1):(u.warn("The %s must have a name in order to register.",e),!1):(u.warn("The type must be given in order to register."),!1)}t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(d(e,t,n))switch(e){case"module":Object(o.default)(t,n,a);break;case"mixin":Object(i.default)(t,n,a);break;default:Object(s.default)(e,t,n,a)}}},"./thirdParty/registerItem.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),r=n("./util/logger.js"),o=Object(r.getLogger)("thirdParty:registerType");function i(e){return void 0!==a.lib[e]}t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s="".concat(e,"/").concat(t),l=i(s);!l||r?(l&&o.warn("Overwriting %s",s),a.lib[s]=n):o.warn("%s is already registered",s)}},"./thirdParty/registerMixin.js":function(e,t,n){"use strict";n.r(t);var a=n("./lib.js"),r=n("./mixins/index.js"),o=n("./util/logger.js"),i=Object(o.getLogger)("thirdParty:registerMixin");function s(e){return void 0!==r.default[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=s(e);!o||n?(o&&i.warn("Overwriting mixins/%s",e),r.default[e]=t,a.lib["mixins/".concat(e)]=r.default[e]):i.warn("mixins/%s is already registered",e)}},"./thirdParty/registerModule.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./util/logger.js"),o=Object(r.getLogger)("thirdParty:registerModule");function i(e){return void 0!==a.modules[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=i(e);!r||n?(r&&o.warn("Overwriting module %s",e),a.modules[e]=t,"function"==typeof a.modules[e].onRegisterCallback&&a.modules[e].onRegisterCallback()):o.warn("A module with the name %s is already registered",e)}},"./thirdParty/registerSome.js":function(e,t,n){"use strict";n.r(t);var a=n("./thirdParty/register.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach(function(e){var n=e.type,r=e.name,o=e.item;Object(a.default)(n,r,o,t)})}},"./toolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getToolOptions",function(){return r}),n.d(t,"setToolOptions",function(){return o}),n.d(t,"clearToolOptions",function(){return i}),n.d(t,"clearToolOptionsByToolType",function(){return s}),n.d(t,"clearToolOptionsByToolName",function(){return l}),n.d(t,"clearToolOptionsByElement",function(){return u});var a={};function r(e,t){if(!a[e])return{};var n=a[e].find(function(e){return e.element===t});return n?n.options:{}}function o(e,t,n){if(a[e]){var r=a[e].findIndex(function(e){return e.element===t});-1===r?a[e].push({element:t,options:n}):a[e][r].options=Object.assign(a[e][r].options||{},n)}else a[e]=[{element:t,options:n}]}function i(e,t){var n=a[e];n&&(a[e]=n.filter(function(e){return e.element!==t}))}function s(e){return l(e)}function l(e){delete a[e]}function u(e){for(var t in a)a[t]=a[t].filter(function(t){return t.element!==e})}},"./tools/CrosshairsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./tools/base/BaseTool.js"),p=n("./externalModules.js"),v=n("./stateManagement/loadHandlerManager.js"),b=n("./stateManagement/toolState.js"),y=n("./util/pointProjector.js"),x=n("./util/convertToVector3.js"),w=n("./toolOptions.js"),j=n("./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:j.crosshairsCursor};return(e=l()(this,d()(t).call(this,n,a))).mouseDownCallback=e._chooseLocation.bind(f()(e)),e.mouseDragCallback=e._chooseLocation.bind(f()(e)),e.touchDragCallback=e._chooseLocation.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_chooseLocation",value:function(e){var t=e.detail,n=t.element;e.stopImmediatePropagation();var a=Object(b.getToolState)(n,this.name);if(a){var r=n,o=p.default.cornerstone.getEnabledElement(r),i=p.default.cornerstone.metaData.get("imagePlaneModule",o.image.imageId);if(i){var s=t.currentPoints.image,l=Object(y.imagePointToPatientPoint)(s,i);a.data[0].synchronizationContext.getSourceElements().forEach(function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,a=Object(b.getToolState)(e,"stack");if(void 0!==a){var o=a.data[0];if(o.imageIds.forEach(function(e,a){var r=p.default.cornerstone.metaData.get("imagePlaneModule",e);if(r&&r.imagePositionPatient&&r.rowCosines&&r.columnCosines){var o=Object(x.default)(r.imagePositionPatient),i=Object(x.default)(r.rowCosines),s=Object(x.default)(r.columnCosines).clone().cross(i.clone()),u=Math.abs(s.clone().dot(o)-s.clone().dot(l));u<t&&(t=u,n=a)}}),n!==o.currentImageIdIndex&&-1!==n&&void 0!==o.imageIds[n]){var i=v.default.getStartLoadHandler(e),s=v.default.getEndLoadHandler(e),u=v.default.getErrorLoadingHandler(e);i&&i(e),(!0===o.preventCache?p.default.cornerstone.loadImage(o.imageIds[n]):p.default.cornerstone.loadAndCacheImage(o.imageIds[n])).then(function(t){var a=p.default.cornerstone.getViewport(e);o.currentImageIdIndex=n,p.default.cornerstone.displayImage(e,t,a),s&&s(e,t)},function(t){u&&u(e,o.imageIds[n],t)})}}}})}}}},{key:"activeCallback",value:function(e,t){var n=t.mouseButtonMask,a=t.synchronizationContext;Object(w.setToolOptions)(this.name,e,{mouseButtonMask:n}),Object(b.clearToolState)(e,this.name),Object(b.addToolState)(e,this.name,{synchronizationContext:a})}}]),t}(g.default)},"./tools/DoubleTapFitToWindowTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"doubleTapCallback",value:function(e){h.default.cornerstone.fitToWindow(e.detail.element)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/DragProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return _});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./tools/base/BaseTool.js"),v=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./util/getRGBPixels.js"),x=n("./util/calculateSUV.js"),w=n("./drawing/index.js"),j=n("./drawing/drawTextBox.js"),T=n("./tools/cursors/index.js"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"DragProbe",strategies:{default:E,minimal:O},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.probeCursor};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._movingEventCallback.bind(f()(e)),e.touchEndCallback=e._endMovingEventCallback.bind(f()(e)),e.mouseDragCallback=e._movingEventCallback.bind(f()(e)),e.mouseUpCallback=e._endMovingEventCallback.bind(f()(e)),e.dragEventData={},e}return m()(t,e),i()(t,[{key:"_movingEventCallback",value:function(e){var t=e.detail,n=t.element;this.dragEventData=t,g.default.cornerstone.updateImage(n)}},{key:"_endMovingEventCallback",value:function(e){var t=e.detail.element;this.dragEventData={},g.default.cornerstone.updateImage(t)}},{key:"renderToolData",value:function(e){this.dragEventData.currentPoints&&e&&e.detail&&Boolean(Object.keys(this.dragEventData.currentPoints).length)&&(e.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(e))}}]),t}(p.default);function E(e){var t=this.configuration,n=g.default.cornerstone,a=e.detail,r=a.element,o=a.image,i=a.currentPoints,s=a.canvasContext,l=Object(w.getNewContext)(s.canvas),u=b.default.getActiveColor(),d=v.default.getFontSize(),c=Math.round(i.image.x),f=Math.round(i.image.y);c<0||f<0||c>=o.columns||f>=o.rows||Object(w.draw)(l,function(e){Object(w.setShadow)(e,t);var a,s,l="".concat(c,", ").concat(f);if(o.color)a=Object(y.default)(r,c,f,1,1),s="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]," A: ").concat(a[3]);else{var h=(a=n.getStoredPixels(r,c,f,1,1))[0],m=h*o.slope+o.intercept,g=Object(x.default)(o,h);s="SP: ".concat(h," MO: ").concat(parseFloat(m.toFixed(3))),g&&(s+=" SUV: ".concat(parseFloat(g.toFixed(3))))}var p={x:i.canvas.x+5,y:i.canvas.y-5};Object(j.default)(e,s,p.x,p.y+d+5,u),Object(j.default)(e,l,p.x,p.y,u)})}function O(e){var t=this.configuration,n=g.default.cornerstone,a=e.detail,r=a.element,o=a.image,i=a.currentPoints,s=a.canvasContext,l=a.isTouchEvent,u=Object(w.getNewContext)(s.canvas),d=b.default.getActiveColor(),c=i.page.y-v.default.getFontSize()/2;l&&(c=i.page.y-4*v.default.getFontSize());var f=n.pageToPixel(r,i.page.x,c);f.x<0||f.y<0||f.x>=o.columns||f.y>=o.rows||Object(w.draw)(u,function(e){Object(w.setShadow)(e,t);var a,i=n.metaData.get("generalSeriesModule",o.imageId),s=i&&i.modality,u="";if(o.color)a=Object(y.default)(r,f.x,f.y,1,1),u="R: ".concat(a[0]," G: ").concat(a[1]," B: ").concat(a[2]);else{var c=(a=n.getStoredPixels(r,f.x,f.y,1,1))[0],h=parseFloat((c*o.slope+o.intercept).toFixed(2));if("CT"===s)u+="HU: ".concat(h);else if("PT"===s){u+=h;var m=Object(x.default)(o,c);m&&(u+=" SUV: ".concat(parseFloat(m.toFixed(2))))}else u+=h}var g=n.pixelToCanvas(r,f),p={x:12,y:-(v.default.getFontSize()+10)/2},b=Object(j.textBoxWidth)(e,u,5);l&&(p={x:-b/2,y:-v.default.getFontSize()-10-12}),Object(w.drawCircle)(e,r,g,6,{color:d},"canvas"),Object(j.default)(e,u,g.x+p.x,g.y+p.y,d)})}},"./tools/EraserTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./tools/base/BaseTool.js"),v=n("./stateManagement/toolState.js"),b=n("./store/index.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:y.eraserCursor};return(e=l()(this,d()(t).call(this,n,a))).preMouseDownCallback=e._deleteAllNearbyTools.bind(f()(e)),e.preTouchStartCallback=e._deleteAllNearbyTools.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_deleteAllNearbyTools",value:function(e){var t=e.detail.currentPoints.canvas,n=e.detail.element;return b.state.tools.forEach(function(e){var a=Object(v.getToolState)(n,e.name);a&&a.data.forEach(function(a){"function"==typeof e.pointNearTool&&e.pointNearTool(n,a,t)&&(Object(v.removeToolState)(n,e.name,a),g.default.cornerstone.updateImage(n))})}),!0}}]),t}(p.default)},"./tools/FreehandRoiSculptorTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./events.js"),p=n("./externalModules.js"),v=n("./stateManagement/toolColors.js"),b=n("./drawing/drawHandles.js"),y=n("./store/index.js"),x=n("./stateManagement/toolState.js"),w=n("./util/clip.js"),j=n("./store/getToolForElement.js"),T=n("./tools/base/BaseTool.js"),_=n("./store/setToolCursor.js"),E=n("./tools/cursors/index.js"),O=n("./util/freehand/index.js"),S=O.default.FreehandHandleData,C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"FreehandRoiSculptor",referencedToolName:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:I(),svgCursor:E.freehandRoiSculptorCursor};return(e=l()(this,d()(t).call(this,n,a))).updateOnMouseMove=!0,e.isMultiPartTool=!0,e.referencedToolName=e.initialConfiguration.referencedToolName,e._active=!1,e.activeMouseUpCallback=e.activeMouseUpCallback.bind(f()(e)),e.activeTouchEndCallback=e.activeTouchEndCallback.bind(f()(e)),e.activeMouseDragCallback=e.activeMouseDragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=e.detail;if(null===this.configuration.currentTool)return!1;var n=t.element,a=this.configuration;if(!Object(x.getToolState)(n,this.referencedToolName).data[a.currentTool])return!1;if(this._active){var r=t.canvasContext.canvas.getContext("2d"),o={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(b.default)(r,t,this.configuration.mouseLocation.handles,o)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(e)}},{key:"doubleClickCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),p.default.cornerstone.updateImage(t.element)}},{key:"doubleTapCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),p.default.cornerstone.updateImage(t.element)}},{key:"preTouchStartCallback",value:function(e){return this._initialiseSculpting(e),!0}},{key:"preMouseDownCallback",value:function(e){if(this.options.mouseButtonMask.includes(e.detail.buttons))return this._initialiseSculpting(e),!0}},{key:"activeMouseDragCallback",value:function(e){var t=this.configuration;if(this._active){var n=e.detail,a=Object(x.getToolState)(n.element,this.referencedToolName);if(a){var r=a.data[t.currentTool].handles.points;this._getMouseLocation(n),this._sculpt(n,r),p.default.cornerstone.updateImage(n.element)}}}},{key:"activeMouseUpCallback",value:function(e){this._activeEnd(e)}},{key:"activeTouchEndCallback",value:function(e){this._activeEnd(e),this._deselectAllTools(e),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function(e){var t=e.detail,n=t.element,a=this.configuration;this._active=!1,y.state.isMultiPartToolActive=!1,this._getMouseLocation(t),this._invalidateToolData(t),a.mouseUpRender=!0,this._deactivateSculpt(n),p.default.cornerstone.updateImage(t.element),function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}(e)}},{key:"_renderHoverCursor",value:function(e){var t,n=e.detail,a=n.element,r=n.canvasContext.canvas.getContext("2d"),o=Object(x.getToolState)(a,this.referencedToolName).data[this.configuration.currentTool];this._recentTouchEnd=!1,this.configuration.mouseUpRender?(t=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):t=y.state.mousePositionImage;var i=Object(j.default)(a,this.referencedToolName).distanceFromPointCanvas(a,o,t);if(this.configuration.mouseLocation.handles.start.x=t.x,this.configuration.mouseLocation.handles.start.y=t.y,this.configuration.limitRadiusOutsideRegion){var s=i;i=this._limitCursorRadiusCanvas(n,i),s>this.configuration.hoverCursorFadeDistance*i&&(r.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var l={fill:null,color:this.configuration.hoverColor,handleRadius:i};Object(b.default)(r,n,this.configuration.mouseLocation.handles,l),this.configuration.limitRadiusOutsideRegion&&(r.globalAlpha=1)}},{key:"newImageCallback",value:function(e){this._deselectAllTools(e)}},{key:"enabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"passiveCallback",value:function(e){this._deselectAllTools(e)}},{key:"disabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"_selectFreehandTool",value:function(e){var t=this.configuration,n=e.element,a=this._getClosestFreehandToolOnElement(n,e);void 0!==a&&(t.currentTool=a,Object(_.hideToolCursor)(n))}},{key:"_activateFreehandTool",value:function(e,t){var n=Object(x.getToolState)(e,this.referencedToolName).data;this.configuration.currentTool=t;for(var a=0;a<n.length;a++)n[a].active=a===t}},{key:"_initialiseSculpting",value:function(e){var t=e.detail,n=this.configuration,a=t.element;null===n.currentTool&&(this._selectFreehandTool(t),null===n.currentTool)||(this._active=!0,y.state.isMultiPartToolActive=!0,this._configureToolSize(t),this._getMouseLocation(t),this._activateFreehandTool(a,n.currentTool),this._activateSculpt(a),p.default.cornerstone.updateImage(t.element))}},{key:"_sculpt",value:function(e,t){var n=this.configuration;this._sculptData={element:e.element,image:e.image,mousePoint:e.currentPoints.image,points:t,toolSize:this._toolSizeImage,minSpacing:n.minSpacing,maxSpacing:Math.max(this._toolSizeImage,2*n.minSpacing)};var a=this._pushHandles();void 0!==a.first&&(this._insertNewHandles(a),this._consolidateHandles())}},{key:"_pushHandles",value:function(){for(var e=this._sculptData,t=e.points,n=e.mousePoint,a=e.toolSize,r={},o=0;o<t.length;o++){var i=p.default.cornerstoneMath.point.distance(t[o],n);i>a||(this._pushOneHandle(o,i),void 0===r.first?(r.first=o,r.last=o):r.last=o)}return r}},{key:"_pushOneHandle",value:function(e,t){var n=this._sculptData,a=n.points,r=n.mousePoint,o=n.toolSize,i=n.image,s=a[e],l={x:r.x+o*((s.x-r.x)/t),y:r.y+o*((s.y-r.y)/t)};Object(w.clipToBox)(l,i),s.x=l.x,s.y=l.y;var u=this.constructor._getPreviousHandleIndex(e,a.length);a[u].lines.pop(),a[u].lines.push(s)}},{key:"_insertNewHandles",value:function(e){for(var t=this._findNewHandleIndicies(e),n=0,a=0;a<t.length;a++)this._insertHandleRadially(t[a]+1+n),n++}},{key:"_findNewHandleIndicies",value:function(e){for(var t=this._sculptData,n=t.points,a=t.maxSpacing,r=[],o=e.first;o<=e.last;o++)this._checkSpacing(o,n,r,a);var i=this.constructor._getNextHandleIndex(e.last,n.length);if(i!==e.first){this._checkSpacing(i,n,r,a);var s=this.constructor._getPreviousHandleIndex(e.first,n.length);s!==i&&this._checkSpacing(s,n,r,a)}return r}},{key:"_checkSpacing",value:function(e,t,n,a){var r=this.constructor._getNextHandleIndex(e,t.length);p.default.cornerstoneMath.point.distance(t[e],t[r])>a&&n.push(e)}},{key:"_insertHandleRadially",value:function(e){var t=this._sculptData.points,n=e-1,a=this.constructor._getNextHandleIndexBeforeInsert(e,t.length),r=this._getInsertPosition(e,n,a),o=new S(r);t.splice(e,0,o),t[n].lines.pop(),t[n].lines.push(t[e]),O.default.addLine(t,e)}},{key:"_consolidateHandles",value:function(){if(!(this._sculptData.points.length<=3)){var e=this._findCloseHandlePairs();this._mergeCloseHandles(e)}}},{key:"_findCloseHandlePairs",value:function(){for(var e=this._sculptData,t=e.points,n=e.minSpacing,a=[],r=t.length,o=0;o<r;o++){var i=this.constructor._getNextHandleIndex(o,t.length);p.default.cornerstoneMath.point.distance(t[o],t[i])<n&&(a.push([o,i]),0===o&&(r-=1),o++)}return a}},{key:"_mergeCloseHandles",value:function(e){for(var t=0,n=0;n<e.length;n++){var a=this.constructor._getCorrectedPair(e[n],t);this._combineHandles(a),t++}var r=this._findCloseHandlePairs();r.length&&this._mergeCloseHandles(r)}},{key:"_combineHandles",value:function(e){var t=this._sculptData,n=t.points,a=t.image,r={x:(n[e[0]].x+n[e[1]].x)/2,y:(n[e[0]].y+n[e[1]].y)/2};Object(w.clipToBox)(r,a),n[e[0]].x=r.x,n[e[0]].y=r.y;var o=this.constructor._getNextHandleIndex(e[1],n.length);n[e[0]].lines.pop(),n[e[0]].lines.push(n[o]),n.splice(e[1],1)}},{key:"_configureToolSize",value:function(e){var t=e.element,n=this.configuration,a=n.currentTool,r=e.currentPoints.image,o=Object(x.getToolState)(t,this.referencedToolName).data[a],i=Object(j.default)(t,this.referencedToolName),s=i.distanceFromPoint(t,o,r),l=i.distanceFromPointCanvas(t,o,r);n.limitRadiusOutsideRegion&&(s=this._limitCursorRadiusImage(e,s),l=this._limitCursorRadiusCanvas(e,l)),this._toolSizeImage=s,this._toolSizeCanvas=l}},{key:"_getMouseLocation",value:function(e){var t=this.configuration;t.mouseLocation.handles.start.x=e.currentPoints.image.x,t.mouseLocation.handles.start.y=e.currentPoints.image.y,Object(w.clipToBox)(t.mouseLocation.handles.start,e.image)}},{key:"_activateSculpt",value:function(e){this._deactivateSculpt(e),e.addEventListener(g.default.MOUSE_UP,this.activeMouseUpCallback),e.addEventListener(g.default.MOUSE_CLICK,this.activeMouseUpCallback),e.addEventListener(g.default.MOUSE_DRAG,this.activeMouseDragCallback),e.addEventListener(g.default.TOUCH_END,this.activeTouchEndCallback),e.addEventListener(g.default.TOUCH_TAP,this.activeTouchEndCallback),e.addEventListener(g.default.TOUCH_DRAG,this.activeMouseDragCallback),p.default.cornerstone.updateImage(e)}},{key:"_deactivateSculpt",value:function(e){e.removeEventListener(g.default.MOUSE_UP,this.activeMouseUpCallback),e.removeEventListener(g.default.MOUSE_CLICK,this.activeMouseUpCallback),e.removeEventListener(g.default.MOUSE_DRAG,this.activeMouseDragCallback),e.removeEventListener(g.default.TOUCH_END,this.activeTouchEndCallback),e.removeEventListener(g.default.TOUCH_TAP,this.activeTouchEndCallback),e.removeEventListener(g.default.TOUCH_DRAG,this.activeMouseDragCallback),p.default.cornerstone.updateImage(e)}},{key:"_invalidateToolData",value:function(e){var t=this.configuration,n=e.element;Object(x.getToolState)(n,this.referencedToolName).data[t.currentTool].invalidated=!0}},{key:"_deselectAllTools",value:function(e){var t=this.configuration,n=Object(x.getToolState)(this.element,this.referencedToolName);if(t.currentTool=null,n)for(var a=0;a<n.data.length;a++)n.data[a].active=!1;Object(_.setToolCursor)(this.element,this.svgCursor),p.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function(e,t){return this._limitCursorRadius(e,t,!0)}},{key:"_limitCursorRadiusImage",value:function(e,t){return this._limitCursorRadius(e,t,!1)}},{key:"_limitCursorRadius",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.element,r=e.image,o=this.configuration,i=Object(x.getToolState)(a,this.referencedToolName),s=i.data[o.currentTool],l=1;if(n){var u=p.default.cornerstone.pixelToCanvas(a,{x:0,y:0}),d=p.default.cornerstone.pixelToCanvas(a,{x:r.width,y:r.height}),c=(d.x-u.x)*(d.y-u.y);l=c/(r.width*r.height)}var f=s.area*l,h=Math.pow(f/Math.PI,.5);return Math.min(t,h)}},{key:"_getClosestFreehandToolOnElement",value:function(e,t){var n=Object(j.default)(e,this.referencedToolName),a=Object(x.getToolState)(e,this.referencedToolName);if(a){for(var r=a.data,o=t.currentPoints.image,i={distance:1/0,toolIndex:null},s=0;s<r.length;s++){var l=n.distanceFromPoint(e,r[s],o);-1!==l&&l<i.distance&&(i.distance=l,i.toolIndex=s)}return i.toolIndex}}},{key:"_getInsertPosition",value:function(e,t,n){var a,r=this._sculptData,o=r.points,i=r.toolSize,s=r.mousePoint,l=r.image,u={x:(o[t].x+o[n].x)/2,y:(o[t].y+o[n].y)/2},d=p.default.cornerstoneMath.point.distance(s,u);if(d<i){var c={x:(u.x-s.x)/d,y:(u.y-s.y)/d};a={x:s.x+i*c.x,y:s.y+i*c.y}}else a=u;return Object(w.clipToBox)(a,l),a}},{key:"minSpacing",get:function(){return this.configuration.minSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=e}},{key:"maxSpacing",get:function(){return this.configuration.maxSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=e}},{key:"showCursorOnHover",get:function(){return this.configuration.showCursorOnHover},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=e,p.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function(){return this.configuration.limitRadiusOutsideRegion},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=e,p.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function(){return this.configuration.hoverCursorFadeAlpha},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");e=Math.max(Math.min(e,1),0),this.configuration.hoverCursorFadeAlpha=e,p.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function(){return this.configuration.hoverCursorFadeDistance},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");e=Math.max(e,1),this.configuration.hoverCursorFadeDistance=e,p.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function(e,t){var n=[e[0]-t,e[1]-t];return n[1]<0&&(n[1]=0),n}},{key:"_getNextHandleIndex",value:function(e,t){return e===t-1?0:e+1}},{key:"_getPreviousHandleIndex",value:function(e,t){return 0===e?t-1:e-1}},{key:"_getNextHandleIndexBeforeInsert",value:function(e,t){return e===t?0:e}}]),t}(T.default);function I(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:v.default.getActiveColor(),hoverColor:v.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2}}},"./tools/MagnifyTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./drawing/index.js"),v=n("./tools/base/BaseTool.js"),b=n("./store/setToolCursor.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:y.magnifyCursor};return(e=l()(this,d()(t).call(this,n,a))).zoomCanvas=void 0,e.zoomElement=void 0,e.activeCallback=e._createMagnificationCanvas.bind(f()(e)),e.enabledCallback=e._createMagnificationCanvas.bind(f()(e)),e.disabledCallback=e._destroyMagnificationCanvas.bind(f()(e)),e.postTouchStartCallback=e._addMagnifyingGlass.bind(f()(e)),e.touchDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.touchEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.touchDragEndCallback=e._removeMagnifyingGlass.bind(f()(e)),e.postMouseDownCallback=e._addMagnifyingGlass.bind(f()(e)),e.mouseDragCallback=e._updateMagnifyingGlass.bind(f()(e)),e.mouseUpCallback=e._removeMagnifyingGlass.bind(f()(e)),e.mouseClickCallback=e._removeMagnifyingGlass.bind(f()(e)),e.newImageCallback=e._drawMagnificationTool.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_addMagnifyingGlass",value:function(e){var t=this;this._removeZoomElement(),this._drawZoomedElement(e),window.requestAnimationFrame(function(){return t._drawMagnificationTool(e)}),Object(b.hideToolCursor)(e.detail.element),e.preventDefault(),e.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function(e){this._drawMagnificationTool(e),e.preventDefault(),e.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function(e){var t=e.detail.element;Object(b.setToolCursor)(this.element,this.svgCursor),t.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function(e){var t=e.detail.element,n=t.querySelector(".magnifyTool");if(n||this._createMagnificationCanvas(t),void 0!==this.zoomCanvas){var a=t.querySelector("canvas:not(.magnifyTool)"),r=Object(p.getNewContext)(n),o=g.default.cornerstone.pixelToCanvas(e.detail.element,e.detail.currentPoints.image),i=Math.min(this.configuration.magnifySize,a.width,a.height),s=this.configuration.magnificationLevel;n.width=i,n.height=i,o.x=Math.max(o.x,.5*i/s),o.x=Math.min(o.x,a.width-.5*i/s),o.y=Math.max(o.y,.5*i/s),o.y=Math.min(o.y,a.height-.5*i/s);var l={x:o.x*s-.5*i,y:o.y*s-.5*i};l.x=Math.max(l.x,0),l.y=Math.max(l.y,0),r.drawImage(this.zoomCanvas,l.x,l.y,i,i,0,0,i,i);var u={top:Math.max(o.y-.5*i-(e.detail.isTouchEvent?120:0),0),left:Math.max(o.x-.5*i,0)},d=n.getBoundingClientRect();u.top=Math.min(u.top,a.height-d.height),u.left=Math.min(u.left,a.width-d.width),n.style.top="".concat(u.top,"px"),n.style.left="".concat(u.left,"px"),n.style.display="block"}}},{key:"_drawZoomedElement",value:function(e){var t=e.detail.enabledElement;void 0===t&&(t=g.default.cornerstone.getEnabledElement(e.detail.element));var n=this.configuration.magnificationLevel,a=t.canvas,r=t.image;this.zoomElement||(this.zoomElement=document.createElement("div"),this.zoomElement.width=a.width*n,this.zoomElement.height=a.height*n,g.default.cornerstone.enable(this.zoomElement,t.options));var o=g.default.cornerstone.getEnabledElement(this.zoomElement),i=g.default.cornerstone.getViewport(t.element);this.zoomCanvas=o.canvas,this.zoomCanvas.width=a.width*n,this.zoomCanvas.height=a.height*n,o.viewport=Object.assign({},i),i.scale*=n,g.default.cornerstone.displayImage(this.zoomElement,r),g.default.cornerstone.setViewport(this.zoomElement,i)}},{key:"_removeZoomElement",value:function(){void 0!==this.zoomElement&&(g.default.cornerstone.disable(this.zoomElement),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function(e){if(null===e.querySelector(".magnifyTool")){var t=document.createElement("canvas");t.classList.add("magnifyTool"),t.width=this.configuration.magnifySize,t.height=this.configuration.magnifySize,t.style.position="absolute",t.style.display="none",e.appendChild(t)}}},{key:"_destroyMagnificationCanvas",value:function(e){var t=e.querySelector(".magnifyTool");t&&e.removeChild(t)}}]),t}(v.default)},"./tools/OrientationMarkersTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return y});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./orientation/index.js"),p=n("./drawing/index.js"),v=n("./stateManagement/toolColors.js"),b=n("./drawing/drawTextBox.js"),y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"OrientationMarkers",configuration:{drawAllMarkers:!0},mixins:["enabledOrDisabledBinaryTool"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){var t=h.default.cornerstone;t.getEnabledElement(e).image&&t.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(p.getNewContext)(t.canvasContext.canvas),a=t.element,r=j(a);if(r){var o=T(a,r),i=v.default.getToolColor(),s={top:Object(b.textBoxWidth)(n,r.top,0),left:Object(b.textBoxWidth)(n,r.left,0),right:Object(b.textBoxWidth)(n,r.right,0),bottom:Object(b.textBoxWidth)(n,r.bottom,0),height:Object(b.textBoxWidth)(n,"M",0)};x(n,r,o,s,i),this.configuration.drawAllMarkers&&w(n,r,o,s,i)}}}]),t}(m.default),x=function(e,t,n,a,r){Object(b.default)(e,t.top,n.top.x-a.top/2,n.top.y,r),Object(b.default)(e,t.left,n.left.x-a.left/2,n.left.y,r)},w=function(e,t,n,a,r){Object(b.default)(e,t.right,n.right.x-a.right,n.right.y,r),Object(b.default)(e,t.bottom,n.bottom.x-a.bottom/2,n.bottom.y-a.height,r)},j=function(e){var t=h.default.cornerstone,n=t.getEnabledElement(e),a=t.metaData.get("imagePlaneModule",n.image.imageId);if(a&&a.rowCosines&&a.columnCosines){var r=g.default.getOrientationString(a.rowCosines),o=g.default.getOrientationString(a.columnCosines),i=g.default.invertOrientationString(r);return{top:g.default.invertOrientationString(o),bottom:o,left:i,right:r}}},T=function(e){var t=h.default.cornerstone.getEnabledElement(e);return{top:h.default.cornerstone.pixelToCanvas(e,{x:t.image.width/2,y:5}),bottom:h.default.cornerstone.pixelToCanvas(e,{x:t.image.width/2,y:t.image.height-15}),left:h.default.cornerstone.pixelToCanvas(e,{x:5,y:t.image.height/2}),right:h.default.cornerstone.pixelToCanvas(e,{x:t.image.width-10,y:t.image.height/2})}}},"./tools/OverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Overlay",configuration:{},mixins:["enabledOrDisabledBinaryTool"]},o=Object.assign(a,n);return(e=l()(this,d()(t).call(this,o))).initialConfiguration=o,e}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){h.default.cornerstone.getEnabledElement(e).image&&h.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=t.image,a=t.viewport,r=t.canvasContext;if(t&&t.enabledElement&&n){var o=h.default.cornerstone.metaData.get("overlayPlaneModule",n.imageId);if(o&&o.overlays&&o.overlays.length){var i=a.displayedArea.columnPixelSpacing||1,s=a.displayedArea.rowPixelSpacing||1,l=Math.abs(a.displayedArea.brhc.x-a.displayedArea.tlhc.x)*i,u=Math.abs(a.displayedArea.brhc.y-a.displayedArea.tlhc.y)*s;o.overlays.forEach(function(e){if(!1!==e.visible){var t=document.createElement("canvas");t.width=l,t.height=u;var n=t.getContext("2d");n.fillStyle=e.fillStyle||"white","R"===e.type&&(n.fillRect(0,0,t.width,t.height),n.globalCompositeOperation="xor");for(var a=0,o=0;o<e.rows;o++)for(var i=0;i<e.columns;i++)e.pixelData[a++]>0&&n.fillRect(i,o,1,1);var s=!isNaN(parseFloat(e.x))&&isFinite(e.x)?e.x:0,d=!isNaN(parseFloat(e.y))&&isFinite(e.y)?e.y:0;r.drawImage(t,s,d)}})}}}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}};return(e=l()(this,d()(t).call(this,n,a))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport;if(t.numPointers===this.configuration.touchPointers){var r=this._getTranslation(t);this._applyTranslation(a,r),g.default.cornerstone.setViewport(n,a)}}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,r=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?r*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/r,y:a.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return b});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./tools/base/BaseTool.js"),v=n("./tools/cursors/index.js"),b=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:v.panCursor};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._dragCallback.bind(f()(e)),e.mouseDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=this._getTranslation(t);this._applyTranslation(a,r),g.default.cornerstone.setViewport(n,a)}},{key:"_getTranslation",value:function(e){var t=e.viewport,n=e.image,a=e.deltaPoints,r=t.scale,o=t.scale;return n.rowPixelSpacing<n.columnPixelSpacing?r*=n.columnPixelSpacing/n.rowPixelSpacing:n.columnPixelSpacing<n.rowPixelSpacing&&(o*=n.rowPixelSpacing/n.columnPixelSpacing),{x:a.page.x/r,y:a.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(p.default)},"./tools/ReferenceLinesTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return _});var a=n("../node_modules/@babel/runtime/regenerator/index.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/createClass.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),g=n("../node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(g),v=n("./externalModules.js"),b=n("./tools/base/BaseTool.js"),y=n("./drawing/index.js"),x=n("./tools/referenceLines/renderActiveReferenceLine.js"),w=n("./util/wait.js"),j=n("./util/logger.js"),T=Object(j.getLogger)("tools:ReferenceLinesTool"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l()(this,t);var a={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:x.default}};return(e=f()(this,m()(t).call(this,n,a))).renderer=null,e.synchronizationContext=null,e}var n;return p()(t,e),d()(t,[{key:"enabledCallback",value:(n=i()(r.a.mark(function e(t){var n,a,o=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(o.length>1&&void 0!==o[1]?o[1]:{}).synchronizationContext,a=this.configuration.renderer,e.next=4,Object(w.waitForEnabledElementImageToLoad)(t);case 4:if(e.sent&&a&&n){e.next=8;break}return T.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),e.abrupt("return");case 8:this.renderer=a,this.synchronizationContext=n,this.forceImageUpdate(t);case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){v.default.cornerstone.getEnabledElement(e).image&&v.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail;if(this.renderer&&this.synchronizationContext){var a=this.synchronizationContext.getSourceElements(),r=Object(y.getNewContext)(n.canvasContext.canvas);v.default.cornerstone.setToPixelCoordinateSystem(n.enabledElement,r),a.forEach(function(a){a!==e.currentTarget&&t.renderer(r,n,e.currentTarget,a)})}}}]),t}(b.default)},"./tools/RotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./util/angleBetweenPoints.js"),p=n("./tools/cursors/index.js"),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"Rotate",strategies:{default:b,horizontal:y,vertical:x},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{roundAngles:!1,flipHorizontal:!1,flipVertical:!1,rotateScale:1},svgCursor:p.rotateCursor};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){this.dragCallback(e)}},{key:"mouseDragCallback",value:function(e){this.dragCallback(e)}},{key:"postMouseDownCallback",value:function(e){this.initialRotation=e.detail.viewport.rotation}},{key:"dragCallback",value:function(e){e.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(e),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(m.default);function b(e){var t=this.configuration,n=t.roundAngles,a=t.rotateScale,r=e.detail,o=r.element,i=r.viewport,s=r.startPoints,l=r.currentPoints,u=i.initialRotation,d=o.getBoundingClientRect(o),c=i.scale,f=i.translation,h={x:d.left+o.clientWidth/2+f.x*c,y:d.top+o.clientHeight/2+f.y*c},m=Object(g.default)(h,s.client,l.client);m.angle*=a,n&&(m.angle=Math.ceil(m.angle)),m.direction<0&&(m.angle=-m.angle),i.rotation=u+m.angle}function y(e){var t=this.configuration,n=t.flipHorizontal,a=e.detail,r=a.viewport,o=r.initialRotation,i=(a.currentPoints.client.x-a.startPoints.client.x)*t.rotateScale;t.roundAngles&&(i=Math.round(Math.abs(i))*(i>0?1:-1)),n&&(i=-i),r.rotation=o+i}function x(e){var t=this.configuration,n=t.flipVertical,a=e.detail,r=a.viewport,o=r.initialRotation,i=(a.currentPoints.client.y-a.startPoints.client.y)*t.rotateScale;t.roundAngles&&(i=Math.round(Math.abs(i))*(i>0?1:-1)),n&&(i=-i),r.rotation=o+i}},"./tools/RotateTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchRotateCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport;a.rotation+=t.rotation,h.default.cornerstone.setViewport(n,a)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/ScaleOverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./drawing/index.js"),p=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),b=n("./util/logger.js"),y=Object(b.getLogger)("tools:ScaleOverlayTool"),x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"enabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"disabledCallback",value:function(e){this.forceImageUpdate(e)}},{key:"forceImageUpdate",value:function(e){h.default.cornerstone.getEnabledElement(e).image&&h.default.cornerstone.updateImage(e)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(g.getNewContext)(t.canvasContext.canvas),a=t.image,r=t.viewport,o=t.element,i=a.rowPixelSpacing,s=a.columnPixelSpacing,l=h.default.cornerstone.metaData.get("imagePlaneModule",a.imageId);if(l&&(i=l.rowPixelSpacing||l.rowImagePixelSpacing,s=l.columnPixelSpacing||l.colImagePixelSpacing),i&&s){var u={width:n.canvas.width,height:n.canvas.height},d=10/i*r.scale,c=10/s*r.scale,f=w(u,.25,.05),m=w(u,.05,.15);if(u.width&&u.height&&f&&m){var b=v.default.getToolColor(),x=p.default.getToolWidth(),_=Object.assign({},{hscaleBounds:f,vscaleBounds:m,verticalMinorTick:d,horizontalMinorTick:c,verticalLine:{start:{x:m.bottomRight.x,y:m.topLeft.y},end:{x:m.bottomRight.x,y:m.bottomRight.y}},horizontalLine:{start:{x:f.topLeft.x,y:f.bottomRight.y},end:{x:f.bottomRight.x,y:f.bottomRight.y}},color:b,lineWidth:x},this.configuration);Object(g.draw)(n,function(e){Object(g.setShadow)(e,_),Object(g.drawLine)(e,o,_.verticalLine.start,_.verticalLine.end,{color:_.color,lineWidth:_.lineWidth},"canvas"),j(e,o,_),Object(g.drawLine)(e,o,_.horizontalLine.start,_.horizontalLine.end,{color:_.color,lineWidth:_.lineWidth},"canvas"),T(e,o,_)})}}else y.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"))}}]),t}(m.default),w=function(e,t,n){var a=t*Math.min(1e3,e.width),r=n*Math.min(1e3,e.height),o={left:a,top:r,width:e.width-2*a,height:e.height-2*r};return{topLeft:{x:o.left,y:o.top},bottomRight:{x:o.left+o.width,y:o.top+o.height}}},j=function(e,t,n){for(var a=0;n.verticalLine.start.y+a*n.verticalMinorTick<=n.vscaleBounds.bottomRight.y;){var r=n.color,o=n.lineWidth,i={x:n.verticalLine.start.x,y:n.verticalLine.start.y+a*n.verticalMinorTick},s={x:0,y:n.verticalLine.start.y+a*n.verticalMinorTick};s.x=a%5==0?n.verticalLine.start.x-n.majorTickLength:n.verticalLine.start.x-n.minorTickLength,Object(g.drawLine)(e,t,i,s,{color:r,lineWidth:o},"canvas"),a++}},T=function(e,t,n){for(var a=0;n.horizontalLine.start.x+a*n.horizontalMinorTick<=n.hscaleBounds.bottomRight.x;){var r=n.color,o=n.lineWidth,i={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:n.horizontalLine.start.y},s={x:n.horizontalLine.start.x+a*n.horizontalMinorTick,y:0};s.y=a%5==0?n.horizontalLine.start.y-n.majorTickLength:n.horizontalLine.start.y-n.minorTickLength,Object(g.drawLine)(e,t,i,s,{color:r,lineWidth:o},"canvas"),a++}}},"./tools/StackScrollMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return g});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./tools/base/BaseTool.js"),m=n("./util/scroll.js"),g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.direction,a=t.element,r=this.configuration,o=r.loop,i=r.allowSkipping,s=r.invert?-n:n;Object(m.default)(a,s,o,i)}}]),t}(h.default)},"./tools/StackScrollMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return y});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./tools/base/BaseTool.js"),p=n("./util/scroll.js"),v=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}};return(e=l()(this,d()(t).call(this,n,a))).multiTouchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail;if(t.numPointers===this.configuration.touchPointers){var n=t.element,a=t.deltaPoints,r=this.configuration,o=r.loop,i=r.allowSkipping,s=Object(b.getToolOptions)(this.name,n),l=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(!l)return;if(Math.abs(u)>=l){var d=Math.round(u/l);Object(p.default)(n,d,o,i),s.deltaY=u%l}else s.deltaY=u;Object(b.setToolOptions)(this.name,n,s)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(v.getToolState)(e,"stack");if(t&&t.data&&t.data.length)return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(t.data[0].imageIds.length,8))}}]),t}(g.default)},"./tools/StackScrollTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./tools/base/BaseTool.js"),p=n("./util/scroll.js"),v=n("./stateManagement/toolState.js"),b=n("./toolOptions.js"),y=n("./tools/cursors/index.js"),x=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:y.stackScrollCursor};return(e=l()(this,d()(t).call(this,n,a))).mouseDragCallback=e._dragCallback.bind(f()(e)),e.touchDragCallback=e._dragCallback.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,n=t.element,a=t.deltaPoints,r=this.configuration,o=r.loop,i=r.allowSkipping,s=Object(b.getToolOptions)(this.name,n),l=this._getPixelPerImage(n),u=this._getDeltaY(n,a.page.y);if(l){if(Math.abs(u)>=l){var d=Math.round(u/l);Object(p.default)(n,d,o,i),s.deltaY=u%l}else s.deltaY=u;Object(b.setToolOptions)(this.name,n,s)}}},{key:"_getDeltaY",value:function(e,t){return(Object(b.getToolOptions)(this.name,e).deltaY||0)+t}},{key:"_getPixelPerImage",value:function(e){var t=Object(v.getToolState)(e,"stack");if(t&&t.data&&t.data.length)return this.configuration.stackScrollSpeed||Math.max(2,e.offsetHeight/Math.max(t.data[0].imageIds.length,8))}}]),t}(g.default)},"./tools/WwwcRegionTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return j});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./tools/base/BaseTool.js"),v=n("./drawing/index.js"),b=n("./util/clip.js"),y=n("./util/getLuminance.js"),x=n("./stateManagement/toolColors.js"),w=n("./tools/cursors/index.js"),j=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:w.wwwcRegionCursor};return(e=l()(this,d()(t).call(this,n,a)))._resetHandles(),e.postTouchStartCallback=e._startOutliningRegion.bind(f()(e)),e.touchDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.touchEndCallback=e._applyStrategy.bind(f()(e)),e.postMouseDownCallback=e._startOutliningRegion.bind(f()(e)),e.mouseClickCallback=e._startOutliningRegion.bind(f()(e)),e.mouseDragCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseMoveCallback=e._setHandlesAndUpdate.bind(f()(e)),e.mouseUpCallback=e._applyStrategy.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,r=x.default.getColorIfActive({active:!0}),o=Object(v.getNewContext)(n.canvasContext.canvas);Object(v.draw)(o,function(e){Object(v.drawRect)(e,a,t.handles.start,t.handles.end,{color:r})})}},{key:"_startOutliningRegion",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.image;return T(this.handles.start)?this.handles.start=n:(this.handles.end=n,this._applyStrategy(e)),g.default.cornerstone.updateImage(t),!0}},{key:"_setHandlesAndUpdate",value:function(e){var t=e.detail.element;this.handles.end=e.detail.currentPoints.image,g.default.cornerstone.updateImage(t)}},{key:"_applyStrategy",value:function(e){T(this.handles.start)||T(this.handles.end)||(e.detail.handles=this.handles,_(e,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function(){this.handles={start:{},end:{}}}}]),t}(p.default),T=function(e){return 0===Object.keys(e).length&&e.constructor===Object},_=function(e,t){var n=e.detail,a=n.image,r=n.element,o=e.detail.handles,i=o.start,s=o.end,l=Math.min(i.x,s.x),u=Math.min(i.y,s.y),d=Math.abs(i.x-s.x),c=Math.abs(i.y-s.y);l=Object(b.default)(l,0,a.width),u=Object(b.default)(u,0,a.height),d=Math.floor(Math.min(d,Math.abs(a.width-l))),c=Math.floor(Math.min(c,Math.abs(a.height-u)));var f=Object(y.default)(r,l,u,d,c),h=E(f,a.minPixelValue,a.maxPixelValue),m=n.viewport;void 0===t.minWindowWidth&&(t.minWindowWidth=10),m.voi.windowWidth=Math.max(Math.abs(h.max-h.min),t.minWindowWidth),m.voi.windowCenter=h.mean,m.voiLUT=void 0,g.default.cornerstone.setViewport(r,m),g.default.cornerstone.updateImage(r)},E=function(e,t,n){var a=e.length,r=n,o=t,i=0;if(a<2)return{min:r,max:o,mean:(t+n)/2};for(var s=0;s<a;s++){var l=e[s];r=Math.min(r,l),o=Math.max(o,l),i+=l}return{min:r,max:o,mean:i/a}}},"./tools/WwwcTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./tools/cursors/index.js"),p=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"Wwwc",strategies:{basicLevelingStrategy:v},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:g.wwwcCursor};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseDragCallback",value:function(e){this.applyActiveStrategy(e),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}},{key:"touchDragCallback",value:function(e){e.stopImmediatePropagation(),this.applyActiveStrategy(e),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(m.default);function v(e){var t=e.detail,n=(t.image.maxPixelValue*t.image.slope+t.image.intercept-(t.image.minPixelValue*t.image.slope+t.image.intercept))/1024,a=t.deltaPoints.page.x*n,r=t.deltaPoints.page.y*n;0===this.configuration.orientation?(t.viewport.voi.windowWidth+=a,t.viewport.voi.windowCenter+=r):(t.viewport.voi.windowWidth+=r,t.viewport.voi.windowCenter+=a),t.viewport.voiLUT=void 0}},"./tools/ZoomMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./util/zoom/index.js"),p=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=t.spinY,o=this.configuration,i=o.maxScale,s=o.minScale,l=o.invert?r/4:-r/4,u=Object(g.changeViewportScale)(a,l,{maxScale:i,minScale:s});h.default.cornerstone.setViewport(n,u)}}]),t}(m.default)},"./tools/ZoomTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./util/clip.js"),p=n("./util/zoom/index.js"),v=n("./tools/cursors/index.js"),b=p.default.correctShift,y=p.default.changeViewportScale,x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"Zoom",strategies:{default:j,translate:T,zoomToCenter:_},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:v.zoomCursor};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchDragCallback",value:function(e){w.call(this,e)}},{key:"mouseDragCallback",value:function(e){w.call(this,e)}}]),t}(m.default),w=function(e){if(!e.detail.deltaPoints.page.y)return!1;this.applyActiveStrategy(e,this.configuration),h.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)};function j(e){var t=this.configuration,n=e.detail.deltaPoints.page.y,a=e.detail,r=a.element,o=a.viewport,i=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],s=i[0],l=i[1],u=i[2],d=i[3],c=y(o,t.invert?-n/100:n/100,{maxScale:t.maxScale,minScale:t.minScale});h.default.cornerstone.setViewport(r,c);var f=h.default.cornerstone.pageToPixel(r,s,l),m={x:u-f.x,y:d-f.y};m=b(m,c),o.translation.x-=m.x,o.translation.y-=m.y}function T(e){var t=this.configuration,n=t.preventZoomOutsideImage,a=e.detail.deltaPoints.page.y,r=t.invert?-a/100:a/100,o=e.detail.image,i=[e.detail.startPoints.image.x,e.detail.startPoints.image.y],s=i[0],l=i[1],u=y(e.detail.viewport,r,{maxScale:t.maxScale,minScale:t.minScale}),d={x:0,y:0},c=.01;if(r<0)u.scale<3&&(Math.abs(u.translation.x)<c?u.translation.x=0:d.x=u.translation.x/8,Math.abs(u.translation.y)<c?u.translation.y=0:d.y=u.translation.y/8);else{n&&Object(g.clipToBox)(e.detail.startPoints.image,o);var f={x:o.width/2-s,y:o.height/2-l};f=b(f,u);var h={x:u.translation.x-f.x,y:u.translation.y-f.y};Math.abs(h.x)<c?u.translation.x=f.x:d.x=h.x/8,Math.abs(h.y)<c?u.translation.y=f.y:d.y=h.y/8}u.translation.x-=d.x,u.translation.y-=d.y}function _(e){var t=this.configuration,n=e.detail.deltaPoints.page.y;y(e.detail.viewport,t.invert?-n/100:n/100,{maxScale:t.maxScale,minScale:t.minScale})}},"./tools/ZoomTouchPinchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return p});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseTool.js"),g=n("./util/zoom/index.js").default.correctShift,p=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}};return l()(this,d()(t).call(this,e,n))}return f()(t,e),i()(t,[{key:"touchPinchCallback",value:function(e){var t=e.detail,n=t.element,a=t.viewport,r=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],o=r[0],i=r[1],s=r[2],l=r[3],u=this.configuration,d=u.maxScale,c=u.minScale;a.scale+=t.scaleChange*a.scale,d&&a.scale>d?a.scale=d:c&&a.scale<c&&(a.scale=c),h.default.cornerstone.setViewport(n,a);var f=h.default.cornerstone.pageToPixel(n,o,i),m={x:s-f.x,y:l-f.y};m=g(m,a),a.translation.x-=m.x,a.translation.y-=m.y,h.default.cornerstone.setViewport(n,a)}}]),t}(m.default)},"./tools/annotation/AngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return P});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),b=n("./manipulators/index.js"),y=n("./drawing/index.js"),x=n("./drawing/drawLinkedTextBox.js"),w=n("./drawing/drawTextBox.js"),j=n("./drawing/drawHandles.js"),T=n("./util/lineSegDistance.js"),_=n("./util/roundToDecimal.js"),E=n("./tools/cursors/index.js"),O=n("./util/triggerEvent.js"),S=n("./events.js"),C=n("./util/getPixelSpacing.js"),I=n("./util/throttle.js"),M=n("./store/index.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:E.angleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e.throttledUpdateCachedStats=Object(I.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&(Object(T.default)(e,t.handles.start,t.handles.middle,n)<25||Object(T.default)(e,t.handles.middle,t.handles.end,n)<25)}},{key:"updateCachedStats",value:function(e,t,n){var a=k(e,n.handles.middle,n.handles.start),r=k(e,n.handles.end,n.handles.middle),o=k(e,n.handles.end,n.handles.start),i=D(a),s=D(r),l=D(o),u=Math.acos((Math.pow(i,2)+Math.pow(s,2)-Math.pow(l,2))/(2*i*s));u*=180/Math.PI,n.rAngle=Object(_.default)(u,2),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.enabledElement,r=this.configuration,o=r.handleRadius,i=r.drawHandlesOnHover,s=r.hideHandlesIfMoving,l=r.renderDashed,u=Object(g.getToolState)(e.currentTarget,this.name),d=Object(M.getModule)("globalConfiguration").configuration.lineDash;if(u)for(var c=Object(y.getNewContext)(n.canvasContext.canvas),f=n.image,m=n.element,b=Object(C.default)(f),T=b.rowPixelSpacing,_=b.colPixelSpacing,E=p.default.getToolWidth(),O=function(e){var r=u.data[e];if(!1===r.visible)return"continue";Object(y.draw)(c,function(e){Object(y.setShadow)(e,t.configuration);var u=v.default.getColorIfActive(r),c=h.default.cornerstone.pixelToCanvas(n.element,r.handles.start),g=h.default.cornerstone.pixelToCanvas(n.element,r.handles.middle),p={color:u};l&&(p.lineDash=d),Object(y.drawJoinedLines)(e,n.element,r.handles.start,[r.handles.middle,r.handles.end],p);var b={color:u,handleRadius:o,drawHandlesIfActive:i,hideHandlesIfMoving:s};if(t.configuration.drawHandles&&Object(j.default)(e,n,r.handles,b),!0===r.invalidated&&(r.rAngle?t.throttledUpdateCachedStats(f,m,r):t.updateCachedStats(f,m,r)),r.rAngle){var O,S=function(e,t,n){var a=t&&n?"":" (isotropic)";return e.rAngle.toString()+String.fromCharCode(parseInt("00B0",16))+a}(r,T,_);if(!r.handles.textBox.hasMoved){O={x:g.x,y:g.y};var C=Object(w.textBoxWidth)(e,S,5);g.x<c.x?O.x-=15+C+10:O.x+=15;var M=h.default.cornerstone.internal.getTransform(a);M.invert();var P=M.transformPoint(O.x,O.y);r.handles.textBox.x=P.x,r.handles.textBox.y=P.y}Object(x.default)(e,n.element,r.handles.textBox,S,r.handles,I,u,E,0,!0)}})},S=0;S<u.data.length;S++)O(S);function I(e){return[e.start,e.middle,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,e.preventDefault(),e.stopPropagation();var a=e.detail,r=this.createNewMeasurement(a),o=e.detail.element;Object(g.addToolState)(o,this.name,r),h.default.cornerstone.updateImage(o),Object(b.moveNewHandle)(a,this.name,r,r.handles.middle,this.options,t,function(e){if(r.active=!1,!e)return Object(g.removeToolState)(o,n.name,r),void(n.preventNewMeasurement=!1);r.handles.end.active=!0,h.default.cornerstone.updateImage(o),Object(b.moveNewHandle)(a,n.name,r,r.handles.end,n.options,t,function(e){e?(r.active=!1,h.default.cornerstone.updateImage(o)):Object(g.removeToolState)(o,n.name,r),n.preventNewMeasurement=!1,h.default.cornerstone.updateImage(o);var t={toolName:n.name,toolType:n.name,element:o,measurementData:r};Object(O.default)(o,S.default.MEASUREMENT_COMPLETED,t)})})}}}]),t}(m.default);function D(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function k(e,t,n){var a=Object(C.default)(e);return{x:(t.x-n.x)*(a.colPixelSpacing||1),y:(t.y-n.y)*(a.rowPixelSpacing||1)}}},"./tools/annotation/ArrowAnnotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return P});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./events.js"),p=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/textStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./manipulators/index.js"),x=n("./util/pointInsideBoundingBox.js"),w=n("./util/lineSegDistance.js"),j=n("./util/triggerEvent.js"),T=n("./stateManagement/toolState.js"),_=n("./drawing/drawLinkedTextBox.js"),E=n("./drawing/index.js"),O=n("./drawing/drawArrow.js"),S=n("./drawing/drawHandles.js"),C=n("./drawing/drawTextBox.js"),I=n("./tools/cursors/index.js"),M=n("./store/index.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:D,changeTextCallback:k,drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,arrowFirst:!0,renderDashed:!1,allowEmptyLabel:!1},svgCursor:I.arrowAnnotateCursor};return(e=l()(this,d()(t).call(this,n,a))).preventNewMeasurement=!1,e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&Object(w.default)(e,t.handles.start,t.handles.end,n)<25}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=n.element,r=n.enabledElement,o=this.configuration,i=o.handleRadius,s=o.drawHandlesOnHover,l=o.hideHandlesIfMoving,u=o.renderDashed,d=Object(T.getToolState)(a,this.name);if(d){var c,f=e.detail.canvasContext.canvas,m=Object(E.getNewContext)(f),g=p.default.getToolWidth();u&&(c=Object(M.getModule)("globalConfiguration").configuration.lineDash);for(var y=function(n){var o=d.data[n];if(!1===o.visible)return"continue";Object(E.draw)(m,function(n){Object(E.setShadow)(n,t.configuration);var u=b.default.getColorIfActive(o),d=h.default.cornerstone.pixelToCanvas(a,o.handles.start),f=h.default.cornerstone.pixelToCanvas(a,o.handles.end);t.configuration.arrowFirst?Object(O.default)(n,f,d,u,g,c):Object(O.default)(n,d,f,u,g,c);var m={color:u,handleRadius:i,drawHandlesIfActive:s,hideHandlesIfMoving:l};t.configuration.drawHandles&&Object(S.default)(n,e.detail,o.handles,m);var p=function(e){return e.text}(o);if(p&&""!==p){var y=Object(C.textBoxWidth)(n,p,5),x=v.default.getFontSize()+10,j=Math.max(y,x)/2+5;if(f.x<d.x&&(j=-j),!o.handles.textBox.hasMoved){var T;T=t.configuration.arrowFirst?{x:f.x-y/2+j,y:f.y-x/2}:{x:d.x-y/2-j,y:d.y-x/2};var I=h.default.cornerstone.internal.getTransform(r);I.invert();var M=I.transformPoint(T.x,T.y);o.handles.textBox.x=M.x,o.handles.textBox.y=M.y}Object(_.default)(n,a,o.handles.textBox,p,o.handles,w,u,g,0,!1)}})},x=0;x<d.data.length;x++)y(x)}function w(e){return[e.start,{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2},e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this,a=e.detail.element,r=this.createNewMeasurement(e),o=this.configuration.allowEmptyLabel;Object(T.addToolState)(a,this.name,r),h.default.cornerstone.updateImage(a),Object(y.moveNewHandle)(e.detail,this.name,r,r.handles.end,this.options,t,function(t){t?void 0===r.text&&n.configuration.getTextCallback(function(e){if(e||o){r.text=e,r.active=!1;var t={toolName:n.name,toolType:n.name,element:a,measurementData:r};h.default.cornerstone.updateImage(a),Object(j.default)(a,g.default.MEASUREMENT_COMPLETED,t)}else Object(T.removeToolState)(a,n.name,r)},e.detail):Object(T.removeToolState)(a,n.name,r),h.default.cornerstone.updateImage(a)})}},{key:"doubleClickCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"touchPressCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"_updateTextForNearbyAnnotation",value:function(e){var t=e.detail.element,n=e.detail.currentPoints.canvas,a=Object(T.getToolState)(t,this.name);if(!a)return!1;for(var r=0;r<a.data.length;r++){var o=a.data[r];if(this.pointNearTool(t,o,n)||Object(x.default)(o.handles.textBox,n))return o.active=!0,h.default.cornerstone.updateImage(t),this.configuration.changeTextCallback(o,e.detail,this._doneChangingTextCallback.bind(this,t,o)),e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function(e,t,n,a){!0===a?Object(T.removeToolState)(e,this.name,t):t.text=n,t.active=!1,h.default.cornerstone.updateImage(e),Object(j.default)(e,g.default.MEASUREMENT_MODIFIED,{toolName:this.name,toolType:this.name,element:e,measurementData:t})}}]),t}(m.default);function D(e){e(prompt("Enter your annotation:"))}function k(e,t,n){n(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return I});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./tools/base/BaseAnnotationTool.js"),p=n("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),v=n("./tools/annotation/bidirectionalTool/pointNearTool.js"),b=n("./tools/annotation/bidirectionalTool/renderToolData.js"),y=n("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),x=n("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),w=n("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),j=n("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),T=n("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),_=n("./tools/cursors/index.js"),E=n("./util/throttle.js"),O=n("./util/getPixelSpacing.js"),S=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),C=function(e,t,n){return n()},I=function(e){function t(e){var n;r()(this,t);var a={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:C,getMeasurementLocationCallback:C,textBox:"",shadow:"",drawHandles:!0,drawHandlesOnHover:!0,hideHandlesIfMoving:!1,renderDashed:!1,additionalData:[]},svgCursor:_.bidirectionalCursor};return(n=l()(this,d()(t).call(this,e,a))).throttledUpdateCachedStats=Object(E.default)(n.updateCachedStats,110),n.createNewMeasurement=p.default.bind(f()(n)),n.pointNearTool=v.default.bind(f()(n)),n.renderToolData=b.default.bind(f()(n)),n.addNewMeasurement=y.default.bind(f()(n)),n._moveCallback=x.default.bind(f()(n)),n.handleSelectedCallback=w.default.bind(f()(n)),n.handleSelectedMouseCallback=j.default.bind(f()(n)),n.handleSelectedTouchCallback=T.default.bind(f()(n)),n}return m()(t,e),i()(t,[{key:"updateCachedStats",value:function(e,t,n){if(n.toolName===this.name){var a=Object(O.default)(e),r=Object(S.default)(n,a),o=r.shortestDiameter;n.longestDiameter=r.longestDiameter,n.shortestDiameter=o,n.invalidated=!1}}}]),t}(g.default)},"./tools/annotation/CircleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return M});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),b=n("./store/index.js"),y=n("./drawing/index.js"),x=n("./util/calculateSUV.js"),w=n("./util/ellipse/index.js"),j=n("./util/getROITextBoxCoords.js"),T=n("./util/numbersWithCommas.js"),_=n("./util/throttle.js"),E=n("./util/logger.js"),O=n("./util/getPixelSpacing.js"),S=n("./tools/cursors/index.js"),C=n("./util/getCircleCoords.js"),I=Object(E.getLogger)("tools:annotation:CircleRoiTool"),M=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"CircleRoi",supportedInteractionTypes:["Mouse","Touch"],svgCursor:S.circleRoiCursor,configuration:{renderDashed:!1,hideHandlesIfMoving:!1}};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(_.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};I.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end,o=h.default.cornerstoneMath.point.distance;if(r||I.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;var i="mouse"===a?15:25,s=h.default.cornerstone.pixelToCanvas(e,t.handles.start),l=h.default.cornerstone.pixelToCanvas(e,t.handles.end),u=o(s,n),d=o(s,l);return u>d-i/2&&u<d+i/2}},{key:"updateCachedStats",value:function(e,t,n){var a=(h.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,r=Object(O.default)(e),o=function(e,t,n,a,r){var o,i=Object(C.default)(n.start,n.end),s=h.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),l=Object(w.calculateEllipseStatistics)(s,i);return"PT"===a&&(o={mean:Object(x.default)(e,l.mean,!0)||0,stdDev:Object(x.default)(e,l.stdDev,!0)||0}),{area:Math.PI*(i.width*(r.colPixelSpacing||1)/2)*(i.height*(r.rowPixelSpacing||1)/2)||0,count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(g.getToolState)(e.currentTarget,this.name);if(n){var a=h.default.cornerstoneMath.point.distance,r=e.detail,o=r.image,i=r.element,s=r.canvasContext,l=p.default.getToolWidth(),u=this.configuration,d=u.handleRadius,c=u.drawHandlesOnHover,f=u.hideHandlesIfMoving,m=u.renderDashed,x=Object(y.getNewContext)(s.canvas),w=Object(O.default)(o),T=w.rowPixelSpacing,_=w.colPixelSpacing,E=Object(b.getModule)("globalConfiguration").configuration.lineDash,S=(h.default.cornerstone.metaData.get("generalSeriesModule",o.imageId)||{}).modality,I=T&&_;Object(y.draw)(x,function(e){for(var s=0;s<n.data.length;s++){var u=n.data[s];if(!1!==u.visible){var g=v.default.getColorIfActive(u),p={color:g,handleRadius:d,drawHandlesIfActive:c,hideHandlesIfMoving:f};Object(y.setShadow)(e,t.configuration);var b=h.default.cornerstone.pixelToCanvas(i,u.handles.start),x=h.default.cornerstone.pixelToCanvas(i,u.handles.end),w=a(b,x),T={color:g};if(m&&(T.lineDash=E),Object(y.drawCircle)(e,i,u.handles.start,w,T,"pixel"),Object(y.drawHandles)(e,r,u.handles,p),!0===u.invalidated&&(u.cachedStats?t.throttledUpdateCachedStats(o,i,u):t.updateCachedStats(o,i,u)),!u.handles.textBox.hasMoved){var _=Object(j.default)(r.viewport,u.handles);Object.assign(u.handles.textBox,_)}var O=D(e,o.color,u.cachedStats,S,I,t.configuration);u.unit=P(S,t.configuration.showHounsfieldUnits),Object(y.drawLinkedTextBox)(e,i,u.handles.textBox,O,u.handles,function(e){return t=e.start,n=e.end,[{x:(r=(a=Object(C.default)(t,n)).left)+(i=a.width)/2,y:o=a.top},{x:r,y:o+(s=a.height)/2},{x:r+i/2,y:o+s},{x:r+i,y:o+s/2}];var t,n,a,r,o,i,s},g,l,10,!0)}}})}}}]),t}(m.default);function P(e,t){return"CT"===e&&!1!==t?"HU":""}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,r=n.mean,o=n.stdDev,i=n.min,s=n.max,l=n.meanStdDevSUV,u=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,h=[],m=[];if(!t){var g=l&&0!==l.mean,p=P(u,c.showHounsfieldUnits),v="Mean: ".concat(Object(T.default)(r.toFixed(2))," ").concat(p),b="Std Dev: ".concat(Object(T.default)(o.toFixed(2))," ").concat(p);if(g){for(var y=" SUV: ",x="".concat(y).concat(Object(T.default)(l.mean.toFixed(2))),w="".concat(y).concat(Object(T.default)(l.stdDev.toFixed(2))),j=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(v).width<j;)v+=" ";m.push("".concat(v).concat(x)),m.push("".concat(b,"     ").concat(w))}else m.push("".concat(v,"     ").concat(b));if(f){for(var _="Min: ".concat(i," ").concat(p),E="Max: ".concat(s," ").concat(p),O=g?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(v,"     ")).width);e.measureText(_).width<O;)_+=" ";m.push("".concat(_).concat(E))}}return h.push(k(a,d)),m.forEach(function(e){return h.push(e)}),h}function k(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(T.default)(e.toFixed(2))).concat(n)}},"./tools/annotation/CobbAngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return P});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/textStyle.js"),p=n("./stateManagement/toolState.js"),v=n("./stateManagement/toolStyle.js"),b=n("./stateManagement/toolColors.js"),y=n("./manipulators/index.js"),x=n("./drawing/index.js"),w=n("./drawing/drawHandles.js"),j=n("./drawing/drawLinkedTextBox.js"),T=n("./util/lineSegDistance.js"),_=n("./util/roundToDecimal.js"),E=n("./events.js"),O=n("./tools/cursors/index.js"),S=n("./util/triggerEvent.js"),C=n("./util/throttle.js"),I=n("./util/getPixelSpacing.js"),M=n("./store/index.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:O.cobbAngleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).hasIncomplete=!1,e.throttledUpdateCachedStats=Object(C.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,invalidated:!0,complete:!1,value:"",handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:e.currentPoints.image.x+1,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(e,t,n){return!1!==t.visible&&!this.hasIncomplete&&(Object(T.default)(e,t.handles.start,t.handles.end,n)<25||Object(T.default)(e,t.handles.start2,t.handles.end2,n)<25)}},{key:"updateCachedStats",value:function(e,t,n){var a=Object(I.default)(e),r=a.rowPixelSpacing,o=a.colPixelSpacing,i=(Math.ceil(n.handles.start.x)-Math.ceil(n.handles.end.x))*(o||1),s=(Math.ceil(n.handles.start.y)-Math.ceil(n.handles.end.y))*(r||1),l=(Math.ceil(n.handles.start2.x)-Math.ceil(n.handles.end2.x))*(o||1),u=(Math.ceil(n.handles.start2.y)-Math.ceil(n.handles.end2.y))*(r||1),d=Math.acos(Math.abs((i*l+s*u)/(Math.sqrt(i*i+s*s)*Math.sqrt(l*l+u*u))));d*=180/Math.PI,n.rAngle=Object(_.default)(d,2),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.drawHandlesOnHover,i=a.hideHandlesIfMoving,s=a.renderDashed,l=Object(p.getToolState)(e.currentTarget,this.name);if(l)for(var u=Object(x.getNewContext)(n.canvasContext.canvas),d=v.default.getToolWidth(),c=Object(M.getModule)("globalConfiguration").configuration.lineDash,f=g.default.getFont(),h=function(e){var a=l.data[e];if(!1===a.visible)return"continue";Object(x.draw)(u,function(e){Object(x.setShadow)(e,t.configuration);var l=b.default.getColorIfActive(a),u={color:l};s&&(u.lineDash=c),Object(x.drawLine)(e,n.element,a.handles.start,a.handles.end,u),a.complete&&Object(x.drawLine)(e,n.element,a.handles.start2,a.handles.end2,u);var h={color:l,handleRadius:r,drawHandlesIfActive:o,hideHandlesIfMoving:i};t.configuration.drawHandles&&Object(w.default)(e,n,a.handles,h),e.fillStyle=l;var m=a.value;if(!a.handles.textBox.hasMoved){var g={x:(a.handles.start.x+a.handles.end.x)/2,y:(a.handles.start.y+a.handles.end.y)/2-10};e.font=f,a.handles.textBox.x=g.x,a.handles.textBox.y=g.y}Object(j.default)(e,n.element,a.handles.textBox,m,a.handles,y,l,d,0,!0)})},m=0;m<l.data.length;m++)h(m);function y(e){return[e.start,e.start2,e.end,e.end2]}}},{key:"getIncomplete",value:function(e){var t=Object(p.getToolState)(e,this.name);if(t&&Array.isArray(t.data))return t.data.find(function(e){return!1===e.complete})}},{key:"addNewMeasurement",value:function(e,t){var n=this;e.preventDefault(),e.stopPropagation();var a,r,o=e.detail,i=function(e){e||Object(p.removeToolState)(s,n.name,a)},s=e.detail.element,l=this.getIncomplete(s);l?((a=l).complete=!0,a.handles.start2={x:o.currentPoints.image.x,y:o.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},a.handles.end2={x:o.currentPoints.image.x,y:o.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},r=a.handles.end2,this.hasIncomplete=!1,i=function(e){if(e){var t=E.default.MEASUREMENT_COMPLETED,r={toolName:n.name,toolType:n.name,element:s,measurementData:a};Object(S.default)(s,t,r)}else Object(p.removeToolState)(s,n.name,a)}):(a=this.createNewMeasurement(o),Object(p.addToolState)(s,this.name,a),r=a.handles.end),h.default.cornerstone.updateImage(s),Object(y.moveNewHandle)(o,this.name,a,r,this.options,t,i)}},{key:"onMeasureModified",value:function(e){var t=e.detail.element,n=h.default.cornerstone.getEnabledElement(t).image,a=Object(I.default)(n),r=a.rowPixelSpacing,o=a.colPixelSpacing;if(e.detail.toolName===this.name){var i=e.detail.measurementData;!0===i.invalidated&&(i.rAngle?this.throttledUpdateCachedStats(n,t,i):this.updateCachedStats(n,t,i));var s=i.rAngle;i.value="",Number.isNaN(s)||(i.value=function(e,t,n){var a=t&&n?"":" (isotropic)";return e.toString()+String.fromCharCode(parseInt("00B0",16))+a}(s,r,o))}}},{key:"activeCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(E.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function(e){this.onMeasureModified=this.onMeasureModified.bind(this),e.addEventListener(E.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function(e){e.removeEventListener(E.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function(e){e.removeEventListener(E.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),t}(m.default)},"./tools/annotation/EllipticalRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return M});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),b=n("./manipulators/getHandleNearImagePoint.js"),y=n("./drawing/index.js"),x=n("./util/calculateSUV.js"),w=n("./util/ellipse/index.js"),j=n("./util/getROITextBoxCoords.js"),T=n("./util/numbersWithCommas.js"),_=n("./util/throttle.js"),E=n("./tools/cursors/index.js"),O=n("./util/logger.js"),S=n("./util/getPixelSpacing.js"),C=n("./store/index.js"),I=Object(O.getLogger)("tools:annotation:EllipticalRoiTool"),M=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:E.ellipticalRoiCursor};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(_.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};I.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end;if(r||I.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;if(Object(b.default)(e,t.handles,n,6))return!0;var o="mouse"===a?15:25,i=h.default.cornerstone.pixelToCanvas(e,t.handles.start),s=h.default.cornerstone.pixelToCanvas(e,t.handles.end),l={left:Math.min(i.x,s.x)+o/2,top:Math.min(i.y,s.y)+o/2,width:Math.abs(i.x-s.x)-o,height:Math.abs(i.y-s.y)-o},u={left:Math.min(i.x,s.x)-o/2,top:Math.min(i.y,s.y)-o/2,width:Math.abs(i.x-s.x)+o,height:Math.abs(i.y-s.y)+o},d=Object(w.pointInEllipse)(l,n);return!(!Object(w.pointInEllipse)(u,n)||d)}},{key:"updateCachedStats",value:function(e,t,n){var a=(h.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,r=Object(S.default)(e),o=function(e,t,n,a,r){var o,i=L(n.start,n.end),s=h.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),l=Object(w.calculateEllipseStatistics)(s,i);return"PT"===a&&(o={mean:Object(x.default)(e,l.mean,!0)||0,stdDev:Object(x.default)(e,l.stdDev,!0)||0}),{area:Math.PI*(i.width*(r.colPixelSpacing||1)/2)*(i.height*(r.rowPixelSpacing||1)/2)||0,count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(g.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,r=a.image,o=a.element,i=p.default.getToolWidth(),s=Object(C.getModule)("globalConfiguration").configuration.lineDash,l=this.configuration,u=l.handleRadius,d=l.drawHandlesOnHover,c=l.hideHandlesIfMoving,f=l.renderDashed,m=Object(y.getNewContext)(a.canvasContext.canvas),b=Object(S.default)(r),x=b.rowPixelSpacing,w=b.colPixelSpacing,T=(h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,_=x&&w;Object(y.draw)(m,function(e){for(var l=0;l<n.data.length;l++){var h=n.data[l];if(!1!==h.visible){var m=v.default.getColorIfActive(h),g={color:m,handleRadius:u,drawHandlesIfActive:d,hideHandlesIfMoving:c};Object(y.setShadow)(e,t.configuration);var p={color:m};if(f&&(p.lineDash=s),Object(y.drawEllipse)(e,o,h.handles.start,h.handles.end,p,"pixel",h.handles.initialRotation),Object(y.drawHandles)(e,a,h.handles,g),!0===h.invalidated&&(h.cachedStats?t.throttledUpdateCachedStats(r,o,h):t.updateCachedStats(r,o,h)),!h.handles.textBox.hasMoved){var b=Object(j.default)(a.viewport,h.handles);Object.assign(h.handles.textBox,b)}var x=D(e,r.color,h.cachedStats,T,_,t.configuration);h.unit=P(T,t.configuration.showHounsfieldUnits),Object(y.drawLinkedTextBox)(e,o,h.handles.textBox,x,h.handles,function(e){return[{x:(n=(t=L(e.start,e.end)).left)+(r=t.width)/2,y:a=t.top},{x:n,y:a+(o=t.height)/2},{x:n+r/2,y:a+o},{x:n+r,y:a+o/2}];var t,n,a,r,o},m,i,10,!0)}}})}}}]),t}(m.default);function P(e,t){return"CT"===e&&!1!==t?"HU":""}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.area,r=n.mean,o=n.stdDev,i=n.min,s=n.max,l=n.meanStdDevSUV,u=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,h=[],m=[];if(!t){var g=l&&0!==l.mean,p=P(u,c.showHounsfieldUnits),v="Mean: ".concat(Object(T.default)(r.toFixed(2))," ").concat(p),b="Std Dev: ".concat(Object(T.default)(o.toFixed(2))," ").concat(p);if(g){for(var y=" SUV: ",x="".concat(y).concat(Object(T.default)(l.mean.toFixed(2))),w="".concat(y).concat(Object(T.default)(l.stdDev.toFixed(2))),j=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(v).width<j;)v+=" ";m.push("".concat(v).concat(x)),m.push("".concat(b,"     ").concat(w))}else m.push("".concat(v)),m.push("".concat(b));if(f){for(var _="Min: ".concat(i," ").concat(p),E="Max: ".concat(s," ").concat(p),O=g?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(v,"     ")).width);e.measureText(_).width<O;)_+=" ";m.push("".concat(_).concat(E))}}return h.push(k(a,d)),m.forEach(function(e){return h.push(e)}),h}function k(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(T.default)(e.toFixed(2))).concat(n)}function L(e,t){return{left:Math.round(Math.min(e.x,t.x)),top:Math.round(Math.min(e.y,t.y)),width:Math.round(Math.abs(e.x-t.x)),height:Math.round(Math.abs(e.y-t.y))}}},"./tools/annotation/FreehandRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return z});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./events.js"),p=n("./externalModules.js"),v=n("./tools/base/BaseAnnotationTool.js"),b=n("./stateManagement/toolState.js"),y=n("./stateManagement/toolStyle.js"),x=n("./stateManagement/toolColors.js"),w=n("./store/index.js"),j=n("./util/triggerEvent.js"),T=n("./util/findAndMoveHelpers.js"),_=n("./util/pointInsideBoundingBox.js"),E=n("./util/calculateSUV.js"),O=n("./util/numbersWithCommas.js"),S=n("./drawing/index.js"),C=n("./drawing/drawLinkedTextBox.js"),I=n("./drawing/drawHandles.js"),M=n("./util/clip.js"),P=n("./store/setToolCursor.js"),D=n("./tools/cursors/index.js"),k=n("./util/freehand/index.js"),L=n("./util/logger.js"),A=n("./util/throttle.js"),R=Object(L.getLogger)("tools:annotation:FreehandRoiTool"),B=k.default.insertOrDelete,F=k.default.freehandArea,U=k.default.calculateFreehandStatistics,H=k.default.freehandIntersect,N=k.default.FreehandHandleData,z=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1,drawHandles:!0,renderDashed:!1},svgCursor:D.freehandRoiCursor};return(e=l()(this,d()(t).call(this,n,a))).isMultiPartTool=!0,e._drawing=!1,e._dragging=!1,e._modifying=!1,e._drawingMouseDownCallback=e._drawingMouseDownCallback.bind(f()(e)),e._drawingMouseMoveCallback=e._drawingMouseMoveCallback.bind(f()(e)),e._drawingMouseDragCallback=e._drawingMouseDragCallback.bind(f()(e)),e._drawingMouseUpCallback=e._drawingMouseUpCallback.bind(f()(e)),e._drawingMouseDoubleClickCallback=e._drawingMouseDoubleClickCallback.bind(f()(e)),e._editMouseUpCallback=e._editMouseUpCallback.bind(f()(e)),e._editMouseDragCallback=e._editMouseDragCallback.bind(f()(e)),e._drawingTouchStartCallback=e._drawingTouchStartCallback.bind(f()(e)),e._drawingTouchDragCallback=e._drawingTouchDragCallback.bind(f()(e)),e._drawingDoubleTapClickCallback=e._drawingDoubleTapClickCallback.bind(f()(e)),e._editTouchDragCallback=e._editTouchDragCallback.bind(f()(e)),e.throttledUpdateCachedStats=Object(A.default)(e.updateCachedStats,110),e}return m()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return t.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},t}R.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.points;if(!a)throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!(!a||!1===t.visible)&&void 0!==this._pointNearHandle(e,t,n)}},{key:"distanceFromPoint",value:function(e,t,n){for(var a=1/0,r=0;r<t.handles.points.length;r++){var o=p.default.cornerstoneMath.point.distance(t.handles.points[r],n);a=Math.min(a,o)}return a===1/0?-1:a}},{key:"distanceFromPointCanvas",value:function(e,t,n){var a=1/0;if(!t)return-1;for(var r=p.default.cornerstone.pixelToCanvas(e,n),o=t.handles.points,i=0;i<o.length;i++){var s=p.default.cornerstone.pixelToCanvas(e,o[i]),l=p.default.cornerstoneMath.point.distance(s,r);a=Math.min(a,l)}return a===1/0?-1:a}},{key:"updateCachedStats",value:function(e,t,n){for(var a,r,o=p.default.cornerstone.metaData.get("generalSeriesModule",e.imageId),i=o?o.modality:null,s=n.handles.points,l={left:s[0].x,right:s[0].x,bottom:s[0].y,top:s[0].x},u=0;u<s.length;u++)l.left=Math.min(l.left,s[u].x),l.right=Math.max(l.right,s[u].x),l.bottom=Math.min(l.bottom,s[u].y),l.top=Math.max(l.top,s[u].y);var d={left:l.left,top:l.bottom,width:Math.abs(l.right-l.left),height:Math.abs(l.top-l.bottom)};if(n.polyBoundingBox=d,!e.color){var c=p.default.cornerstone.getPixels(t,d.left,d.top,d.width,d.height);a=U.call(this,c,d,n.handles.points),"PT"===i&&(r={mean:Object(E.default)(e,(a.mean-e.intercept)/e.slope),stdDev:Object(E.default)(e,(a.stdDev-e.intercept)/e.slope)}),a&&!isNaN(a.mean)&&(n.meanStdDev=a,n.meanStdDevSUV=r)}var f=F(n.handles.points,(e.columnPixelSpacing||1)*(e.rowPixelSpacing||1));isNaN(f)||(n.area=f),n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=Object(b.getToolState)(e.currentTarget,this.name);if(a)for(var r=n.image,o=n.element,i=this.configuration,s=p.default.cornerstone.metaData.get("generalSeriesModule",r.imageId),l=s?s.modality:null,u=Object(S.getNewContext)(n.canvasContext.canvas),d=y.default.getToolWidth(),c=i.renderDashed,f=Object(w.getModule)("globalConfiguration").configuration.lineDash,h=function(e){var s=a.data[e];if(!1===s.visible)return"continue";Object(S.draw)(u,function(e){var a,l=x.default.getColorIfActive(s);s.active?s.handles.invalidHandlePlacement?(l=i.invalidColor,a=i.invalidColor):(l=x.default.getColorIfActive(s),a=x.default.getFillColor()):a=x.default.getToolColor();var u={color:l};if(c&&(u.lineDash=f),s.handles.points.length){var h=s.handles.points;Object(S.drawJoinedLines)(e,o,h[0],h,u),s.polyBoundingBox?Object(S.drawJoinedLines)(e,o,h[h.length-1],[h[0]],u):Object(S.drawJoinedLines)(e,o,h[h.length-1],[i.mouseLocation.handles.start],u)}if(u={color:l,fill:a},(i.alwaysShowHandles||s.active&&s.polyBoundingBox)&&(u.handleRadius=i.activeHandleRadius,t.configuration.drawHandles&&Object(I.default)(e,n,s.handles.points,u)),s.canComplete){u.handleRadius=i.completeHandleRadius;var m=s.handles.points[0];t.configuration.drawHandles&&Object(I.default)(e,n,[m],u)}if(s.active&&!s.polyBoundingBox){u.handleRadius=i.activeHandleRadius,t.configuration.drawHandles&&Object(I.default)(e,n,i.mouseLocation.handles,u);var p=s.handles.points[0];t.configuration.drawHandles&&Object(I.default)(e,n,[p],u)}if(!0!==s.invalidated||s.active||(s.meanStdDev&&s.meanStdDevSUV&&s.area?t.throttledUpdateCachedStats(r,o,s):t.updateCachedStats(r,o,s)),s.polyBoundingBox&&!s.handles.textBox.freehand){s.handles.textBox.hasMoved||(s.handles.textBox.x=s.polyBoundingBox.left+s.polyBoundingBox.width,s.handles.textBox.y=s.polyBoundingBox.top+s.polyBoundingBox.height/2);var b=g.call(t,s);Object(C.default)(e,o,s.handles.textBox,b,s.handles.points,v,l,d,0,!0)}})},m=0;m<a.data.length;m++)h(m);function g(e){var t=e.meanStdDev,n=e.meanStdDevSUV,a=e.area,o=[];if(t&&void 0!==t.mean){var i="";"CT"===l&&(i="HU"),e.unit=i;var s="Mean: ".concat(Object(O.default)(t.mean.toFixed(2))," ").concat(i),u="StdDev: ".concat(Object(O.default)(t.stdDev.toFixed(2))," ").concat(i);if(n&&void 0!==n.mean){var d=" SUV: ";s+=d+Object(O.default)(n.mean.toFixed(2)),u+=d+Object(O.default)(n.stdDev.toFixed(2))}o.push(s),o.push(u)}if(a){var c=" mm".concat(String.fromCharCode(178));r.rowPixelSpacing&&r.columnPixelSpacing||(c=" pixels".concat(String.fromCharCode(178)));var f="Area: ".concat(Object(O.default)(a.toFixed(2))).concat(c);o.push(f)}return o}function v(e){return e}}},{key:"addNewMeasurement",value:function(e){var t=e.detail;this._startDrawing(e),this._addPoint(t),V(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=this._pointNearHandleAllTools(t);return!!t.event.ctrlKey&&(void 0!==n&&n.handleNearby.hasBoundingBox||B.call(this,e,n),V(e),!0)}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",r=e.detail.element,o=Object(b.getToolState)(r,this.name);if(n.hasBoundingBox)Object(T.moveHandleNearImagePoint)(e,this,t,n,a);else{var i=this.configuration;i.dragOrigin={x:n.x,y:n.y};for(var s=0;s<o.data.length;s++)for(var l=o.data[s].handles.points,u=0;u<l.length;u++)l[u]===n&&(i.currentHandle=u,i.currentTool=s);this._modifying=!0,this._activateModify(r),V(e)}}},{key:"_drawingMouseMoveCallback",value:function(e){var t=e.detail,n=t.currentPoints,a=t.element,r=Object(b.getToolState)(a,this.name),o=this.configuration,i=r.data[o.currentTool],s=n.canvas;this._getMouseLocation(t),this._checkInvalidHandleLocation(i,t);var l=this._pointNearHandle(a,i,s),u=i.handles.points;void 0!==l&&!l.hasBoundingBox&&l<u.length-1&&(o.mouseLocation.handles.start.x=u[l].x,o.mouseLocation.handles.start.y=u[l].y),p.default.cornerstone.updateImage(a)}},{key:"_drawingMouseDragCallback",value:function(e){this.options.mouseButtonMask.includes(e.detail.buttons)&&this._drawingDrag(e)}},{key:"_drawingTouchDragCallback",value:function(e){this._drawingDrag(e)}},{key:"_drawingDrag",value:function(e){var t=e.detail,n=t.element,a=Object(b.getToolState)(n,this.name).data[this.configuration.currentTool];this._getMouseLocation(t),this._checkInvalidHandleLocation(a,t),this._addPointPencilMode(t,a.handles.points),this._dragging=!0,p.default.cornerstone.updateImage(n)}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;if(this._dragging){this._dragging=!1;var n=this.configuration,a=n.currentTool,r=Object(b.getToolState)(t,this.name).data[a];!H.end(r.handles.points)&&r.canComplete&&this._endDrawing(t,n.currentHandle),V(e)}}},{key:"_drawingMouseDownCallback",value:function(e){var t=e.detail,n=t.currentPoints,a=t.element;if(this.options.mouseButtonMask.includes(t.buttons)){var r=n.canvas,o=this.configuration,i=o.currentTool,s=Object(b.getToolState)(a,this.name).data[i],l=this._pointNearHandle(a,s,r);!H.end(s.handles.points)&&s.canComplete?this._endDrawing(a,o.currentHandle):void 0===l&&this._addPoint(t),V(e)}}},{key:"_drawingTouchStartCallback",value:function(e){var t=e.detail,n=t.element,a=t.currentPoints.canvas,r=this.configuration,o=r.currentTool,i=Object(b.getToolState)(n,this.name).data[o],s=this._pointNearHandle(n,i,a);!H.end(i.handles.points)&&i.canComplete?this._endDrawing(n,r.currentHandle):void 0===s&&this._addPoint(t),V(e)}},{key:"completeDrawing",value:function(e){if(this._drawing){var t=Object(b.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];if(!H.end(a.handles.points)&&a.handles.points.length>=2){var r=n.currentHandle;a.polyBoundingBox={},this._endDrawing(e,r)}}}},{key:"_drawingMouseDoubleClickCallback",value:function(e){this.completeDrawing(e.detail.element),V(e)}},{key:"_drawingDoubleTapClickCallback",value:function(e){this.completeDrawing(e.detail.element),V(e)}},{key:"_editMouseDragCallback",value:function(e){var t=e.detail,n=t.element;if(this.options.mouseButtonMask.includes(t.buttons)){var a,r=Object(b.getToolState)(n,this.name),o=this.configuration,i=r.data[o.currentTool],s=o.currentHandle,l=i.handles.points;if(this._getMouseLocation(t),i.handles.invalidHandlePlacement=H.modify(l,s),i.active=!0,i.highlight=!0,l[s].x=o.mouseLocation.handles.start.x,l[s].y=o.mouseLocation.handles.start.y,a=this._getPrevHandleIndex(s,l),s>=0){var u=l[a].lines[l[a].lines.length-1];u.x=o.mouseLocation.handles.start.x,u.y=o.mouseLocation.handles.start.y}p.default.cornerstone.updateImage(n)}}},{key:"_editTouchDragCallback",value:function(e){var t,n=e.detail,a=n.element,r=Object(b.getToolState)(a,this.name),o=this.configuration,i=r.data[o.currentTool],s=o.currentHandle,l=i.handles.points;if(this._getMouseLocation(n),i.handles.invalidHandlePlacement=H.modify(l,s),i.active=!0,i.highlight=!0,l[s].x=o.mouseLocation.handles.start.x,l[s].y=o.mouseLocation.handles.start.y,t=this._getPrevHandleIndex(s,l),s>=0){var u=l[t].lines[l[t].lines.length-1];u.x=o.mouseLocation.handles.start.x,u.y=o.mouseLocation.handles.start.y}p.default.cornerstone.updateImage(a)}},{key:"_getPrevHandleIndex",value:function(e,t){return 0===e?t.length-1:e-1}},{key:"_editMouseUpCallback",value:function(e){var t=e.detail,n=t.element,a=Object(b.getToolState)(n,this.name);this._deactivateModify(n),this._dropHandle(t,a),this._endDrawing(n),p.default.cornerstone.updateImage(n)}},{key:"_dropHandle",value:function(e,t){var n=this.configuration,a=t.data[n.currentTool].handles,r=a.points;if(a.invalidHandlePlacement){var o,i=n.currentHandle,s=r[i];o=0===i?r[r.length-1]:r[i-1],s.x=n.dragOrigin.x,s.y=n.dragOrigin.y,o.lines[0]=s,a.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function(e){var t,n=e.detail,a=this.createNewMeasurement(n),r=n.element,o=this.configuration;e.type===g.default.MOUSE_DOWN_ACTIVATE?t="Mouse":e.type===g.default.TOUCH_START_ACTIVE&&(t="Touch"),this._activateDraw(r,t),this._getMouseLocation(n),Object(b.addToolState)(r,this.name,a);var i=Object(b.getToolState)(r,this.name);o.currentTool=i.data.length-1,this._activeDrawingToolReference=i.data[o.currentTool]}},{key:"_addPoint",value:function(e){var t=e.currentPoints,n=e.element,a=Object(b.getToolState)(n,this.name),r=this.configuration,o=a.data[r.currentTool];if(!o.handles.invalidHandlePlacement){var i=new N(t.image);o.handles.points.length&&o.handles.points[r.currentHandle-1].lines.push(t.image),o.handles.points.push(i),r.currentHandle+=1,p.default.cornerstone.updateImage(n),this.fireModifiedEvent(n,o)}}},{key:"_addPointPencilMode",value:function(e,t){var n=this,a=e.element,r=this.configuration.mouseLocation.handles.start;t.every(function(e){return n._isDistanceLargerThanSpacing(a,e,r)})&&this._addPoint(e)}},{key:"_endDrawing",value:function(e,t){var n=Object(b.getToolState)(e,this.name),a=this.configuration,r=n.data[a.currentTool];if(r.active=!1,r.highlight=!1,r.handles.invalidHandlePlacement=!1,void 0!==t){var o=r.handles.points;o[a.currentHandle-1].lines.push(o[0])}this._modifying&&(this._modifying=!1,r.invalidated=!0),a.currentHandle=0,a.currentTool=-1,r.canComplete=!1,this._drawing&&this._deactivateDraw(e),p.default.cornerstone.updateImage(e),this.fireModifiedEvent(e,r),this.fireCompletedEvent(e,r)}},{key:"_pointNearHandle",value:function(e,t,n){if(void 0!==t.handles&&void 0!==t.handles.points&&!1!==t.visible){for(var a=0;a<t.handles.points.length;a++){var r=p.default.cornerstone.pixelToCanvas(e,t.handles.points[a]);if(p.default.cornerstoneMath.point.distance(r,n)<6)return a}return t.handles.textBox&&Object(_.default)(t.handles.textBox,n)?t.handles.textBox:void 0}}},{key:"_pointNearHandleAllTools",value:function(e){var t=e.element,n=e.currentPoints.canvas,a=Object(b.getToolState)(t,this.name);if(a)for(var r,o=0;o<a.data.length;o++)if(void 0!==(r=this._pointNearHandle(t,a.data[o],n)))return{handleNearby:r,toolIndex:o}}},{key:"_getMouseLocation",value:function(e){var t=e.currentPoints,n=e.image,a=this.configuration;a.mouseLocation.handles.start.x=t.image.x,a.mouseLocation.handles.start.y=t.image.y,Object(M.clipToBox)(a.mouseLocation.handles.start,n)}},{key:"_checkInvalidHandleLocation",value:function(e,t){if(e.handles.points.length<2)return!0;var n;n=this._dragging?this._checkHandlesPencilMode(e,t):this._checkHandlesPolygonMode(e,t),e.handles.invalidHandlePlacement=n}},{key:"_checkHandlesPolygonMode",value:function(e,t){var n=t.element,a=this.configuration.mouseLocation.handles.start,r=e.handles.points,o=!1;return e.canComplete=!1,this._isDistanceSmallerThanCompleteSpacingCanvas(n,r[0],a)&&!H.end(r)&&r.length>2?(e.canComplete=!0,o=!1):o=H.newHandle(a,r),o}},{key:"_checkHandlesPencilMode",value:function(e,t){var n=H.newHandle(this.configuration.mouseLocation.handles.start,e.handles.points);return!1===n&&(n=this._invalidHandlePencilMode(e,t)),n}},{key:"_invalidHandlePencilMode",value:function(e,t){var n=t.element,a=this.configuration.mouseLocation.handles.start,r=e.handles.points;if(this._isDistanceSmallerThanCompleteSpacingCanvas(n,r[0],a))return e.canComplete=!0,!1;e.canComplete=!1;for(var o=1;o<r.length-1;o++)if(this._isDistanceSmallerThanSpacing(n,r[o],a))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function(e,t,n){var a,r=p.default.cornerstone.pixelToCanvas(e,t),o=p.default.cornerstone.pixelToCanvas(e,n);return"Mouse"===this._drawingInteractionType?a=this.configuration.completeHandleRadius:"Touch"===this._drawingInteractionType&&(a=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(e,r,o,"<",a)}},{key:"_isDistanceSmallerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,"<")}},{key:"_isDistanceLargerThanSpacing",value:function(e,t,n){return this._compareDistanceToSpacing(e,t,n,">")}},{key:"_compareDistanceToSpacing",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:">",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;return">"===a?p.default.cornerstoneMath.point.distance(t,n)>r:p.default.cornerstoneMath.point.distance(t,n)<r}},{key:"_activateDraw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=t,w.state.isMultiPartToolActive=!0,Object(P.hideToolCursor)(this.element),e.addEventListener(g.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.addEventListener(g.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.addEventListener(g.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.addEventListener(g.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.addEventListener(g.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(g.default.TOUCH_START,this._drawingMouseMoveCallback),e.addEventListener(g.default.TOUCH_START,this._drawingTouchStartCallback),e.addEventListener(g.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.addEventListener(g.default.TOUCH_END,this._drawingMouseUpCallback),e.addEventListener(g.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),p.default.cornerstone.updateImage(e)}},{key:"_deactivateDraw",value:function(e){this._drawing=!1,w.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(P.setToolCursor)(this.element,this.svgCursor),e.removeEventListener(g.default.MOUSE_DOWN,this._drawingMouseDownCallback),e.removeEventListener(g.default.MOUSE_MOVE,this._drawingMouseMoveCallback),e.removeEventListener(g.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),e.removeEventListener(g.default.MOUSE_DRAG,this._drawingMouseDragCallback),e.removeEventListener(g.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(g.default.TOUCH_START,this._drawingTouchStartCallback),e.removeEventListener(g.default.TOUCH_DRAG,this._drawingTouchDragCallback),e.removeEventListener(g.default.TOUCH_START,this._drawingMouseMoveCallback),e.removeEventListener(g.default.TOUCH_END,this._drawingMouseUpCallback),p.default.cornerstone.updateImage(e)}},{key:"_activateModify",value:function(e){w.state.isToolLocked=!0,e.addEventListener(g.default.MOUSE_UP,this._editMouseUpCallback),e.addEventListener(g.default.MOUSE_DRAG,this._editMouseDragCallback),e.addEventListener(g.default.MOUSE_CLICK,this._editMouseUpCallback),e.addEventListener(g.default.TOUCH_END,this._editMouseUpCallback),e.addEventListener(g.default.TOUCH_DRAG,this._editTouchDragCallback),p.default.cornerstone.updateImage(e)}},{key:"_deactivateModify",value:function(e){w.state.isToolLocked=!1,e.removeEventListener(g.default.MOUSE_UP,this._editMouseUpCallback),e.removeEventListener(g.default.MOUSE_DRAG,this._editMouseDragCallback),e.removeEventListener(g.default.MOUSE_CLICK,this._editMouseUpCallback),e.removeEventListener(g.default.TOUCH_END,this._editMouseUpCallback),e.removeEventListener(g.default.TOUCH_DRAG,this._editTouchDragCallback),p.default.cornerstone.updateImage(e)}},{key:"passiveCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"enabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"disabledCallback",value:function(e){this._closeToolIfDrawing(e)}},{key:"_closeToolIfDrawing",value:function(e){this._drawing&&(this._endDrawing(e,this.configuration.currentHandle),p.default.cornerstone.updateImage(e))}},{key:"fireModifiedEvent",value:function(e,t){var n=g.default.MEASUREMENT_MODIFIED,a={toolName:this.name,toolType:this.name,element:e,measurementData:t};Object(j.default)(e,n,a)}},{key:"fireCompletedEvent",value:function(e,t){var n=g.default.MEASUREMENT_COMPLETED,a={toolName:this.name,toolType:this.name,element:e,measurementData:t};Object(j.default)(e,n,a)}},{key:"cancelDrawing",value:function(e){if(this._drawing){var t=Object(b.getToolState)(e,this.name),n=this.configuration,a=t.data[n.currentTool];a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1,n.currentHandle=0,n.currentTool=-1,a.canComplete=!1,Object(b.removeToolState)(e,this.name,a),this._deactivateDraw(e),p.default.cornerstone.updateImage(e)}}},{key:"newImageCallback",value:function(e){var t=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var n=e.detail.element,a=this._activeDrawingToolReference;a.active=!1,a.highlight=!1,a.handles.invalidHandlePlacement=!1;var r=a.handles.points;r[t.currentHandle-1].lines.push(r[0]),t.currentHandle=0,t.currentTool=-1,a.canComplete=!1,this._deactivateDraw(n),p.default.cornerstone.updateImage(n)}}},{key:"spacing",get:function(){return this.configuration.spacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=e,p.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function(){return this.configuration.activeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=e,p.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function(){return this.configuration.completeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=e,p.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function(){return this.configuration.alwaysShowHandles},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=e,p.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function(){return this.configuration.invalidColor},set:function(e){this.configuration.invalidColor=e,p.default.cornerstone.updateImage(this.element)}}]),t}(v.default);function V(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/LengthTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return S});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./tools/base/BaseAnnotationTool.js"),m=n("./stateManagement/toolState.js"),g=n("./stateManagement/toolStyle.js"),p=n("./stateManagement/toolColors.js"),v=n("./drawing/index.js"),b=n("./drawing/drawLinkedTextBox.js"),y=n("./drawing/drawHandles.js"),x=n("./util/lineSegDistance.js"),w=n("./tools/cursors/index.js"),j=n("./util/logger.js"),T=n("./util/getPixelSpacing.js"),_=n("./util/throttle.js"),E=n("./store/index.js"),O=Object(j.getLogger)("tools:annotation:LengthTool"),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:w.lengthCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(_.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t=e.currentPoints.image,n=t.x,a=t.y;return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:n,y:a,highlight:!0,active:!1},end:{x:n,y:a,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}O.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){return t&&t.handles&&t.handles.start&&t.handles.end?!1!==t.visible&&Object(x.default)(e,t.handles.start,t.handles.end,n)<25:(O.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"updateCachedStats",value:function(e,t,n){var a=Object(T.default)(e),r=(n.handles.end.x-n.handles.start.x)*(a.colPixelSpacing||1),o=(n.handles.end.y-n.handles.start.y)*(a.rowPixelSpacing||1),i=Math.sqrt(r*r+o*o);n.length=i,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.drawHandlesOnHover,i=a.hideHandlesIfMoving,s=a.renderDashed,l=Object(m.getToolState)(e.currentTarget,this.name);if(l)for(var u=Object(v.getNewContext)(n.canvasContext.canvas),d=n.image,c=n.element,f=Object(T.default)(d),h=f.rowPixelSpacing,x=f.colPixelSpacing,w=g.default.getToolWidth(),j=Object(E.getModule)("globalConfiguration").configuration.lineDash,_=function(e){var a=l.data[e];if(!1===a.visible)return"continue";Object(v.draw)(u,function(e){Object(v.setShadow)(e,t.configuration);var l=p.default.getColorIfActive(a),u={color:l};s&&(u.lineDash=j),Object(v.drawLine)(e,c,a.handles.start,a.handles.end,u);var f={color:l,handleRadius:r,drawHandlesIfActive:o,hideHandlesIfMoving:i};if(t.configuration.drawHandles&&Object(y.default)(e,n,a.handles,f),!a.handles.textBox.hasMoved){var m={x:Math.max(a.handles.start.x,a.handles.end.x)};m.y=m.x===a.handles.start.x?a.handles.start.y:a.handles.end.y,a.handles.textBox.x=m.x,a.handles.textBox.y=m.y}!0===a.invalidated&&(a.length?t.throttledUpdateCachedStats(d,c,a):t.updateCachedStats(d,c,a));var g=function(e,t,n){var a,r=(a=Number(e.length),isNaN(a)?void 0:a);if(!r)return"";var o="mm";return t&&n||(o="pixels"),e.unit=o,"".concat(r.toFixed(2)," ").concat(o)}(a,h,x);Object(b.default)(e,c,a.handles.textBox,g,a.handles,S,l,w,10,!0)})},O=0;O<l.data.length;O++)_(O);function S(e){return[e.start,{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2},e.end]}}}]),t}(h.default)},"./tools/annotation/ProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/toolState.js"),p=n("./stateManagement/textStyle.js"),v=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./drawing/drawTextBox.js"),x=n("./drawing/drawHandles.js"),w=n("./util/getRGBPixels.js"),j=n("./util/calculateSUV.js"),T=n("./tools/cursors/index.js"),_=n("./util/logger.js"),E=n("./util/throttle.js"),O=n("./store/index.js"),S=Object(_.getLogger)("tools:annotation:ProbeTool"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:T.probeCursor,configuration:{drawHandles:!0,renderDashed:!1}};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(E.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};S.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n){var a=t&&t.handles&&t.handles.end;if(a||S.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!a||!1===t.visible)return!1;var r=h.default.cornerstone.pixelToCanvas(e,t.handles.end);return h.default.cornerstoneMath.point.distance(r,n)<5}},{key:"updateCachedStats",value:function(e,t,n){var a=Math.round(n.handles.end.x),r=Math.round(n.handles.end.y),o={};a>=0&&r>=0&&a<e.columns&&r<e.rows&&(o.x=a,o.y=r,e.color?o.storedPixels=Object(w.default)(t,a,r,1,1):(o.storedPixels=h.default.cornerstone.getStoredPixels(t,a,r,1,1),o.sp=o.storedPixels[0],o.mo=o.sp*e.slope+e.intercept,o.suv=Object(j.default)(e,o.sp))),n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,a=this.configuration,r=a.handleRadius,o=a.renderDashed,i=Object(g.getToolState)(e.currentTarget,this.name);if(i)for(var s=Object(b.getNewContext)(n.canvasContext.canvas),l=n.image,u=n.element,d=p.default.getFontSize(),c=Object(O.getModule)("globalConfiguration").configuration.lineDash,f=function(e){var a=i.data[e];if(!1===a.visible)return"continue";Object(b.draw)(s,function(e){var i,s,f=v.default.getColorIfActive(a);if(t.configuration.drawHandles){var m={handleRadius:r,color:f};o&&(m.lineDash=c),Object(x.default)(e,n,a.handles,m)}!0===a.invalidated&&(a.cachedStats?t.throttledUpdateCachedStats(l,u,a):t.updateCachedStats(l,u,a));var g=a.cachedStats,p=g.x,b=g.y,w=g.storedPixels,j=g.sp,T=g.mo,_=g.suv;if(p>=0&&b>=0&&p<l.columns&&b<l.rows){i="".concat(p,", ").concat(b),l.color?s="R: ".concat(w[0]," G: ").concat(w[1]," B: ").concat(w[2]):(s="SP: ".concat(j," MO: ").concat(parseFloat(T.toFixed(3))),_&&(s+=" SUV: ".concat(parseFloat(_.toFixed(3)))));var E=h.default.cornerstone.pixelToCanvas(n.element,{x:a.handles.end.x+3,y:a.handles.end.y-3});Object(y.default)(e,s,E.x,E.y+d+5,f),Object(y.default)(e,i,E.x,E.y,f)}})},m=0;m<i.data.length;m++)f(m)}}]),t}(m.default)},"./tools/annotation/RectangleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return C});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./externalModules.js"),m=n("./tools/base/BaseAnnotationTool.js"),g=n("./stateManagement/toolState.js"),p=n("./stateManagement/toolStyle.js"),v=n("./stateManagement/toolColors.js"),b=n("./drawing/index.js"),y=n("./util/calculateSUV.js"),x=n("./util/getROITextBoxCoords.js"),w=n("./util/numbersWithCommas.js"),j=n("./util/throttle.js"),T=n("./tools/cursors/index.js"),_=n("./util/logger.js"),E=n("./util/getPixelSpacing.js"),O=n("./store/index.js"),S=Object(_.getLogger)("tools:annotation:RectangleRoiTool"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:T.rectangleRoiCursor};return(e=l()(this,d()(t).call(this,n,a))).throttledUpdateCachedStats=Object(j.default)(e.updateCachedStats,110),e}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};S.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(e,t,n,a){var r=t&&t.handles&&t.handles.start&&t.handles.end;if(r||S.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!r||!1===t.visible)return!1;var o="mouse"===a?15:25,i=h.default.cornerstone.pixelToCanvas(e,t.handles.start),s=h.default.cornerstone.pixelToCanvas(e,t.handles.end),l={left:Math.min(i.x,s.x),top:Math.min(i.y,s.y),width:Math.abs(i.x-s.x),height:Math.abs(i.y-s.y)};return h.default.cornerstoneMath.rect.distanceToPoint(l,n)<o}},{key:"updateCachedStats",value:function(e,t,n){var a=(h.default.cornerstone.metaData.get("generalSeriesModule",e.imageId)||{}).modality,r=Object(E.default)(e),o=function(e,t,n,a,r){var o,i=I(n.start,n.end),s=function(e,t){for(var n=0,a=0,r=0,o=0,i=e?e[0]:null,s=e?e[0]:null,l=t.top;l<t.top+t.height;l++)for(var u=t.left;u<t.left+t.width;u++)n+=e[o],a+=e[o]*e[o],i=Math.min(i,e[o]),s=Math.max(s,e[o]),r++,o++;if(0===r)return{count:r,mean:0,variance:0,stdDev:0,min:0,max:0};var d=n/r,c=a/r-d*d;return{count:r,mean:d,variance:c,stdDev:Math.sqrt(c),min:i,max:s}}(h.default.cornerstone.getPixels(t,i.left,i.top,i.width,i.height),i);return"PT"===a&&(o={mean:Object(y.default)(e,s.mean,!0)||0,stdDev:Object(y.default)(e,s.stdDev,!0)||0}),{area:i.width*(r.colPixelSpacing||1)*(i.height*(r.rowPixelSpacing||1))||0,count:s.count||0,mean:s.mean||0,variance:s.variance||0,stdDev:s.stdDev||0,min:s.min||0,max:s.max||0,meanStdDevSUV:o}}(e,t,n.handles,a,r);n.cachedStats=o,n.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(g.getToolState)(e.currentTarget,this.name);if(n){var a=e.detail,r=a.image,o=a.element,i=p.default.getToolWidth(),s=Object(O.getModule)("globalConfiguration").configuration.lineDash,l=this.configuration,u=l.handleRadius,d=l.drawHandlesOnHover,c=l.hideHandlesIfMoving,f=l.renderDashed,m=Object(b.getNewContext)(a.canvasContext.canvas),y=Object(E.default)(r),w=y.rowPixelSpacing,j=y.colPixelSpacing,T=(h.default.cornerstone.metaData.get("generalSeriesModule",r.imageId)||{}).modality,_=w&&j;Object(b.draw)(m,function(e){for(var l=0;l<n.data.length;l++){var h=n.data[l];if(!1!==h.visible){var m=v.default.getColorIfActive(h),g={color:m,handleRadius:u,drawHandlesIfActive:d,hideHandlesIfMoving:c};Object(b.setShadow)(e,t.configuration);var p={color:m};if(f&&(p.lineDash=s),Object(b.drawRect)(e,o,h.handles.start,h.handles.end,p,"pixel",h.handles.initialRotation),t.configuration.drawHandles&&Object(b.drawHandles)(e,a,h.handles,g),!0===h.invalidated&&(h.cachedStats?t.throttledUpdateCachedStats(r,o,h):t.updateCachedStats(r,o,h)),!h.handles.textBox.hasMoved){var y=Object(x.default)(a.viewport,h.handles);Object.assign(h.handles.textBox,y)}var w=D(e,r.color,h.cachedStats,T,_,t.configuration);h.unit=P(T,t.configuration.showHounsfieldUnits),Object(b.drawLinkedTextBox)(e,o,h.handles.textBox,w,h.handles,function(e){return[{x:(n=(t=I(e.start,e.end)).left)+(r=t.width)/2,y:a=t.top},{x:n,y:a+(o=t.height)/2},{x:n+r/2,y:a+o},{x:n+r,y:a+o/2}];var t,n,a,r,o},m,i,10,!0)}}})}}}]),t}(m.default);function I(e,t){return{left:Math.min(e.x,t.x),top:Math.min(e.y,t.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}}function M(e,t){var n=t?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(w.default)(e.toFixed(2))).concat(n)}function P(e,t){return"CT"===e&&!1!==t?"HU":""}function D(e,t,n,a,r){var o=n.area,i=n.mean,s=n.stdDev,l=n.min,u=n.max,d=n.meanStdDevSUV,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},f=c.showMinMax||!1,h=[],m=[];if(!t){var g=d&&0!==d.mean,p=P(a,c.showHounsfieldUnits),v="Mean: ".concat(Object(w.default)(i.toFixed(2))," ").concat(p),b="Std Dev: ".concat(Object(w.default)(s.toFixed(2))," ").concat(p);if(g){for(var y=" SUV: ",x="".concat(y).concat(Object(w.default)(d.mean.toFixed(2))),j="".concat(y).concat(Object(w.default)(d.stdDev.toFixed(2))),T=Math.floor(e.measureText("".concat(b,"     ")).width);e.measureText(v).width<T;)v+=" ";m.push("".concat(v).concat(x)),m.push("".concat(b,"     ").concat(j))}else m.push("".concat(v)),m.push("".concat(b));if(f){for(var _="Min: ".concat(l," ").concat(p),E="Max: ".concat(u," ").concat(p),O=g?Math.floor(e.measureText("".concat(b,"     ")).width):Math.floor(e.measureText("".concat(v,"     ")).width);e.measureText(_).width<O;)_+=" ";m.push("".concat(_).concat(E))}}return h.push(M(o,r)),m.forEach(function(e){return h.push(e)}),h}},"./tools/annotation/TextMarkerTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./tools/base/BaseAnnotationTool.js"),p=n("./externalModules.js"),v=n("./util/pointInsideBoundingBox.js"),b=n("./stateManagement/toolColors.js"),y=n("./drawing/index.js"),x=n("./drawing/drawTextBox.js"),w=n("./stateManagement/toolState.js"),j=n("./tools/cursors/index.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:_},svgCursor:j.textMarkerCursor};return(e=l()(this,d()(t).call(this,n,a))).touchPressCallback=e._changeText.bind(f()(e)),e.doubleClickCallback=e._changeText.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){var t=this.configuration;if(t.current){var n={visible:!0,active:!0,text:t.current,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}};if(p.default.cornerstoneMath.point.insideRect(n.handles.end,{left:0,top:0,width:e.image.width,height:e.image.height})){var a=t.markers.indexOf(t.current);return(a+=t.ascending?1:-1)>=t.markers.length?a=t.loop?0:-1:a<0&&(a=t.loop?t.markers.length:-1),t.current=t.markers[a],n}}}},{key:"pointNearTool",value:function(e,t,n){if(!1===t.visible)return!1;if(t.handles.end.boundingBox){var a=p.default.cornerstoneMath.rect.distanceToPoint(t.handles.end.boundingBox,n),r=Object(v.default)(t.handles.end,n);return a<10||r}}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=e.detail,n=this.configuration,a=Object(w.getToolState)(t.element,this.name);if(a)for(var r=Object(y.getNewContext)(t.canvasContext.canvas),o=function(e){var o=a.data[e];if(!1===o.visible)return"continue";var i=b.default.getColorIfActive(o);Object(y.draw)(r,function(e){Object(y.setShadow)(e,n);var a=p.default.cornerstone.pixelToCanvas(t.element,o.handles.end);o.handles.end.boundingBox=Object(x.default)(e,o.text,a.x,a.y-10,i,{centering:{x:!0,y:!0}})})},i=0;i<a.data.length;i++)o(i)}},{key:"_changeText",value:function(e){var t,n=e.detail,a=n.element;function r(e,t,n){!0===n?Object(w.removeToolState)(a,this.name,e):e.text=t,e.active=!1,p.default.cornerstone.updateImage(a)}var o=this.configuration,i=n.currentPoints.canvas,s=Object(w.getToolState)(a,this.name);if(s)for(var l=0;l<s.data.length;l++)if(this.pointNearTool(a,t=s.data[l],i))return t.active=!0,p.default.cornerstone.updateImage(a),o.changeTextCallback(t,n,r),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation()}}]),t}(g.default),_=function(e,t,n){n(e,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./events.js"),o=n("./manipulators/index.js"),i=n("./manipulators/anyHandlesOutsideImage.js"),s=n("./stateManagement/toolState.js"),l=n("./util/triggerEvent.js"),u=n("./util/getActiveTool.js"),d=n("./tools/annotation/BidirectionalTool.js"),c=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js");t.default=function(e,t){var n=this,h=e.detail,m=h.element,g=h.image,p=h.buttons,v=this.configuration;if(!f(g)){var b=this.createNewMeasurement(h),y=function(){b.active=!1,a.default.cornerstone.updateImage(m)};Object(s.addToolState)(m,this.name,b),a.default.cornerstone.updateImage(m);var x=(new Date).getTime(),w=b.handles,j=w.end,T=w.perpendicularStart;Object(o.moveNewHandle)(h,this.name,b,j,{},t,function(e){if(e){var o=b.handles,f=b.longestDiameter,w=b.shortestDiameter,j=Object(i.default)(h,o),_=parseFloat(f)||0,E=parseFloat(w)||0,O=_<1||E<1,S=(new Date).getTime()-x<150;j||O||S?(b.cancelled=!0,Object(s.removeToolState)(m,n.name,b)):v.getMeasurementLocationCallback(b,h,y),Object(c.default)(h,b),T.locked=!1,b.invalidated=!0,a.default.cornerstone.updateImage(m);var C=Object(u.default)(m,p,t);C instanceof d.default&&C.updateCachedStats(g,m,b);var I={toolName:n.name,toolType:n.name,element:m,measurementData:b};Object(l.default)(m,r.default.MEASUREMENT_MODIFIED,I),Object(l.default)(m,r.default.MEASUREMENT_COMPLETED,I)}else Object(s.removeToolState)(m,n.name,b)})}};var f=function(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId),n=e.rowPixelSpacing,r=e.columnPixelSpacing;return t&&(n=t.rowPixelSpacing||t.rowImagePixelSpacing,r=t.columnPixelSpacing||t.colImagePixelSpacing),!n||!r}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var a=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:e,y:t,index:n,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},a)};t.default=function(e){var t=e.currentPoints.image,n=t.x,r=t.y;return{toolName:this.name,toolType:this.name,isCreating:!0,visible:!0,active:!0,invalidated:!0,handles:{start:a(n,r,0),end:a(n,r,1,{active:!0}),perpendicularStart:a(n,r,2,{locked:!0}),perpendicularEnd:a(n,r,3),textBox:a(n-50,r-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0}}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";"touch"===a?this.handleSelectedTouchCallback(e):this.handleSelectedMouseCallback(e)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./events.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./manipulators/getHandleNearImagePoint.js"),c=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),h=n("./tools/annotation/bidirectionalTool/invertHandles.js"),m=n("./store/setToolCursor.js");t.default=function(e){var t,n=this,a=e.detail,b=a.element,y=i.state.clickProximity,x=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(l.removeToolState)(b,n.name,t),e&&(e.moving=!1,e.selected=!0),Object(m.setToolCursor)(n.element,n.svgCursor),o.default.cornerstone.updateImage(b),b.addEventListener(s.default.MOUSE_MOVE,n._moveCallback),b.addEventListener(s.default.TOUCH_START,n._moveCallback)},w=a.startPoints.canvas,j=Object(l.getToolState)(e.currentTarget,this.name);if(j){for(var T=function(r){var o=d.default.apply(void 0,[b,(t=j.data[r]).handles,w,y]);if(o)return b.removeEventListener(s.default.MOUSE_MOVE,n._moveCallback),b.removeEventListener(s.default.TOUCH_START,n._moveCallback),t.active=!0,g(t.handles),o.moving=!0,(o=Object(h.default)(a,t,o)).hasBoundingBox||Object(m.hideToolCursor)(n.element),Object(f.default)(a,n.name,t,o,function(){return x(o)}),v(e),{v:!0}},_=0;_<j.data.length;_++){var E=T(_);if("object"===r()(E))return E.v}var O=function(e){return function(){p(e,!1),x()}};for(_=0;_<j.data.length;_++)if(this.pointNearTool(b,t=j.data[_],w,"mouse")){b.removeEventListener(s.default.MOUSE_MOVE,this._moveCallback),b.removeEventListener(s.default.TOUCH_START,this._moveCallback),t.active=!0,g(t.handles),p(t.handles,!0);var S=O(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"mouse",S),v(e),!0}}};var g=function(e){var t=!1;return Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)}),t},p=function(e,t){Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].moving=t)})},v=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("./externalModules.js"),i=n("./store/index.js"),s=n("./events.js"),l=n("./stateManagement/toolState.js"),u=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./manipulators/getHandleNearImagePoint.js"),c=n("./manipulators/index.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");t.default=function(e){var t,n=this,a=e.detail,p=a.element,v=i.state.touchProximity,b=function(e){t.invalidated=!0,Object(u.default)(a,t.handles)&&Object(l.removeToolState)(p,n.name,t),e&&(e.moving=!1,e.selected=!0),o.default.cornerstone.updateImage(p),p.addEventListener(s.default.TOUCH_DRAG,n._moveCallback)},y=a.startPoints.canvas,x=Object(l.getToolState)(e.currentTarget,this.name);if(x){for(var w=function(r){var o=d.default.apply(void 0,[p,(t=x.data[r]).handles,y,v]);if(o)return p.removeEventListener(s.default.TOUCH_DRAG,n._moveCallback),t.active=!0,h(t.handles),o.moving=!0,Object(f.default)(a,n.name,t,o,function(){return b(o)}),g(e),{v:!0}},j=0;j<x.data.length;j++){var T=w(j);if("object"===r()(T))return T.v}var _=function(e){return function(){m(e,!1),b()}};for(j=0;j<x.data.length;j++)if(this.pointNearTool(p,t=x.data[j],y,"touch")){p.removeEventListener(s.default.TOUCH_DRAG,this._moveCallback),t.active=!0,h(t.handles),m(t.handles,!0);var E=_(t.handles);return Object(c.moveAllHandles)(a,this.name,t,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"touch",E),g(e),!0}}};var h=function(e){var t=!1;return Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)}),t},m=function(e,t){Object.keys(e).forEach(function(n){"textBox"!==n&&(e[n].moving=t)})},g=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=function(e,t,n){var a=e[n];e[n]=t[n],t[n]=a},r=function(e,t){a(e,t,"x"),a(e,t,"y"),a(e,t,"moving"),a(e,t,"hover"),a(e,t,"active"),a(e,t,"selected")};function o(e,t,n){var a=e.image,o=a.rowPixelSpacing,i=a.columnPixelSpacing,s=t.handles,l=s.start,u=s.end,d=s.perpendicularStart,c=s.perpendicularEnd,f=(l.x-u.x)*(i||1),h=(l.y-u.y)*(o||1),m=Math.sqrt(f*f+h*h),g=(d.x-c.x)*(i||1),p=(d.y-c.y)*(o||1);return(Math.sqrt(g*g+p*p)||0)>m?(r(l,u),r(l,d),r(u,c),Object.values(s).find(function(e){return!0===e.moving})):n}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./stateManagement/toolCoordinates.js"),o=n("./manipulators/getHandleNearImagePoint.js"),i=n("./stateManagement/toolState.js");t.default=function(e){var t=this,n=e.detail,s=n.element;r.default.setCoords(n);var l=Object(i.getToolState)(s,this.name);if(l){for(var u=!1,d=function(e){var a=n.currentPoints.canvas,r=l.data[e],i=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=Object(o.default)(e,t,n,a),i=!1;return Object.keys(t).forEach(function(e){if("textBox"!==e){var n=t[e],a=n===r;n.active!==a&&(i=!0),n.active=a}}),i}(s,r.handles,a);Object.keys(r.handles).forEach(function(e){if("textBox"!==e){var t=r.handles[e];t.hover=t.active}}),i&&(u=!0);var d=t.pointNearTool(s,r,a,"mouse");(d&&!r.active||!d&&r.active)&&(r.active=!r.active,u=!0)},c=0;c<l.data.length;c++)d(c);!0===u&&a.default.cornerstone.updateImage(s)}}},"./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function o(e,t){return{start:e,end:t}}function i(e,t,n){var i=a.default.cornerstoneMath.lineSegment,s=e.handles,l=s.start,u=s.end,d=s.perpendicularStart,c=s.perpendicularEnd,f=t.image,h=f.columnPixelSpacing,m=void 0===h?1:h,g=f.rowPixelSpacing,p=void 0===g?1:g,v=o(l,u),b=o(d,c),y=i.intersectLine(v,b);return{columnPixelSpacing:m,rowPixelSpacing:p,start:l,end:u,perpendicularStart:d,perpendicularEnd:c,longLine:v,intersection:y,distanceToFixed:Object(r.default)(m,p,n,y),fixedPoint:n}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),s=n("./util/getActiveTool.js"),l=n("./tools/base/BaseAnnotationTool.js");t.default=function(e,t,n,u,d,c){var f=e.element,h=e.image,m=e.buttons,g={x:u.x-e.currentPoints.image.x,y:u.y-e.currentPoints.image.y},p=function(e){var r=e.detail;u.hasMoved=!0,null==u.index?(u.x=r.currentPoints.image.x+g.x,u.y=r.currentPoints.image.y+g.y):Object(i.default)(u,r,n,g),c&&(u.x=Math.max(u.x,0),u.x=Math.min(u.x,r.image.width),u.y=Math.max(u.y,0),u.y=Math.min(u.y,r.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(f);var d=Object(s.default)(f,m,"mouse");d instanceof l.default&&d.updateCachedStats(h,f,n),a.default.cornerstone.triggerEvent(f,o.default.MEASUREMENT_MODIFIED,{toolName:t,toolType:t,element:f,measurementData:n})};u.active=!0,u.moving=!0,r.state.isToolLocked=!0,f.addEventListener(o.default.MOUSE_DRAG,p),f.addEventListener(o.default.TOUCH_DRAG,p);var v=a.default.cornerstone.getImage(f),b=function(){a.default.cornerstone.getImage(f).imageId!==v.imageId&&y()};f.addEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,b);var y=function e(){u.active=!1,r.state.isToolLocked=!1,f.removeEventListener(a.default.cornerstone.EVENTS.IMAGE_RENDERED,b),f.removeEventListener(o.default.MOUSE_DRAG,p),f.removeEventListener(o.default.MOUSE_UP,e),f.removeEventListener(o.default.MOUSE_CLICK,e),f.removeEventListener(o.default.TOUCH_DRAG,p),f.removeEventListener(o.default.TOUCH_DRAG_END,e),f.removeEventListener(o.default.TAP,e),a.default.cornerstone.updateImage(f),"function"==typeof d&&d()};f.addEventListener(o.default.MOUSE_UP,y),f.addEventListener(o.default.MOUSE_CLICK,y),f.addEventListener(o.default.TOUCH_DRAG_END,y),f.addEventListener(o.default.TAP,y)}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js");function i(e,t,n,i){var s=Object(r.default)(t,n,i),l=s.columnPixelSpacing,u=s.rowPixelSpacing,d=s.distanceToFixed,c=Object(a.default)(l,u,i,e);if(c<=d)return!1;var f=d/c,h={x:i.x+(e.x-i.x)*f,y:i.y+(e.y-i.y)*f},m=Object(o.default)(s,h);return t.handles.perpendicularStart.x=m.start.x,t.handles.perpendicularStart.y=m.start.y,t.handles.perpendicularEnd.x=m.end.x,t.handles.perpendicularEnd.y=m.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),r=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function o(e,t){var n=e.columnPixelSpacing,o=e.rowPixelSpacing,i=e.start,s=e.perpendicularStart,l=e.perpendicularEnd,u=e.intersection,d=e.fixedPoint,c=Object(r.default)(n,o,s,u),f=Object(r.default)(n,o,l,u),h=Object(a.default)(n,o,d,t),m=d===i?1:-1,g=m*o,p=m*n;return{start:{x:t.x+h.y*c*g,y:t.y+h.x*c*p*-1},end:{x:t.x+h.y*f*g*-1,y:t.y+h.x*f*p}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function r(e,t){return Object(a.default)(e,t)?-1:1}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js");function r(e,t,n){var r=e.columnPixelSpacing,o=e.rowPixelSpacing,i=e.perpendicularEnd,s=e.fixedPoint,l=Number.MAX_SAFE_INTEGER,u=Object(a.default)(s,i)*l;return{start:t,end:{x:t.x+n.y*o*u,y:t.y+n.x*r*u*-1}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function r(e,t,n){return Object(a.default)(e,n)?t:n}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js":function(e,t,n){"use strict";function a(e,t){return e===t}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function r(e,t,n){return 0!==Object(a.default)(e,t,n.start,n.end)}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js"),s=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js"),l=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js");function u(e,t,n,u){var d=a.default.cornerstoneMath.lineSegment,c=Object(o.default)(t,n,u),f=c.columnPixelSpacing,h=c.rowPixelSpacing,m=c.start,g=c.longLine,p=c.intersection;if(!Object(i.default)(f,h,g))return!1;var v=Object(r.default)(f,h,m,p),b=Object(s.default)(c,e,v),y=d.intersectLine(g,b);if(!y)return!1;var x=Object(l.default)(c,y,b,v);return t.handles.perpendicularStart.x=x.start.x,t.handles.perpendicularStart.y=x.start.y,t.handles.perpendicularEnd.x=x.end.x,t.handles.perpendicularEnd.y=x.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return s});var a=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),r=n.n(a),o=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js");function s(e,t,n,a){var s,l=e.columnPixelSpacing,u=e.rowPixelSpacing,d=e.fixedPoint,c=e.perpendicularStart,f=e.perpendicularEnd,h=e.distanceToFixed,m=Object(o.default)(d,f)*h,g=Object(i.default)(d,c,f)===c,p=g?"start":"end",v=g?"end":"start";return s={},r()(s,p,{x:n.start.x,y:n.start.y}),r()(s,v,{x:t.x+a.y*u*m,y:t.y+a.x*l*m*-1}),s}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js");t.default=function(e,t,n,i){var s,l,u,d,c={},f={},h={x:t.currentPoints.image.x+i.x,y:t.currentPoints.image.y+i.y};0===e.index?Object(r.default)(h,n,t,n.handles.end)?(e.x=h.x,e.y=h.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):1===e.index?Object(r.default)(h,n,t,n.handles.start)?(e.x=h.x,e.y=h.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):2===e.index?(s=!1,c.start={x:n.handles.start.x,y:n.handles.start.y},c.end={x:n.handles.end.x,y:n.handles.end.y},f.start={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},f.end={x:h.x,y:h.y},(l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f))||(f.end={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f),u=a.default.cornerstoneMath.point.distance(l,n.handles.start),d=a.default.cornerstoneMath.point.distance(l,n.handles.end),(!l||u<3||d<3)&&(s=!0)),s||Object(o.default)(h,n,t,n.handles.perpendicularEnd)||(t.currentPoints.image.x=n.handles.perpendicularStart.x,t.currentPoints.image.y=n.handles.perpendicularStart.y)):3===e.index&&(s=!1,c.start={x:n.handles.start.x,y:n.handles.start.y},c.end={x:n.handles.end.x,y:n.handles.end.y},f.start={x:n.handles.perpendicularStart.x,y:n.handles.perpendicularStart.y},f.end={x:h.x,y:h.y},(l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f))||(f.end={x:n.handles.perpendicularEnd.x,y:n.handles.perpendicularEnd.y},l=a.default.cornerstoneMath.lineSegment.intersectLine(c,f),u=a.default.cornerstoneMath.point.distance(l,n.handles.start),d=a.default.cornerstoneMath.point.distance(l,n.handles.end),(!l||u<3||d<3)&&(s=!0)),s||Object(o.default)(h,n,t,n.handles.perpendicularStart)||(t.currentPoints.image.x=n.handles.perpendicularEnd.x,t.currentPoints.image.y=n.handles.perpendicularEnd.y))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./store/index.js"),o=n("./events.js"),i=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),s=n("./util/getActiveTool.js"),l=n("./tools/base/BaseAnnotationTool.js"),u=[o.default.TOUCH_END,o.default.TOUCH_DRAG_END,o.default.TOUCH_PINCH,o.default.TOUCH_PRESS,o.default.TAP];t.default=function(e,t,n,d,c,f){var h=e.element,m=e.image,g=e.buttons,p={x:d.x-e.currentPoints.image.x,y:d.y-e.currentPoints.image.y},v=function(e){var r=e.detail;d.hasMoved=!0,null==d.index?(d.x=r.currentPoints.image.x+p.x,d.y=r.currentPoints.image.y+p.y):Object(i.default)(d,r,n,p),f&&(d.x=Math.max(d.x,0),d.x=Math.min(d.x,r.image.width),d.y=Math.max(d.y,0),d.y=Math.min(d.y,r.image.height)),n.invalidated=!0,a.default.cornerstone.updateImage(h);var u=Object(s.default)(h,g,"touch");u instanceof l.default&&u.updateCachedStats(m,h,n),a.default.cornerstone.triggerEvent(h,o.default.MEASUREMENT_MODIFIED,{toolName:t,toolType:t,element:h,measurementData:n})};d.active=!0,r.state.isToolLocked=!0,h.addEventListener(o.default.TOUCH_DRAG,v);var b=function e(){d.active=!1,r.state.isToolLocked=!1,h.removeEventListener(o.default.TOUCH_DRAG,v),u.forEach(function(t){h.removeEventListener(t,e)}),a.default.cornerstone.updateImage(h),"function"==typeof c&&c()};u.forEach(function(e){h.addEventListener(e,b)})}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(e,t,n){"use strict";n.r(t);var a=n("./store/index.js"),r=n("./externalModules.js"),o=n("./util/pointInsideBoundingBox.js"),i=function(e,t,n,a){var o=r.default.cornerstone,i=r.default.cornerstoneMath,s={start:o.pixelToCanvas(e,t.perpendicularStart),end:o.pixelToCanvas(e,t.perpendicularEnd)};return i.lineSegment.distanceToPoint(s,n)<a};t.default=function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",l=r.default.cornerstone,u=r.default.cornerstoneMath,d=t.handles,c={start:l.pixelToCanvas(e,d.start),end:l.pixelToCanvas(e,d.end)},f=u.lineSegment.distanceToPoint(c,n);if(Object(o.default)(d.textBox,n))return!0;var h="mouse"===s?a.state.clickProximity:a.state.touchProximity;return!!i(e,d,n,h)||f<h}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./drawing/drawHandles.js"),i=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),s=n("./store/index.js"),l=n("./stateManagement/toolStyle.js"),u=n("./stateManagement/toolColors.js"),d=n("./stateManagement/toolState.js"),c=n("./drawing/index.js"),f=n("./drawing/drawLinkedTextBox.js"),h=n("./util/getPixelSpacing.js");t.default=function(e){var t=this,n=e.detail,a=n.element,r=n.canvasContext,g=n.image,p=this.configuration,v=p.handleRadius,b=p.drawHandlesOnHover,y=p.hideHandlesIfMoving,x=p.renderDashed,w=Object(s.getModule)("globalConfiguration").configuration.lineDash,j=Object(d.getToolState)(a,this.name);if(j){var T=Object(h.default)(g),_=T.rowPixelSpacing,E=T.colPixelSpacing;if(_&&E)for(var O,S=Object(c.getNewContext)(r.canvas),C=u.default.getActiveColor(),I=l.default.getToolWidth(),M=function(e){var r=j.data[e];if(!1===r.visible)return"continue";O=r.active?C:u.default.getToolColor(),!0===r.invalidated&&(r.longestDiameter&&r.shortestDiameter?t.throttledUpdateCachedStats(g,a,r):t.updateCachedStats(g,a,r)),Object(c.draw)(S,function(e){Object(c.setShadow)(e,t.configuration);var s=r.handles,l=s.start,u=s.end,d=s.perpendicularStart,h=s.perpendicularEnd,g=s.textBox,p={color:O},j={color:O,strokeWidth:T};x&&(p.lineDash=w,j.lineDash=w),Object(c.drawLine)(e,a,l,u,p);var T=I;Object(i.default)(n,r),Object(c.drawLine)(e,a,d,h,j);var S={color:O,handleRadius:v,drawHandlesIfActive:b,hideHandlesIfMoving:y};t.configuration.drawHandles&&Object(o.default)(e,n,r.handles,S);var C=m(r,_,E);Object(f.default)(e,a,g,C,r.handles,function(e){return[e.start,e.end,e.perpendicularStart,e.perpendicularEnd]},O,I,10,!0)})},P=0;P<j.data.length;P++)M(P)}};var m=function(e,t,n){var a=" mm";t&&n||(a=" pixels");var o=" L ".concat(e.longestDiameter).concat(a),i=" W ".concat(e.shortestDiameter).concat(a),s=e.labels;return s&&Array.isArray(s)?[].concat(r()(s),[o,i]):[o,i]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(e,t,n){"use strict";function a(e,t){var n=t.rowPixelSpacing,a=t.colPixelSpacing,r=e.handles,o=r.start,i=r.end,s=r.perpendicularStart,l=r.perpendicularEnd,u=(o.x-i.x)*(a||1),d=(o.y-i.y)*(n||1),c=Math.sqrt(u*u+d*d),f=(s.x-l.x)*(a||1),h=(s.y-l.y)*(n||1),m=Math.sqrt(f*f+h*h);if(m||(m=0),m>c){var g=c;c=m,m=g}return{longestDiameter:c.toFixed(1),shortestDiameter:m.toFixed(1)}}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js":function(e,t,n){"use strict";function a(e,t,n,a){var r=(n.x-a.x)/t,o=(n.y-a.y)/e;return Math.sqrt(r*r+o*o)}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/getLineVector.js":function(e,t,n){"use strict";function a(e,t,n,a){var r=(n.x-a.x)*e,o=(n.y-a.y)*t,i=Math.sqrt(r*r+o*o);return{x:r/i,y:o/i,length:i}}n.r(t),n.d(t,"default",function(){return a})},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js");function r(e,t){if(!t.handles.perpendicularStart.locked)return!1;var n,r,o,i,s=t.handles,l=s.start,u=s.end,d=e.image,c=d.columnPixelSpacing,f=void 0===c?1:c,h=d.rowPixelSpacing,m=void 0===h?1:h;if(l.x===u.x&&l.y===u.y)n=l.x,r=l.y,o=u.x,i=u.y;else{var g={x:(l.x+u.x)/2,y:(l.y+u.y)/2},p=Object(a.default)(f,m,l,u),v=p.length/2,b=v/(2*m),y=v/(2*f);n=g.x+y*p.y,r=g.y-b*p.x,o=g.x-y*p.y,i=g.y+b*p.x}return t.handles.perpendicularStart.x=n,t.handles.perpendicularStart.y=r,t.handles.perpendicularEnd.x=o,t.handles.perpendicularEnd.y=i,!0}},"./tools/annotation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/annotation/AngleTool.js"),r=n("./tools/annotation/ArrowAnnotateTool.js"),o=n("./tools/annotation/BidirectionalTool.js"),i=n("./tools/annotation/CircleRoiTool.js"),s=n("./tools/annotation/CobbAngleTool.js"),l=n("./tools/annotation/EllipticalRoiTool.js"),u=n("./tools/annotation/FreehandRoiTool.js"),d=n("./tools/annotation/LengthTool.js"),c=n("./tools/annotation/ProbeTool.js"),f=n("./tools/annotation/RectangleRoiTool.js"),h=n("./tools/annotation/TextMarkerTool.js");n.d(t,"AngleTool",function(){return a.default}),n.d(t,"ArrowAnnotateTool",function(){return r.default}),n.d(t,"BidirectionalTool",function(){return o.default}),n.d(t,"CircleRoiTool",function(){return i.default}),n.d(t,"CobbAngleTool",function(){return s.default}),n.d(t,"EllipticalRoiTool",function(){return l.default}),n.d(t,"FreehandRoiTool",function(){return u.default}),n.d(t,"LengthTool",function(){return d.default}),n.d(t,"ProbeTool",function(){return c.default}),n.d(t,"RectangleRoiTool",function(){return f.default}),n.d(t,"TextMarkerTool",function(){return h.default}),t.default={AngleTool:a.default,ArrowAnnotateTool:r.default,BidirectionalTool:o.default,CircleRoiTool:i.default,CobbAngleTool:s.default,EllipticalRoiTool:l.default,FreehandRoiTool:u.default,LengthTool:d.default,ProbeTool:c.default,RectangleRoiTool:f.default,TextMarkerTool:h.default}},"./tools/base/BaseAnnotationTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(c),h=n("./tools/base/BaseTool.js"),m=n("./stateManagement/toolState.js"),g=n("./manipulators/handleActivator.js"),p=n("./util/findAndMoveHelpers.js"),v=n("./util/logger.js"),b=Object(v.getLogger)("baseAnnotationTool");t.default=function(e){function t(){return r()(this,t),l()(this,d()(t).apply(this,arguments))}return f()(t,e),i()(t,[{key:"createNewMeasurement",value:function(e){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function(e,t,n){throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function(e,t,n){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function(e){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function(e){for(var t=e.detail,n=t.element,a=t.currentPoints.canvas,r=Object(m.getToolState)(n,this.name),o=!1,i=0;i<r.data.length;i++){var s=r.data[i];!0===Object(g.default)(n,s.handles,a)&&(o=!0);var l=this.pointNearTool(n,s,a,"mouse")&&!s.active,u=!this.pointNearTool(n,s,a,"mouse")&&s.active;(l||u)&&(s.active=!s.active,o=!0)}return o}},{key:"handleSelectedCallback",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";Object(p.moveHandleNearImagePoint)(e,this,t,n,a)}},{key:"toolSelectedCallback",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";Object(p.moveAnnotation)(e,this,t,n)}},{key:"updateCachedStats",value:function(e,t,n){b.warn("updateCachedStats not implemented for ".concat(this.name,"."))}}]),t}(h.default)},"./tools/base/BaseBrushTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./tools/base/BaseTool.js"),p=n("./events.js"),v=n("./externalModules.js"),b=n("./store/isToolActiveForElement.js"),y=n("./store/index.js"),x=n("./util/segmentation/index.js"),w=Object(y.getModule)("segmentation");t.default=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r()(this,t),a.configuration||(a.configuration={alwaysEraseOnClick:!1}),(n=l()(this,d()(t).call(this,e,a))).updateOnMouseMove=!0,n.hideDefaultCursor=!0,n._drawing=!1,n._drawingMouseUpCallback=n._drawingMouseUpCallback.bind(f()(n)),n}return m()(t,e),i()(t,[{key:"renderBrush",value:function(e){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function(e){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function(e){this._lastImageCoords=e.detail.currentPoints.image,this._drawing&&this._paint(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=t.element,a=t.currentPoints;return this._startPainting(e),this._lastImageCoords=a.image,this._drawing=!0,this._startListeningForMouseUp(n),this._paint(e),!0}},{key:"_startPainting",value:function(e){var t=e.detail,n=w.configuration,a=w.getters.labelmap2D(t.element),r=a.labelmap2D,o=a.labelmap3D,i=a.currentImageIdIndex,s=a.activeLabelmapIndex,l=this._isCtrlDown(t)||this.configuration.alwaysEraseOnClick;if(this.paintEventData={labelmap2D:r,labelmap3D:o,currentImageIdIndex:i,activeLabelmapIndex:s,shouldErase:l},n.storeHistory){var u=r.pixelData.slice();this.paintEventData.previousPixelData=u}}},{key:"_endPainting",value:function(e){for(var t=w.configuration,n=w.setters,a=this.paintEventData,r=a.labelmap2D,o=a.currentImageIdIndex,i=new Set(r.pixelData).values(),s=[],l=!1;!l;){var u=i.next();(l=u.done)||s.push(u.value)}if(r.segmentsOnLabelmap=s,t.storeHistory){var d=this.paintEventData.previousPixelData,c=r.pixelData,f={imageIdIndex:o,diff:Object(x.getDiffBetweenPixelData)(d,c)};n.pushState(this.element,[f])}Object(x.triggerLabelmapModifiedEvent)(this.element)}},{key:"mouseMoveCallback",value:function(e){this._lastImageCoords=e.detail.currentPoints.image}},{key:"renderToolData",value:function(e){var t=e.detail.element;Object(b.default)(t,this.name)&&this.renderBrush(e)}},{key:"passiveCallback",value:function(e){try{v.default.cornerstone.updateImage(this.element)}catch(t){return}}},{key:"_drawingMouseUpCallback",value:function(e){var t=e.detail.element;this._endPainting(e),this._drawing=!1,this._mouseUpRender=!0,this._stopListeningForMouseUp(t)}},{key:"newImageCallback",value:function(e){this._drawing&&(this._endPainting(e),this._startPainting(e))}},{key:"_startListeningForMouseUp",value:function(e){e.removeEventListener(p.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(p.default.MOUSE_CLICK,this._drawingMouseUpCallback),e.addEventListener(p.default.MOUSE_UP,this._drawingMouseUpCallback),e.addEventListener(p.default.MOUSE_CLICK,this._drawingMouseUpCallback),v.default.cornerstone.updateImage(e)}},{key:"_stopListeningForMouseUp",value:function(e){e.removeEventListener(p.default.MOUSE_UP,this._drawingMouseUpCallback),e.removeEventListener(p.default.MOUSE_CLICK,this._drawingMouseUpCallback),v.default.cornerstone.updateImage(e)}},{key:"increaseBrushSize",value:function(){var e=w.setters,t=w.configuration.radius,n=Math.floor(1.2*t);n===t&&(n+=1),e.radius(n)}},{key:"decreaseBrushSize",value:function(){var e=w.setters,t=Math.floor(.8*w.configuration.radius);e.radius(t)}},{key:"_isCtrlDown",value:function(e){return e.event&&e.event.ctrlKey||e.ctrlKey}}]),t}(g.default)},"./tools/base/BaseTool.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(s),u=n("./mixins/index.js"),d=n("./util/logger.js"),c=n("./util/deepmerge.js"),f=n("./store/setToolCursor.js"),h=n("./store/index.js"),m=Object(d.getLogger)("tools:base:BaseTool"),g=Object(h.getModule)("globalConfiguration");t.default=function(){function e(t,n){i()(this,e),this.initialConfiguration=Object(c.default)(n,t);var a=this.initialConfiguration,r=a.strategies,o=a.defaultStrategy,s=a.configuration,l=a.supportedInteractionTypes,u=a.mixins,d=a.svgCursor;this.name=a.name,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=l||[],this.strategies=r||{},this.defaultStrategy=o||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,d&&(this.svgCursor=d),this._options={},this._configuration=Object.assign({},s),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,u&&u.length&&this._applyMixins(u),this._cursors=Object.assign({},this.initialConfiguration.cursors);var f=this.defaultStrategy&&this._cursors[this.activeStrategy];f&&(this.svgCursor=f)}return l()(e,[{key:"mergeOptions",value:function(e){this._options=Object.assign({},this._options,e)}},{key:"clearOptions",value:function(){this._options={}}},{key:"applyActiveStrategy",value:function(e,t){return this.strategies[this.activeStrategy].call(this,e,t)}},{key:"_applyMixins",value:function(e){for(var t=0;t<e.length;t++){var n=u.default["".concat(e[t])];"object"===r()(n)?(Object.assign(this,n),"function"==typeof this.initializeMixin&&this.initializeMixin()):m.warn("".concat(this.name,": mixin ").concat(u.default[t]," does not exist."))}"function"===this.initializeMixin&&delete this.initializeMixin}},{key:"setActiveStrategy",value:function(e){this.activeStrategy=e,g.configuration.showSVGCursors&&this.changeCursor(this.element,e)}},{key:"changeCursor",value:function(e,t){if(e){var n=this._cursors[t];n&&(this.svgCursor=n,"active"===this.mode&&Object(f.setToolCursor)(e,n))}}},{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"options",get:function(){return this._options}}],[{key:"configuration",get:function(){}}]),e}()},"./tools/base/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/base/BaseAnnotationTool.js"),r=n("./tools/base/BaseTool.js"),o=n("./tools/base/BaseBrushTool.js");n.d(t,"BaseAnnotationTool",function(){return a.default}),n.d(t,"BaseBrushTool",function(){return o.default}),n.d(t,"BaseTool",function(){return r.default}),t.default={BaseAnnotationTool:a.default,BaseBrushTool:o.default,BaseTool:r.default}},"./tools/cursors/MouseCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./stateManagement/toolColors.js"),l=n("./store/index.js").modules.cursor,u=function(){function e(t,n){r()(this,e),this.iconGroupString=t,this.options=Object.assign({},l.getters.defaultOptions(),n)}return i()(e,[{key:"getIconSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(e)}},{key:"getIconWithPointerSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconWithPointerSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(e)}},{key:"_generateIconWithPointerSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.mousePointerGroupString,a=t.iconSize,r=t.viewBox,o=a/Math.max(r.x,r.y),i=16+a,s='\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(i,'" height="').concat(i,'" viewBox="0 0 ').concat(i," ").concat(i,'"\n      >\n        <g>\n          ').concat(n,'\n        </g>\n        <g transform="translate(16, 16) scale(').concat(o,')">\n          ').concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(s,t)}},{key:"_generateIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.iconSize,a=t.viewBox,r='\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(n,'" height="').concat(n,'" viewBox="0 0\n        ').concat(a.x," ").concat(a.y,'"\n      >\n        ').concat(this.iconGroupString,"\n      </svg>");return this._injectColors(r,t)}},{key:"_injectColors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.activeColor||s.default.getActiveColor(),a=t.toolColor||s.default.getToolColor(),r=t.fillColor||s.default.getFillColor();return e.replace(/ACTIVE_COLOR/g,"".concat(n)).replace(/TOOL_COLOR/g,"".concat(a)).replace(/FILL_COLOR/g,"".concat(r))}},{key:"mousePoint",get:function(){var e=this.options.mousePoint;return"".concat(e.x," ").concat(e.y)}}]),e}()},"./tools/cursors/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"angleCursor",function(){return r}),n.d(t,"arrowAnnotateCursor",function(){return o}),n.d(t,"bidirectionalCursor",function(){return i}),n.d(t,"cobbAngleCursor",function(){return s}),n.d(t,"circleRoiCursor",function(){return l}),n.d(t,"ellipticalRoiCursor",function(){return u}),n.d(t,"freehandRoiCursor",function(){return d}),n.d(t,"freehandRoiSculptorCursor",function(){return c}),n.d(t,"lengthCursor",function(){return f}),n.d(t,"probeCursor",function(){return h}),n.d(t,"rectangleRoiCursor",function(){return m}),n.d(t,"textMarkerCursor",function(){return g}),n.d(t,"crosshairsCursor",function(){return p}),n.d(t,"eraserCursor",function(){return v}),n.d(t,"magnifyCursor",function(){return b}),n.d(t,"panCursor",function(){return y}),n.d(t,"rotateCursor",function(){return x}),n.d(t,"stackScrollCursor",function(){return w}),n.d(t,"wwwcRegionCursor",function(){return j}),n.d(t,"wwwcCursor",function(){return T}),n.d(t,"zoomCursor",function(){return _}),n.d(t,"freehandEraseInsideCursor",function(){return P}),n.d(t,"freehandFillInsideCursor",function(){return D}),n.d(t,"freehandEraseOutsideCursor",function(){return k}),n.d(t,"freehandFillOutsideCursor",function(){return L}),n.d(t,"segRectangleEraseInsideCursor",function(){return A}),n.d(t,"segRectangleFillInsideCursor",function(){return R}),n.d(t,"segRectangleEraseOutsideCursor",function(){return B}),n.d(t,"segRectangleFillOutsideCursor",function(){return F}),n.d(t,"segCircleEraseInsideCursor",function(){return U}),n.d(t,"segCircleFillInsideCursor",function(){return H}),n.d(t,"segCircleEraseOutsideCursor",function(){return N}),n.d(t,"segCircleFillOutsideCursor",function(){return z});var a=n("./tools/cursors/MouseCursor.js"),r=new a.default('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />',{viewBox:{x:1792,y:1792}}),o=new a.default('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',{viewBox:{x:24,y:24}}),i=new a.default('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',{viewBox:{x:48,y:48}}),s=new a.default('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',{viewBox:{x:32,y:32}}),l=new a.default('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',{viewBox:{x:32,y:32}}),u=new a.default('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />',{viewBox:{x:32,y:32}}),d=new a.default('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',{viewBox:{x:18,y:18}}),c=new a.default('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>',{viewBox:{x:18,y:18}}),f=new a.default('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',{viewBox:{x:24,y:24}}),h=new a.default('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />',{viewBox:{x:1792,y:1792}}),m=new a.default('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),g=new a.default('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />',{viewBox:{x:1792,y:1792}}),p=new a.default('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />',{viewBox:{x:1792,y:1792}}),v=new a.default('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />',{viewBox:{x:2048,y:1792}}),b=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />',{viewBox:{x:512,y:512}}),y=new a.default('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />',{viewBox:{x:1792,y:1792}}),x=new a.default('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />',{viewBox:{x:1792,y:1792}}),w=new a.default('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />',{viewBox:{x:24,y:28}}),j=new a.default('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),T=new a.default('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />',{viewBox:{x:18,y:18}}),_=new a.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />',{viewBox:{x:640,y:512}}),E={x:127,y:60},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>')},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>\n      <rect fill="').concat(e,'" x="95.84" y="9.38" width="15.85" height="47.14"/>')},C='<path fill="ACTIVE_COLOR" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',I='<path fill="ACTIVE_COLOR" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',M='<path fill="ACTIVE_COLOR" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',P=new a.default("".concat(C," ").concat(O()),{viewBox:E}),D=new a.default("".concat(C," ").concat(S()),{viewBox:E}),k=new a.default("".concat(C," ").concat(O()),{viewBox:E}),L=new a.default("".concat(C," ").concat(S()),{viewBox:E}),A=new a.default("".concat(I," ").concat(O()),{viewBox:E}),R=new a.default("".concat(I," ").concat(S()),{viewBox:E}),B=new a.default("".concat(I," ").concat(O()),{viewBox:E}),F=new a.default("".concat(I," ").concat(S()),{viewBox:E}),U=new a.default("".concat(M," ").concat(O()),{viewBox:E}),H=new a.default("".concat(M," ").concat(S()),{viewBox:E}),N=new a.default("".concat(M," ").concat(O()),{viewBox:E}),z=new a.default("".concat(M," ").concat(S()),{viewBox:E})},"./tools/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/CrosshairsTool.js");n.d(t,"CrosshairsTool",function(){return a.default});var r=n("./tools/DoubleTapFitToWindowTool.js");n.d(t,"DoubleTapFitToWindowTool",function(){return r.default});var o=n("./tools/DragProbeTool.js");n.d(t,"DragProbeTool",function(){return o.default});var i=n("./tools/EraserTool.js");n.d(t,"EraserTool",function(){return i.default});var s=n("./tools/FreehandRoiSculptorTool.js");n.d(t,"FreehandRoiSculptorTool",function(){return s.default});var l=n("./tools/MagnifyTool.js");n.d(t,"MagnifyTool",function(){return l.default});var u=n("./tools/OverlayTool.js");n.d(t,"OverlayTool",function(){return u.default});var d=n("./tools/OrientationMarkersTool.js");n.d(t,"OrientationMarkersTool",function(){return d.default});var c=n("./tools/PanMultiTouchTool.js");n.d(t,"PanMultiTouchTool",function(){return c.default});var f=n("./tools/PanTool.js");n.d(t,"PanTool",function(){return f.default});var h=n("./tools/ReferenceLinesTool.js");n.d(t,"ReferenceLinesTool",function(){return h.default});var m=n("./tools/RotateTool.js");n.d(t,"RotateTool",function(){return m.default});var g=n("./tools/RotateTouchTool.js");n.d(t,"RotateTouchTool",function(){return g.default});var p=n("./tools/ScaleOverlayTool.js");n.d(t,"ScaleOverlayTool",function(){return p.default});var v=n("./tools/StackScrollMouseWheelTool.js");n.d(t,"StackScrollMouseWheelTool",function(){return v.default});var b=n("./tools/StackScrollMultiTouchTool.js");n.d(t,"StackScrollMultiTouchTool",function(){return b.default});var y=n("./tools/StackScrollTool.js");n.d(t,"StackScrollTool",function(){return y.default});var x=n("./tools/WwwcRegionTool.js");n.d(t,"WwwcRegionTool",function(){return x.default});var w=n("./tools/WwwcTool.js");n.d(t,"WwwcTool",function(){return w.default});var j=n("./tools/ZoomMouseWheelTool.js");n.d(t,"ZoomMouseWheelTool",function(){return j.default});var T=n("./tools/ZoomTool.js");n.d(t,"ZoomTool",function(){return T.default});var _=n("./tools/ZoomTouchPinchTool.js");n.d(t,"ZoomTouchPinchTool",function(){return _.default}),t.default={CrosshairsTool:a.default,DoubleTapFitToWindowTool:r.default,DragProbeTool:o.default,EraserTool:i.default,FreehandRoiSculptorTool:s.default,MagnifyTool:l.default,OverlayTool:u.default,OrientationMarkersTool:d.default,PanMultiTouchTool:c.default,PanTool:f.default,ReferenceLinesTool:h.default,RotateTool:m.default,RotateTouchTool:g.default,ScaleOverlayTool:p.default,StackScrollMouseWheelTool:v.default,StackScrollMultiTouchTool:b.default,StackScrollTool:y.default,WwwcRegionTool:x.default,WwwcTool:w.default,ZoomMouseWheelTool:j.default,ZoomTool:T.default,ZoomTouchPinchTool:_.default}},"./tools/referenceLines/calculateReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/pointProjector.js");t.default=function(e,t){var n=Object(a.planePlaneIntersection)(e,t);if(n)return{start:Object(a.projectPatientPointToImagePlane)(n.start,e),end:Object(a.projectPatientPointToImagePlane)(n.end,e)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=n("./tools/referenceLines/calculateReferenceLine.js"),o=n("./stateManagement/toolColors.js"),i=n("./util/convertToVector3.js"),s=n("./drawing/index.js");t.default=function(e,t,n,l){var u=a.default.cornerstone,d=u.getEnabledElement(n).image,c=u.getEnabledElement(l).image;if(d&&c){var f=u.metaData.get("imagePlaneModule",d.imageId),h=u.metaData.get("imagePlaneModule",c.imageId);if(f&&h&&f.rowCosines&&f.columnCosines&&f.imagePositionPatient&&h.rowCosines&&h.columnCosines&&h.imagePositionPatient&&f.frameOfReferenceUID===h.frameOfReferenceUID){f.rowCosines=Object(i.default)(f.rowCosines),f.columnCosines=Object(i.default)(f.columnCosines),f.imagePositionPatient=Object(i.default)(f.imagePositionPatient),h.rowCosines=Object(i.default)(h.rowCosines),h.columnCosines=Object(i.default)(h.columnCosines),h.imagePositionPatient=Object(i.default)(h.imagePositionPatient);var m=f.rowCosines.clone().cross(f.columnCosines),g=h.rowCosines.clone().cross(h.columnCosines),p=m.angleTo(g);if(!((p=Math.abs(p))<.5)){var v=Object(r.default)(f,h);if(v){var b=o.default.getActiveColor();e.setTransform(1,0,0,1,0,0),Object(s.draw)(e,function(e){Object(s.drawLine)(e,t.element,v.start,v.end,{color:b})})}}}}}},"./tools/segmentation/BrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return w});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./tools/base/index.js"),v=n("./store/index.js"),b=n("./util/segmentation/index.js"),y=n("./util/logger.js"),x=(Object(y.getLogger)("tools:BrushTool"),Object(v.getModule)("segmentation")),w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],configuration:{},mixins:["renderBrushMixin"]};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._paint.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_paint",value:function(e){var t=e.detail,n=t.image,a=n.rows,r=n.columns,o=t.currentPoints.image,i=o.x,s=o.y;if(!(i<0||i>r||s<0||s>a)){var l=x.configuration.radius,u=Object(b.getCircle)(l,a,r,i,s),d=this.paintEventData,c=d.labelmap2D,f=d.labelmap3D,h=d.shouldErase;Object(b.drawBrushPixels)(u,c.pixelData,f.activeSegmentIndex,r,h),g.default.cornerstone.updateImage(e.detail.element)}}}]),t}(p.BaseBrushTool)},"./tools/segmentation/CircleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/segmentation/strategies/index.js"),h=n("./tools/cursors/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"CircleScissors",strategies:{FILL_INSIDE:f.fillInsideCircle,FILL_OUTSIDE:f.fillOutsideCircle,ERASE_OUTSIDE:f.eraseOutsideCircle,ERASE_INSIDE:f.eraseInsideCircle},cursors:{FILL_INSIDE:h.segCircleFillInsideCursor,FILL_OUTSIDE:h.segCircleFillOutsideCursor,ERASE_OUTSIDE:h.segCircleEraseOutsideCursor,ERASE_INSIDE:h.segCircleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:h.segCircleFillInsideCursor,mixins:["circleSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/CorrectionScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/cursors/index.js"),h=n("./tools/segmentation/strategies/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"CorrectionScissors",strategies:{CORRECTION:h.correction},cursors:{CORRECTION:f.freehandFillInsideCursor},defaultStrategy:"CORRECTION",supportedInteractionTypes:["Mouse","Touch"],svgCursor:f.freehandFillInsideCursor,mixins:["polylineSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/FreehandScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return h});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/cursors/index.js"),f=n("./tools/segmentation/strategies/index.js"),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"FreehandScissors",strategies:{FILL_INSIDE:f.fillInsideFreehand,FILL_OUTSIDE:f.fillOutsideFreehand,ERASE_OUTSIDE:f.eraseOutsideFreehand,ERASE_INSIDE:f.eraseInsideFreehand},cursors:{FILL_INSIDE:c.freehandFillInsideCursor,FILL_OUTSIDE:c.freehandFillOutsideCursor,ERASE_OUTSIDE:c.freehandEraseOutsideCursor,ERASE_INSIDE:c.freehandEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:c.freehandFillInsideCursor,mixins:["freehandSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(n("./tools/base/index.js").BaseTool)},"./tools/segmentation/RectangleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(u),c=n("./tools/base/index.js"),f=n("./tools/segmentation/strategies/index.js"),h=n("./tools/cursors/index.js"),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var n={name:"RectangleScissors",strategies:{FILL_INSIDE:f.fillInsideRectangle,FILL_OUTSIDE:f.fillOutsideRectangle,ERASE_OUTSIDE:f.eraseOutsideRectangle,ERASE_INSIDE:f.eraseInsideRectangle},cursors:{FILL_INSIDE:h.segRectangleFillInsideCursor,FILL_OUTSIDE:h.segRectangleFillOutsideCursor,ERASE_OUTSIDE:h.segRectangleEraseOutsideCursor,ERASE_INSIDE:h.segRectangleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],mixins:["rectangleSegmentationMixin"]};return i()(this,l()(t).call(this,e,n))}return d()(t,e),t}(c.BaseTool)},"./tools/segmentation/SphericalBrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return T});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(s),u=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(u),c=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),f=n.n(c),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./externalModules.js"),p=n("./tools/base/BaseBrushTool.js"),v=n("./store/index.js"),b=n("./util/segmentation/index.js"),y=n("./stateManagement/toolState.js"),x=n("./util/logger.js"),w=Object(x.getLogger)("tools:SphericalBrushTool"),j=Object(v.getModule)("segmentation"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r()(this,t);var a={name:"SphericalBrush",supportedInteractionTypes:["Mouse","Touch"],configuration:{alwaysEraseOnClick:!1},mixins:["renderBrushMixin"]};return(e=l()(this,d()(t).call(this,n,a))).touchDragCallback=e._paint.bind(f()(e)),e}return m()(t,e),i()(t,[{key:"_startPainting",value:function(e){var t,n=j.configuration,a=j.getters,r=e.detail,o=r.element,i=r.image,s=g.default.cornerstone,l=n.radius,u=i.rows,d=i.columns,c=Math.max(i.rowPixelSpacing,i.columnPixelSpacing),f=Object(y.getToolState)(o,"stack").data[0].imageIds,h=a.labelmap2D(o),m=h.labelmap2D,p=h.labelmap3D,v=h.currentImageIdIndex,b=h.activeLabelmapIndex,x=this._isCtrlDown(r)||this.configuration.alwaysEraseOnClick,T=s.metaData.get("imagePlaneModule",i.imageId);if(T?t=this._getImagesInRange(v,T.imagePositionPatient,f,l,c):(w.warn("No imagePlane metadata found for image, defaulting to circle brush application."),t=[{imageIdIndex:v,radiusOnImage:l}]),this.paintEventData={labelmap2D:m,labelmap3D:p,currentImageIdIndex:v,activeLabelmapIndex:b,shouldErase:x,imagesInRange:t},n.storeHistory){for(var _=[],E=0;E<t.length;E++){var O=a.labelmap2DByImageIdIndex(p,t[E].imageIdIndex,u,d).pixelData.slice();_.push(O)}this.paintEventData.previousPixeldataForImagesInRange=_}}},{key:"_paint",value:function(e){var t=j.getters,n=e.detail,a=n.image,r=a.rows,o=a.columns,i=n.currentPoints.image,s=i.x,l=i.y;if(!(s<0||s>o||l<0||l>r)){for(var u=this.paintEventData,d=u.labelmap3D,c=u.imagesInRange,f=u.shouldErase,h=0;h<c.length;h++){var m=c[h],p=m.imageIdIndex,v=m.radiusOnImage,y=Object(b.getCircle)(v,r,o,s,l),x=t.labelmap2DByImageIdIndex(d,p,r,o);Object(b.drawBrushPixels)(y,x.pixelData,d.activeSegmentIndex,o,f)}g.default.cornerstone.updateImage(e.detail.element)}}},{key:"_getImagesInRange",value:function(e,t,n,a,r){for(var o=a*r,i=[{imageIdIndex:e,radiusOnImage:a}],s=e+1;s<n.length;s++){var l=this._getRadiusOnImage(n[s],t,o,r);if(!l)break;i.push({imageIdIndex:s,radiusOnImage:l})}for(var u=e-1;u>=0;u--){var d=this._getRadiusOnImage(n[u],t,o,r);if(!d)break;i.push({imageIdIndex:u,radiusOnImage:d})}return i}},{key:"_getRadiusOnImage",value:function(e,t,n,a){var r=g.default.cornerstone.metaData.get("imagePlaneModule",e);if(r){var o=r.imagePositionPatient,i=Math.sqrt(Math.pow(o[0]-t[0],2)+Math.pow(o[1]-t[1],2)+Math.pow(o[2]-t[2],2));if(!(i>n))return Math.floor(Math.sqrt(Math.pow(n,2)-Math.pow(i,2))/a)}else w.warn("Can't find imagePlane metadata for image, cancelling spherical brushing on: ".concat(e,","))}},{key:"_endPainting",value:function(e){for(var t=this.paintEventData,n=t.labelmap3D,a=t.imagesInRange,r=[],o=j.configuration,i=j.setters,s=0;s<a.length;s++){for(var l=a[s].imageIdIndex,u=n.labelmaps2D[l],d=new Set(u.pixelData).values(),c=[],f=!1;!f;){var h=d.next();(f=h.done)||c.push(h.value)}if(u.segmentsOnLabelmap=c,o.storeHistory){var m=this.paintEventData.previousPixeldataForImagesInRange[s],g=n.labelmaps2D[l].pixelData;r.push({imageIdIndex:l,diff:Object(b.getDiffBetweenPixelData)(m,g)})}}o.storeHistory&&i.pushState(this.element,r),Object(b.triggerLabelmapModifiedEvent)(this.element)}}]),t}(p.default)},"./tools/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/segmentation/BrushTool.js"),r=n("./tools/segmentation/SphericalBrushTool.js"),o=n("./tools/segmentation/FreehandScissorsTool.js"),i=n("./tools/segmentation/RectangleScissorsTool.js"),s=n("./tools/segmentation/CircleScissorsTool.js"),l=n("./tools/segmentation/CorrectionScissorsTool.js");n.d(t,"BrushTool",function(){return a.default}),n.d(t,"SphericalBrushTool",function(){return r.default}),n.d(t,"FreehandScissorsTool",function(){return o.default}),n.d(t,"RectangleScissorsTool",function(){return i.default}),n.d(t,"CircleScissorsTool",function(){return s.default}),n.d(t,"CorrectionScissorsTool",function(){return l.default}),t.default={BrushTool:a.default,SphericalBrushTool:r.default,CircleScissorsTool:s.default,CorrectionScissorsTool:l.default,FreehandScissorsTool:o.default,RectangleScissorsTool:i.default}},"./tools/segmentation/strategies/correction.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./tools/segmentation/strategies/index.js"),i=n("./util/segmentation/index.js"),s=n("./util/clip.js"),l=n("./util/isPointInImage.js"),u=n("./util/logger.js"),d=Object(u.getLogger)("util:segmentation:operations:correction");function c(e,t){var n=t.pixelData,a=t.segmentIndex,u=t.segmentationMixinType;if("freehandSegmentationMixin"===u){var c=function(e,t){for(var n=t.pixelData,a=t.points,r=e.detail.image,o=r.width,i=r.height,l=[],u=0;u<a.length;u++){var d=a[u],c=Math.floor(d.x),f=Math.floor(d.y);c=Object(s.default)(c,0,o-1),f=Object(s.default)(f,0,i-1);var h=l[l.length-1];h&&c===h.x&&f===h.y||l.push({x:c,y:f,segment:n[f*o+c]})}return l}(e,t),m=function(e,t){for(var n=!0,a=!0,r=0;r<e.length&&(e[r].segment===t?a=!1:n=!1,n||a);r++);return a?{isScissorOperation:!0,operation:"fillInsideFreehand"}:n?{isScissorOperation:!0,operation:"eraseInsideFreehand"}:{isScissorOperation:!1}}(c,a);if(m.isScissorOperation)"fillInsideFreehand"===m.operation?(d.warn("The line never intersects a segment."),Object(o.fillInsideFreehand)(e,t)):"eraseInsideFreehand"===m.operation&&(d.warn("The line is only ever inside the segment."),Object(o.eraseInsideFreehand)(e,t));else{var g=new Uint8Array(n.length);(function(e,t){var n=e[0].segment===t,a=[];a.push({additive:!n,nodes:[]});for(var r=0,o=0;o<e.length;o++){var i=e[o];n?(a[r].nodes.push(i),i.segment!==t&&(r++,n=!n,a.push({additive:!0,nodes:[]}),a[r].nodes.push(e[o-1]),a[r].nodes.push(i))):(a[r].nodes.push(i),i.segment===t&&(r++,n=!n,a.push({additive:!1,nodes:[]}),a[r].nodes.push(e[o-1]),a[r].nodes.push(i)))}return a.pop(),a.shift(),a})(c,a).forEach(function(t){!function(e,t,n,a,o){var s=o.detail.image,u=s.width,c=s.height,m=e.nodes,g=e.additive,p=g?0:1,v=function(e){return e.y*u+e.x},b=function(e){return{x:e%u,y:Math.floor(e/u)}};d.warn(g?"additive operation...":"subtractive operation...");for(var y=function(e){for(var t=[],n=0;n<e.length-1;n++)t.push(e[n]),t.push.apply(t,r()(Object(i.getPixelPathBetweenPixels)(e[n],e[n+1])));for(var a=[],o=[],s=0;s<t.length-1;s++){var l=(void 0,-1===(h={x:(f=t[s+1]).x-(c=t[s]).x,y:f.y-c.y}).x&&1===h.y?{left:{x:c.x-1,y:c.y-1},right:{x:c.x+1,y:c.y+1}}:0===h.x&&1===h.y?{left:{x:c.x-1,y:c.y},right:{x:c.x+1,y:c.y}}:1===h.x&&1===h.y?{left:{x:c.x-1,y:c.y+1},right:{x:c.x+1,y:c.y-1}}:1===h.x&&0===h.y?{left:{x:c.x,y:c.y+1},right:{x:c.x,y:c.y-1}}:1===h.x&&-1===h.y?{left:{x:c.x+1,y:c.y+1},right:{x:c.x-1,y:c.y-1}}:0===h.x&&-1===h.y?{left:{x:c.x+1,y:c.y},right:{x:c.x-1,y:c.y}}:-1===h.x&&-1===h.y?{left:{x:c.x+1,y:c.y-1},right:{x:c.x-1,y:c.y+1}}:-1===h.x&&0===h.y?{left:{x:c.x,y:c.y-1},right:{x:c.x,y:c.y+1}}:void d.error("Unable to find left and right paths for flood fill ",c,f,h)),u=l.right;a.push(l.left),o.push(u)}var c,f,h;return{pixelPath:t,leftPath:a,rightPath:o}}(m),x=y.pixelPath,w=y.leftPath,j=y.rightPath,T=x[0],_={xMin:T.x,xMax:T.x,yMin:T.y,yMax:T.y},E=0;E<n.length;E++)t[E]===a?(f(_,b(E)),n[E]=1):n[E]=0;for(var O=0;O<x.length;O++){var S=x[O];n[v(S)]=2,f(_,S)}!function(e,t,n){e.xMax=Math.min(e.xMax+2,n),e.xMin=Math.max(e.xMin-2,0),e.yMax=Math.min(e.yMax+2,t),e.yMin=Math.max(e.yMin-2,0)}(_,c,u);var C=_.xMin,I=_.xMax,M=_.yMin,P=_.yMax;function D(e,t){if(!(e>=I||e<C||t>=P||t<M))return n[t*u+e]}for(var k=0,L=0,A=0;A<w.length;A++){var R=w[A];n[v(R)]===p&&Object(l.default)(R,c,u)&&(k+=h(R,3,n,D,u));var B=j[A];n[v(B)]===p&&Object(l.default)(B,c,u)&&(L+=h(B,4,n,D,u))}if(0!==k&&0!==L){for(var F=g?a:0,U=k<L?3:4,H=0;H<n.length;H++)n[H]===U&&(t[H]=F);if(F===a)for(var N=0;N<x.length;N++)t[v(x[N])]=a;else for(var z=0;z<x.length;z++){var V=v(x[z]);t[V]===a&&(t[V]=0)}}}(t,n,g,a,e)})}}else d.error("correction operation requires freehandSegmentationMixin operationData, recieved ".concat(u))}function f(e,t){var n=t.x,a=t.y;n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),a<e.yMin&&(e.yMin=a),a>e.yMax&&(e.yMax=a)}function h(e,t,n,a,r){for(var o=Object(i.floodFill)(a,[e.x,e.y]).flooded,s=0;s<o.length;s++){var l=o[s];n[l[1]*r+l[0]]=t}return o.length}},"./tools/segmentation/strategies/eraseCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideCircle",function(){return c}),n.d(t,"eraseOutsideCircle",function(){return f});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/ellipse/index.js"),i=n("./util/logger.js"),s=n("./util/segmentation/index.js"),l=n("./util/getCircleCoords.js"),u=Object(i.getLogger)("util:segmentation:operations:eraseInsideCircle");function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.segmentationMixinType;if("circleSegmentationMixin"===a){var i=e.detail,d=Object(s.getBoundingBoxAroundCircle)(e),c=r()(d,2),f=c[0],h=c[1],m=Object(l.default)(i.handles.start,i.handles.end);n?Object(s.eraseInsideShape)(e,t,function(e){return Object(o.pointInEllipse)(m,e)},f,h):Object(s.eraseOutsideShape)(e,t,function(e){return Object(o.pointInEllipse)(m,e)},f,h)}else u.error("eraseInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(a))}function c(e,t){d(e,t,!0)}function f(e,t){d(e,t,!1)}},"./tools/segmentation/strategies/eraseFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideFreehand",function(){return d}),n.d(t,"eraseOutsideFreehand",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/isPointInPolygon.js"),s=n("./util/logger.js"),l=Object(s.getLogger)("util:segmentation:operations:eraseInsideFreehand");function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,s=t.segmentationMixinType;if("freehandSegmentationMixin"===s){var u=e.detail.image,d=a.map(function(e){return[e.x,e.y]}),c=Object(o.getBoundingBoxAroundPolygon)(d,u),f=r()(c,2),h=f[0],m=f[1];n?Object(o.eraseInsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},h,m):Object(o.eraseOutsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},h,m)}else l.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(s))}function d(e,t){u(e,t,!0)}function c(e,t){u(e,t,!1)}},"./tools/segmentation/strategies/eraseRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideRectangle",function(){return u}),n.d(t,"eraseOutsideRectangle",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/logger.js"),i=n("./util/segmentation/index.js"),s=Object(o.getLogger)("util:segmentation:operations:eraseInsideRectangle");function l(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,o=t.segmentationMixinType;if("rectangleSegmentationMixin"===o){var l=e.detail,u=l.image,d=a.map(function(e){return[e.x,e.y]}),c=Object(i.getBoundingBoxAroundPolygon)(d,u),f=r()(c,2),h=f[0],m=f[1];n?Object(i.eraseInsideShape)(e,t,function(){return!0},h,m):Object(i.eraseOutsideBoundingBox)(e,t,h,m)}else s.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(o))}function u(e,t){l(e,t,!0)}function d(e,t){l(e,t,!1)}},"./tools/segmentation/strategies/fillCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideCircle",function(){return c}),n.d(t,"fillOutsideCircle",function(){return f});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/ellipse/index.js"),s=n("./util/getCircleCoords.js"),l=n("./util/logger.js"),u=Object(l.getLogger)("util:segmentation:operations:fillCircle");function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.segmentationMixinType;if("circleSegmentationMixin"===a){var l=e.detail,d=Object(o.getBoundingBoxAroundCircle)(e),c=r()(d,2),f=c[0],h=c[1],m=Object(s.default)(l.handles.start,l.handles.end);n?Object(o.fillInsideShape)(e,t,function(e){return Object(i.pointInEllipse)(m,e)},f,h):Object(o.fillOutsideShape)(e,t,function(e){return Object(i.pointInEllipse)(m,e)},f,h)}else u.error("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(a))}function c(e,t){d(e,t,!0)}function f(e,t){d(e,t,!1)}},"./tools/segmentation/strategies/fillFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideFreehand",function(){return d}),n.d(t,"fillOutsideFreehand",function(){return c});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/isPointInPolygon.js"),s=n("./util/logger.js"),l=Object(s.getLogger)("util:segmentation:operations:fillInsideFreehand");function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,s=t.segmentationMixinType;if("freehandSegmentationMixin"===s){var u=e.detail.image,d=a.map(function(e){return[e.x,e.y]}),c=Object(o.getBoundingBoxAroundPolygon)(d,u),f=r()(c,2),h=f[0],m=f[1];n?Object(o.fillInsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},h,m):Object(o.fillOutsideShape)(e,t,function(e){return Object(i.default)([e.x,e.y],d)},h,m)}else l.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(s))}function d(e,t){u(e,t,!0)}function c(e,t){u(e,t,!1)}},"./tools/segmentation/strategies/fillRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideRectangle",function(){return u}),n.d(t,"fillOutsideRectangle",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/index.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("util:segmentation:operations:fillInsideRectangle");function l(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.points,i=t.segmentationMixinType;if("rectangleSegmentationMixin"===i){var l=e.detail.image,u=a.map(function(e){return[e.x,e.y]}),d=Object(o.getBoundingBoxAroundPolygon)(u,l),c=r()(d,2),f=c[0],h=c[1];n?Object(o.fillInsideShape)(e,t,function(){return!0},f,h):Object(o.fillOutsideBoundingBox)(e,t,f,h)}else s.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(i))}function u(e,t){l(e,t,!0)}function d(e,t){l(e,t,!1)}},"./tools/segmentation/strategies/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./tools/segmentation/strategies/correction.js");n.d(t,"correction",function(){return a.default});var r=n("./tools/segmentation/strategies/eraseFreehand.js");n.d(t,"eraseInsideFreehand",function(){return r.eraseInsideFreehand}),n.d(t,"eraseOutsideFreehand",function(){return r.eraseOutsideFreehand});var o=n("./tools/segmentation/strategies/eraseRectangle.js");n.d(t,"eraseInsideRectangle",function(){return o.eraseInsideRectangle}),n.d(t,"eraseOutsideRectangle",function(){return o.eraseOutsideRectangle});var i=n("./tools/segmentation/strategies/fillFreehand.js");n.d(t,"fillInsideFreehand",function(){return i.fillInsideFreehand}),n.d(t,"fillOutsideFreehand",function(){return i.fillOutsideFreehand});var s=n("./tools/segmentation/strategies/fillRectangle.js");n.d(t,"fillInsideRectangle",function(){return s.fillInsideRectangle}),n.d(t,"fillOutsideRectangle",function(){return s.fillOutsideRectangle});var l=n("./tools/segmentation/strategies/fillCircle.js");n.d(t,"fillInsideCircle",function(){return l.fillInsideCircle}),n.d(t,"fillOutsideCircle",function(){return l.fillOutsideCircle});var u=n("./tools/segmentation/strategies/eraseCircle.js");n.d(t,"eraseInsideCircle",function(){return u.eraseInsideCircle}),n.d(t,"eraseOutsideCircle",function(){return u.eraseOutsideCircle})},"./util/SaveAs.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=e.querySelector("canvas");if(a.msToBlob){var r=a.msToBlob();return window.navigator.msSaveBlob(r,t)}var o=document.createElement("a");if(o.download=t,o.href=a.toDataURL(n,1),document.createEvent){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}else o.fireEvent&&o.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),o=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));return{angle:180*Math.acos((Math.pow(a,2)+Math.pow(r,2)-Math.pow(o,2))/(2*a*r))/Math.PI,direction:(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)}}},"./util/calculateSUV.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");function r(e){return parseFloat(".".concat(e))}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=a.default.cornerstone,i=o.metaData.get("patientStudyModule",e.imageId),s=o.metaData.get("generalSeriesModule",e.imageId);if(i&&s){var l=s.modality;if("PT"===l){var u=n?t:t*e.slope+e.intercept,d=i.patientWeight;if(d){var c=o.metaData.get("petIsotopeModule",e.imageId);if(c){var f=c.radiopharmaceuticalInfo,h=f.radiopharmaceuticalStartTime,m=f.radionuclideTotalDose,g=f.radionuclideHalfLife,p=s.seriesTime;if(h&&m&&g&&p){var v=r(p.fractionalSeconds||0)+p.seconds+60*p.minutes+60*p.hours*60,b=r(h.fractionalSeconds||0)+h.seconds+60*h.minutes+60*h.hours*60,y=v-b,x=m*Math.exp(-y*Math.log(2)/g),w=u*d/x*1e3;return w}}}}}}},"./util/clip.js":function(e,t,n){"use strict";function a(e,t,n){return Math.min(Math.max(t,e),n)}function r(e,t){e.x=a(e.x,0,t.width),e.y=a(e.y,0,t.height)}n.r(t),n.d(t,"clip",function(){return a}),n.d(t,"clipToBox",function(){return r}),t.default=a},"./util/convertToVector3.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e){var t=a.default.cornerstoneMath;if(e instanceof t.Vector3)return e;var n=Object.keys(e);return n.includes("x")&&n.includes("y")&&n.includes("z")?new t.Vector3(e.x,e.y,e.z):new t.Vector3(e[0],e[1],e[2])}},"./util/copyPoints.js":function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y;return{x:t,y:n}}n.r(t),t.default=function(e){return{page:a(e.page),image:a(e.image),client:a(e.client),canvas:a(e.canvas)}}},"./util/debounce.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/isObject.js");t.default=function(e,t,n){var r,o,i,s,l,u,d=0,c=!1,f=!1,h=!0,m=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=r,a=o;return r=o=void 0,d=t,s=e.apply(a,n)}function p(e,t){return m?window.requestAnimationFrame(e):setTimeout(e,t)}function v(e){return d=e,l=p(y,t),c?g(e):s}function b(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-d>=i}function y(){var e=Date.now();if(b(e))return x(e);l=p(y,function(e){var n=t-(e-u);return f?Math.min(n,i-(e-d)):n}(e))}function x(e){return l=void 0,h&&r?g(e):(r=o=void 0,s)}function w(){for(var e=Date.now(),n=b(e),a=arguments.length,i=new Array(a),d=0;d<a;d++)i[d]=arguments[d];if(r=i,o=this,u=e,n){if(void 0===l)return v(u);if(f)return l=p(y,t),g(u)}return void 0===l&&(l=p(y,t)),s}return t=Number(t)||0,Object(a.default)(n)&&(c=Boolean(n.leading),i=(f="maxWait"in n)?Math.max(Number(n.maxWait)||0,t):i,h="trailing"in n?Boolean(n.trailing):h),w.cancel=function(){void 0!==l&&function(e){if(m)return window.cancelAnimationFrame(e);clearTimeout(e)}(l),d=0,r=u=o=l=void 0},w.flush=function(){return void 0===l?s:x(Date.now())},w.pending=function(){return void 0!==l},w}},"./util/debugLib/common.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a);t.default=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return a.colors[Math.abs(t)%a.colors.length]}function a(e){var n;function r(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(r.enabled){var i=r,s=Number(new Date),l=s-(n||s);i.diff=l,i.prev=n,i.curr=s,n=s,t[0]=a.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;u++;var r=a.formatters[n];return"function"==typeof r&&(e=r.call(i,t[u]),t.splice(u,1),u--),e}),a.formatArgs.call(i,t);var d=i.log||a.log;d.apply(i,t)}}return r.namespace=e,r.enabled=a.enabled(e),r.useColors=a.useColors(),r.color=t(e),r.destroy=o,r.extend=i,"function"==typeof a.init&&a.init(r),a.instances.push(r),r}function o(){var e=a.instances.indexOf(this);return-1!==e&&(a.instances.splice(e,1),!0)}function i(e,t){var n=a(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return a.debug=a,a.default=a,a.coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){var e=[].concat(r()(a.names.map(s)),r()(a.skips.map(s).map(function(e){return"-".concat(e)}))).join(",");return a.enable(""),e},a.enable=function(e){var t;a.save(e),a.names=[],a.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^".concat(e.substr(1),"$"))):a.names.push(new RegExp("^".concat(e,"$"))));for(t=0;t<a.instances.length;t++){var o=a.instances[t];o.enabled=a.enabled(o.namespace)}},a.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=a.skips.length;t<n;t++)if(a.skips[t].test(e))return!1;for(t=0,n=a.names.length;t<n;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=n("../node_modules/ms/index.js"),Object.keys(e).forEach(function(t){a[t]=e[t]}),a.instances=[],a.names=[],a.skips=[],a.formatters={},a.selectColor=t,a.enable(a.load()),a}},"./util/debugLib/index.js":function(e,t,n){"use strict";n.r(t),(function(e){var a=n("./util/debugLib/common.js"),r={formatArgs:function(e){if(e[0]="".concat((this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" "),"+").concat(o.humanize(this.diff)),this.useColors){var t="color: ".concat(this.color);e.splice(1,0,t,"color: inherit");var n=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))}),e.splice(a,0,t)}},save:function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(t){}},load:function(){var t;try{t=r.storage.getItem("debug")}catch(n){console.warn(n)}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},useColors:function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},storage:function(){try{return localStorage}catch(e){}}(),colors:["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"]};r.log=console.debug||console.log||function(){};var o=Object(a.default)(r);o.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: ".concat(t.message)}},t.default=o}).call(this,n("../node_modules/process/browser.js"))},"./util/deepmerge.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a),o=function(e){return e&&"object"===r()(e)&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)},i=function(e,t){return t&&!0===t.clone&&o(e)?u(Array.isArray(e)?[]:{},e,t):e},s=function(e,t,n){var a=e.slice();return t.forEach(function(t,r){void 0===a[r]?a[r]=i(t,n):o(t)?a[r]=u(e[r],t,n):-1===e.indexOf(t)&&a.push(i(t,n))}),a},l=function(e,t,n){var a={};return o(e)&&Object.keys(e).forEach(function(t){a[t]=i(e[t],n)}),Object.keys(t).forEach(function(r){a[r]=o(t[r])&&e[r]?u(e[r],t[r],n):i(t[r],n)}),a},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=Array.isArray(t),r=n||{arrayMerge:s},o=r.arrayMerge||s;return a?Array.isArray(e)?o(e,t,n):i(t,n):l(e,t,n)};t.default=u},"./util/ellipse/calculateEllipseStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/pointInEllipse.js");t.default=function(e,t){for(var n=0,r=0,o=0,i=0,s=null,l=null,u=t.top;u<t.top+t.height;u++)for(var d=t.left;d<t.left+t.width;d++){var c={x:d,y:u};Object(a.default)(t,c)&&(null===s&&(s=e[i],l=e[i]),n+=e[i],r+=e[i]*e[i],s=Math.min(s,e[i]),l=Math.max(l,e[i]),o++),i++}if(0===o)return{count:o,mean:0,variance:0,stdDev:0,min:0,max:0};var f=n/o,h=r/o-f*f;return{count:o,mean:f,variance:h,stdDev:Math.sqrt(h),min:s,max:l}}},"./util/ellipse/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/ellipse/calculateEllipseStatistics.js");n.d(t,"calculateEllipseStatistics",function(){return a.default});var r=n("./util/ellipse/pointInEllipse.js");n.d(t,"pointInEllipse",function(){return r.default}),t.default={calculateEllipseStatistics:a.default,pointInEllipse:r.default}},"./util/ellipse/pointInEllipse.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=e.width/2,a=e.height/2;if(n<=0||a<=0)return!1;var r=t.x-(e.left+n),o=t.y-(e.top+a);return r*r/(n*n)+o*o/(a*a)<=1}},"./util/findAndMoveHelpers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"moveHandleNearImagePoint",function(){return i}),n.d(t,"findHandleDataNearImagePoint",function(){return s}),n.d(t,"moveAnnotation",function(){return l});var a=n("./store/index.js"),r=n("./manipulators/getHandleNearImagePoint.js"),o=n("./manipulators/index.js"),i=function(e,t,n,r,i){n.active=!0,a.state.isToolLocked=!0,Object(o.moveHandle)(e.detail,t.name,n,r,t.options,i),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()},s=function(e,t,n,o){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mouse",s=0;s<t.data.length;s++){var l=t.data[s],u=Object(r.default)(e,l.handles,o,"mouse"===i?a.state.clickProximity:a.state.touchProximity);if(u)return{handle:u,data:l}}},l=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";n.active=!0,a.state.isToolLocked=!0,Object(o.moveAllHandles)(e.detail,t.name,n,null,t.options,r,function(){n.active=!1,a.state.isToolLocked=!1}),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./util/freehand/ClickedLineData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=function e(t,n){r()(this,e),this.toolIndex=t,this.handleIndexArray=n}},"./util/freehand/FreehandHandleData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];r()(this,e),this.x=t.x,this.y=t.y,this.highlight=n,this.active=a,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(a),o=n("../node_modules/@babel/runtime/helpers/createClass.js"),i=n.n(o),s=n("./stateManagement/toolState.js"),l=n("./externalModules.js"),u=n("./util/freehand/ClickedLineData.js"),d=function(){function e(t,n){r()(this,e),this._eventData=t,this._toolName=n}return i()(e,[{key:"findLine",value:function(){var e=this.findTool();if(null===e)return null;var t=this._getCloseLinesInTool(e);return t?this._findCorrectLine(e,t):null}},{key:"findTool",value:function(){return this._toolData=Object(s.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,this._toolData?this._nearestHandleToPointAllTools().toolIndex:null}},{key:"_nearestHandleToPointAllTools",value:function(){for(var e=this._toolData,t={toolIndex:null,handleIndex:null,distance:1/0},n=0;n<e.data.length;n++){var a=this._nearestHandleToPoint(n);null!==a&&a.distance<t.distance&&(t=a)}return t}},{key:"_nearestHandleToPoint",value:function(e){var t=this._eventData,n=this._toolData.data[e],a=n.handles.points;if(void 0===a)return null;if(!1===n.visible)return null;for(var r={toolIndex:e,handleIndex:null,distance:1/0},o=0;o<a.length;o++){var i=l.default.cornerstone.pixelToCanvas(t.element,a[o]),s=l.default.cornerstoneMath.point.distance(i,this._mousePoint);s<r.distance&&(r.handleIndex=o,r.distance=s)}return r}},{key:"_getCloseLinesInTool",value:function(t){for(var n=this._toolData.data[t].handles.points,a=[],r=0;r<n.length;r++){var o=e.getNextHandleIndex(r,n.length);this._distanceOfPointfromLine(n[r],n[o])<10&&a.push([r,o])}return a}},{key:"_findCorrectLine",value:function(e,t){for(var n=0;n<t.length;n++)if(this._pointProjectsToLineSegment(e,t[n]))return new u.default(e,t[n]);return null}},{key:"_pointProjectsToLineSegment",value:function(t,n){var a=this._toolData.data[t],r=a.handles.points;if(void 0!==a.handles.points){if(!1===a.visible)return!1;var o=e.getCanvasPointsFromHandles(r[n[0]],r[n[1]],this._eventData.element),i=e.getLineAsVector(o),s=this._getLineOriginToMouseAsVector(o),l=(s[0]*i[0]+s[1]*i[1])/i.magnitude;return l>0&&l<i.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(e){return[this._mousePoint.x-e[0].x,this._mousePoint.y-e[0].y]}},{key:"_distanceOfPointfromLine",value:function(e,t){var n=this._eventData,a=l.default.cornerstone.pixelToCanvas(n.element,e),r=l.default.cornerstone.pixelToCanvas(n.element,t),o=this._mousePoint;return Math.abs((r.y-a.y)*o.x-(r.x-a.x)*o.y+r.x*a.y-r.y*a.x)/l.default.cornerstoneMath.point.distance(a,r)}}],[{key:"getCanvasPointsFromHandles",value:function(e,t,n){var a=[];return e.x<t.x?(a.push(l.default.cornerstone.pixelToCanvas(n,e)),a.push(l.default.cornerstone.pixelToCanvas(n,t))):(a.push(l.default.cornerstone.pixelToCanvas(n,t)),a.push(l.default.cornerstone.pixelToCanvas(n,e))),a}},{key:"getLineAsVector",value:function(e){var t=[e[1].x-e[0].x,e[1].y-e[0].y];return t.magnitude=l.default.cornerstoneMath.point.distance(e[0],e[1]),t}},{key:"getNextHandleIndex",value:function(e,t){return e<t-1?e+1:0}}]),e}()},"./util/freehand/addLine.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e[t].lines.push(t===e.length-1?e[0]:e[t+1])}},"./util/freehand/calculateFreehandStatistics.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/pointInFreehand.js");function r(e,t,n,r){Object(a.default)(e,t)&&(n.value+=r,n.squared+=r*r,n.count++)}t.default=function(e,t,n){var a={count:0,mean:0,variance:0,stdDev:0},o=function(e,t,n){for(var a={value:0,squared:0,count:0},o=0,i=t.top;i<t.top+t.height;i++)for(var s=t.left;s<t.left+t.width;s++)r(n,{x:s,y:i},a,e[o]),o++;return a}(e,t,n);return 0===o.count||(a.count=o.count,a.mean=o.value/o.count,a.variance=o.squared/o.count-a.mean*a.mean,a.stdDev=Math.sqrt(a.variance)),a}},"./util/freehand/freehandArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=0,a=e.length-1;t=t||1;for(var r=0;r<e.length;r++)n+=(e[a].x+e[r].x)*(e[a].y-e[r].y),a=r;return Math.abs(n*t/2)}},"./util/freehand/freehandIntersect.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var i=e.length-1,s=0;s<e.length;s++)if(-1===a.indexOf(s)&&-1===a.indexOf(i)){if(r(t,n,o(e[i]),o(e[s])))return!0;i=s}else i=s;return!1}function r(e,t,n,a){var r=!1,o=[i(e,t,n),i(e,t,a),i(n,a,e),i(n,a,t)];return o[0]!==o[1]&&o[2]!==o[3]||((0===o[0]&&s(e,n,t)||0===o[1]&&s(e,a,t)||0===o[2]&&s(n,e,a)||0===o[3]&&s(n,t,a))&&(r=!0),r)}function o(e){return{x:e.x,y:e.y}}function i(e,t,n){var a=(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y);return 0===a?0:a>0?1:2}function s(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}n.r(t),t.default={newHandle:function(e,t){var n=t.length-1;return a(t,o(t[n]),o(e),[n])},end:function(e){var t=e.length-1;return a(e,o(e[t]),o(e[0]),[t,0])},modify:function(e,t){var n=o(e[t]),r=t-1;0===t&&(r=e.length-1);var i=o(e[r]);return!!a(e,n,i,[t,r])||a(e,n,i=o(e[r=t===e.length-1?0:t+1]),[t,r])}}},"./util/freehand/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/calculateFreehandStatistics.js"),r=n("./util/freehand/ClickedLineData.js"),o=n("./util/freehand/freehandArea.js"),i=n("./util/freehand/FreehandHandleData.js"),s=n("./util/freehand/freehandIntersect.js"),l=n("./util/freehand/FreehandLineFinder.js"),u=n("./util/freehand/insertOrDelete.js"),d=n("./util/freehand/pointInFreehand.js"),c=n("./util/freehand/addLine.js");t.default={calculateFreehandStatistics:a.default,ClickedLineData:r.default,freehandArea:o.default,FreehandHandleData:i.default,freehandIntersect:s.default,FreehandLineFinder:l.default,insertOrDelete:u.default,pointInFreehand:d.default,addLine:c.default}},"./util/freehand/insertOrDelete.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/freehand/FreehandLineFinder.js"),r=n("./util/freehand/FreehandHandleData.js"),o=n("./stateManagement/toolState.js"),i=n("./externalModules.js"),s=n("./util/freehand/addLine.js");function l(e,t){var n=Object(o.getToolState)(e.element,this.name);if(void 0!==n){var a=t.handleIndex,r=n.data[t.toolIndex],s=r.handles.points;s.length<=3||(a===s.length-1?(s[a-1].lines.pop(),s[a-1].lines.push(s[0])):0===a?(s[s.length-1].lines.pop(),s[s.length-1].lines.push(s[a+1])):(s[a-1].lines.pop(),s[a-1].lines.push(s[a+1])),s.splice(a,1),r.invalidated=!0,r.active=!0,r.highlight=!0,i.default.cornerstone.updateImage(e.element))}}function u(e,t){var n=Object(o.getToolState)(e.element,this.name);if(void 0!==n){var a=n.data[t.toolIndex],l=function(e){for(var t=e.handleIndexArray,n=1/0,a=t.includes(0),r=0;r<t.length;r++){var o=t[r];0!==o&&o<n&&(n=o)}return a&&1===n&&(n=0),++n}(t);if(l!==1/0){var u=new r.default(e.currentPoints.image),d=a.handles.points;d.splice(l,0,u),d[l-1].lines.pop(),d[l-1].lines.push(e.currentPoints.image),Object(s.default)(d,l),a.active=!0,a.highlight=!0,a.invalidated=!0,i.default.cornerstone.updateImage(e.element)}}}t.default=function(e,t){var n=e.detail;if(t&&null!==t.handleNearby)l.call(this,n,{toolIndex:t.toolIndex,handleIndex:t.handleNearby});else{var r=new a.default(n,this.name).findLine();r&&u.call(this,n,r)}}},"./util/freehand/pointInFreehand.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){for(var n=!1,a=e.length-1,r=0;r<e.length;r++)void 0,void 0,void 0,d=(s=e[a]).y,!((u=(i=e[r]).y)<(l=(o=t).y)&&l<d||d<l&&l<u)||!function(e,t,n){if(t.x>e.x&&n.x>e.x)return!0;if(t.x===n.x)return e.x<t.x;if(t.x>n.x){var a=t;t=n,n=a}var r=function(e,t,n){var a=(n.y-t.y)/(n.x-t.x);return{value:t.y+a*(e.x-t.x),gradient:a}}(e,t,n);return Math.sign(r.gradient)*e.y>Math.sign(r.gradient)*r.value}(o,i,s)||(n=!n),a=r;var o,i,s,l,u,d;return n}},"./util/getActiveTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./store/index.js"),r=n("./store/getActiveToolsForElement.js"),o=n("./store/filterToolsUsableWithMultiPartTools.js");function i(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";if("touch"===i?n=(n=Object(r.default)(e,a.getters.touchTools())).filter(function(e){return e.options.isTouchActive}):(n=(n=Object(r.default)(e,a.getters.mouseTools())).filter(function(e){return Array.isArray(e.options.mouseButtonMask)&&t&&e.options.mouseButtonMask.includes(t)&&e.options.isMouseActive}),a.state.isMultiPartToolActive&&(n=Object(o.default)(n))),0!==n.length)return n[0]}},"./util/getCircleCoords.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e,t){var n=(0,a.default.cornerstoneMath.point.distance)(e,t);return{left:Math.floor(Math.min(e.x-n,t.x)),top:Math.floor(Math.min(e.y-n,t.y)),width:2*n,height:2*n}}},"./util/getDefault.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return void 0===e?t:e}},"./util/getKeyPressData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var a=n("./store/index.js"),r=n("./externalModules.js");function o(e){var t=r.default.cornerstone,n=e.currentTarget,o=t.getEnabledElement(n);if(o&&o.image){var i=a.default.state.mousePositionImage;return{event:window.event||e,element:n,viewport:t.getViewport(n),image:o.image,currentPoints:{image:i,canvas:t.pixelToCanvas(n,i)},keyCode:e.keyCode,which:e.which}}}},"./util/getLuminance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r,o){if(!e)throw new Error("getLuminance: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,s,l,u=a.default.cornerstone.getEnabledElement(e).image,d=[],c=0,f=u.getPixelData();if(u.color)for(s=0;s<o;s++)for(l=0;l<r;l++)d[c++]=.2126*f[i=4*((s+n)*u.columns+(l+t))]+.7152*f[i+1]+.0722*f[i+2];else for(s=0;s<o;s++)for(l=0;l<r;l++)d[c++]=f[i=(s+n)*u.columns+(l+t)]*u.slope+u.intercept;return d}},"./util/getMaxSimultaneousRequests.js":function(e,t,n){"use strict";var a;n.r(t),n.d(t,"getDefaultSimultaneousRequests",function(){return l}),n.d(t,"getMaxSimultaneousRequests",function(){return s}),n.d(t,"setMaxSimultaneousRequests",function(){return i}),n.d(t,"getBrowserInfo",function(){return o}),n.d(t,"isMobileDevice",function(){return u});var r={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function o(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE ".concat(e[1]||"")):"Chrome"===n[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}function i(e){a=e}function s(){return a||l()}function l(){var e=o().split(" "),t=e[1],n=r[e[0]];return n?n[t]?n[t]:n.default:r.default}function u(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},"./util/getPixelSpacing.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./externalModules.js");function r(e){var t=a.default.cornerstone.metaData.get("imagePlaneModule",e.imageId);return t?{rowPixelSpacing:t.rowPixelSpacing||t.rowImagePixelSpacing,colPixelSpacing:t.columnPixelSpacing||t.colImagePixelSpacing}:{rowPixelSpacing:e.rowPixelSpacing,colPixelSpacing:e.columnPixelSpacing}}},"./util/getRGBPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r,o){if(!e)throw new Error("getRGBPixels: parameter element must not be undefined");t=Math.round(t),n=Math.round(n);var i,s,l,u=a.default.cornerstone.getEnabledElement(e),d=[],c=0,f=u.image.getPixelData();if(u.image.color)for(s=0;s<o;s++)for(l=0;l<r;l++){var h=f[1+(i=4*((s+n)*u.image.columns+(l+t)))],m=f[i+2],g=f[i+3];d[c++]=f[i],d[c++]=h,d[c++]=m,d[c++]=g}return d}},"./util/getROITextBoxCoords.js":function(e,t,n){"use strict";function a(e,t){var n=function(e){var t=[e.start,e.end].sort(function(e,t){return e.x<t.x?-1:1}),n=[e.start,e.end].sort(function(e,t){return e.y<t.y?-1:1});return{top:n[0],left:t[0],bottom:n[n.length-1],right:t[t.length-1]}}(t),a=(n.left.x+n.right.x)/2,r=(n.top.y+n.bottom.y)/2,o={};return e.rotation>=0&&e.rotation<90&&(o.x=e.hflip?n.left.x:n.right.x,o.y=r),e.rotation>=90&&e.rotation<180&&(o.x=a,o.y=e.vflip?n.bottom.y:n.top.y),e.rotation>=180&&e.rotation<270&&(o.x=e.hflip?n.right.x:n.left.x,o.y=r),e.rotation>=270&&e.rotation<360&&(o.x=a,o.y=e.vflip?n.top.y:n.bottom.y),o}n.r(t),n.d(t,"default",function(){return a})},"./util/isEmptyObject.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return 0===Object.keys(e).length&&e.constructor===Object}},"./util/isObject.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/typeof.js"),r=n.n(a);t.default=function(e){var t=r()(e);return null!==e&&("object"===t||"function"===t)}},"./util/isPointInImage.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.x,r=e.y;return a<n&&a>=0&&r<t&&r>=0}n.r(t),n.d(t,"default",function(){return a})},"./util/isPointInPolygon.js":function(e,t,n){"use strict";function a(e,t){for(var n=e[0],a=e[1],r=!1,o=0,i=t.length-1;o<t.length;i=o++){var s=t[o][0],l=t[o][1],u=t[i][1];l>a!=u>a&&n<(t[i][0]-s)*(a-l)/(u-l)+s&&(r=!r)}return r}n.r(t),n.d(t,"default",function(){return a})},"./util/lineSegDistance.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n,r){var o=a.default.cornerstone,i={start:o.pixelToCanvas(e,t),end:o.pixelToCanvas(e,n)};return a.default.cornerstoneMath.lineSegment.distanceToPoint(i,r)}},"./util/logger.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLogger",function(){return i}),n.d(t,"enable",function(){return s}),n.d(t,"disable",function(){return l});var a=n("./util/debugLib/index.js"),r="cornerstoneTools",o=Object(a.default)(r);o.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var i=function(e){return{log:o.extend(e),warn:console.warn.bind(console),error:console.error.bind(console)}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(r,":*");return a.default.enable(e)},l=function(){return a.default.disable()}},"./util/makeUnselectable.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.style.webkitUserSelect="none",e.style.webkitTouchCallout="none",e.style.mozUserSelect="none",e.style.msUserSelect="none",e.style.oUserSelect="none",e.style.khtmlUserSelect="none",e.style.userSelect="none",e.unselectable="on",e.oncontextmenu=function(){return!1},!0===t&&(e.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},"./util/pointInsideBoundingBox.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t){if(e.boundingBox)return a.default.cornerstoneMath.point.insideRect(t,e.boundingBox)}},"./util/pointProjector.js":function(e,t,n){"use strict";n.r(t),n.d(t,"projectPatientPointToImagePlane",function(){return o}),n.d(t,"imagePointToPatientPoint",function(){return i}),n.d(t,"planePlaneIntersection",function(){return s}),n.d(t,"rotatePoint",function(){return l});var a=n("./externalModules.js"),r=n("./util/convertToVector3.js");function o(e,t){var n=Object(r.default)(t.rowCosines),a=Object(r.default)(t.columnCosines),o=Object(r.default)(t.imagePositionPatient),i=e.clone().sub(o);return{x:n.dot(i)/t.columnPixelSpacing,y:a.dot(i)/t.rowPixelSpacing}}function i(e,t){var n=Object(r.default)(t.rowCosines),a=Object(r.default)(t.columnCosines),o=Object(r.default)(t.imagePositionPatient),i=n.clone().multiplyScalar(e.x);i.multiplyScalar(t.columnPixelSpacing);var s=a.clone().multiplyScalar(e.y);s.multiplyScalar(t.rowPixelSpacing);var l=i.add(s);return l.add(o),l}function s(e,t){var n=Object(r.default)(e.rowCosines),o=Object(r.default)(e.columnCosines),s=Object(r.default)(e.imagePositionPatient),l=Object(r.default)(t.rowCosines),u=Object(r.default)(t.columnCosines),d=Object(r.default)(t.imagePositionPatient),c=n.clone().cross(o),f=new a.default.cornerstoneMath.Plane;f.setFromNormalAndCoplanarPoint(c,s);var h=l.clone().cross(u),m=new a.default.cornerstoneMath.Plane;m.setFromNormalAndCoplanarPoint(h,d);var g=m.clone().intersectPlane(f),p=g.origin,v=g.direction,b=i({x:t.columns,y:t.rows},t),y=d.distanceTo(b),x=new a.default.cornerstoneMath.Line3;x.start=p,x.end=p.clone().add(v.multiplyScalar(y));var w=function(e,t){var n=[];return Object.keys(t).forEach(function(a){var r=e.intersectLine(t[a]);r&&n.push(r)}),n}(x,function(e){var t=i({x:0,y:0},e),n=i({x:e.columns,y:0},e),r=i({x:0,y:e.rows},e),o=i({x:e.columns,y:e.rows},e);return{top:new a.default.cornerstoneMath.Line3(t,n),left:new a.default.cornerstoneMath.Line3(t,r),right:new a.default.cornerstoneMath.Line3(n,o),bottom:new a.default.cornerstoneMath.Line3(r,o)}}(t));if(2===w.length)return{start:w[0],end:w[1]}}function l(e,t,n){var a=n*(Math.PI/180);return{x:Math.cos(a)*(e.x-t.x)-Math.sin(a)*(e.y-t.y)+t.x,y:Math.sin(a)*(e.x-t.x)+Math.cos(a)*(e.y-t.y)+t.y}}},"./util/roundToDecimal.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},"./util/scroll.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/scrollToIndex.js"),r=n("./stateManagement/toolState.js"),o=n("./util/clip.js"),i=n("./externalModules.js");function s(e,t,n){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index)return e.pending.splice(e.pending.indexOf(t),1),void(e.pending.length>0&&s(e,e.pending[0],n));n.addEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,function a(r){e.imageIds.indexOf(r.detail.image.imageId)===t.index&&(e.pending.splice(e.pending.indexOf(t),1),n.removeEventListener(i.default.cornerstone.EVENTS.NEW_IMAGE,a),e.pending.length>0&&s(e,e.pending[0],n))}),Object(a.default)(n,t.index)}}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=Object(r.getToolState)(e,"stack");if(l&&l.data&&l.data.length){var u=l.data[0];u.pending||(u.pending=[]);var d=u.currentImageIdIndex+t;if(n){var c=u.imageIds.length;d%=c}else d=Object(o.default)(d,0,u.imageIds.length-1);if(i)Object(a.default)(e,d);else{var f={index:d};u.pending.push(f),s(u,f,e)}}}},"./util/scrollToIndex.js":function(e,t,n){"use strict";n.r(t);var a=n("./events.js"),r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),i=n("./requestPool/requestPoolManager.js"),s=n("./stateManagement/loadHandlerManager.js"),l=n("./util/triggerEvent.js");t.default=function(e,t){var n=Object(o.getToolState)(e,"stack");if(n&&n.data&&n.data.length){var u,d=r.default.cornerstone;if(n.data.length>1){var c=Object(o.getToolState)(e,"stackRenderer");c&&c.data&&c.data.length&&(u=c.data[0])}var f=n.data[0];t<0&&(t+=f.imageIds.length);var h=s.default.getStartLoadHandler(e),m=s.default.getEndLoadHandler(e),g=s.default.getErrorLoadingHandler(e);if(t!==f.currentImageIdIndex){h&&h(e);var p={newImageIdIndex:t,direction:t-f.currentImageIdIndex};f.currentImageIdIndex=t;var v=f.imageIds[t];(Boolean(f.preventCache)?d.loadImage(v):d.loadAndCacheImage(v)).then(function(a){if(f.currentImageIdIndex===t){try{d.getEnabledElement(e)}catch(r){return}u?(u.currentImageIdIndex=t,u.render(e,n.data)):d.displayImage(e,a),m&&m(e,a)}},function(n){g&&g(e,f.imageIds[t],n)}),i.default.startGrabbing(),Object(l.default)(e,a.default.STACK_SCROLL,p)}}}},"./util/segmentation/drawBrush.js":function(e,t,n){"use strict";n.r(t),n.d(t,"drawBrushPixels",function(){return i});var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a),o=n("./util/segmentation/eraseIfSegmentIndex.js");function i(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,t){return t*a+e};e.forEach(function(e){var a=s.apply(void 0,r()(e));i?Object(o.default)(a,t,n):t[a]=n})}},"./util/segmentation/eraseIfSegmentIndex.js":function(e,t,n){"use strict";function a(e,t,n){t[e]===n&&(t[e]=0)}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/eraseOutsideBoundingBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./util/segmentation/eraseIfSegmentIndex.js");function r(e,t,n,r){for(var o=t.pixelData,i=t.segmentIndex,s=e.detail.image,l=s.width,u=s.height,d=0;d<l;d++)for(var c=0;c<n[1];c++)Object(a.default)(c*l+d,o,i);for(var f=0;f<n[0];f++)for(var h=n[1];h<r[1];h++)Object(a.default)(h*l+f,o,i);for(var m=r[0];m<l;m++)for(var g=n[1];g<r[1];g++)Object(a.default)(g*l+m,o,i);for(var p=0;p<l;p++)for(var v=r[1];v<u;v++)Object(a.default)(v*l+p,o,i)}},"./util/segmentation/eraseShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideShape",function(){return u}),n.d(t,"eraseOutsideShape",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/eraseOutsideBoundingBox.js"),i=n("./util/segmentation/isSameSegment.js"),s=n("./util/logger.js");function l(e,t,n,a,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",u=e.detail.image.width,d=t.pixelData,c=t.segmentIndex,f=r()(a,2),h=f[0],m=f[1],g=r()(s,2),p=g[0],v=g[1];"outside"===l&&Object(o.default)(e,t,a,s);for(var b=h;b<p;b++)for(var y=m;y<v;y++){var x=y*u+b;Object(i.default)(x,d,c)&&n({x:b,y:y})&&(d[x]=0)}}function u(e,t,n,a,r){l(e,t,n,a,r,"inside")}function d(e,t,n,a,r){l(e,t,function(e){return!n(e)},a,r,"outside")}Object(s.getLogger)("util:segmentation:operations:eraseOutsideCircle")},"./util/segmentation/fillOutsideBoundingBox.js":function(e,t,n){"use strict";function a(e,t,n,a){for(var r=t.pixelData,o=t.segmentIndex,i=e.detail.image,s=i.width,l=i.height,u=0;u<s;u++)for(var d=0;d<n[1];d++)r[d*s+u]=o;for(var c=0;c<n[0];c++)for(var f=n[1];f<a[1];f++)r[f*s+c]=o;for(var h=a[0];h<s;h++)for(var m=n[1];m<a[1];m++)r[m*s+h]=o;for(var g=0;g<s;g++)for(var p=a[1];p<l;p++)r[p*s+g]=o}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/fillShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideShape",function(){return u}),n.d(t,"fillOutsideShape",function(){return d});var a=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=n.n(a),o=n("./util/segmentation/fillOutsideBoundingBox.js"),i=n("./util/logger.js"),s=Object(i.getLogger)("util:segmentation:operations:helpers:fillShape");function l(e,t,n,a,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",u=t.pixelData,d=t.segmentIndex;if(void 0!==u&&void 0!==d){var c=e.detail.image.width,f=r()(a,2),h=f[0],m=f[1],g=r()(i,2),p=g[0],v=g[1];"outside"===l&&Object(o.default)(e,t,a,i);for(var b=h;b<p;b++)for(var y=m;y<v;y++){var x=y*c+b;n({x:b,y:y})&&(u[x]=d)}}else s.error("fillInsideShape requires operationData to contain pixelData and segmentIndex")}function u(e,t,n,a,r){l(e,t,n,a,r,"inside")}function d(e,t,n,a,r){l(e,t,function(e){return!n(e)},a,r,"outside")}},"./util/segmentation/floodFill.js":function(e,t,n){"use strict";n.r(t);var a=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=n.n(a);function o(e,t){return e===t}function i(e){for(var t=0,n=0;n<e.length;n+=1)0!==e[n]&&(t+=1);return t}function s(e,t,n){return(new Array(n+1).join(t)+e).slice(-n)}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.onFlood||function(){},l=n.onBoundary||function(){},u=n.equals||o,d=n.diagonals||!1,c=_(t),f=O(),h=[],m=[],g={},p={};for(h.push({currentArgs:t});h.length>0;)v(h.pop());return{flooded:m,boundaries:C()};function v(e){var t=e.currentArgs,n=e.previousArgs;b(t)||(y(t),x(t)?(w(t),T(t)):j(n))}function b(e){return!0===g[e]}function y(e){g[e]=!0}function x(e){var t=E(_,[e]);return E(u,[t,c])}function w(e){m.push(e),a.apply(void 0,r()(e))}function j(e){p[e]=e,l.apply(void 0,r()(e))}function T(e){for(var t=0;t<f.length;t+=1){for(var n=f[t],a=e.slice(0),r=0;r<e.length;r+=1)a[r]+=n[r];h.push({currentArgs:a,previousArgs:e})}}function _(t){return e.apply(void 0,r()(t))}function E(e,t){try{return e.apply(void 0,r()(t))}catch(n){return}}function O(){return S(t.length).filter(function(e){var t=i(e);return 0!==t&&(1===t||d)})}function S(e){for(var t=[],n=function(e){return e.split("").map(function(e){return parseInt(e,10)-1})},a=0;a<Math.pow(3,e);a+=1){var r=s(a.toString(3),"0",e);t.push(n(r))}return t}function C(){var e=[];for(var t in p)p.hasOwnProperty(t)&&e.unshift(p[t]);return e}}},"./util/segmentation/getBoundingBoxAroundCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./util/getCircleCoords.js");function r(e){var t=e.detail.handles,n=e.detail.image,r=n.width,o=n.height,i=Object(a.default)(t.start,t.end),s=i.width+i.left,l=i.left,u=i.top+i.height,d=i.top;return l=Math.floor(l),d=Math.floor(d),s=Math.floor(s),u=Math.floor(u),s=Math.min(r,s),l=Math.max(0,l),u=Math.min(o,u),[[l,d=Math.max(0,d)],[s,u]]}},"./util/segmentation/getBoundingBoxAroundPolygon.js":function(e,t,n){"use strict";function a(e,t){var n=1/0,a=0,r=1/0,o=0,i=t.width,s=t.height;return e.forEach(function(e){n=Math.min(e[0],n),a=Math.max(e[0],a),r=Math.min(e[1],r),o=Math.max(e[1],o)}),n=Math.floor(n),r=Math.floor(r),a=Math.floor(a),o=Math.floor(o),a=Math.min(i,a),n=Math.max(0,n),o=Math.min(s,o),r=Math.max(0,r),[[n,r],[a,o]]}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/getCircle.js":function(e,t,n){"use strict";function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=Math.floor(a),i=Math.floor(r);if(1===e)return[[o,i]];for(var s=[],l=0,u=-e;u<=e;u++){var d=i+u;if(!(d>t||d<0))for(var c=-e;c<=e;c++){var f=o+c;f>=n||f<0||c*c+u*u<e*e&&(s[l++]=[o+c,i+u])}}return s}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/getDiffBetweenPixelData.js":function(e,t,n){"use strict";function a(e,t){for(var n=[],a=0;a<e.length;a++)e[a]!==t[a]&&n.push([a,e[a],t[a]]);return n}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/getPixelPathBetweenPixels.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js"),r=1/Math.sqrt(2),o={up:{x:0,y:1},upRight:{x:r,y:r},right:{x:1,y:0},downRight:{x:r,y:-r},down:{x:0,y:1},downLeft:{x:-r,y:-r},left:{x:-1,y:0},upLeft:{x:-r,y:r}};function i(e,t){var n=d(e,t);switch(f([c(n,o.up),c(n,o.right),c(n,o.upRight)])){case 0:e.y++;break;case 1:e.x++;break;case 2:e.y++,e.x++}}function s(e,t){var n=d(e,t);switch(f([c(n,o.up),c(n,o.left),c(n,o.upLeft)])){case 0:e.y++;break;case 1:e.x--;break;case 2:e.y++,e.x--}}function l(e,t){var n=d(e,t);switch(f([c(n,o.down),c(n,o.right),c(n,o.downRight)])){case 0:e.y--;break;case 1:e.x++;break;case 2:e.y--,e.x++}}function u(e,t){var n=d(e,t);switch(f([c(n,o.down),c(n,o.left),c(n,o.downLeft)])){case 0:e.y--;break;case 1:e.x--;break;case 2:e.y--,e.x--}}function d(e,t){var n=a.default.cornerstoneMath.point.distance(e,t);return{x:(t.x-e.x)/n,y:(t.y-e.y)/n}}function c(e,t){return e.x*t.x+e.y*t.y}function f(e){var t=e[0]>e[1]?0:1;return e[2]>e[t]&&(t=2),t}t.default=function(e,t){for(var n={x:e.x,y:e.y},a=[];t.x!==n.x||t.y!==n.y;)t.x===n.x?t.y>n.y?n.y++:n.y--:t.y===n.y?t.x>n.x?n.x++:n.x--:t.y>n.y?t.x>n.x?i(n,t):s(n,t):t.x>n.x?l(n,t):u(n,t),a.push({x:n.x,y:n.y});return a.pop(),a}},"./util/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/segmentation/drawBrush.js");n.d(t,"drawBrushPixels",function(){return a.drawBrushPixels});var r=n("./util/segmentation/eraseIfSegmentIndex.js");n.d(t,"eraseIfSegmentIndex",function(){return r.default});var o=n("./util/segmentation/eraseOutsideBoundingBox.js");n.d(t,"eraseOutsideBoundingBox",function(){return o.default});var i=n("./util/segmentation/eraseShape.js");n.d(t,"eraseInsideShape",function(){return i.eraseInsideShape}),n.d(t,"eraseOutsideShape",function(){return i.eraseOutsideShape});var s=n("./util/segmentation/fillOutsideBoundingBox.js");n.d(t,"fillOutsideBoundingBox",function(){return s.default});var l=n("./util/segmentation/fillShape.js");n.d(t,"fillInsideShape",function(){return l.fillInsideShape}),n.d(t,"fillOutsideShape",function(){return l.fillOutsideShape});var u=n("./util/segmentation/floodFill.js");n.d(t,"floodFill",function(){return u.default});var d=n("./util/segmentation/getBoundingBoxAroundCircle.js");n.d(t,"getBoundingBoxAroundCircle",function(){return d.default});var c=n("./util/segmentation/getBoundingBoxAroundPolygon.js");n.d(t,"getBoundingBoxAroundPolygon",function(){return c.default});var f=n("./util/segmentation/getCircle.js");n.d(t,"getCircle",function(){return f.default});var h=n("./util/segmentation/getPixelPathBetweenPixels.js");n.d(t,"getPixelPathBetweenPixels",function(){return h.default});var m=n("./util/segmentation/isSameSegment.js");n.d(t,"isSameSegment",function(){return m.default});var g=n("./util/segmentation/triggerLabelmapModifiedEvent.js");n.d(t,"triggerLabelmapModifiedEvent",function(){return g.default});var p=n("./util/segmentation/getDiffBetweenPixelData.js");n.d(t,"getDiffBetweenPixelData",function(){return p.default})},"./util/segmentation/isSameSegment.js":function(e,t,n){"use strict";function a(e,t,n){return t[e]===n}n.r(t),n.d(t,"default",function(){return a})},"./util/segmentation/triggerLabelmapModifiedEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("./externalModules.js"),r=n("./events.js"),o=n("./store/index.js");function i(e,t){var n=Object(o.getModule)("segmentation");t=void 0===t?n.getters.activeLabelmapIndex(e):t,a.default.cornerstone.triggerEvent(e,r.default.LABELMAP_MODIFIED,{labelmapIndex:t})}},"./util/setContextToDisplayFontSize.js":function(e,t,n){"use strict";n.r(t);var a=n("./externalModules.js");t.default=function(e,t,n){var r=.1;return a.default.cornerstone.setToPixelCoordinateSystem(e,t,r),{fontSize:n/e.viewport.scale/r,lineHeight:n/e.viewport.scale/r,fontScale:r}}},"./util/throttle.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/debounce.js"),r=n("./util/isObject.js");t.default=function(e,t,n){var o=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Object(r.default)(n)&&(o="leading"in n?Boolean(n.leading):o,i="trailing"in n?Boolean(n.trailing):i),Object(a.default)(e,t,{leading:o,trailing:i,maxWait:t})}},"./util/triggerEvent.js":function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:a,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,a),e.dispatchEvent(n)}n.r(t),n.d(t,"default",function(){return a})},"./util/uuidv4.js":function(e,t,n){"use strict";function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}n.r(t),n.d(t,"default",function(){return a})},"./util/wait.js":function(e,t,n){"use strict";n.r(t),n.d(t,"wait",function(){return r}),n.d(t,"waitForEnabledElementImageToLoad",function(){return o});var a=n("./externalModules.js"),r=function(e){return new Promise(function(t){return setTimeout(t,e)})};function o(e){try{var t=a.default.cornerstone.getEnabledElement(e);return t.image?t:r(250).then(function(){return o(e)})}catch(n){return null}}t.default=r},"./util/zoom/changeViewportScale.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var a=n.maxScale,r=n.minScale,o=Math.log(e.scale)/Math.log(1.7),i=Math.pow(1.7,o+t);return e.scale=a&&i>a?a:r&&i<r?r:i,e}},"./util/zoom/correctShift.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=t.vflip,a=t.rotation;if(e.x*=t.hflip?-1:1,e.y*=n?-1:1,0!==a){var r=a*Math.PI/180,o=Math.cos(r),i=Math.sin(r),s=e.x*i+e.y*o;e.x=e.x*o-e.y*i,e.y=s}return e}},"./util/zoom/index.js":function(e,t,n){"use strict";n.r(t);var a=n("./util/zoom/changeViewportScale.js");n.d(t,"changeViewportScale",function(){return a.default});var r=n("./util/zoom/correctShift.js");n.d(t,"correctShift",function(){return r.default}),t.default={changeViewportScale:a.default,correctShift:r.default}},"./version.js":function(e,t,n){"use strict";n.r(t),t.default="5.1.3"}})}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("dicom-parser",[],t):"object"==typeof exports?exports["dicom-parser"]=t():e.dicomParser=t()}(this,function(){return function(e){var t=this.webpackHotUpdate;this.webpackHotUpdate=function(e,n){!function(e,t){if(x[e]&&y[e]){for(var n in y[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(m[n]=t[n]);0==--p&&0===v&&_()}}(e,n),t&&t(e,n)};var n,a=!0,r="8f0975605be62f01e67c",o={},i=[],s=[];function l(e){var t=O[e];if(!t)return S;var a=function(a){return t.hot.active?(O[a]?-1===O[a].parents.indexOf(e)&&O[a].parents.push(e):(i=[e],n=a),-1===t.children.indexOf(a)&&t.children.push(a)):(console.warn("[HMR] unexpected require("+a+") from disposed module "+e),i=[]),S(a)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(t){S[e]=t}}};for(var o in S)Object.prototype.hasOwnProperty.call(S,o)&&"e"!==o&&Object.defineProperty(a,o,r(o));return a.e=function(e){return"ready"===c&&f("prepare"),v++,S.e(e).then(t,function(e){throw t(),e});function t(){v--,"prepare"===c&&(b[e]||T(e),0===v&&0===p&&_())}},a}function u(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var a=0;a<e.length;a++)t._acceptedDependencies[e[a]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:j,apply:E,status:function(e){if(!e)return c;d.push(e)},addStatusHandler:function(e){d.push(e)},removeStatusHandler:function(e){var t=d.indexOf(e);t>=0&&d.splice(t,1)},data:o[e]};return n=void 0,t}var d=[],c="idle";function f(e){c=e;for(var t=0;t<d.length;t++)d[t].call(null,e)}var h,m,g,p=0,v=0,b={},y={},x={};function w(e){return+e+""===e?+e:e}function j(e){if("idle"!==c)throw new Error("check() is only allowed in idle status");return a=e,f("check"),(t=1e4,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var a=new XMLHttpRequest,o=S.p+""+r+".hot-update.json";a.open("GET",o,!0),a.timeout=t,a.send(null)}catch(i){return n(i)}a.onreadystatechange=function(){if(4===a.readyState)if(0===a.status)n(new Error("Manifest request to "+o+" timed out."));else if(404===a.status)e();else if(200!==a.status&&304!==a.status)n(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(a.responseText)}catch(r){return void n(r)}e(t)}}})).then(function(e){if(!e)return f("idle"),null;y={},b={},x=e.c,g=e.h,f("prepare");var t=new Promise(function(e,t){h={resolve:e,reject:t}});return m={},T("dicomParser"),"prepare"===c&&0===v&&0===p&&_(),t});var t}function T(e){x[e]?(y[e]=!0,p++,function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script");n.charset="utf-8",n.src=S.p+""+e+"."+r+".hot-update.js",t.appendChild(n)}(e)):b[e]=!0}function _(){f("ready");var e=h;if(h=null,e)if(a)Promise.resolve().then(function(){return E(a)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in m)Object.prototype.hasOwnProperty.call(m,n)&&t.push(w(n));e.resolve(t)}}function E(t){if("ready"!==c)throw new Error("apply() is only allowed in ready status");var n,a,s,l,u;function d(e){for(var t=[e],n={},a=t.slice().map(function(e){return{chain:[e],id:e}});a.length>0;){var r=a.pop(),o=r.id,i=r.chain;if((l=O[o])&&!l.hot._selfAccepted){if(l.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:o};if(l.hot._main)return{type:"unaccepted",chain:i,moduleId:o};for(var s=0;s<l.parents.length;s++){var u=l.parents[s],d=O[u];if(d){if(d.hot._declinedDependencies[o])return{type:"declined",chain:i.concat([u]),moduleId:o,parentId:u};-1===t.indexOf(u)&&(d.hot._acceptedDependencies[o]?(n[u]||(n[u]=[]),h(n[u],[o])):(delete n[u],t.push(u),a.push({chain:i.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];-1===e.indexOf(a)&&e.push(a)}}t=t||{};var p={},v=[],b={},y=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var j in m)if(Object.prototype.hasOwnProperty.call(m,j)){var T;u=w(j);var _=!1,E=!1,C=!1,I="";switch((T=m[j]?d(u):{type:"disposed",moduleId:j}).chain&&(I="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(_=new Error("Aborted because of self decline: "+T.moduleId+I));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(_=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+I));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(_=new Error("Aborted because "+u+" is not accepted"+I));break;case"accepted":t.onAccepted&&t.onAccepted(T),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),C=!0;break;default:throw new Error("Unexception type "+T.type)}if(_)return f("abort"),Promise.reject(_);if(E)for(u in b[u]=m[u],h(v,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,u)&&(p[u]||(p[u]=[]),h(p[u],T.outdatedDependencies[u]));C&&(h(v,[T.moduleId]),b[u]=y)}var M,P=[];for(a=0;a<v.length;a++)O[u=v[a]]&&O[u].hot._selfAccepted&&P.push({module:u,errorHandler:O[u].hot._selfAccepted});f("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var D,k=v.slice();k.length>0;)if(u=k.pop(),l=O[u]){var L={},A=l.hot._disposeHandlers;for(s=0;s<A.length;s++)(n=A[s])(L);for(o[u]=L,l.hot.active=!1,delete O[u],delete p[u],s=0;s<l.children.length;s++){var R=O[l.children[s]];R&&(M=R.parents.indexOf(u))>=0&&R.parents.splice(M,1)}}for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(l=O[u]))for(D=p[u],s=0;s<D.length;s++)(M=l.children.indexOf(D[s]))>=0&&l.children.splice(M,1);for(u in f("apply"),r=g,b)Object.prototype.hasOwnProperty.call(b,u)&&(e[u]=b[u]);var B=null;for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(l=O[u])){D=p[u];var F=[];for(a=0;a<D.length;a++)if(n=l.hot._acceptedDependencies[D[a]]){if(-1!==F.indexOf(n))continue;F.push(n)}for(a=0;a<F.length;a++){n=F[a];try{n(D)}catch(H){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:D[a],error:H}),t.ignoreErrored||B||(B=H)}}}for(a=0;a<P.length;a++){var U=P[a];i=[u=U.module];try{S(u)}catch(H){if("function"==typeof U.errorHandler)try{U.errorHandler(H)}catch(N){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:N,originalError:H}),t.ignoreErrored||B||(B=N),B||(B=H)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:H}),t.ignoreErrored||B||(B=H)}}return B?(f("fail"),Promise.reject(B)):(f("idle"),new Promise(function(e){e(v)}))}var O={};function S(t){if(O[t])return O[t].exports;var n=O[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=i,i=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}return S.m=e,S.c=O,S.d=function(e,t,n){S.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},S.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},S.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(t,"a",t),t},S.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},S.p="",S.h=function(){return r},l("./index.js")(S.s="./index.js")}({"../node_modules/assert/assert.js":function(e,t,n){"use strict";(function(t){function a(e,t){if(e===t)return 0;for(var n=e.length,a=t.length,r=0,o=Math.min(n,a);r<o;++r)if(e[r]!==t[r]){n=e[r],a=t[r];break}return n<a?-1:a<n?1:0}function r(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=n("../node_modules/util/util.js"),i=Object.prototype.hasOwnProperty,s=Array.prototype.slice,l="foo"===(function(){}).name;function u(e){return Object.prototype.toString.call(e)}function d(e){return!r(e)&&"function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var c=e.exports=v,f=/\s*function\s+([^\(\s]*)\s*/;function h(e){if(o.isFunction(e)){if(l)return e.name;var t=e.toString().match(f);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(l||!o.isFunction(e))return o.inspect(e);var t=h(e);return"[Function"+(t?": "+t:"")+"]"}function p(e,t,n,a,r){throw new c.AssertionError({message:n,actual:e,expected:t,operator:a,stackStartFunction:r})}function v(e,t){e||p(e,!0,t,"==",c.ok)}function b(e,t,n,i){if(e===t)return!0;if(r(e)&&r(t))return 0===a(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(d(e)&&d(t)&&u(e)===u(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===a(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(r(e)!==r(t))return!1;var l=(i=i||{actual:[],expected:[]}).actual.indexOf(e);return-1!==l&&l===i.expected.indexOf(t)||(i.actual.push(e),i.expected.push(t),function(e,t,n,a){if(null==e||null==t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var r=y(e),i=y(t);if(r&&!i||!r&&i)return!1;if(r)return b(e=s.call(e),t=s.call(t),n);var l,u,d=j(e),c=j(t);if(d.length!==c.length)return!1;for(d.sort(),c.sort(),u=d.length-1;u>=0;u--)if(d[u]!==c[u])return!1;for(u=d.length-1;u>=0;u--)if(!b(e[l=d[u]],t[l],n,a))return!1;return!0}(e,t,n,i))}return n?e===t:e==t}function y(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function x(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(n){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function w(e,t,n,a){var r;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(a=n,n=null),r=function(e){var t;try{e()}catch(n){t=n}return t}(t),a=(n&&n.name?" ("+n.name+").":".")+(a?" "+a:"."),e&&!r&&p(r,n,"Missing expected exception"+a);var i="string"==typeof a,s=!e&&r&&!n;if((!e&&o.isError(r)&&i&&x(r,n)||s)&&p(r,n,"Got unwanted exception"+a),e&&r&&n&&!x(r,n)||!e&&r)throw r}c.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(g(e.actual),128)+" "+e.operator+" "+m(g(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var a=n.stack,r=h(t),o=a.indexOf("\n"+r);if(o>=0){var i=a.indexOf("\n",o+1);a=a.substring(i+1)}this.stack=a}}},o.inherits(c.AssertionError,Error),c.fail=p,c.ok=v,c.equal=function(e,t,n){e!=t&&p(e,t,n,"==",c.equal)},c.notEqual=function(e,t,n){e==t&&p(e,t,n,"!=",c.notEqual)},c.deepEqual=function(e,t,n){b(e,t,!1)||p(e,t,n,"deepEqual",c.deepEqual)},c.deepStrictEqual=function(e,t,n){b(e,t,!0)||p(e,t,n,"deepStrictEqual",c.deepStrictEqual)},c.notDeepEqual=function(e,t,n){b(e,t,!1)&&p(e,t,n,"notDeepEqual",c.notDeepEqual)},c.notDeepStrictEqual=function e(t,n,a){b(t,n,!0)&&p(t,n,a,"notDeepStrictEqual",e)},c.strictEqual=function(e,t,n){e!==t&&p(e,t,n,"===",c.strictEqual)},c.notStrictEqual=function(e,t,n){e===t&&p(e,t,n,"!==",c.notStrictEqual)},c.throws=function(e,t,n){w(!0,e,t,n)},c.doesNotThrow=function(e,t,n){w(!1,e,t,n)},c.ifError=function(e){if(e)throw e};var j=Object.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/base64-js/index.js":function(e,t,n){"use strict";t.byteLength=function(e){return 3*e.length/4-u(e)},t.toByteArray=function(e){var t,n,a,i,s,l=e.length;i=u(e),s=new o(3*l/4-i),n=i>0?l-4:l;var d=0;for(t=0;t<n;t+=4)a=r[e.charCodeAt(t)]<<18|r[e.charCodeAt(t+1)]<<12|r[e.charCodeAt(t+2)]<<6|r[e.charCodeAt(t+3)],s[d++]=a>>16&255,s[d++]=a>>8&255,s[d++]=255&a;return 2===i?(a=r[e.charCodeAt(t)]<<2|r[e.charCodeAt(t+1)]>>4,s[d++]=255&a):1===i&&(a=r[e.charCodeAt(t)]<<10|r[e.charCodeAt(t+1)]<<4|r[e.charCodeAt(t+2)]>>2,s[d++]=a>>8&255,s[d++]=255&a),s},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o="",i=[],s=16383,l=0,u=n-r;l<u;l+=s)i.push(d(e,l,l+s>u?u:l+s));return 1===r?(o+=a[(t=e[n-1])>>2],o+=a[t<<4&63],o+="=="):2===r&&(o+=a[(t=(e[n-2]<<8)+e[n-1])>>10],o+=a[t>>4&63],o+=a[t<<2&63],o+="="),i.push(o),i.join("")};for(var a=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=i.length;s<l;++s)a[s]=i[s],r[i.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function d(e,t,n){for(var r,o=[],i=t;i<n;i+=3)o.push(a[(r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]))>>18&63]+a[r>>12&63]+a[r>>6&63]+a[63&r]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},"../node_modules/browserify-zlib/lib/binding.js":function(e,t,n){"use strict";(function(e,a){var r=n("../node_modules/assert/assert.js"),o=n("../node_modules/pako/lib/zlib/zstream.js"),i=n("../node_modules/pako/lib/zlib/deflate.js"),s=n("../node_modules/pako/lib/zlib/inflate.js"),l=n("../node_modules/pako/lib/zlib/constants.js");for(var u in l)t[u]=l[u];function d(e){if("number"!=typeof e||e<t.DEFLATE||e>t.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}t.NONE=0,t.DEFLATE=1,t.INFLATE=2,t.GZIP=3,t.GUNZIP=4,t.DEFLATERAW=5,t.INFLATERAW=6,t.UNZIP=7,d.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,r(this.init_done,"close before init"),r(this.mode<=t.UNZIP),this.mode===t.DEFLATE||this.mode===t.GZIP||this.mode===t.DEFLATERAW?i.deflateEnd(this.strm):this.mode!==t.INFLATE&&this.mode!==t.GUNZIP&&this.mode!==t.INFLATERAW&&this.mode!==t.UNZIP||s.inflateEnd(this.strm),this.mode=t.NONE,this.dictionary=null)},d.prototype.write=function(e,t,n,a,r,o,i){return this._write(!0,e,t,n,a,r,o,i)},d.prototype.writeSync=function(e,t,n,a,r,o,i){return this._write(!1,e,t,n,a,r,o,i)},d.prototype._write=function(n,o,i,s,l,u,d,c){if(r.equal(arguments.length,8),r(this.init_done,"write before init"),r(this.mode!==t.NONE,"already finalized"),r.equal(!1,this.write_in_progress,"write already in progress"),r.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,r.equal(!1,void 0===o,"must provide flush value"),this.write_in_progress=!0,o!==t.Z_NO_FLUSH&&o!==t.Z_PARTIAL_FLUSH&&o!==t.Z_SYNC_FLUSH&&o!==t.Z_FULL_FLUSH&&o!==t.Z_FINISH&&o!==t.Z_BLOCK)throw new Error("Invalid flush value");if(null==i&&(i=e.alloc(0),l=0,s=0),this.strm.avail_in=l,this.strm.input=i,this.strm.next_in=s,this.strm.avail_out=c,this.strm.output=u,this.strm.next_out=d,this.flush=o,!n)return this._process(),this._checkError()?this._afterSync():void 0;var f=this;return a.nextTick(function(){f._process(),f._after()}),this},d.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},d.prototype._process=function(){var e=null;switch(this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=i.deflate(this.strm,this.flush);break;case t.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=t.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=t.GUNZIP):this.mode=t.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:for(this.err=s.inflate(this.strm,this.flush),this.err===t.Z_NEED_DICT&&this.dictionary&&(this.err=s.inflateSetDictionary(this.strm,this.dictionary),this.err===t.Z_OK?this.err=s.inflate(this.strm,this.flush):this.err===t.Z_DATA_ERROR&&(this.err=t.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===t.GUNZIP&&this.err===t.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=s.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},d.prototype._checkError=function(){switch(this.err){case t.Z_OK:case t.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===t.Z_FINISH)return this._error("unexpected end of file"),!1;break;case t.Z_STREAM_END:break;case t.Z_NEED_DICT:return this._error(null==this.dictionary?"Missing dictionary":"Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},d.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},d.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},d.prototype.init=function(e,n,a,o,i){r(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),r(e>=8&&e<=15,"invalid windowBits"),r(n>=-1&&n<=9,"invalid compression level"),r(a>=1&&a<=9,"invalid memlevel"),r(o===t.Z_FILTERED||o===t.Z_HUFFMAN_ONLY||o===t.Z_RLE||o===t.Z_FIXED||o===t.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,e,a,o,i),this._setDictionary()},d.prototype.params=function(){throw new Error("deflateParams Not supported")},d.prototype.reset=function(){this._reset(),this._setDictionary()},d.prototype._init=function(e,n,a,r,l){switch(this.level=e,this.windowBits=n,this.memLevel=a,this.strategy=r,this.flush=t.Z_NO_FLUSH,this.err=t.Z_OK,this.mode!==t.GZIP&&this.mode!==t.GUNZIP||(this.windowBits+=16),this.mode===t.UNZIP&&(this.windowBits+=32),this.mode!==t.DEFLATERAW&&this.mode!==t.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=i.deflateInit2(this.strm,this.level,t.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:case t.UNZIP:this.err=s.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==t.Z_OK&&this._error("Init error"),this.dictionary=l,this.write_in_progress=!1,this.init_done=!0},d.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:this.err=i.deflateSetDictionary(this.strm,this.dictionary)}this.err!==t.Z_OK&&this._error("Failed to set dictionary")}},d.prototype._reset=function(){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:case t.GZIP:this.err=i.deflateReset(this.strm);break;case t.INFLATE:case t.INFLATERAW:case t.GUNZIP:this.err=s.inflateReset(this.strm)}this.err!==t.Z_OK&&this._error("Failed to reset stream")},t.Zlib=d}).call(this,n("../node_modules/buffer/index.js").Buffer,n("../node_modules/process/browser.js"))},"../node_modules/browserify-zlib/lib/index.js":function(e,t,n){"use strict";(function(e){var a=n("../node_modules/buffer/index.js").Buffer,r=n("../node_modules/stream-browserify/index.js").Transform,o=n("../node_modules/browserify-zlib/lib/binding.js"),i=n("../node_modules/util/util.js"),s=n("../node_modules/assert/assert.js").ok,l=n("../node_modules/buffer/index.js").kMaxLength,u="Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var d=Object.keys(o),c=0;c<d.length;c++){var f=d[c];f.match(/^Z/)&&Object.defineProperty(t,f,{enumerable:!0,value:o[f],writable:!1})}for(var h={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},m=Object.keys(h),g=0;g<m.length;g++){var p=m[g];h[h[p]]=p}function v(e,t,n){var r=[],o=0;function i(){for(var t;null!==(t=e.read());)r.push(t),o+=t.length;e.once("readable",i)}function s(){var t,i=null;o>=l?i=new RangeError(u):t=a.concat(r,o),r=[],e.close(),n(i,t)}e.on("error",function(t){e.removeListener("end",s),e.removeListener("readable",i),n(t)}),e.on("end",s),e.end(t),i()}function b(e,t){if("string"==typeof t&&(t=a.from(t)),!a.isBuffer(t))throw new TypeError("Not a string or buffer");return e._processChunk(t,e._finishFlushFlag)}function y(e){if(!(this instanceof y))return new y(e);S.call(this,e,o.DEFLATE)}function x(e){if(!(this instanceof x))return new x(e);S.call(this,e,o.INFLATE)}function w(e){if(!(this instanceof w))return new w(e);S.call(this,e,o.GZIP)}function j(e){if(!(this instanceof j))return new j(e);S.call(this,e,o.GUNZIP)}function T(e){if(!(this instanceof T))return new T(e);S.call(this,e,o.DEFLATERAW)}function _(e){if(!(this instanceof _))return new _(e);S.call(this,e,o.INFLATERAW)}function E(e){if(!(this instanceof E))return new E(e);S.call(this,e,o.UNZIP)}function O(e){return e===o.Z_NO_FLUSH||e===o.Z_PARTIAL_FLUSH||e===o.Z_SYNC_FLUSH||e===o.Z_FULL_FLUSH||e===o.Z_FINISH||e===o.Z_BLOCK}function S(e,n){var i=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||t.Z_DEFAULT_CHUNK,r.call(this,e),e.flush&&!O(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!O(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:o.Z_FINISH,e.chunkSize&&(e.chunkSize<t.Z_MIN_CHUNK||e.chunkSize>t.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<t.Z_MIN_WINDOWBITS||e.windowBits>t.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<t.Z_MIN_LEVEL||e.level>t.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<t.Z_MIN_MEMLEVEL||e.memLevel>t.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=t.Z_FILTERED&&e.strategy!=t.Z_HUFFMAN_ONLY&&e.strategy!=t.Z_RLE&&e.strategy!=t.Z_FIXED&&e.strategy!=t.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!a.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(n);var s=this;this._hadError=!1,this._handle.onerror=function(e,n){C(s),s._hadError=!0;var a=new Error(e);a.errno=n,a.code=t.codes[n],s.emit("error",a)};var l=t.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(l=e.level);var u=t.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(u=e.strategy),this._handle.init(e.windowBits||t.Z_DEFAULT_WINDOWBITS,l,e.memLevel||t.Z_DEFAULT_MEMLEVEL,u,e.dictionary),this._buffer=a.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=u,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!i._handle},configurable:!0,enumerable:!0})}function C(t,n){n&&e.nextTick(n),t._handle&&(t._handle.close(),t._handle=null)}function I(e){e.emit("close")}Object.defineProperty(t,"codes",{enumerable:!0,value:Object.freeze(h),writable:!1}),t.Deflate=y,t.Inflate=x,t.Gzip=w,t.Gunzip=j,t.DeflateRaw=T,t.InflateRaw=_,t.Unzip=E,t.createDeflate=function(e){return new y(e)},t.createInflate=function(e){return new x(e)},t.createDeflateRaw=function(e){return new T(e)},t.createInflateRaw=function(e){return new _(e)},t.createGzip=function(e){return new w(e)},t.createGunzip=function(e){return new j(e)},t.createUnzip=function(e){return new E(e)},t.deflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new y(t),e,n)},t.deflateSync=function(e,t){return b(new y(t),e)},t.gzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new w(t),e,n)},t.gzipSync=function(e,t){return b(new w(t),e)},t.deflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new T(t),e,n)},t.deflateRawSync=function(e,t){return b(new T(t),e)},t.unzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new E(t),e,n)},t.unzipSync=function(e,t){return b(new E(t),e)},t.inflate=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new x(t),e,n)},t.inflateSync=function(e,t){return b(new x(t),e)},t.gunzip=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new j(t),e,n)},t.gunzipSync=function(e,t){return b(new j(t),e)},t.inflateRaw=function(e,t,n){return"function"==typeof t&&(n=t,t={}),v(new _(t),e,n)},t.inflateRawSync=function(e,t){return b(new _(t),e)},i.inherits(S,r),S.prototype.params=function(n,a,r){if(n<t.Z_MIN_LEVEL||n>t.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+n);if(a!=t.Z_FILTERED&&a!=t.Z_HUFFMAN_ONLY&&a!=t.Z_RLE&&a!=t.Z_FIXED&&a!=t.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+a);if(this._level!==n||this._strategy!==a){var i=this;this.flush(o.Z_SYNC_FLUSH,function(){s(i._handle,"zlib binding closed"),i._handle.params(n,a),i._hadError||(i._level=n,i._strategy=a,r&&r())})}else e.nextTick(r)},S.prototype.reset=function(){return s(this._handle,"zlib binding closed"),this._handle.reset()},S.prototype._flush=function(e){this._transform(a.alloc(0),"",e)},S.prototype.flush=function(t,n){var r=this,i=this._writableState;("function"==typeof t||void 0===t&&!n)&&(n=t,t=o.Z_FULL_FLUSH),i.ended?n&&e.nextTick(n):i.ending?n&&this.once("end",n):i.needDrain?n&&this.once("drain",function(){return r.flush(t,n)}):(this._flushFlag=t,this.write(a.alloc(0),"",n))},S.prototype.close=function(t){C(this,t),e.nextTick(I,this)},S.prototype._transform=function(e,t,n){var r,i=this._writableState,s=(i.ending||i.ended)&&(!e||i.length===e.length);return null===e||a.isBuffer(e)?this._handle?(s?r=this._finishFlushFlag:(r=this._flushFlag,e.length>=i.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(e,r,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},S.prototype._processChunk=function(e,t,n){var r=e&&e.length,o=this._chunkSize-this._offset,i=0,d=this,c="function"==typeof n;if(!c){var f,h=[],m=0;this.on("error",function(e){f=e}),s(this._handle,"zlib binding closed");do{var g=this._handle.writeSync(t,e,i,r,this._buffer,this._offset,o)}while(!this._hadError&&b(g[0],g[1]));if(this._hadError)throw f;if(m>=l)throw C(this),new RangeError(u);var p=a.concat(h,m);return C(this),p}s(this._handle,"zlib binding closed");var v=this._handle.write(t,e,i,r,this._buffer,this._offset,o);function b(l,u){if(this&&(this.buffer=null,this.callback=null),!d._hadError){var f=o-u;if(s(f>=0,"have should not go down"),f>0){var g=d._buffer.slice(d._offset,d._offset+f);d._offset+=f,c?d.push(g):(h.push(g),m+=g.length)}if((0===u||d._offset>=d._chunkSize)&&(o=d._chunkSize,d._offset=0,d._buffer=a.allocUnsafe(d._chunkSize)),0===u){if(i+=r-l,r=l,!c)return!0;var p=d._handle.write(t,e,i,r,d._buffer,d._offset,d._chunkSize);return p.callback=b,void(p.buffer=e)}if(!c)return!1;n()}}v.buffer=e,v.callback=b},i.inherits(y,S),i.inherits(x,S),i.inherits(w,S),i.inherits(j,S),i.inherits(T,S),i.inherits(_,S),i.inherits(E,S)}).call(this,n("../node_modules/process/browser.js"))},"../node_modules/buffer/index.js":function(e,t,n){"use strict";(function(e){var a=n("../node_modules/base64-js/index.js"),r=n("../node_modules/ieee754/index.js"),o=n("../node_modules/isarray/index.js");function i(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return u(this,e,t,n)}function u(e,t,n,a){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,a){if(n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(a||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===a?new Uint8Array(t):void 0===a?new Uint8Array(t,n):new Uint8Array(t,n,a),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=f(e,t),e}(e,t,n,a):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var a=0|m(t,n),r=(e=s(e,a)).write(t,n);return r!==a&&(e=e.slice(0,r)),e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(a=t.length)!=a?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var a;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(d(t),e=s(e,t<0?0:0|h(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var a=0;a<n;a+=1)e[a]=255&t[a];return e}function h(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(e).length;default:if(a)return H(e).length;t=(""+t).toLowerCase(),a=!0}}function g(e,t,n){var a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function p(e,t,n){var a=e[t];e[t]=e[n],e[n]=a}function v(e,t,n,a,r){if(0===e.length)return-1;if("string"==typeof n?(a=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,a)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,a,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,a,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,a,r){var o,i=1,s=e.length,l=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;i=2,s/=2,l/=2,n/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(r){var d=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===d?0:o-d)){if(-1===d&&(d=o),o-d+1===l)return d*i}else-1!==d&&(o-=o-d),d=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var c=!0,f=0;f<l;f++)if(u(e,o+f)!==u(t,f)){c=!1;break}if(c)return o}return-1}function y(e,t,n,a){n=Number(n)||0;var r=e.length-n;a?(a=Number(a))>r&&(a=r):a=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");a>o/2&&(a=o/2);for(var i=0;i<a;++i){var s=parseInt(t.substr(2*i,2),16);if(isNaN(s))return i;e[n+i]=s}return i}function x(e,t,n,a){return z(H(t,e.length-n),e,n,a)}function w(e,t,n,a){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,a)}function j(e,t,n,a){return w(e,t,n,a)}function T(e,t,n,a){return z(N(t),e,n,a)}function _(e,t,n,a){return z(function(e,t){for(var n,a,r=[],o=0;o<e.length&&!((t-=2)<0);++o)a=(n=e.charCodeAt(o))>>8,r.push(n%256),r.push(a);return r}(t,e.length-n),e,n,a)}function E(e,t,n){return a.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var a=[],r=t;r<n;){var o,i,s,l,u=e[r],d=null,c=u>239?4:u>223?3:u>191?2:1;if(r+c<=n)switch(c){case 1:u<128&&(d=u);break;case 2:128==(192&(o=e[r+1]))&&(l=(31&u)<<6|63&o)>127&&(d=l);break;case 3:i=e[r+2],128==(192&(o=e[r+1]))&&128==(192&i)&&(l=(15&u)<<12|(63&o)<<6|63&i)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:i=e[r+2],s=e[r+3],128==(192&(o=e[r+1]))&&128==(192&i)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&i)<<6|63&s)>65535&&l<1114112&&(d=l)}null===d?(d=65533,c=1):d>65535&&(a.push((d-=65536)>>>10&1023|55296),d=56320|1023&d),a.push(d),r+=c}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);for(var n="",a=0;a<t;)n+=String.fromCharCode.apply(String,e.slice(a,a+=S));return n}(a)}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=i(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return u(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,a){return d(t),t<=0?s(e,t):void 0!==n?"string"==typeof a?s(e,t).fill(n,a):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return c(null,e)},l.allocUnsafeSlow=function(e){return c(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,a=t.length,r=0,o=Math.min(n,a);r<o;++r)if(e[r]!==t[r]){n=e[r],a=t[r];break}return n<a?-1:a<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var a=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var i=e[n];if(!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(a,r),r+=i.length}return a},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):g.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,a,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===a&&(a=0),void 0===r&&(r=this.length),t<0||n>e.length||a<0||r>this.length)throw new RangeError("out of range index");if(a>=r&&t>=n)return 0;if(a>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(a>>>=0),i=(n>>>=0)-(t>>>=0),s=Math.min(o,i),u=this.slice(a,r),d=e.slice(t,n),c=0;c<s;++c)if(u[c]!==d[c]){o=u[c],i=d[c];break}return o<i?-1:i<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,a){if(void 0===t)a="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)a=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===a&&(a="utf8")):(a=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var o=!1;;)switch(a){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return j(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function C(e,t,n){var a="";n=Math.min(e.length,n);for(var r=t;r<n;++r)a+=String.fromCharCode(127&e[r]);return a}function I(e,t,n){var a="";n=Math.min(e.length,n);for(var r=t;r<n;++r)a+=String.fromCharCode(e[r]);return a}function M(e,t,n){var a,r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=(a=e[i])<16?"0"+a.toString(16):a.toString(16);return o}function P(e,t,n){for(var a=e.slice(t,n),r="",o=0;o<a.length;o+=2)r+=String.fromCharCode(a[o]+256*a[o+1]);return r}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,a,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+a>e.length)throw new RangeError("Index out of range")}function L(e,t,n,a){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(a?r:1-r))>>>8*(a?r:1-r)}function A(e,t,n,a){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(a?r:3-r)&255}function R(e,t,n,a,r,o){if(n+a>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,a,o){return o||R(e,0,n,4),r.write(e,t,n,a,23,4),n+4}function F(e,t,n,a,o){return o||R(e,0,n,8),r.write(e,t,n,a,52,8),n+8}l.prototype.slice=function(e,t){var n,a=this.length;if((e=~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),(t=void 0===t?a:~~t)<0?(t+=a)<0&&(t=0):t>a&&(t=a),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var a=this[e],r=1,o=0;++o<t&&(r*=256);)a+=this[e+o]*r;return a},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var a=this[e+--t],r=1;t>0&&(r*=256);)a+=this[e+--t]*r;return a},l.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var a=this[e],r=1,o=0;++o<t&&(r*=256);)a+=this[e+o]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var a=t,r=1,o=this[e+--a];a>0&&(r*=256);)o+=this[e+--a]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,a){e=+e,t|=0,n|=0,a||k(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,a){e=+e,t|=0,n|=0,a||k(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):A(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,a){if(e=+e,t|=0,!a){var r=Math.pow(2,8*n-1);k(this,e,t,n,r-1,-r)}var o=0,i=1,s=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,a){if(e=+e,t|=0,!a){var r=Math.pow(2,8*n-1);k(this,e,t,n,r-1,-r)}var o=n-1,i=1,s=0;for(this[t+o]=255&e;--o>=0&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):A(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,a){if(n||(n=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<n&&(a=n),a===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-n&&(a=e.length-t+n);var r,o=a-n;if(this===e&&n<t&&t<a)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,n=this.length):"string"==typeof n&&(a=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!l.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var i=l.isBuffer(e)?e:H(new l(e,a).toString()),s=i.length;for(o=0;o<n-t;++o)this[o+t]=i[o%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function H(e,t){var n;t=t||1/0;for(var a=e.length,r=null,o=[],i=0;i<a;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(i+1===a){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function N(e){return a.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,a){for(var r=0;r<a&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/core-util-is/lib/util.js":function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n("../node_modules/buffer/index.js").Buffer)},"../node_modules/events/events.js":function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function r(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(o(n=this._events[e]))return!1;if(a(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(r(n))for(s=Array.prototype.slice.call(arguments,1),i=(u=n.slice()).length,l=0;l<i;l++)u[l].apply(this,s);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var i;if(!a(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){if(!a(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var n,o,i,s;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,o=-1,n===t||a(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(s=i;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(a(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(a(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},"../node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,n,a,r){var o,i,s=8*r-a-1,l=(1<<s)-1,u=l>>1,d=-7,c=n?r-1:0,f=n?-1:1,h=e[t+c];for(c+=f,o=h&(1<<-d)-1,h>>=-d,d+=s;d>0;o=256*o+e[t+c],c+=f,d-=8);for(i=o&(1<<-d)-1,o>>=-d,d+=a;d>0;i=256*i+e[t+c],c+=f,d-=8);if(0===o)o=1-u;else{if(o===l)return i?NaN:1/0*(h?-1:1);i+=Math.pow(2,a),o-=u}return(h?-1:1)*i*Math.pow(2,o-a)},t.write=function(e,t,n,a,r,o){var i,s,l,u=8*o-r-1,d=(1<<u)-1,c=d>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,h=a?0:o-1,m=a?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=d):(i=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-i))<1&&(i--,l*=2),(t+=i+c>=1?f/l:f*Math.pow(2,1-c))*l>=2&&(i++,l/=2),i+c>=d?(s=0,i=d):i+c>=1?(s=(t*l-1)*Math.pow(2,r),i+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,r),i=0));r>=8;e[n+h]=255&s,h+=m,s/=256,r-=8);for(i=i<<r|s,u+=r;u>0;e[n+h]=255&i,h+=m,i/=256,u-=8);e[n+h-m]|=128*g}},"../node_modules/inherits/inherits_browser.js":function(e,t){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"../node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"../node_modules/pako/lib/utils/common.js":function(e,t,n){"use strict";var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var a in n)r(n,a)&&(e[a]=n[a])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,a,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+a),r);else for(var o=0;o<a;o++)e[r+o]=t[n+o]},flattenChunks:function(e){var t,n,a,r,o,i;for(a=0,t=0,n=e.length;t<n;t++)a+=e[t].length;for(i=new Uint8Array(a),r=0,t=0,n=e.length;t<n;t++)i.set(o=e[t],r),r+=o.length;return i}},i={arraySet:function(e,t,n,a,r){for(var o=0;o<a;o++)e[r+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(a)},"../node_modules/pako/lib/zlib/adler32.js":function(e,t,n){"use strict";e.exports=function(e,t,n,a){for(var r=65535&e|0,o=e>>>16&65535|0,i=0;0!==n;){n-=i=n>2e3?2e3:n;do{o=o+(r=r+t[a++]|0)|0}while(--i);r%=65521,o%=65521}return r|o<<16|0}},"../node_modules/pako/lib/zlib/constants.js":function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"../node_modules/pako/lib/zlib/crc32.js":function(e,t,n){"use strict";var a=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,r){var o=a,i=r+n;e^=-1;for(var s=r;s<i;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}},"../node_modules/pako/lib/zlib/deflate.js":function(e,t,n){"use strict";var a,r=n("../node_modules/pako/lib/utils/common.js"),o=n("../node_modules/pako/lib/zlib/trees.js"),i=n("../node_modules/pako/lib/zlib/adler32.js"),s=n("../node_modules/pako/lib/zlib/crc32.js"),l=n("../node_modules/pako/lib/zlib/messages.js"),u=-2,d=258,c=262,f=103,h=113,m=666;function g(e,t){return e.msg=l[t],t}function p(e){return(e<<1)-(e>4?9:0)}function v(e){for(var t=e.length;--t>=0;)e[t]=0}function b(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function y(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,b(e.strm)}function x(e,t){e.pending_buf[e.pending++]=t}function w(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function j(e,t){var n,a,r=e.max_chain_length,o=e.strstart,i=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-c?e.strstart-(e.w_size-c):0,u=e.window,f=e.w_mask,h=e.prev,m=e.strstart+d,g=u[o+i-1],p=u[o+i];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+i]===p&&u[n+i-1]===g&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<m);if(a=d-(m-o),o=m-d,a>i){if(e.match_start=t,i=a,a>=s)break;g=u[o+i-1],p=u[o+i]}}}while((t=h[t&f])>l&&0!=--r);return i<=e.lookahead?i:e.lookahead}function T(e){var t,n,a,o,l,u,d,f,h,m,g=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=g+(g-c)){r.arraySet(e.window,e.window,g,g,0),e.match_start-=g,e.strstart-=g,e.block_start-=g,t=n=e.hash_size;do{a=e.head[--t],e.head[t]=a>=g?a-g:0}while(--n);t=n=g;do{a=e.prev[--t],e.prev[t]=a>=g?a-g:0}while(--n);o+=g}if(0===e.strm.avail_in)break;if(d=e.window,f=e.strstart+e.lookahead,m=void 0,(m=(u=e.strm).avail_in)>(h=o)&&(m=h),n=0===m?0:(u.avail_in-=m,r.arraySet(d,u.input,u.next_in,m,f),1===u.state.wrap?u.adler=i(u.adler,d,m,f):2===u.state.wrap&&(u.adler=s(u.adler,d,m,f)),u.next_in+=m,u.total_in+=m,m),e.lookahead+=n,e.lookahead+e.insert>=3)for(e.ins_h=e.window[l=e.strstart-e.insert],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<c&&0!==e.strm.avail_in)}function _(e,t){for(var n,a;;){if(e.lookahead<c){if(T(e),e.lookahead<c&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-c&&(e.match_length=j(e,n)),e.match_length>=3)if(a=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else a=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var n,a,r;;){if(e.lookahead<c){if(T(e),e.lookahead<c&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-c&&(e.match_length=j(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,a=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((a=o._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function O(e,t,n,a,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=a,this.func=r}function S(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),v(this.dyn_ltree),v(this.dyn_dtree),v(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),v(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),v(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):g(e,u)}function I(e){var t,n=C(e);return 0===n&&((t=e.state).window_size=2*t.w_size,v(t.head),t.max_lazy_match=a[t.level].max_lazy,t.good_match=a[t.level].good_length,t.nice_match=a[t.level].nice_length,t.max_chain_length=a[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function M(e,t,n,a,o,i){if(!e)return u;var s=1;if(-1===t&&(t=6),a<0?(s=0,a=-a):a>15&&(s=2,a-=16),o<1||o>9||8!==n||a<8||a>15||t<0||t>9||i<0||i>4)return g(e,u);8===a&&(a=9);var l=new S;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=a,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=i,l.method=n,I(e)}a=[new O(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(T(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+n;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,y(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-c&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&y(e,!1),1)}),new O(4,4,8,4,_),new O(4,5,16,8,_),new O(4,6,32,32,_),new O(4,4,16,16,E),new O(8,16,32,32,E),new O(8,16,128,128,E),new O(8,32,128,256,E),new O(32,128,258,1024,E),new O(32,258,258,4096,E)],t.deflateInit=function(e,t){return M(e,t,8,15,8,0)},t.deflateInit2=M,t.deflateReset=I,t.deflateResetKeep=C,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,0):u},t.deflate=function(e,t){var n,r,i,l;if(!e||!e.state||t>5||t<0)return e?g(e,u):u;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===m&&4!==t)return g(e,0===e.avail_out?-5:u);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,x(r,31),x(r,139),x(r,8),r.gzhead?(x(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),x(r,255&r.gzhead.time),x(r,r.gzhead.time>>8&255),x(r,r.gzhead.time>>16&255),x(r,r.gzhead.time>>24&255),x(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),x(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(x(r,255&r.gzhead.extra.length),x(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(x(r,0),x(r,0),x(r,0),x(r,0),x(r,0),x(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),x(r,3),r.status=h);else{var c=8+(r.w_bits-8<<4)<<8;c|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(c|=32),c+=31-c%31,r.status=h,w(r,c),0!==r.strstart&&(w(r,e.adler>>>16),w(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(e.adler=s(e.adler,r.pending_buf,r.pending-i,i)),b(e),i=r.pending,r.pending!==r.pending_buf_size));)x(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(e.adler=s(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=s(e.adler,r.pending_buf,r.pending-i,i)),b(e),i=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,x(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>i&&(e.adler=s(e.adler,r.pending_buf,r.pending-i,i)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=s(e.adler,r.pending_buf,r.pending-i,i)),b(e),i=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,x(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>i&&(e.adler=s(e.adler,r.pending_buf,r.pending-i,i)),0===l&&(r.status=f)}else r.status=f;if(r.status===f&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&b(e),r.pending+2<=r.pending_buf_size&&(x(r,255&e.adler),x(r,e.adler>>8&255),e.adler=0,r.status=h)):r.status=h),0!==r.pending){if(b(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(n)&&4!==t)return g(e,-5);if(r.status===m&&0!==e.avail_in)return g(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&r.status!==m){var j=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(T(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,a,r,i,s=e.window;;){if(e.lookahead<=d){if(T(e),e.lookahead<=d&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(a=s[r=e.strstart-1])===s[++r]&&a===s[++r]&&a===s[++r]){i=e.strstart+d;do{}while(a===s[++r]&&a===s[++r]&&a===s[++r]&&a===s[++r]&&a===s[++r]&&a===s[++r]&&a===s[++r]&&a===s[++r]&&r<i);e.match_length=d-(i-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(r,t):a[r.level].func(r,t);if(3!==j&&4!==j||(r.status=m),1===j||3===j)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===j&&(1===t?o._tr_align(r):5!==t&&(o._tr_stored_block(r,0,0,!1),3===t&&(v(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),b(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(x(r,255&e.adler),x(r,e.adler>>8&255),x(r,e.adler>>16&255),x(r,e.adler>>24&255),x(r,255&e.total_in),x(r,e.total_in>>8&255),x(r,e.total_in>>16&255),x(r,e.total_in>>24&255)):(w(r,e.adler>>>16),w(r,65535&e.adler)),b(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==f&&t!==h&&t!==m?g(e,u):(e.state=null,t===h?g(e,-3):0):u},t.deflateSetDictionary=function(e,t){var n,a,o,s,l,d,c,f,h=t.length;if(!e||!e.state)return u;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return u;for(1===s&&(e.adler=i(e.adler,t,h,0)),n.wrap=0,h>=n.w_size&&(0===s&&(v(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new r.Buf8(n.w_size),r.arraySet(f,t,h-n.w_size,n.w_size,0),t=f,h=n.w_size),l=e.avail_in,d=e.next_in,c=e.input,e.avail_in=h,e.next_in=0,e.input=t,T(n);n.lookahead>=3;){a=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[a+3-1])&n.hash_mask,n.prev[a&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=a,a++}while(--o);n.strstart=a,n.lookahead=2,T(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=d,e.input=c,e.avail_in=l,n.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},"../node_modules/pako/lib/zlib/inffast.js":function(e,t,n){"use strict";e.exports=function(e,t){var n,a,r,o,i,s,l,u,d,c,f,h,m,g,p,v,b,y,x,w,j,T,_,E,O;E=e.input,r=(a=e.next_in)+(e.avail_in-5),O=e.output,i=(o=e.next_out)-(t-e.avail_out),s=o+(e.avail_out-257),l=(n=e.state).dmax,u=n.wsize,d=n.whave,c=n.wnext,f=n.window,h=n.hold,m=n.bits,g=n.lencode,p=n.distcode,v=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{m<15&&(h+=E[a++]<<m,h+=E[a++]<<(m+=8),m+=8),y=g[h&v];t:for(;;){if(h>>>=x=y>>>24,m-=x,0==(x=y>>>16&255))O[o++]=65535&y;else{if(!(16&x)){if(0==(64&x)){y=g[(65535&y)+(h&(1<<x)-1)];continue t}if(32&x){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&y,(x&=15)&&(m<x&&(h+=E[a++]<<m,m+=8),w+=h&(1<<x)-1,h>>>=x,m-=x),m<15&&(h+=E[a++]<<m,h+=E[a++]<<(m+=8),m+=8),y=p[h&b];n:for(;;){if(h>>>=x=y>>>24,m-=x,!(16&(x=y>>>16&255))){if(0==(64&x)){y=p[(65535&y)+(h&(1<<x)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(j=65535&y,m<(x&=15)&&(h+=E[a++]<<m,(m+=8)<x&&(h+=E[a++]<<m,m+=8)),(j+=h&(1<<x)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=x,m-=x,j>(x=o-i)){if((x=j-x)>d&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(T=0,_=f,0===c){if(T+=u-x,x<w){w-=x;do{O[o++]=f[T++]}while(--x);T=o-j,_=O}}else if(c<x){if(T+=u+c-x,(x-=c)<w){w-=x;do{O[o++]=f[T++]}while(--x);if(T=0,c<w){w-=x=c;do{O[o++]=f[T++]}while(--x);T=o-j,_=O}}}else if(T+=c-x,x<w){w-=x;do{O[o++]=f[T++]}while(--x);T=o-j,_=O}for(;w>2;)O[o++]=_[T++],O[o++]=_[T++],O[o++]=_[T++],w-=3;w&&(O[o++]=_[T++],w>1&&(O[o++]=_[T++]))}else{T=o-j;do{O[o++]=O[T++],O[o++]=O[T++],O[o++]=O[T++],w-=3}while(w>2);w&&(O[o++]=O[T++],w>1&&(O[o++]=O[T++]))}break}}break}}while(a<r&&o<s);h&=(1<<(m-=(w=m>>3)<<3))-1,e.next_in=a-=w,e.next_out=o,e.avail_in=a<r?r-a+5:5-(a-r),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=h,n.bits=m}},"../node_modules/pako/lib/zlib/inflate.js":function(e,t,n){"use strict";var a=n("../node_modules/pako/lib/utils/common.js"),r=n("../node_modules/pako/lib/zlib/adler32.js"),o=n("../node_modules/pako/lib/zlib/crc32.js"),i=n("../node_modules/pako/lib/zlib/inffast.js"),s=n("../node_modules/pako/lib/zlib/inftrees.js"),l=-2,u=12,d=30;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(e.total_in=e.total_out=(t=e.state).total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new a.Buf32(852),t.distcode=t.distdyn=new a.Buf32(592),t.sane=1,t.back=-1,0):l}function m(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):l}function g(e,t){var n,a;return e&&e.state?(t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==(a=e.state).window&&a.wbits!==t&&(a.window=null),a.wrap=n,a.wbits=t,m(e))):l}function p(e,t){var n,a;return e?(a=new f,e.state=a,a.window=null,0!==(n=g(e,t))&&(e.state=null),n):l}var v,b,y=!0;function x(e){if(y){var t;for(v=new a.Buf32(512),b=new a.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,v,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,b,0,e.work,{bits:5}),y=!1}e.lencode=v,e.lenbits=9,e.distcode=b,e.distbits=5}function w(e,t,n,r){var o,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new a.Buf8(i.wsize)),r>=i.wsize?(a.arraySet(i.window,t,n-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((o=i.wsize-i.wnext)>r&&(o=r),a.arraySet(i.window,t,n-r,o,i.wnext),(r-=o)?(a.arraySet(i.window,t,n-r,r,0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0}t.inflateReset=m,t.inflateReset2=g,t.inflateResetKeep=h,t.inflateInit=function(e){return p(e,15)},t.inflateInit2=p,t.inflate=function(e,t){var n,f,h,m,g,p,v,b,y,j,T,_,E,O,S,C,I,M,P,D,k,L,A,R,B=0,F=new a.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(n=e.state).mode===u&&(n.mode=13),g=e.next_out,h=e.output,m=e.next_in,f=e.input,b=n.hold,y=n.bits,j=p=e.avail_in,T=v=e.avail_out,L=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;y<16;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(2&n.wrap&&35615===b){n.check=0,F[0]=255&b,F[1]=b>>>8&255,n.check=o(n.check,F,2,0),b=0,y=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",n.mode=d;break}if(8!=(15&b)){e.msg="unknown compression method",n.mode=d;break}if(y-=4,k=8+(15&(b>>>=4)),0===n.wbits)n.wbits=k;else if(k>n.wbits){e.msg="invalid window size",n.mode=d;break}n.dmax=1<<k,e.adler=n.check=1,n.mode=512&b?10:u,b=0,y=0;break;case 2:for(;y<16;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(n.flags=b,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=d;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=d;break}n.head&&(n.head.text=b>>8&1),512&n.flags&&(F[0]=255&b,F[1]=b>>>8&255,n.check=o(n.check,F,2,0)),b=0,y=0,n.mode=3;case 3:for(;y<32;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}n.head&&(n.head.time=b),512&n.flags&&(F[0]=255&b,F[1]=b>>>8&255,F[2]=b>>>16&255,F[3]=b>>>24&255,n.check=o(n.check,F,4,0)),b=0,y=0,n.mode=4;case 4:for(;y<16;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}n.head&&(n.head.xflags=255&b,n.head.os=b>>8),512&n.flags&&(F[0]=255&b,F[1]=b>>>8&255,n.check=o(n.check,F,2,0)),b=0,y=0,n.mode=5;case 5:if(1024&n.flags){for(;y<16;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}n.length=b,n.head&&(n.head.extra_len=b),512&n.flags&&(F[0]=255&b,F[1]=b>>>8&255,n.check=o(n.check,F,2,0)),b=0,y=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((_=n.length)>p&&(_=p),_&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),a.arraySet(n.head.extra,f,m,_,k)),512&n.flags&&(n.check=o(n.check,f,_,m)),p-=_,m+=_,n.length-=_),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break e;_=0;do{k=f[m+_++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&_<p);if(512&n.flags&&(n.check=o(n.check,f,_,m)),p-=_,m+=_,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break e;_=0;do{k=f[m+_++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&_<p);if(512&n.flags&&(n.check=o(n.check,f,_,m)),p-=_,m+=_,k)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;y<16;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(b!==(65535&n.check)){e.msg="header crc mismatch",n.mode=d;break}b=0,y=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=u;break;case 10:for(;y<32;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}e.adler=n.check=c(b),b=0,y=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=g,e.avail_out=v,e.next_in=m,e.avail_in=p,n.hold=b,n.bits=y,2;e.adler=n.check=1,n.mode=u;case u:if(5===t||6===t)break e;case 13:if(n.last){b>>>=7&y,y-=7&y,n.mode=27;break}for(;y<3;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}switch(n.last=1&b,y-=1,3&(b>>>=1)){case 0:n.mode=14;break;case 1:if(x(n),n.mode=20,6===t){b>>>=2,y-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=d}b>>>=2,y-=2;break;case 14:for(b>>>=7&y,y-=7&y;y<32;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",n.mode=d;break}if(n.length=65535&b,b=0,y=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(_=n.length){if(_>p&&(_=p),_>v&&(_=v),0===_)break e;a.arraySet(h,f,m,_,g),p-=_,m+=_,v-=_,g+=_,n.length-=_;break}n.mode=u;break;case 17:for(;y<14;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(n.nlen=257+(31&b),y-=5,n.ndist=1+(31&(b>>>=5)),y-=5,n.ncode=4+(15&(b>>>=5)),b>>>=4,y-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=d;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;y<3;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}n.lens[U[n.have++]]=7&b,b>>>=3,y-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,L=s(0,n.lens,0,19,n.lencode,0,n.work,A={bits:n.lenbits}),n.lenbits=A.bits,L){e.msg="invalid code lengths set",n.mode=d;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(B=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,I=65535&B,!((S=B>>>24)<=y);){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(I<16)b>>>=S,y-=S,n.lens[n.have++]=I;else{if(16===I){for(R=S+2;y<R;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(b>>>=S,y-=S,0===n.have){e.msg="invalid bit length repeat",n.mode=d;break}k=n.lens[n.have-1],_=3+(3&b),b>>>=2,y-=2}else if(17===I){for(R=S+3;y<R;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}y-=S,k=0,_=3+(7&(b>>>=S)),b>>>=3,y-=3}else{for(R=S+7;y<R;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}y-=S,k=0,_=11+(127&(b>>>=S)),b>>>=7,y-=7}if(n.have+_>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=d;break}for(;_--;)n.lens[n.have++]=k}}if(n.mode===d)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=d;break}if(n.lenbits=9,L=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,A={bits:n.lenbits}),n.lenbits=A.bits,L){e.msg="invalid literal/lengths set",n.mode=d;break}if(n.distbits=6,n.distcode=n.distdyn,L=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,A={bits:n.distbits}),n.distbits=A.bits,L){e.msg="invalid distances set",n.mode=d;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(p>=6&&v>=258){e.next_out=g,e.avail_out=v,e.next_in=m,e.avail_in=p,n.hold=b,n.bits=y,i(e,T),g=e.next_out,h=e.output,v=e.avail_out,m=e.next_in,f=e.input,p=e.avail_in,b=n.hold,y=n.bits,n.mode===u&&(n.back=-1);break}for(n.back=0;C=(B=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,I=65535&B,!((S=B>>>24)<=y);){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(C&&0==(240&C)){for(M=S,P=C,D=I;C=(B=n.lencode[D+((b&(1<<M+P)-1)>>M)])>>>16&255,I=65535&B,!(M+(S=B>>>24)<=y);){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}b>>>=M,y-=M,n.back+=M}if(b>>>=S,y-=S,n.back+=S,n.length=I,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=u;break}if(64&C){e.msg="invalid literal/length code",n.mode=d;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(R=n.extra;y<R;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}n.length+=b&(1<<n.extra)-1,b>>>=n.extra,y-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(B=n.distcode[b&(1<<n.distbits)-1])>>>16&255,I=65535&B,!((S=B>>>24)<=y);){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(0==(240&C)){for(M=S,P=C,D=I;C=(B=n.distcode[D+((b&(1<<M+P)-1)>>M)])>>>16&255,I=65535&B,!(M+(S=B>>>24)<=y);){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}b>>>=M,y-=M,n.back+=M}if(b>>>=S,y-=S,n.back+=S,64&C){e.msg="invalid distance code",n.mode=d;break}n.offset=I,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(R=n.extra;y<R;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}n.offset+=b&(1<<n.extra)-1,b>>>=n.extra,y-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=d;break}n.mode=25;case 25:if(0===v)break e;if(n.offset>(_=T-v)){if((_=n.offset-_)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=d;break}E=_>n.wnext?n.wsize-(_-=n.wnext):n.wnext-_,_>n.length&&(_=n.length),O=n.window}else O=h,E=g-n.offset,_=n.length;_>v&&(_=v),v-=_,n.length-=_;do{h[g++]=O[E++]}while(--_);0===n.length&&(n.mode=21);break;case 26:if(0===v)break e;h[g++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;y<32;){if(0===p)break e;p--,b|=f[m++]<<y,y+=8}if(e.total_out+=T-=v,n.total+=T,T&&(e.adler=n.check=n.flags?o(n.check,h,T,g-T):r(n.check,h,T,g-T)),T=v,(n.flags?b:c(b))!==n.check){e.msg="incorrect data check",n.mode=d;break}b=0,y=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;y<32;){if(0===p)break e;p--,b+=f[m++]<<y,y+=8}if(b!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=d;break}b=0,y=0}n.mode=29;case 29:L=1;break e;case d:L=-3;break e;case 31:return-4;case 32:default:return l}return e.next_out=g,e.avail_out=v,e.next_in=m,e.avail_in=p,n.hold=b,n.bits=y,(n.wsize||T!==e.avail_out&&n.mode<d&&(n.mode<27||4!==t))&&w(e,e.output,e.next_out,T-e.avail_out)?(n.mode=31,-4):(T-=e.avail_out,e.total_in+=j-=e.avail_in,e.total_out+=T,n.total+=T,n.wrap&&T&&(e.adler=n.check=n.flags?o(n.check,h,T,e.next_out-T):r(n.check,h,T,e.next_out-T)),e.data_type=n.bits+(n.last?64:0)+(n.mode===u?128:0)+(20===n.mode||15===n.mode?256:0),(0===j&&0===T||4===t)&&0===L&&(L=-5),L)},t.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?l:(n.head=t,t.done=!1,0):l},t.inflateSetDictionary=function(e,t){var n,a=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&r(1,t,a,0)!==n.check?-3:w(e,t,a,a)?(n.mode=31,-4):(n.havedict=1,0):l},t.inflateInfo="pako inflate (from Nodeca project)"},"../node_modules/pako/lib/zlib/inftrees.js":function(e,t,n){"use strict";var a=n("../node_modules/pako/lib/utils/common.js"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,u,d,c,f){var h,m,g,p,v,b,y,x,w,j=f.bits,T=0,_=0,E=0,O=0,S=0,C=0,I=0,M=0,P=0,D=0,k=null,L=0,A=new a.Buf16(16),R=new a.Buf16(16),B=null,F=0;for(T=0;T<=15;T++)A[T]=0;for(_=0;_<l;_++)A[t[n+_]]++;for(S=j,O=15;O>=1&&0===A[O];O--);if(S>O&&(S=O),0===O)return u[d++]=20971520,u[d++]=20971520,f.bits=1,0;for(E=1;E<O&&0===A[E];E++);for(S<E&&(S=E),M=1,T=1;T<=15;T++)if(M<<=1,(M-=A[T])<0)return-1;if(M>0&&(0===e||1!==O))return-1;for(R[1]=0,T=1;T<15;T++)R[T+1]=R[T]+A[T];for(_=0;_<l;_++)0!==t[n+_]&&(c[R[t[n+_]]++]=_);if(0===e?(k=B=c,b=19):1===e?(k=r,L-=257,B=o,F-=257,b=256):(k=i,B=s,b=-1),D=0,_=0,T=E,v=d,C=S,I=0,g=-1,p=(P=1<<S)-1,1===e&&P>852||2===e&&P>592)return 1;for(;;){y=T-I,c[_]<b?(x=0,w=c[_]):c[_]>b?(x=B[F+c[_]],w=k[L+c[_]]):(x=96,w=0),h=1<<T-I,E=m=1<<C;do{u[v+(D>>I)+(m-=h)]=y<<24|x<<16|w|0}while(0!==m);for(h=1<<T-1;D&h;)h>>=1;if(0!==h?(D&=h-1,D+=h):D=0,_++,0==--A[T]){if(T===O)break;T=t[n+c[_]]}if(T>S&&(D&p)!==g){for(0===I&&(I=S),v+=E,M=1<<(C=T-I);C+I<O&&!((M-=A[C+I])<=0);)C++,M<<=1;if(P+=1<<C,1===e&&P>852||2===e&&P>592)return 1;u[g=D&p]=S<<24|C<<16|v-d|0}}return 0!==D&&(u[v+D]=T-I<<24|64<<16|0),f.bits=S,0}},"../node_modules/pako/lib/zlib/messages.js":function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"../node_modules/pako/lib/zlib/trees.js":function(e,t,n){"use strict";var a=n("../node_modules/pako/lib/utils/common.js");function r(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],i=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);r(u);var d=new Array(60);r(d);var c=new Array(512);r(c);var f=new Array(256);r(f);var h=new Array(29);r(h);var m,g,p,v=new Array(30);function b(e,t,n,a,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=a,this.max_length=r,this.has_stree=e&&e.length}function y(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?c[e]:c[256+(e>>>7)]}function w(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function j(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,w(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function T(e,t,n){j(e,n[2*t],n[2*t+1])}function _(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function E(e,t,n){var a,r,o=new Array(16),i=0;for(a=1;a<=15;a++)o[a]=i=i+n[a-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=_(o[s]++,s))}}function O(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function S(e){e.bi_valid>8?w(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function C(e,t,n,a){var r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&a[t]<=a[n]}function I(e,t,n){for(var a=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&C(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!C(t,a,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=a}function M(e,t,n){var a,r,s,l,u=0;if(0!==e.last_lit)do{a=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],r=e.pending_buf[e.l_buf+u],u++,0===a?T(e,r,t):(T(e,(s=f[r])+256+1,t),0!==(l=o[s])&&j(e,r-=h[s],l),T(e,s=x(--a),n),0!==(l=i[s])&&j(e,a-=v[s],l))}while(u<e.last_lit);T(e,256,t)}function P(e,t){var n,a,r,o=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(r=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=i[2*r+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)I(e,o,n);r=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],I(e,o,1),a=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=a,o[2*r]=o[2*n]+o[2*a],e.depth[r]=(e.depth[n]>=e.depth[a]?e.depth[n]:e.depth[a])+1,o[2*n+1]=o[2*a+1]=r,e.heap[1]=r++,I(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,a,r,o,i,s,l=t.dyn_tree,u=t.max_code,d=t.stat_desc.static_tree,c=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=l[2*l[2*(a=e.heap[n])+1]+1]+1)>m&&(o=m,g++),l[2*a+1]=o,a>u||(e.bl_count[o]++,i=0,a>=h&&(i=f[a-h]),e.opt_len+=(s=l[2*a])*(o+i),c&&(e.static_len+=s*(d[2*a+1]+i)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(a=e.bl_count[o];0!==a;)(r=e.heap[--n])>u||(l[2*r+1]!==o&&(e.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),a--)}}(e,t),E(o,u,e.bl_count)}function D(e,t,n){var a,r,o=-1,i=t[1],s=0,l=7,u=4;for(0===i&&(l=138,u=3),t[2*(n+1)+1]=65535,a=0;a<=n;a++)r=i,i=t[2*(a+1)+1],++s<l&&r===i||(s<u?e.bl_tree[2*r]+=s:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=r,0===i?(l=138,u=3):r===i?(l=6,u=3):(l=7,u=4))}function k(e,t,n){var a,r,o=-1,i=t[1],s=0,l=7,u=4;for(0===i&&(l=138,u=3),a=0;a<=n;a++)if(r=i,i=t[2*(a+1)+1],!(++s<l&&r===i)){if(s<u)do{T(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(T(e,r,e.bl_tree),s--),T(e,16,e.bl_tree),j(e,s-3,2)):s<=10?(T(e,17,e.bl_tree),j(e,s-3,3)):(T(e,18,e.bl_tree),j(e,s-11,7));s=0,o=r,0===i?(l=138,u=3):r===i?(l=6,u=3):(l=7,u=4)}}r(v);var L=!1;function A(e,t,n,r){j(e,0+(r?1:0),3),function(e,t,n,r){S(e),w(e,n),w(e,~n),a.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}t._tr_init=function(e){L||(function(){var e,t,n,a,r,l=new Array(16);for(n=0,a=0;a<28;a++)for(h[a]=n,e=0;e<1<<o[a];e++)f[n++]=a;for(f[n-1]=a,r=0,a=0;a<16;a++)for(v[a]=r,e=0;e<1<<i[a];e++)c[r++]=a;for(r>>=7;a<30;a++)for(v[a]=r<<7,e=0;e<1<<i[a]-7;e++)c[256+r++]=a;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,l[8]++;for(;e<=255;)u[2*e+1]=9,e++,l[9]++;for(;e<=279;)u[2*e+1]=7,e++,l[7]++;for(;e<=287;)u[2*e+1]=8,e++,l[8]++;for(E(u,287,l),e=0;e<30;e++)d[2*e+1]=5,d[2*e]=_(e,5);m=new b(u,o,257,286,15),g=new b(d,i,0,30,15),p=new b(new Array(0),s,0,19,7)}(),L=!0),e.l_desc=new y(e.dyn_ltree,m),e.d_desc=new y(e.dyn_dtree,g),e.bl_desc=new y(e.bl_tree,p),e.bi_buf=0,e.bi_valid=0,O(e)},t._tr_stored_block=A,t._tr_flush_block=function(e,t,n,a){var r,o,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),P(e,e.l_desc),P(e,e.d_desc),i=function(e){var t;for(D(e,e.dyn_ltree,e.l_desc.max_code),D(e,e.dyn_dtree,e.d_desc.max_code),P(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),(o=e.static_len+3+7>>>3)<=(r=e.opt_len+3+7>>>3)&&(r=o)):r=o=n+5,n+4<=r&&-1!==t?A(e,t,n,a):4===e.strategy||o===r?(j(e,2+(a?1:0),3),M(e,u,d)):(j(e,4+(a?1:0),3),function(e,t,n,a){var r;for(j(e,t-257,5),j(e,n-1,5),j(e,a-4,4),r=0;r<a;r++)j(e,e.bl_tree[2*l[r]+1],3);k(e,e.dyn_ltree,t-1),k(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),M(e,e.dyn_ltree,e.dyn_dtree)),O(e),a&&S(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(f[n]+256+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){j(e,2,3),T(e,256,u),function(e){16===e.bi_valid?(w(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},"../node_modules/pako/lib/zlib/zstream.js":function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},"../node_modules/process-nextick-args/index.js":function(e,t,n){"use strict";(function(t){e.exports=!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?{nextTick:function(e,n,a,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,i,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,n)});case 3:return t.nextTick(function(){e.call(null,n,a)});case 4:return t.nextTick(function(){e.call(null,n,a,r)});default:for(o=new Array(s-1),i=0;i<o.length;)o[i++]=arguments[i];return t.nextTick(function(){e.apply(null,o)})}}}:t}).call(this,n("../node_modules/process/browser.js"))},"../node_modules/process/browser.js":function(e,t){var n,a,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var l,u=[],d=!1,c=-1;function f(){d&&l&&(d=!1,l.length?u=l.concat(u):c=-1,u.length&&h())}function h(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(l=u,u=[];++c<t;)l&&l[c].run();c=-1,t=u.length}l=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||s(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"../node_modules/readable-stream/duplex-browser.js":function(e,t,n){e.exports=n("../node_modules/readable-stream/lib/_stream_duplex.js")},"../node_modules/readable-stream/lib/_stream_duplex.js":function(e,t,n){"use strict";var a=n("../node_modules/process-nextick-args/index.js"),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=c;var o=n("../node_modules/core-util-is/lib/util.js");o.inherits=n("../node_modules/inherits/inherits_browser.js");var i=n("../node_modules/readable-stream/lib/_stream_readable.js"),s=n("../node_modules/readable-stream/lib/_stream_writable.js");o.inherits(c,i);for(var l=r(s.prototype),u=0;u<l.length;u++){var d=l[u];c.prototype[d]||(c.prototype[d]=s.prototype[d])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||a.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(e,t){this.push(null),this.end(),a.nextTick(t,e)}},"../node_modules/readable-stream/lib/_stream_passthrough.js":function(e,t,n){"use strict";e.exports=o;var a=n("../node_modules/readable-stream/lib/_stream_transform.js"),r=n("../node_modules/core-util-is/lib/util.js");function o(e){if(!(this instanceof o))return new o(e);a.call(this,e)}r.inherits=n("../node_modules/inherits/inherits_browser.js"),r.inherits(o,a),o.prototype._transform=function(e,t,n){n(null,e)}},"../node_modules/readable-stream/lib/_stream_readable.js":function(e,t,n){"use strict";(function(t,a){var r=n("../node_modules/process-nextick-args/index.js");e.exports=y;var o,i=n("../node_modules/isarray/index.js");y.ReadableState=b,n("../node_modules/events/events.js");var s=function(e,t){return e.listeners(t).length},l=n("../node_modules/readable-stream/lib/internal/streams/stream-browser.js"),u=n("../node_modules/safe-buffer/index.js").Buffer,d=t.Uint8Array||function(){},c=n("../node_modules/core-util-is/lib/util.js");c.inherits=n("../node_modules/inherits/inherits_browser.js");var f=n(0),h=void 0;h=f&&f.debuglog?f.debuglog("stream"):function(){};var m,g=n("../node_modules/readable-stream/lib/internal/streams/BufferList.js"),p=n("../node_modules/readable-stream/lib/internal/streams/destroy.js");c.inherits(y,l);var v=["error","close","destroy","pause","resume"];function b(e,t){var a=t instanceof(o=o||n("../node_modules/readable-stream/lib/_stream_duplex.js"));this.objectMode=!!(e=e||{}).objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,i=e.readableHighWaterMark;this.highWaterMark=r||0===r?r:a&&(i||0===i)?i:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(m||(m=n("../node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new m(e.encoding),this.encoding=e.encoding)}function y(e){if(o=o||n("../node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof y))return new y(e);this._readableState=new b(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),l.call(this)}function x(e,t,n,a,r){var o,i=e._readableState;return null===t?(i.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,_(e)}}(e,i)):(r||(o=function(e,t){var n,a;return u.isBuffer(a=t)||a instanceof d||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(i,t)),o?e.emit("error",o):i.objectMode||t&&t.length>0?("string"==typeof t||i.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),a?i.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,i,t,!0):i.ended?e.emit("error",new Error("stream.push() after EOF")):(i.reading=!1,i.decoder&&!n?(t=i.decoder.write(t),i.objectMode||0!==t.length?w(e,i,t,!1):O(e,i)):w(e,i,t,!1))):a||(i.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(i)}function w(e,t,n,a){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,a?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&_(e)),O(e,t)}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),y.prototype.destroy=p.destroy,y.prototype._undestroy=p.undestroy,y.prototype._destroy=function(e,t){this.push(null),t(e)},y.prototype.push=function(e,t){var n,a=this._readableState;return a.objectMode?n=!0:"string"==typeof e&&((t=t||a.defaultEncoding)!==a.encoding&&(e=u.from(e,t),t=""),n=!0),x(this,e,t,!1,n)},y.prototype.unshift=function(e){return x(this,e,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(e){return m||(m=n("../node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this._readableState.decoder=new m(e),this._readableState.encoding=e,this};var j=8388608;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=j?e=j:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function _(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(E,e):E(e))}function E(e){h("emit readable"),e.emit("readable"),M(e)}function O(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(S,e,t))}function S(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function C(e){h("readable nexttick read 0"),e.read(0)}function I(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function P(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var a;return e<t.head.data.length?(a=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):a=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,a=1,r=n.data;for(e-=r.length;n=n.next;){var o=n.data,i=e>o.length?o.length:e;if(r+=i===o.length?o:o.slice(0,e),0==(e-=i)){i===o.length?(++a,t.head=n.next?n.next:t.tail=null):(t.head=n,n.data=o.slice(i));break}++a}return t.length-=a,r}(e,t):function(e,t){var n=u.allocUnsafe(e),a=t.head,r=1;for(a.data.copy(n),e-=a.data.length;a=a.next;){var o=a.data,i=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,i),0==(e-=i)){i===o.length?(++r,t.head=a.next?a.next:t.tail=null):(t.head=a,a.data=o.slice(i));break}++r}return t.length-=r,n}(e,t),a}(e,t.buffer,t.decoder),n);var n}function D(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(k,t,e))}function k(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1}y.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?D(this):_(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&D(this),null;var a,r=t.needReadable;return h("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",r=!0),t.ended||t.reading?h("reading or ended",r=!1):r&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(a=e>0?P(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&D(this)),null!==a&&this.emit("data",a),a},y.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,h("pipe count=%d opts=%j",o.pipesCount,t);var l=t&&!1===t.end||e===a.stdout||e===a.stderr?b:u;function u(){h("onend"),e.end()}o.endEmitted?r.nextTick(l):n.once("end",l),e.on("unpipe",function t(a,r){h("onunpipe"),a===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,h("cleanup"),e.removeListener("close",p),e.removeListener("finish",v),e.removeListener("drain",d),e.removeListener("error",g),e.removeListener("unpipe",t),n.removeListener("end",u),n.removeListener("end",b),n.removeListener("data",m),c=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||d())});var d=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,M(e))}}(n);e.on("drain",d);var c=!1,f=!1;function m(t){h("ondata"),f=!1,!1!==e.write(t)||f||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==L(o.pipes,e))&&!c&&(h("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,f=!0),n.pause())}function g(t){h("onerror",t),b(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function p(){e.removeListener("finish",v),b()}function v(){h("onfinish"),e.removeListener("close",p),b()}function b(){h("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events.error?i(e._events.error)?e._events.error.unshift(n):e._events.error=[n,e._events.error]:e.on(t,n)}(e,"error",g),e.once("close",p),e.once("finish",v),e.emit("pipe",n),o.flowing||(h("pipe resume"),n.resume()),e},y.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var a=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)a[o].emit("unpipe",this,n);return this}var i=L(t.pipes,e);return-1===i||(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},y.prototype.addListener=y.prototype.on=function(e,t){var n=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var a=this._readableState;a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.emittedReadable=!1,a.reading?a.length&&_(this):r.nextTick(C,this))}return n},y.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(I,e,t))}(this,e)),this},y.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(e){var t=this,n=this._readableState,a=!1;for(var r in e.on("end",function(){if(h("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(r){h("wrapped data"),n.decoder&&(r=n.decoder.write(r)),n.objectMode&&null==r||(n.objectMode||r&&r.length)&&(t.push(r)||(a=!0,e.pause()))}),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var o=0;o<v.length;o++)e.on(v[o],this.emit.bind(this,v[o]));return this._read=function(t){h("wrapped _read",t),a&&(a=!1,e.resume())},this},y._fromList=P}).call(this,n("../node_modules/webpack/buildin/global.js"),n("../node_modules/process/browser.js"))},"../node_modules/readable-stream/lib/_stream_transform.js":function(e,t,n){"use strict";e.exports=i;var a=n("../node_modules/readable-stream/lib/_stream_duplex.js"),r=n("../node_modules/core-util-is/lib/util.js");function o(e,t){var n=this._transformState;n.transforming=!1;var a=n.writecb;if(!a)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),a(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function i(e){if(!(this instanceof i))return new i(e);a.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){l(e,t,n)}):l(this,null,null)}function l(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=n("../node_modules/inherits/inherits_browser.js"),r.inherits(i,a),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},i.prototype._write=function(e,t,n){var a=this._transformState;if(a.writecb=n,a.writechunk=e,a.writeencoding=t,!a.transforming){var r=this._readableState;(a.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},i.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},i.prototype._destroy=function(e,t){var n=this;a.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},"../node_modules/readable-stream/lib/_stream_writable.js":function(e,t,n){"use strict";(function(t,a,r){var o=n("../node_modules/process-nextick-args/index.js");function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var a=e.entry;for(e.entry=null;a;){var r=a.callback;t.pendingcb--,r(void 0),a=a.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=b;var s,l=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?a:o.nextTick;b.WritableState=v;var u=n("../node_modules/core-util-is/lib/util.js");u.inherits=n("../node_modules/inherits/inherits_browser.js");var d,c={deprecate:n("../node_modules/util-deprecate/browser.js")},f=n("../node_modules/readable-stream/lib/internal/streams/stream-browser.js"),h=n("../node_modules/safe-buffer/index.js").Buffer,m=r.Uint8Array||function(){},g=n("../node_modules/readable-stream/lib/internal/streams/destroy.js");function p(){}function v(e,t){s=s||n("../node_modules/readable-stream/lib/_stream_duplex.js");var a=t instanceof s;this.objectMode=!!(e=e||{}).objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,u=e.writableHighWaterMark;this.highWaterMark=r||0===r?r:a&&(u||0===u)?u:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===e.decodeStrings),this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,a=n.sync,r=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,a,r){--t.pendingcb,n?(o.nextTick(r,a),o.nextTick(_,e,t),e._writableState.errorEmitted=!0,e.emit("error",a)):(r(a),e._writableState.errorEmitted=!0,e.emit("error",a),_(e,t))}(e,n,a,t,r);else{var i=j(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),a?l(x,e,n,i,r):x(e,n,i,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function b(e){if(s=s||n("../node_modules/readable-stream/lib/_stream_duplex.js"),!(d.call(b,this)||this instanceof s))return new b(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),f.call(this)}function y(e,t,n,a,r,o,i){t.writelen=a,t.writecb=i,t.writing=!0,t.sync=!0,n?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function x(e,t,n,a){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,a(),_(e,t)}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var a=new Array(t.bufferedRequestCount),r=t.corkedRequestsFree;r.entry=n;for(var o=0,s=!0;n;)a[o]=n,n.isBuf||(s=!1),n=n.next,o+=1;a.allBuffers=s,y(e,t,!0,t.length,a,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk;if(y(e,t,!1,t.objectMode?1:l.length,l,n.encoding,n.callback),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function j(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),_(e,t)})}function _(e,t){var n=j(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(b,f),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===b&&e&&e._writableState instanceof v}})):d=function(e){return e instanceof this},b.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},b.prototype.write=function(e,t,n){var a,r=this._writableState,i=!1,s=!r.objectMode&&(h.isBuffer(a=e)||a instanceof m);return s&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=p),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),o.nextTick(t,n)}(this,n):(s||function(e,t,n,a){var r=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),o.nextTick(a,i),r=!1),r}(this,r,e,n))&&(r.pendingcb++,i=function(e,t,n,a,r,o){if(!n){var i=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,n)),t}(t,a,r);a!==i&&(n=!0,r="buffer",a=i)}var s=t.objectMode?1:a.length;t.length+=s;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:a,encoding:r,isBuf:n,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,s,a,r,o);return l}(this,r,s,e,t,n)),i},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},b.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},b.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},b.prototype._writev=null,b.prototype.end=function(e,t,n){var a=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),a.corked&&(a.corked=1,this.uncork()),a.ending||a.finished||function(e,t,n){t.ending=!0,_(e,t),n&&(t.finished?o.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,a,n)},Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n("../node_modules/process/browser.js"),n("../node_modules/timers-browserify/main.js").setImmediate,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/readable-stream/lib/internal/streams/BufferList.js":function(e,t,n){"use strict";var a=n("../node_modules/safe-buffer/index.js").Buffer,r=n(1);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return a.alloc(0);if(1===this.length)return this.head.data;for(var t=a.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},"../node_modules/readable-stream/lib/internal/streams/destroy.js":function(e,t,n){"use strict";var a=n("../node_modules/process-nextick-args/index.js");function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||a.nextTick(r,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(a.nextTick(r,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},"../node_modules/readable-stream/lib/internal/streams/stream-browser.js":function(e,t,n){e.exports=n("../node_modules/events/events.js").EventEmitter},"../node_modules/readable-stream/passthrough.js":function(e,t,n){e.exports=n("../node_modules/readable-stream/readable-browser.js").PassThrough},"../node_modules/readable-stream/readable-browser.js":function(e,t,n){(t=e.exports=n("../node_modules/readable-stream/lib/_stream_readable.js")).Stream=t,t.Readable=t,t.Writable=n("../node_modules/readable-stream/lib/_stream_writable.js"),t.Duplex=n("../node_modules/readable-stream/lib/_stream_duplex.js"),t.Transform=n("../node_modules/readable-stream/lib/_stream_transform.js"),t.PassThrough=n("../node_modules/readable-stream/lib/_stream_passthrough.js")},"../node_modules/readable-stream/transform.js":function(e,t,n){e.exports=n("../node_modules/readable-stream/readable-browser.js").Transform},"../node_modules/readable-stream/writable-browser.js":function(e,t,n){e.exports=n("../node_modules/readable-stream/lib/_stream_writable.js")},"../node_modules/safe-buffer/index.js":function(e,t,n){var a=n("../node_modules/buffer/index.js"),r=a.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function i(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=a:(o(a,t),t.Buffer=i),o(r,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var a=r(e);return void 0!==t?"string"==typeof n?a.fill(t,n):a.fill(t):a.fill(0),a},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a.SlowBuffer(e)}},"../node_modules/setimmediate/setImmediate.js":function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var a,r,o,i,s,l=1,u={},d=!1,c=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick(function(){m(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(i="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&m(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),a=function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){m(e.data)},a=function(e){o.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(r=c.documentElement,a=function(e){var t=c.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):a=function(e){setTimeout(m,0,e)},f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return u[l]=r,a(l),l++},f.clearImmediate=h}function h(e){delete u[e]}function m(e){if(d)setTimeout(m,0,e);else{var t=u[e];if(t){d=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),d=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("../node_modules/webpack/buildin/global.js"),n("../node_modules/process/browser.js"))},"../node_modules/stream-browserify/index.js":function(e,t,n){e.exports=r;var a=n("../node_modules/events/events.js").EventEmitter;function r(){a.call(this)}n("../node_modules/inherits/inherits_browser.js")(r,a),r.Readable=n("../node_modules/readable-stream/readable-browser.js"),r.Writable=n("../node_modules/readable-stream/writable-browser.js"),r.Duplex=n("../node_modules/readable-stream/duplex-browser.js"),r.Transform=n("../node_modules/readable-stream/transform.js"),r.PassThrough=n("../node_modules/readable-stream/passthrough.js"),r.Stream=r,r.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",l));var i=!1;function s(){i||(i=!0,e.end())}function l(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(d(),0===a.listenerCount(this,"error"))throw e}function d(){n.removeListener("data",r),e.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",d),n.removeListener("close",d),e.removeListener("close",d)}return n.on("error",u),e.on("error",u),n.on("end",d),n.on("close",d),e.on("close",d),e.emit("pipe",n),e}},"../node_modules/string_decoder/lib/string_decoder.js":function(e,t,n){"use strict";var a=n("../node_modules/safe-buffer/index.js").Buffer,r=a.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(a.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=d,this.end=c,t=3;break;default:return this.write=f,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(t)}function i(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd".repeat(n);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd".repeat(n+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd".repeat(n+2)}}(this,e,t);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var a=n.charCodeAt(n.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):t}function d(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd".repeat(this.lastTotal-this.lastNeed):t},o.prototype.text=function(e,t){var n=function(e,t,n){var a=t.length-1;if(a<n)return 0;var r=i(t[a]);return r>=0?(r>0&&(e.lastNeed=r-1),r):--a<n?0:(r=i(t[a]))>=0?(r>0&&(e.lastNeed=r-2),r):--a<n?0:(r=i(t[a]))>=0?(r>0&&(2===r?r=0:e.lastNeed=r-3),r):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var a=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,a),e.toString("utf8",t,a)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},"../node_modules/timers-browserify/main.js":function(e,t,n){(function(e){var a=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("../node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/util-deprecate/browser.js":function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(a){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var a=!1;return function(){if(!a){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),a=!0}return e.apply(this,arguments)}}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/util/node_modules/inherits/inherits_browser.js":function(e,t){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"../node_modules/util/support/isBufferBrowser.js":function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},"../node_modules/util/util.js":function(e,t,n){(function(e,a){var r=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var a=arguments,o=a.length,i=String(e).replace(r,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(a[n++]);case"%d":return Number(a[n++]);case"%j":try{return JSON.stringify(a[n++])}catch(t){return"[Circular]"}default:return e}}),l=a[n];n<o;l=a[++n])g(l)||!x(l)?i+=" "+l:i+=" "+s(l);return i},t.deprecate=function(n,r){if(b(e.process))return function(){return t.deprecate(n,r).apply(this,arguments)};if(!0===a.noDeprecation)return n;var o=!1;return function(){if(!o){if(a.throwDeprecation)throw new Error(r);a.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var o,i={};function s(e,n){var a={seen:[],stylize:u};return arguments.length>=3&&(a.depth=arguments[2]),arguments.length>=4&&(a.colors=arguments[3]),m(n)?a.showHidden=n:n&&t._extend(a,n),b(a.showHidden)&&(a.showHidden=!1),b(a.depth)&&(a.depth=2),b(a.colors)&&(a.colors=!1),b(a.customInspect)&&(a.customInspect=!0),a.colors&&(a.stylize=l),d(a,e,a.depth)}function l(e,t){var n=s.styles[t];return n?"\x1b["+s.colors[n][0]+"m"+e+"\x1b["+s.colors[n][1]+"m":e}function u(e,t){return e}function d(e,n,a){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(a,e);return v(r)||(r=d(e,r,a)),r}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return p(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,n);if(o)return o;var i=Object.keys(n),s=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(n)),j(n)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return c(n);if(0===i.length){if(T(n))return e.stylize("[Function"+(n.name?": "+n.name:"")+"]","special");if(y(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(j(n))return c(n)}var l,u="",x=!1,_=["{","}"];return h(n)&&(x=!0,_=["[","]"]),T(n)&&(u=" [Function"+(n.name?": "+n.name:"")+"]"),y(n)&&(u=" "+RegExp.prototype.toString.call(n)),w(n)&&(u=" "+Date.prototype.toUTCString.call(n)),j(n)&&(u=" "+c(n)),0!==i.length||x&&0!=n.length?a<0?y(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=x?function(e,t,n,a,r){for(var o=[],i=0,s=t.length;i<s;++i)C(t,String(i))?o.push(f(e,t,n,a,String(i),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(e,t,n,a,r,!0))}),o}(e,n,a,s,i):i.map(function(t){return f(e,n,a,s,t,x)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,u,_)):_[0]+u+_[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,a,r,o){var i,s,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?s=e.stylize(l.set?"[Getter/Setter]":"[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),C(a,r)||(i="["+r+"]"),s||(e.seen.indexOf(l.value)<0?(s=g(n)?d(e,l.value,null):d(e,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),b(i)){if(o&&r.match(/^\d+$/))return s;(i=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+s}function h(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function g(e){return null===e}function p(e){return"number"==typeof e}function v(e){return"string"==typeof e}function b(e){return void 0===e}function y(e){return x(e)&&"[object RegExp]"===_(e)}function x(e){return"object"==typeof e&&null!==e}function w(e){return x(e)&&"[object Date]"===_(e)}function j(e){return x(e)&&("[object Error]"===_(e)||e instanceof Error)}function T(e){return"function"==typeof e}function _(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(b(o)&&(o=a.env.NODE_DEBUG||""),e=e.toUpperCase(),!i[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=a.pid;i[e]=function(){var a=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,a)}}else i[e]=function(){};return i[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=m,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=p,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=y,t.isObject=x,t.isDate=w,t.isError=j,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n("../node_modules/util/support/isBufferBrowser.js");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",S(),t.format.apply(t,arguments))},t.inherits=n("../node_modules/util/node_modules/inherits/inherits_browser.js"),t._extend=function(e,t){if(!t||!x(t))return e;for(var n=Object.keys(t),a=n.length;a--;)e[n[a]]=t[n[a]];return e}}).call(this,n("../node_modules/webpack/buildin/global.js"),n("../node_modules/process/browser.js"))},"../node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(a){"object"==typeof window&&(n=window)}e.exports=n},"../node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./alloc.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t,n){if(void 0!==e&&t instanceof e)return e.alloc(n);if(t instanceof Uint8Array)return new Uint8Array(n);throw"dicomParser.alloc: unknown type for byteArray"}}).call(this,n("../node_modules/buffer/index.js").Buffer)},"./bigEndianByteArrayParser.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={readUint16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[t]<<8)+e[t+1]},readInt16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";var n=(e[t]<<8)+e[t+1];return 32768&n&&(n=n-65535-1),n},readUint32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[t]+e[t+1])+e[t+2])+e[t+3]},readInt32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]},readFloat:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[3]=e[t],n[2]=e[t+1],n[1]=e[t+2],n[0]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[7]=e[t],n[6]=e[t+1],n[5]=e[t+2],n[4]=e[t+3],n[3]=e[t+4],n[2]=e[t+5],n[1]=e[t+6],n[0]=e[t+7],new Float64Array(n.buffer)[0]}}},"./byteArrayParser.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFixedString=function(e,t,n){if(n<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(t+n>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var a,r="",o=0;o<n;o++){if(0===(a=e[t+o]))return t+=n,r;r+=String.fromCharCode(a)}return r}},"./byteStream.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=(a=n("./sharedCopy.js"))&&a.__esModule?a:{default:a},i=n("./byteArrayParser.js"),s=function(){function t(n,a,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===n)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===a)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(a instanceof Uint8Array==0&&a instanceof e==0)throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(r<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(r>=a.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=n,this.byteArray=a,this.position=r||0,this.warnings=[]}return r(t,[{key:"seek",value:function(e){if(this.position+e<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=e}},{key:"readByteStream",value:function(e){if(this.position+e>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var n=(0,o.default)(this.byteArray,this.position,e);return this.position+=e,new t(this.byteArrayParser,n)}},{key:"readUint16",value:function(){var e=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,e}},{key:"readUint32",value:function(){var e=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,e}},{key:"readFixedString",value:function(e){var t=(0,i.readFixedString)(this.byteArray,this.position,e);return this.position+=e,t}}]),t}();t.default=s}).call(this,n("../node_modules/buffer/index.js").Buffer)},"./dataSet.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("./byteArrayParser.js");function o(e,t){return void 0!==e.parser?e.parser:t}var i=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.byteArrayParser=t,this.byteArray=n,this.elements=a}return a(e,[{key:"uint16",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return o(n,this.byteArrayParser).readUint16(this.byteArray,n.dataOffset+2*t)}},{key:"int16",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return o(n,this.byteArrayParser).readInt16(this.byteArray,n.dataOffset+2*t)}},{key:"uint32",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return o(n,this.byteArrayParser).readUint32(this.byteArray,n.dataOffset+4*t)}},{key:"int32",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return o(n,this.byteArrayParser).readInt32(this.byteArray,n.dataOffset+4*t)}},{key:"float",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return o(n,this.byteArrayParser).readFloat(this.byteArray,n.dataOffset+4*t)}},{key:"double",value:function(e,t){var n=this.elements[e];if(t=void 0!==t?t:0,n&&0!==n.length)return o(n,this.byteArrayParser).readDouble(this.byteArray,n.dataOffset+8*t)}},{key:"numStringValues",value:function(e){var t=this.elements[e];if(t&&t.length>0){var n=(0,r.readFixedString)(this.byteArray,t.dataOffset,t.length).match(/\\/g);return null===n?1:n.length+1}}},{key:"string",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var a=(0,r.readFixedString)(this.byteArray,n.dataOffset,n.length);return t>=0?a.split("\\")[t].trim():a.trim()}}},{key:"text",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var a=(0,r.readFixedString)(this.byteArray,n.dataOffset,n.length);return t>=0?a.split("\\")[t].replace(/ +$/,""):a.replace(/ +$/,"")}}},{key:"floatString",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var a=this.string(e,t=void 0!==t?t:0);if(void 0!==a)return parseFloat(a)}}},{key:"intString",value:function(e,t){var n=this.elements[e];if(n&&n.length>0){var a=this.string(e,t=void 0!==t?t:0);if(void 0!==a)return parseInt(a)}}},{key:"attributeTag",value:function(e){var t=this.elements[e];if(t&&4===t.length){var n=o(t,this.byteArrayParser).readUint16,a=this.byteArray,r=t.dataOffset;return"x"+("00000000"+(256*n(a,r)*256+n(a,r+2)).toString(16)).substr(-8)}}}]),e}();t.default=i},"./findAndSetUNElementLength.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57565===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position "+(e.position-4)+" while reading element of undefined length with tag "+t.tag),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}},"./findEndOfEncapsulatedPixelData.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(t.encapsulatedPixelData=!0,t.basicOffsetTable=[],t.fragments=[],"xfffee000"!==(0,r.default)(e))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var a=e.readUint32()/4,o=0;o<a;o++){var i=e.readUint32();t.basicOffsetTable.push(i)}for(var s=e.position;e.position<e.byteArray.length;){var l=(0,r.default)(e),u=e.readUint32();if("xfffee0dd"===l)return e.seek(u),void(t.length=e.position-t.dataOffset);if("xfffee000"!==l)return n&&n.push("unexpected tag "+l+" while searching for end of pixel data element with undefined length"),u>e.byteArray.length-e.position&&(u=e.byteArray.length-e.position),t.fragments.push({offset:e.position-s-8,position:e.position,length:u}),e.seek(u),void(t.length=e.position-t.dataOffset);t.fragments.push({offset:e.position-s-8,position:e.position,length:u}),e.seek(u)}n&&n.push("pixel data element "+t.tag+" missing sequence delimiter tag xfffee0dd")};var a,r=(a=n("./readTag.js"))&&a.__esModule?a:{default:a}},"./findItemDelimitationItem.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57357===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position "+(e.position-4)+" while reading element of undefined length with tag "+t.tag),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}},"./index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readTag=t.readSequenceItem=t.readSequenceItemsImplicit=t.readSequenceItemsExplicit=t.readPart10Header=t.readEncapsulatedPixelDataFromFragments=t.readEncapsulatedPixelData=t.readEncapsulatedImageFrame=t.readDicomElementImplicit=t.readDicomElementExplicit=t.parseDicom=t.littleEndianByteArrayParser=t.findItemDelimitationItemAndSetElementLength=t.findEndOfEncapsulatedElement=t.findAndSetUNElementLength=t.DataSet=t.sharedCopy=t.ByteStream=t.bigEndianByteArrayParser=t.version=t.alloc=t.readFixedString=t.parseDicomDataSetImplicit=t.parseDicomDataSetExplicit=t.createJPEGBasicOffsetTable=t.explicitDataSetToJS=t.explicitElementToString=t.parseDA=t.parseTM=t.parsePN=t.isPrivateTag=t.isStringVr=void 0;var a=n("./util/index.js"),r=n("./parseDicomDataSet.js"),o=n("./byteArrayParser.js"),i=S(n("./alloc.js")),s=S(n("./version.js")),l=S(n("./bigEndianByteArrayParser.js")),u=S(n("./byteStream.js")),d=S(n("./sharedCopy.js")),c=S(n("./dataSet.js")),f=S(n("./findAndSetUNElementLength.js")),h=S(n("./findEndOfEncapsulatedPixelData.js")),m=S(n("./findItemDelimitationItem.js")),g=S(n("./littleEndianByteArrayParser.js")),p=S(n("./parseDicom.js")),v=S(n("./readDicomElementExplicit.js")),b=S(n("./readDicomElementImplicit.js")),y=S(n("./readEncapsulatedImageFrame.js")),x=S(n("./readEncapsulatedPixelData.js")),w=S(n("./readEncapsulatedPixelDataFromFragments.js")),j=S(n("./readPart10Header.js")),T=S(n("./readSequenceElementExplicit.js")),_=S(n("./readSequenceElementImplicit.js")),E=S(n("./readSequenceItem.js")),O=S(n("./readTag.js"));function S(e){return e&&e.__esModule?e:{default:e}}var C={isStringVr:a.isStringVr,isPrivateTag:a.isPrivateTag,parsePN:a.parsePN,parseTM:a.parseTM,parseDA:a.parseDA,explicitElementToString:a.explicitElementToString,explicitDataSetToJS:a.explicitDataSetToJS,createJPEGBasicOffsetTable:a.createJPEGBasicOffsetTable,parseDicomDataSetExplicit:r.parseDicomDataSetExplicit,parseDicomDataSetImplicit:r.parseDicomDataSetImplicit,readFixedString:o.readFixedString,alloc:i.default,version:s.default,bigEndianByteArrayParser:l.default,ByteStream:u.default,sharedCopy:d.default,DataSet:c.default,findAndSetUNElementLength:f.default,findEndOfEncapsulatedElement:h.default,findItemDelimitationItemAndSetElementLength:m.default,littleEndianByteArrayParser:g.default,parseDicom:p.default,readDicomElementExplicit:v.default,readDicomElementImplicit:b.default,readEncapsulatedImageFrame:y.default,readEncapsulatedPixelData:x.default,readEncapsulatedPixelDataFromFragments:w.default,readPart10Header:j.default,readSequenceItemsExplicit:T.default,readSequenceItemsImplicit:_.default,readSequenceItem:E.default,readTag:O.default};t.isStringVr=a.isStringVr,t.isPrivateTag=a.isPrivateTag,t.parsePN=a.parsePN,t.parseTM=a.parseTM,t.parseDA=a.parseDA,t.explicitElementToString=a.explicitElementToString,t.explicitDataSetToJS=a.explicitDataSetToJS,t.createJPEGBasicOffsetTable=a.createJPEGBasicOffsetTable,t.parseDicomDataSetExplicit=r.parseDicomDataSetExplicit,t.parseDicomDataSetImplicit=r.parseDicomDataSetImplicit,t.readFixedString=o.readFixedString,t.alloc=i.default,t.version=s.default,t.bigEndianByteArrayParser=l.default,t.ByteStream=u.default,t.sharedCopy=d.default,t.DataSet=c.default,t.findAndSetUNElementLength=f.default,t.findEndOfEncapsulatedElement=h.default,t.findItemDelimitationItemAndSetElementLength=m.default,t.littleEndianByteArrayParser=g.default,t.parseDicom=p.default,t.readDicomElementExplicit=v.default,t.readDicomElementImplicit=b.default,t.readEncapsulatedImageFrame=y.default,t.readEncapsulatedPixelData=x.default,t.readEncapsulatedPixelDataFromFragments=w.default,t.readPart10Header=j.default,t.readSequenceItemsExplicit=T.default,t.readSequenceItemsImplicit=_.default,t.readSequenceItem=E.default,t.readTag=O.default,t.default=C},"./littleEndianByteArrayParser.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={readUint16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[t]+256*e[t+1]},readInt16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";var n=e[t]+(e[t+1]<<8);return 32768&n&&(n=n-65535-1),n},readUint32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[t]+256*e[t+1]+256*e[t+2]*256+256*e[t+3]*256*256},readInt32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},readFloat:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],n[4]=e[t+4],n[5]=e[t+5],n[6]=e[t+6],n[7]=e[t+7],new Float64Array(n.buffer)[0]}}},"./parseDicom.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t,f){if(void 0===t)throw"dicomParser.parseDicom: missing required parameter 'byteArray'";return function(e,t){for(var n in e.elements)e.elements.hasOwnProperty(n)&&(t.elements[n]=e.elements[n]);return void 0!==e.warnings&&(t.warnings=e.warnings.concat(t.warnings)),t}(h=(0,l.default)(t,f),function(l){var h=function(e){if(void 0===e.elements.x00020010)throw"dicomParser.parseDicom: missing required meta header attribute 0002,0010";var n=e.elements.x00020010;return d.readFixedString(t,n.dataOffset,n.length)}(l),m=function(e){return"1.2.840.10008.1.2"!==e}(h),g=function(i,l){if("1.2.840.10008.1.2.1.99"===i){if(f&&f.inflater){var d=f.inflater(t,l);return new o.default(s.default,d,0)}if(void 0!==e&&this.module!==e){var c=n("../node_modules/browserify-zlib/lib/index.js"),h=(0,u.default)(t,l,t.length-l),m=c.inflateRawSync(h),g=(0,a.default)(t,m.length+l);return t.copy(g,0,0,l),m.copy(g,l),new o.default(s.default,g,0)}if("undefined"!=typeof pako){var p=t.slice(l),v=pako.inflateRaw(p),b=(0,a.default)(t,v.length+l);return b.set(t.slice(0,l),0),b.set(v,l),new o.default(s.default,b,0)}throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax"}return new o.default("1.2.840.10008.1.2.2"===i?r.default:s.default,t,l)}(h,l.position),p=new i.default(g.byteArrayParser,g.byteArray,{});p.warnings=g.warnings;try{m?c.parseDicomDataSetExplicit(p,g,g.byteArray.length,f):c.parseDicomDataSetImplicit(p,g,g.byteArray.length,f)}catch(v){throw{exception:v,dataSet:p}}return p}(h));var h};var a=h(n("./alloc.js")),r=h(n("./bigEndianByteArrayParser.js")),o=h(n("./byteStream.js")),i=h(n("./dataSet.js")),s=h(n("./littleEndianByteArrayParser.js")),l=h(n("./readPart10Header.js")),u=h(n("./sharedCopy.js")),d=f(n("./byteArrayParser.js")),c=f(n("./parseDicomDataSet.js"));function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}}).call(this,n("../node_modules/webpack/buildin/module.js")(e))},"./parseDicomDataSet.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDicomDataSetExplicit=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(void 0===t)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if((n=void 0===n?t.byteArray.length:n)<t.position||n>t.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var o=e.elements;t.position<n;){var i=(0,a.default)(t,e.warnings,r.untilTag);if(o[i.tag]=i,i.tag===r.untilTag)return}if(t.position>n)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"},t.parseDicomDataSetImplicit=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(void 0===t)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if((n=void 0===n?e.byteArray.length:n)<t.position||n>t.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var o=e.elements;t.position<n;){var i=(0,r.default)(t,a.untilTag,a.vrCallback);if(o[i.tag]=i,i.tag===a.untilTag)return}};var a=o(n("./readDicomElementExplicit.js")),r=o(n("./readDicomElementImplicit.js"));function o(e){return e&&e.__esModule?e:{default:e}}},"./readDicomElementExplicit.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var l,u={tag:(0,o.default)(e),vr:e.readFixedString(2)};return 2==("OB"===(l=u.vr)||"OW"===l||"SQ"===l||"OF"===l||"UT"===l||"UN"===l?4:2)?(u.length=e.readUint16(),u.dataOffset=e.position):(e.seek(2),u.length=e.readUint32(),u.dataOffset=e.position),4294967295===u.length&&(u.hadUndefinedLength=!0),u.tag===n?u:"SQ"===u.vr?((0,s.default)(e,u,t),u):4294967295===u.length?"x7fe00010"===u.tag?((0,a.default)(e,u,t),u):"UN"===u.vr?((0,r.default)(e,u),u):((0,i.default)(e,u),u):(e.seek(u.length),u)};var a=l(n("./findEndOfEncapsulatedPixelData.js")),r=(l(n("./findAndSetUNElementLength.js")),l(n("./readSequenceElementImplicit.js"))),o=l(n("./readTag.js")),i=l(n("./findItemDelimitationItem.js")),s=l(n("./readSequenceElementExplicit.js"));function l(e){return e&&e.__esModule?e:{default:e}}},"./readDicomElementImplicit.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var s={tag:(0,o.default)(e),length:e.readUint32(),dataOffset:e.position};return 4294967295===s.length&&(s.hadUndefinedLength=!0),s.tag===t?s:function(e,t,n){if(void 0!==n)return"SQ"===n(e.tag);if(t.position+4<=t.byteArray.length){var a=(0,o.default)(t);return t.seek(-4),"xfffee000"===a||"xfffee0dd"===a}return t.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1}(s,e,n)&&!(0,i.isPrivateTag)(s.tag)?((0,r.default)(e,s),s):s.hadUndefinedLength?((0,a.default)(e,s),s):(e.seek(s.length),s)};var a=s(n("./findItemDelimitationItem.js")),r=s(n("./readSequenceElementImplicit.js")),o=s(n("./readTag.js")),i=n("./util/util.js");function s(e){return e&&e.__esModule?e:{default:e}}},"./readEncapsulatedImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a,o){if(void 0===e)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===n)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===(a=a||t.basicOffsetTable))throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===a.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(n<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(n>=a.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var i=function(e,t){for(var n=0;n<e.length;n++)if(e[n].offset===t)return n}(o=o||t.fragments,a[n]);if(void 0===i)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";var s=function(e,t,n,a){if(e===t.length-1)return n.length-a;for(var r=t[e+1],o=a+1;o<n.length;o++)if(n[o].offset===r)return o-a;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"}(n,a,o,i);return(0,r.default)(e,t,i,s,o)};var a,r=(a=n("./readEncapsulatedPixelDataFromFragments.js"))&&a.__esModule?a:{default:a}},"./readEncapsulatedPixelData.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(i||(i=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===e)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===n)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(n<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==t.basicOffsetTable.length?(0,a.default)(e,t,n):(0,r.default)(e,t,0,t.fragments.length)};var a=o(n("./readEncapsulatedImageFrame.js")),r=o(n("./readEncapsulatedPixelDataFromFragments.js"));function o(e){return e&&e.__esModule?e:{default:e}}var i=!1},"./readEncapsulatedPixelDataFromFragments.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s,l){if(l=l||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===n)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===(s=s||1))throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(n>=t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(s<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(n+s>t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var u=new r.default(e.byteArrayParser,e.byteArray,t.dataOffset),d=(0,o.default)(u);if("xfffee000"!==d.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";u.seek(d.length);var c=u.position;if(1===s)return(0,i.default)(u.byteArray,c+l[n].offset+8,l[n].length);for(var f=function(e,t,n){for(var a=0,r=t;r<t+n;r++)a+=e[r].length;return a}(l,n,s),h=(0,a.default)(u.byteArray,f),m=0,g=n;g<n+s;g++)for(var p=c+l[g].offset+8,v=0;v<l[g].length;v++)h[m++]=u.byteArray[p++];return h};var a=s(n("./alloc.js")),r=s(n("./byteStream.js")),o=s(n("./readSequenceItem.js")),i=s(n("./sharedCopy.js"));function s(e){return e&&e.__esModule?e:{default:e}}},"./readPart10Header.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var n=new a.default(o.default,e);return function(){!function(){if(n.seek(128),"DICM"!==n.readFixedString(4))throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file."}();for(var e=[],t={};n.position<n.byteArray.length;){var a=n.position,s=(0,i.default)(n,e);if(s.tag>"x0002ffff"){n.position=a;break}s.parser=o.default,t[s.tag]=s}var l=new r.default(n.byteArrayParser,n.byteArray,t);return l.warnings=n.warnings,l.position=n.position,l}()};var a=s(n("./byteStream.js")),r=s(n("./dataSet.js")),o=s(n("./littleEndianByteArrayParser.js")),i=s(n("./readDicomElementExplicit.js"));function s(e){return e&&e.__esModule?e:{default:e}}},"./readSequenceElementExplicit.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";t.items=[],4294967295===t.length?function(e,t,n){for(;e.position+4<=e.byteArray.length;){var a=(0,i.default)(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8),t;var r=u(e,n);t.items.push(r)}n.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),t.length=e.position-t.dataOffset}(e,t,n):function(e,t,n){for(var a=t.dataOffset+t.length;e.position<a;){var r=u(e,n);t.items.push(r)}}(e,t,n)};var a=l(n("./dataSet.js")),r=l(n("./readDicomElementExplicit.js")),o=l(n("./readSequenceItem.js")),i=l(n("./readTag.js")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n("./parseDicomDataSet.js"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=(0,o.default)(e);return 4294967295===n.length?(n.hadUndefinedLength=!0,n.dataSet=function(e,t){for(var n={};e.position<e.byteArray.length;){var o=(0,r.default)(e,t);if(n[o.tag]=o,"xfffee00d"===o.tag)return new a.default(e.byteArrayParser,e.byteArray,n)}return t.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new a.default(e.byteArrayParser,e.byteArray,n)}(e,t),n.length=e.position-n.dataOffset):(n.dataSet=new a.default(e.byteArrayParser,e.byteArray,{}),s.parseDicomDataSetExplicit(n.dataSet,e,e.position+n.length)),n}},"./readSequenceElementImplicit.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";t.items=[],4294967295===t.length?function(e,t,n){for(;e.position+4<=e.byteArray.length;){var a=(0,i.default)(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8),t;var r=u(e,n);t.items.push(r)}e.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),t.length=e.byteArray.length-t.dataOffset}(e,t,n):function(e,t,n){for(var a=t.dataOffset+t.length;e.position<a;){var r=u(e,n);t.items.push(r)}}(e,t,n)};var a=l(n("./dataSet.js")),r=l(n("./readDicomElementImplicit.js")),o=l(n("./readSequenceItem.js")),i=l(n("./readTag.js")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n("./parseDicomDataSet.js"));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=(0,o.default)(e);return 4294967295===n.length?(n.hadUndefinedLength=!0,n.dataSet=function(e,t){for(var n={};e.position<e.byteArray.length;){var o=(0,r.default)(e,void 0,t);if(n[o.tag]=o,"xfffee00d"===o.tag)return new a.default(e.byteArrayParser,e.byteArray,n)}return e.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new a.default(e.byteArrayParser,e.byteArray,n)}(e,t),n.length=e.position-n.dataOffset):(n.dataSet=new a.default(e.byteArrayParser,e.byteArray,{}),s.parseDicomDataSetImplicit(n.dataSet,e,e.position+n.length,{vrCallback:t})),n}},"./readSequenceItem.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(void 0===e)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var t={tag:(0,r.default)(e),length:e.readUint32(),dataOffset:e.position};if("xfffee000"!==t.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset "+e.position;return t};var a,r=(a=n("./readTag.js"))&&a.__esModule?a:{default:a}},"./readTag.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(void 0===e)throw"dicomParser.readTag: missing required parameter 'byteStream'";return"x"+("00000000"+(256*e.readUint16()*256+e.readUint16()).toString(16)).substr(-8)}},"./sharedCopy.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t,n,a){if(void 0!==e&&t instanceof e)return t.slice(n,n+a);if(t instanceof Uint8Array)return new Uint8Array(t.buffer,t.byteOffset+n,a);throw"dicomParser.from: unknown type for byteArray"}}).call(this,n("../node_modules/buffer/index.js").Buffer)},"./util/createJPEGBasicOffsetTable.js":function(e,t,n){"use strict";function a(e,t){return 255===e.byteArray[t]&&217===e.byteArray[t+1]}function r(e,t,n){var r=t.fragments[n];return!(!a(e,r.position+r.length-2)&&!a(e,r.position+r.length-3))}function o(e,t,n){for(var a=n;a<t.fragments.length;a++)if(r(e,t,a))return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==t.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==t.encapsulatedPixelData)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n&&n.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";n=n||t.fragments;for(var a=[],r=0;;){a.push(t.fragments[r].offset);var i=o(e,t,r);if(void 0===i||i===t.fragments.length-1)return a;r=i+1}}},"./util/dataSetToJS.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){if(void 0===t)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";n=n||{omitPrivateAttibutes:!0,maxElementLength:128};var a={};for(var i in t.elements){var s=t.elements[i];if(!0!==n.omitPrivateAttibutes||!o.isPrivateTag(i))if(s.items){for(var l=[],u=0;u<s.items.length;u++)l.push(e(s.items[u].dataSet,n));a[i]=l}else{var d;d=void 0,s.length<n.maxElementLength&&(d=(0,r.default)(t,s)),a[i]=void 0!==d?d:{dataOffset:s.dataOffset,length:s.length}}}return a};var a,r=(a=n("./util/elementToString.js"))&&a.__esModule?a:{default:a},o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n("./util/util.js"))},"./util/elementToString.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e||void 0===t)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===t.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var n,r=t.vr,o=t.tag;function i(t,n){for(var a="",r=0;r<t;r++)0!==r&&(a+="/"),a+=n.call(e,o,r).toString();return a}if(!0===a.isStringVr(r))n=e.string(o);else{if("AT"===r){var s=e.uint32(o);if(void 0===s)return;return s<0&&(s=4294967295+s+1),"x"+s.toString(16).toUpperCase()}"US"===r?n=i(t.length/2,e.uint16):"SS"===r?n=i(t.length/2,e.int16):"UL"===r?n=i(t.length/4,e.uint32):"SL"===r?n=i(t.length/4,e.int32):"FD"===r?n=i(t.length/8,e.double):"FL"===r&&(n=i(t.length/4,e.float))}return n};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n("./util/util.js"))},"./util/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createJPEGBasicOffsetTable=t.explicitDataSetToJS=t.explicitElementToString=t.parseDA=t.parseTM=t.parsePN=t.isPrivateTag=t.isStringVr=void 0;var a=n("./util/util.js"),r=u(n("./util/parseTM.js")),o=u(n("./util/parseDA.js")),i=u(n("./util/elementToString.js")),s=u(n("./util/dataSetToJS.js")),l=u(n("./util/createJPEGBasicOffsetTable.js"));function u(e){return e&&e.__esModule?e:{default:e}}t.isStringVr=a.isStringVr,t.isPrivateTag=a.isPrivateTag,t.parsePN=a.parsePN,t.parseTM=r.default,t.parseDA=o.default,t.explicitElementToString=i.default,t.explicitDataSetToJS=s.default,t.createJPEGBasicOffsetTable=l.default},"./util/parseDA.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&8===e.length){var n=parseInt(e.substring(0,4),10),a=parseInt(e.substring(4,6),10),r=parseInt(e.substring(6,8),10);if(t&&1!=(o=r,i=a,s=n,!isNaN(s)&&i>0&&i<=12&&o>0&&o<=function(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(i,s)))throw"invalid DA '"+e+"'";return{year:n,month:a,day:r}}var o,i,s;if(t)throw"invalid DA '"+e+"'"}},"./util/parseTM.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e.length>=2){var n=parseInt(e.substring(0,2),10),a=e.length>=4?parseInt(e.substring(2,4),10):void 0,r=e.length>=6?parseInt(e.substring(4,6),10):void 0,o=e.length>=8?e.substring(7,13):void 0,i=o?parseInt(o,10)*Math.pow(10,6-o.length):void 0;if(t&&(isNaN(n)||void 0!==a&&isNaN(a)||void 0!==r&&isNaN(r)||void 0!==i&&isNaN(i)||n<0||n>23||a&&(a<0||a>59)||r&&(r<0||r>59)||i&&(i<0||i>999999)))throw"invalid TM '"+e+"'";return{hours:n,minutes:a,seconds:r,fractionalSeconds:i}}if(t)throw"invalid TM '"+e+"'"}},"./util/util.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0};t.isStringVr=function(e){return a[e]},t.isPrivateTag=function(e){return parseInt(e[4],10)%2==1},t.parsePN=function(e){if(void 0!==e){var t=e.split("^");return{familyName:t[0],givenName:t[1],middleName:t[2],prefix:t[3],suffix:t[4]}}}},"./version.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="1.8.5"},0:function(e,t){},1:function(e,t){}})}),function(e,t,n,a){"use strict";var r,o=["","webkit","Moz","MS","ms","o"],i=t.createElement("div"),s=Math.round,l=Math.abs,u=Date.now;function d(e,t,n){return setTimeout(v(e,n),t)}function c(e,t,n){return!!Array.isArray(e)&&(f(e,n[t],n),!0)}function f(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==a)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function h(t,n,a){var r="DEPRECATED METHOD: "+n+"\n"+a+" AT \n";return function(){var n=new Error("get-stack-trace"),a=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=e.console&&(e.console.warn||e.console.log);return o&&o.call(e.console,r,a),t.apply(this,arguments)}}r="function"!=typeof Object.assign?function(e){if(e===a||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}:Object.assign;var m=h(function(e,t,n){for(var r=Object.keys(t),o=0;o<r.length;)(!n||n&&e[r[o]]===a)&&(e[r[o]]=t[r[o]]),o++;return e},"extend","Use `assign`."),g=h(function(e,t){return m(e,t,!0)},"merge","Use `assign`.");function p(e,t,n){var a,o=t.prototype;(a=e.prototype=Object.create(o)).constructor=e,a._super=o,n&&r(a,n)}function v(e,t){return function(){return e.apply(t,arguments)}}function b(e,t){return"function"==typeof e?e.apply(t&&t[0]||a,t):e}function y(e,t){return e===a?t:e}function x(e,t,n){f(_(t),function(t){e.addEventListener(t,n,!1)})}function w(e,t,n){f(_(t),function(t){e.removeEventListener(t,n,!1)})}function j(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function _(e){return e.trim().split(/\s+/g)}function E(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var a=0;a<e.length;){if(n&&e[a][n]==t||!n&&e[a]===t)return a;a++}return-1}function O(e){return Array.prototype.slice.call(e,0)}function S(e,t,n){for(var a=[],r=[],o=0;o<e.length;){var i=t?e[o][t]:e[o];E(r,i)<0&&a.push(e[o]),r[o]=i,o++}return n&&(a=t?a.sort(function(e,n){return e[t]>n[t]}):a.sort()),a}function C(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),s=0;s<o.length;){if((r=(n=o[s])?n+i:t)in e)return r;s++}return a}var I=1;function M(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}var P="ontouchstart"in e,D=C(e,"PointerEvent")!==a,k=P&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),L="touch",A="mouse",R=["x","y"],B=["clientX","clientY"];function F(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){b(e.options.enable,[e])&&n.handler(t)},this.init()}function U(e,t,n){var r=n.pointers.length,o=n.changedPointers.length,i=1&t&&r-o==0,s=12&t&&r-o==0;n.isFirst=!!i,n.isFinal=!!s,i&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,o=r.length;n.firstInput||(n.firstInput=H(t)),o>1&&!n.firstMultiple?n.firstMultiple=H(t):1===o&&(n.firstMultiple=!1);var i=n.firstInput,s=n.firstMultiple,d=s?s.center:i.center,c=t.center=N(r);t.timeStamp=u(),t.deltaTime=t.timeStamp-i.timeStamp,t.angle=W(d,c),t.distance=q(d,c),function(e,t){var n=t.center,a=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},a=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=r.x+(n.x-a.x),t.deltaY=r.y+(n.y-a.y)}(n,t),t.offsetDirection=V(t.deltaX,t.deltaY);var f,h,m=z(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=m.x,t.overallVelocityY=m.y,t.overallVelocity=l(m.x)>l(m.y)?m.x:m.y,t.scale=s?(f=s.pointers,q((h=r)[0],h[1],B)/q(f[0],f[1],B)):1,t.rotation=s?function(e,t){return W(t[1],t[0],B)+W(e[1],e[0],B)}(s.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,o,i,s=e.lastInterval||t,u=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(u>25||s.velocity===a)){var d=t.deltaX-s.deltaX,c=t.deltaY-s.deltaY,f=z(u,d,c);r=f.x,o=f.y,n=l(f.x)>l(f.y)?f.x:f.y,i=V(d,c),e.lastInterval=t}else n=s.velocity,r=s.velocityX,o=s.velocityY,i=s.direction;t.velocity=n,t.velocityX=r,t.velocityY=o,t.direction=i}(n,t);var g=e.element;j(t.srcEvent.target,g)&&(g=t.srcEvent.target),t.target=g}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function H(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:s(e.pointers[n].clientX),clientY:s(e.pointers[n].clientY)},n++;return{timeStamp:u(),pointers:t,center:N(t),deltaX:e.deltaX,deltaY:e.deltaY}}function N(e){var t=e.length;if(1===t)return{x:s(e[0].clientX),y:s(e[0].clientY)};for(var n=0,a=0,r=0;r<t;)n+=e[r].clientX,a+=e[r].clientY,r++;return{x:s(n/t),y:s(a/t)}}function z(e,t,n){return{x:t/e||0,y:n/e||0}}function V(e,t){return e===t?1:l(e)>=l(t)?e<0?2:4:t<0?8:16}function q(e,t,n){n||(n=R);var a=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(a*a+r*r)}function W(e,t,n){return n||(n=R),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}F.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(M(this.element),this.evWin,this.domHandler)}};var G={mousedown:1,mousemove:2,mouseup:4},Z="mousedown",Y="mousemove mouseup";function X(){this.evEl=Z,this.evWin=Y,this.pressed=!1,F.apply(this,arguments)}p(X,F,{handler:function(e){var t=G[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:A,srcEvent:e}))}});var J={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},K={2:L,3:"pen",4:A,5:"kinect"},$="pointerdown",Q="pointermove pointerup pointercancel";function ee(){this.evEl=$,this.evWin=Q,F.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}e.MSPointerEvent&&!e.PointerEvent&&($="MSPointerDown",Q="MSPointerMove MSPointerUp MSPointerCancel"),p(ee,F,{handler:function(e){var t=this.store,n=!1,a=e.type.toLowerCase().replace("ms",""),r=J[a],o=K[e.pointerType]||e.pointerType,i=o==L,s=E(t,e.pointerId,"pointerId");1&r&&(0===e.button||i)?s<0&&(t.push(e),s=t.length-1):12&r&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ne="touchstart",ae="touchstart touchmove touchend touchcancel";function re(){this.evTarget=ne,this.evWin=ae,this.started=!1,F.apply(this,arguments)}function oe(e,t){var n=O(e.touches),a=O(e.changedTouches);return 12&t&&(n=S(n.concat(a),"identifier",!0)),[n,a]}p(re,F,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var n=oe.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:L,srcEvent:e})}}});var ie={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.targetIds={},F.apply(this,arguments)}function ue(e,t){var n=O(e.touches),a=this.targetIds;if(3&t&&1===n.length)return a[n[0].identifier]=!0,[n,n];var r,o,i=O(e.changedTouches),s=[],l=this.target;if(o=n.filter(function(e){return j(e.target,l)}),1===t)for(r=0;r<o.length;)a[o[r].identifier]=!0,r++;for(r=0;r<i.length;)a[i[r].identifier]&&s.push(i[r]),12&t&&delete a[i[r].identifier],r++;return s.length?[S(o.concat(s),"identifier",!0),s]:void 0}function de(){F.apply(this,arguments);var e=v(this.handler,this);this.touch=new le(this.manager,e),this.mouse=new X(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ce(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,fe.call(this,t)):12&e&&fe.call(this,t)}function fe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var a=this.lastTouches;setTimeout(function(){var e=a.indexOf(n);e>-1&&a.splice(e,1)},2500)}}function he(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var r=this.lastTouches[a],o=Math.abs(t-r.x),i=Math.abs(n-r.y);if(o<=25&&i<=25)return!0}return!1}p(le,F,{handler:function(e){var t=ie[e.type],n=ue.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:L,srcEvent:e})}}),p(de,F,{handler:function(e,t,n){var a=n.pointerType==A;if(!(a&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(n.pointerType==L)ce.call(this,t,n);else if(a&&he.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var me=C(i.style,"touchAction"),ge=me!==a,pe="compute",ve="auto",be="manipulation",ye="none",xe="pan-x",we="pan-y",je=function(){if(!ge)return!1;var t={},n=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(a){t[a]=!n||e.CSS.supports("touch-action",a)}),t}();function Te(e,t){this.manager=e,this.set(t)}Te.prototype={set:function(e){e==pe&&(e=this.compute()),ge&&this.manager.element.style&&je[e]&&(this.manager.element.style[me]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return f(this.manager.recognizers,function(t){b(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(T(e,ye))return ye;var t=T(e,xe),n=T(e,we);return t&&n?ye:t||n?t?xe:we:T(e,be)?be:ve}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var a=this.actions,r=T(a,ye)&&!je.none,o=T(a,we)&&!je["pan-y"],i=T(a,xe)&&!je["pan-x"];if(r&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!i||!o)return r||o&&6&n||i&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var _e=32;function Ee(e){this.options=r({},this.defaults,e||{}),this.id=I++,this.manager=null,this.options.enable=y(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Oe(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Se(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ce(e,t){var n=t.manager;return n?n.get(e):e}function Ie(){Ee.apply(this,arguments)}function Me(){Ie.apply(this,arguments),this.pX=null,this.pY=null}function Pe(){Ie.apply(this,arguments)}function De(){Ee.apply(this,arguments),this._timer=null,this._input=null}function ke(){Ie.apply(this,arguments)}function Le(){Ie.apply(this,arguments)}function Ae(){Ee.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Re(e,t){return(t=t||{}).recognizers=y(t.recognizers,Re.defaults.preset),new Be(e,t)}function Be(e,t){this.options=r({},Re.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(D?ee:k?le:P?de:X))(this,U),this.touchAction=new Te(this,this.options.touchAction),Fe(this,!0),f(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Fe(e,t){var n,a=e.element;a.style&&(f(e.options.cssProps,function(r,o){n=C(a.style,o),t?(e.oldCssProps[n]=a.style[n],a.style[n]=r):a.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Ee.prototype={defaults:{},set:function(e){return r(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(c(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ce(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return c(e,"dropRecognizeWith",this)||(e=Ce(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(c(e,"requireFailure",this))return this;var t=this.requireFail;return-1===E(t,e=Ce(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(c(e,"dropRequireFailure",this))return this;e=Ce(e,this);var t=E(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function a(n){t.manager.emit(n,e)}n<8&&a(t.options.event+Oe(n)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),n>=8&&a(t.options.event+Oe(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=_e},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=r({},e);if(!b(this.options.enable,[this,t]))return this.reset(),void(this.state=_e);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},p(Ie,Ee,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,a=6&t,r=this.attrTest(e);return a&&(8&n||!r)?16|t:a||r?4&n?8|t:2&t?4|t:2:_e}}),p(Me,Ie,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(we),24&e&&t.push(xe),t},directionTest:function(e){var t=this.options,n=!0,a=e.distance,r=e.direction,o=e.deltaX,i=e.deltaY;return r&t.direction||(6&t.direction?(r=0===o?1:o<0?2:4,n=o!=this.pX,a=Math.abs(e.deltaX)):(r=0===i?1:i<0?8:16,n=i!=this.pY,a=Math.abs(e.deltaY))),e.direction=r,n&&a>t.threshold&&r&t.direction},attrTest:function(e){return Ie.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Se(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),p(Pe,Ie,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ye]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),p(De,Ee,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ve]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!a||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=d(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return _e},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}}),p(ke,Ie,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ye]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),p(Le,Ie,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Me.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&l(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Se(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),p(Ae,Ee,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[be]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(a&&r&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,i=!this.pCenter||q(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,i&&o?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return _e},failTimeout:function(){return this._timer=d(function(){this.state=_e},this.options.interval,this),_e},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Re.VERSION="2.0.7",Re.defaults={domEvents:!1,touchAction:pe,enable:!0,inputTarget:null,inputClass:null,preset:[[ke,{enable:!1}],[Pe,{enable:!1},["rotate"]],[Le,{direction:6}],[Me,{direction:6},["swipe"]],[Ae],[Ae,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Be.prototype={set:function(e){return r(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var a=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var o=0;o<a.length;)n=a[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Ee)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(c(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(c(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=E(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==a&&t!==a){var n=this.handlers;return f(_(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==a){var n=this.handlers;return f(_(e),function(e){t?n[e]&&n[e].splice(E(n[e],t),1):delete n[e]}),this}},emit:function(e,n){this.options.domEvents&&function(e,n){var a=t.createEvent("Event");a.initEvent(e,!0,!0),a.gesture=n,n.target.dispatchEvent(a)}(e,n);var a=this.handlers[e]&&this.handlers[e].slice();if(a&&a.length){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var r=0;r<a.length;)a[r](n),r++}},destroy:function(){this.element&&Fe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},r(Re,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:_e,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Be,Input:F,TouchAction:Te,TouchInput:le,MouseInput:X,PointerEventInput:ee,TouchMouseInput:de,SingleTouchInput:re,Recognizer:Ee,AttrRecognizer:Ie,Tap:Ae,Pan:Me,Swipe:Le,Pinch:Pe,Rotate:ke,Press:De,on:x,off:w,each:f,merge:g,extend:m,assign:r,inherit:p,bindFn:v,prefixed:C}),(void 0!==e?e:"undefined"!=typeof self?self:{}).Hammer=Re,"function"==typeof define&&define.amd?define(function(){return Re}):"undefined"!=typeof module&&module.exports?module.exports=Re:e.Hammer=Re}(window,document),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneWADOImageLoader",[],t):"object"==typeof exports?exports.cornerstoneWADOImageLoader=t():e.cornerstoneWADOImageLoader=t()}(this,function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./imageLoader/index.js")}({"./externalModules.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/registerLoaders.js"))&&a.__esModule?a:{default:a},o=void 0,i=void 0;t.default={set cornerstone(e){(0,r.default)(o=e)},get cornerstone(){if(!o){if(!window||!window.cornerstone)throw new Error("cornerstoneWADOImageLoader requires a copy of Cornerstone to work properly. Please add cornerstoneWADOImageLoader.external.cornerstone = cornerstone; to your application.");o=window.cornerstone,(0,r.default)(o)}return o},set dicomParser(e){i=e},get dicomParser(){if(!i){if(!window||!window.dicomParser)throw new Error("cornerstoneWADOImageLoader requires a copy of dicomParser to work properly. Please add cornerstoneWADOImageLoader.external.dicomParser = dicomParser; to your application.");i=window.dicomParser}return i}}},"./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js":function(e,t,n){"use strict";function a(e,t){for(var n=e.length,a=new Uint8ClampedArray(n),r=0;r<n;++r)a[r]=e[r]>>t;return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n=e.columns*e.rows,r=e.pixelData,o=e.greenPaletteColorLookupTableData,i=e.bluePaletteColorLookupTableData,s=e.redPaletteColorLookupTableData.length,l=0,u=0,d=e.redPaletteColorLookupTableDescriptor[1],c=8===e.redPaletteColorLookupTableDescriptor[2]?0:8,f=a(e.redPaletteColorLookupTableData,c),h=a(o,c),m=a(i,c),g=0;g<n;++g){var p=r[l++];p<d?p=0:p>d+s-1?p=s-1:p-=d,t[u++]=f[p],t[u++]=h[p],t[u++]=m[p],t[u++]=255}}},"./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var n=e.length/3,a=0,r=0,o=0;o<n;o++)t[r++]=e[a++],t[r++]=e[a++],t[r++]=e[a++],t[r++]=255}},"./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var n=e.length/3,a=0,r=0,o=n,i=2*n,s=0;s<n;s++)t[a++]=e[r++],t[a++]=e[o++],t[a++]=e[i++],t[a++]=255}},"./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var n=e.length/3,a=0,r=0,o=0;o<n;o++){var i=e[a++],s=e[a++],l=e[a++];t[r++]=i+1.402*(l-128),t[r++]=i-.34414*(s-128)-.71414*(l-128),t[r++]=i+1.772*(s-128),t[r++]=255}}},"./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var n=e.length/3,a=0,r=0,o=n,i=2*n,s=0;s<n;s++){var l=e[r++],u=e[o++],d=e[i++];t[a++]=l+1.402*(d-128),t[a++]=l-.34414*(u-128)-.71414*(d-128),t[a++]=l+1.772*(u-128),t[a++]=255}}},"./imageLoader/colorSpaceConverters/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/colorSpaceConverters/convertRGBColorByPixel.js");Object.defineProperty(t,"convertRGBColorByPixel",{enumerable:!0,get:function(){return l(a).default}});var r=n("./imageLoader/colorSpaceConverters/convertRGBColorByPlane.js");Object.defineProperty(t,"convertRGBColorByPlane",{enumerable:!0,get:function(){return l(r).default}});var o=n("./imageLoader/colorSpaceConverters/convertYBRFullByPixel.js");Object.defineProperty(t,"convertYBRFullByPixel",{enumerable:!0,get:function(){return l(o).default}});var i=n("./imageLoader/colorSpaceConverters/convertYBRFullByPlane.js");Object.defineProperty(t,"convertYBRFullByPlane",{enumerable:!0,get:function(){return l(i).default}});var s=n("./imageLoader/colorSpaceConverters/convertPALETTECOLOR.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"convertPALETTECOLOR",{enumerable:!0,get:function(){return l(s).default}})},"./imageLoader/configure.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/internal/index.js");t.default=function(e){(0,a.setOptions)(e)}},"./imageLoader/convertColorSpace.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.data;if("RGB"===e.photometricInterpretation)r(e,n);else if("YBR_RCT"===e.photometricInterpretation)r(e,n);else if("YBR_ICT"===e.photometricInterpretation)r(e,n);else if("PALETTE COLOR"===e.photometricInterpretation)(0,a.convertPALETTECOLOR)(e,n);else if("YBR_FULL_422"===e.photometricInterpretation)r(e,n);else{if("YBR_FULL"!==e.photometricInterpretation)throw new Error("No color space conversion for photometric interpretation "+e.photometricInterpretation);!function(e,t){0===e.planarConfiguration?(0,a.convertYBRFullByPixel)(e.pixelData,t):(0,a.convertYBRFullByPlane)(e.pixelData,t)}(e,n)}};var a=n("./imageLoader/colorSpaceConverters/index.js");function r(e,t){0===e.planarConfiguration?(0,a.convertRGBColorByPixel)(e.pixelData,t):(0,a.convertRGBColorByPlane)(e.pixelData,t)}},"./imageLoader/createImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n("./externalModules.js")),r=d(n("./imageLoader/getImageFrame.js")),o=d(n("./imageLoader/decodeImageFrame.js")),i=d(n("./imageLoader/isColorImage.js")),s=d(n("./imageLoader/convertColorSpace.js")),l=d(n("./shared/getMinMax.js")),u=d(n("./imageLoader/isJPEGBaseline8BitColor.js"));function d(e){return e&&e.__esModule?e:{default:e}}var c="";t.default=function(e,t,n,d){if(!t||!t.length)return Promise.reject(new Error("The file does not contain image data."));var f=a.default.cornerstone,h=document.createElement("canvas"),m=(0,r.default)(e),g=(0,o.default)(m,n,t,h,d);return new Promise(function(t,a){g.then(function(a){var r=f.metaData.get("imagePlaneModule",e)||{},o=f.metaData.get("voiLutModule",e)||{},d=f.metaData.get("modalityLutModule",e)||{},m=f.metaData.get("sopCommonModule",e)||{},g=(0,i.default)(a.photometricInterpretation);if(!(0,u.default)(a,n)&&(function(e){e.pixelData=32===e.bitsAllocated?new Float32Array(e.pixelData):16===e.bitsAllocated?0===e.pixelRepresentation?new Uint16Array(e.pixelData):new Int16Array(e.pixelData):new Uint8Array(e.pixelData)}(a),g)){h.height=a.rows,h.width=a.columns;var p=h.getContext("2d").createImageData(a.columns,a.rows);(0,s.default)(a,p),a.imageData=p,a.pixelData=p.data;var v=(0,l.default)(a.pixelData);a.smallestPixelValue=v.min,a.largestPixelValue=v.max}var b,y={imageId:e,color:g,columnPixelSpacing:r.pixelSpacing?r.pixelSpacing[1]:void 0,columns:a.columns,height:a.rows,intercept:d.rescaleIntercept?d.rescaleIntercept:0,invert:"MONOCHROME1"===a.photometricInterpretation,minPixelValue:a.smallestPixelValue,maxPixelValue:a.largestPixelValue,rowPixelSpacing:r.pixelSpacing?r.pixelSpacing[0]:void 0,rows:a.rows,sizeInBytes:a.pixelData.length,slope:d.rescaleSlope?d.rescaleSlope:1,width:a.columns,windowCenter:o.windowCenter?o.windowCenter[0]:void 0,windowWidth:o.windowWidth?o.windowWidth[0]:void 0,decodeTimeInMS:a.decodeTimeInMS,floatPixelData:void 0};if(a.pixelData instanceof Float32Array){var x=a.pixelData,w=function(e){for(var t=(0,l.default)(e),n=Math.abs(t.max-t.min)/65535,a=t.min,r=e.length,o=new Uint16Array(r),i=65535,s=0,u=0;u<r;u++){var d=Math.floor((e[u]-a)/n);o[u]=d,i=Math.min(i,d),s=Math.max(s,d)}return{min:i,max:s,intPixelData:o,slope:n,intercept:a}}(x);y.minPixelValue=w.min,y.maxPixelValue=w.max,y.slope=w.slope,y.intercept=w.intercept,y.floatPixelData=x,y.getPixelData=function(){return w.intPixelData}}else y.getPixelData=function(){return a.pixelData};if(y.color&&(y.getCanvas=function(){return c===e||(h.height=y.rows,h.width=y.columns,h.getContext("2d").putImageData(a.imageData,0,0),c=e),h}),d.modalityLUTSequence&&d.modalityLUTSequence.length>0&&"1.2.840.10008.5.1.4.1.1.12.1"!==(b=m.sopClassUID)&&"1.2.840.10008.5.1.4.1.1.12.2.1"!==b&&(y.modalityLUT=d.modalityLUTSequence[0]),o.voiLUTSequence&&o.voiLUTSequence.length>0&&(y.voiLUT=o.voiLUTSequence[0]),y.color&&(y.windowWidth=255,y.windowCenter=127),void 0===y.windowCenter||void 0===y.windowWidth){var j=y.maxPixelValue*y.slope+y.intercept,T=y.minPixelValue*y.slope+y.intercept;y.windowWidth=j-T,y.windowCenter=(j+T)/2}t(y)},a)})}},"./imageLoader/decodeImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/internal/options.js"),r=d(n("./imageLoader/webWorkerManager.js")),o=d(n("./imageLoader/decodeJPEGBaseline8BitColor.js")),i=d(n("./shared/decodeImageFrame.js")),s=d(n("./shared/calculateMinMax.js")),l=n("./shared/decoders/decodeJPEG2000.js"),u=n("./shared/decoders/decodeJPEGLS.js");function d(e){return e&&e.__esModule?e:{default:e}}var c=!1;function f(e,t,n,o){var d=o.priority||void 0,f=o.transferPixelData?[n.buffer]:void 0,h=(0,a.getOptions)(),m=h.strict,g=h.decodeConfig;return!1===h.useWebWorkers?(!1===c&&((0,l.initializeJPEG2000)(g),(0,u.initializeJPEGLS)(g),c=!0),new Promise(function(a,r){try{var l=i.default.apply(void 0,[e,t,n,g,o]);(0,s.default)(l,m),a(l)}catch(u){r(u)}})):r.default.addTask("decodeTask",{imageFrame:e,transferSyntax:t,pixelData:n,options:o},d,f).promise}t.default=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return"1.2.840.10008.1.2"===t||"1.2.840.10008.1.2.1"===t||"1.2.840.10008.1.2.2"===t||"1.2.840.10008.1.2.1.99"===t||"1.2.840.10008.1.2.5"===t?f(e,t,n,r):"1.2.840.10008.1.2.4.50"===t?8!==e.bitsAllocated||3!==e.samplesPerPixel&&4!==e.samplesPerPixel?f(e,t,n,r):(0,o.default)(e,n,a):"1.2.840.10008.1.2.4.51"===t||"1.2.840.10008.1.2.4.57"===t||"1.2.840.10008.1.2.4.70"===t||"1.2.840.10008.1.2.4.80"===t||"1.2.840.10008.1.2.4.81"===t||"1.2.840.10008.1.2.4.90"===t||"1.2.840.10008.1.2.4.91"===t?f(e,t,n,r):new Promise(function(e,n){n(new Error("No decoder for transfer syntax "+t))})}},"./imageLoader/decodeJPEGBaseline8BitColor.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./shared/getMinMax.js"))&&a.__esModule?a:{default:a};t.default=function(e,t,n){var a=(new Date).getTime(),o=new Blob([t],{type:"image/jpeg"});return new Promise(function(t,i){var s=new FileReader;void 0===s.readAsBinaryString?s.readAsArrayBuffer(o):s.readAsBinaryString(o),s.onload=function(){var o=new Image;o.onload=function(){n.height=o.height,n.width=o.width,e.rows=o.height,e.columns=o.width;var i=n.getContext("2d");i.drawImage(this,0,0);var s=i.getImageData(0,0,o.width,o.height),l=(new Date).getTime();e.pixelData=s.data,e.imageData=s,e.decodeTimeInMS=l-a;var u=(0,r.default)(e.pixelData);e.smallestPixelValue=u.min,e.largestPixelValue=u.max,t(e)},o.onerror=function(e){i(e)},o.src=void 0===s.readAsBinaryString?"data:image/jpeg;base64,"+window.btoa(function(e){var t=void 0;try{return decodeURIComponent(escape(e))}catch(n){if((t=n)instanceof URIError)return e;throw t}}(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(s.result))))):"data:image/jpeg;base64,"+window.btoa(s.result)},s.onerror=function(e){i(e)}})}},"./imageLoader/getImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a};t.default=function(e){var t=r.default.cornerstone.metaData.get("imagePixelModule",e);return{samplesPerPixel:t.samplesPerPixel,photometricInterpretation:t.photometricInterpretation,planarConfiguration:t.planarConfiguration,rows:t.rows,columns:t.columns,bitsAllocated:t.bitsAllocated,bitsStored:t.bitsStored,pixelRepresentation:t.pixelRepresentation,smallestPixelValue:t.smallestPixelValue,largestPixelValue:t.largestPixelValue,redPaletteColorLookupTableDescriptor:t.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:t.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:t.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:t.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:t.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:t.bluePaletteColorLookupTableData,pixelData:void 0}}},"./imageLoader/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/colorSpaceConverters/index.js");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var r=n("./imageLoader/wadouri/index.js");Object.defineProperty(t,"wadouri",{enumerable:!0,get:function(){return y(r).default}});var o=n("./imageLoader/wadors/index.js");Object.defineProperty(t,"wadors",{enumerable:!0,get:function(){return y(o).default}});var i=n("./imageLoader/configure.js");Object.defineProperty(t,"configure",{enumerable:!0,get:function(){return y(i).default}});var s=n("./imageLoader/convertColorSpace.js");Object.defineProperty(t,"convertColorSpace",{enumerable:!0,get:function(){return y(s).default}});var l=n("./imageLoader/createImage.js");Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return y(l).default}});var u=n("./imageLoader/decodeImageFrame.js");Object.defineProperty(t,"decodeImageFrame",{enumerable:!0,get:function(){return y(u).default}});var d=n("./imageLoader/decodeJPEGBaseline8BitColor.js");Object.defineProperty(t,"decodeJPEGBaseline8BitColor",{enumerable:!0,get:function(){return y(d).default}});var c=n("./imageLoader/getImageFrame.js");Object.defineProperty(t,"getImageFrame",{enumerable:!0,get:function(){return y(c).default}});var f=n("./shared/getMinMax.js");Object.defineProperty(t,"getMinMax",{enumerable:!0,get:function(){return y(f).default}});var h=n("./imageLoader/isColorImage.js");Object.defineProperty(t,"isColorImage",{enumerable:!0,get:function(){return y(h).default}});var m=n("./imageLoader/isJPEGBaseline8BitColor.js");Object.defineProperty(t,"isJPEGBaseline8BitColor",{enumerable:!0,get:function(){return y(m).default}});var g=n("./imageLoader/webWorkerManager.js");Object.defineProperty(t,"webWorkerManager",{enumerable:!0,get:function(){return y(g).default}});var p=n("./version.js");Object.defineProperty(t,"version",{enumerable:!0,get:function(){return y(p).default}});var v=n("./imageLoader/internal/index.js");Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return v.internal}});var b=n("./externalModules.js");function y(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"external",{enumerable:!0,get:function(){return y(b).default}})},"./imageLoader/internal/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internal=t.xhrRequest=t.getOptions=t.setOptions=void 0;var a,r=(a=n("./imageLoader/internal/xhrRequest.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/internal/options.js"),i={xhrRequest:r.default,setOptions:o.setOptions,getOptions:o.getOptions};t.setOptions=o.setOptions,t.getOptions=o.getOptions,t.xhrRequest=r.default,t.internal=i},"./imageLoader/internal/options.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOptions=function(e){a=Object.assign(a,e)},t.getOptions=function(){return a};var a={beforeSend:function(){},imageCreated:function(){},strict:!1,useWebWorkers:!0,decodeConfig:{usePDFJS:!1}}},"./imageLoader/internal/xhrRequest.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/internal/options.js");t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.default.cornerstone,s=(0,o.getOptions)();return new Promise(function(r,o){var l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="arraybuffer",s.beforeSend(l,t),Object.keys(n).forEach(function(e){l.setRequestHeader(e,n[e])}),a.deferred={resolve:r,reject:o},a.url=e,a.imageId=t,l.onloadstart=function(n){s.onloadstart&&s.onloadstart(n,a),i.triggerEvent(i.events,"cornerstoneimageloadstart",{url:e,imageId:t})},l.onloadend=function(n){s.onloadend&&s.onloadend(n,a),i.triggerEvent(i.events,"cornerstoneimageloadend",{url:e,imageId:t})},l.onreadystatechange=function(e){s.onreadystatechange?s.onreadystatechange(e,a):4===l.readyState&&(200===l.status?r(l.response,l):o(l))},l.onprogress=function(n){var r=n.loaded,o=void 0,l=void 0;n.lengthComputable&&(o=n.total,l=Math.round(r/o*100)),s.onprogress&&s.onprogress(n,a),i.triggerEvent(i.events,"cornerstoneimageloadprogress",{url:e,imageId:t,loaded:r,total:o,percentComplete:l})},l.send()})}},"./imageLoader/isColorImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"RGB"===e||"PALETTE COLOR"===e||"YBR_FULL"===e||"YBR_FULL_422"===e||"YBR_PARTIAL_422"===e||"YBR_PARTIAL_420"===e||"YBR_RCT"===e||"YBR_ICT"===e}},"./imageLoader/isJPEGBaseline8BitColor.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t=t||e.transferSyntax,8===e.bitsAllocated&&"1.2.840.10008.1.2.4.50"===t&&(3===e.samplesPerPixel||4===e.samplesPerPixel))return!0}},"./imageLoader/registerLoaders.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n("./imageLoader/wadors/index.js")),r=o(n("./imageLoader/wadouri/index.js"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){a.default.register(e),r.default.register(e)}},"./imageLoader/wadors/findIndexOfString.js":function(e,t,n){"use strict";function a(e,t,n){if(n+e.length>t.length)return!1;for(var a=n,r=0;r<e.length;r++)if(e[r]!==t[a++])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n=n||0;for(var r=function(e){for(var t=new Uint8Array(e.length),n=0,a=e.length;n<a;n++)t[n]=e.charCodeAt(n);return t}(t),o=n;o<e.length;o++)if(r[0]===e[o]&&a(r,e,o))return o;return-1}},"./imageLoader/wadors/getPixelData.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n("./imageLoader/internal/index.js"),o=(a=n("./imageLoader/wadors/findIndexOfString.js"))&&a.__esModule?a:{default:a};function i(e){for(var t=0;t<e.length;t++)if("--"===e[t].substr(0,2))return e[t]}function s(e){for(var t=0;t<e.length;t++)if("Content-Type:"===e[t].substr(0,13))return e[t].substr(13).trim()}function l(e,t,n){t=t||0,n=n||e.length-t;for(var a="",r=t;r<t+n;r++)a+=String.fromCharCode(e[r]);return a}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/octet-stream",a={accept:n};return new Promise(function(n,u){(0,r.xhrRequest)(e,t,a).then(function(e){var t=new Uint8Array(e),a=(0,o.default)(t,"\r\n\r\n");-1===a&&u(new Error("invalid response - no multipart mime header"));var r=l(t,0,a).split("\r\n"),d=i(r);d||u(new Error("invalid response - no boundary marker"));var c=a+4,f=(0,o.default)(t,d,c);-1===f&&u(new Error("invalid response - terminating boundary not found"));var h=f-c-2;n({contentType:s(r),imageFrame:{pixelData:new Uint8Array(e,c,h)}})})})}},"./imageLoader/wadors/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadors/metaData/index.js"),r=u(n("./imageLoader/wadors/findIndexOfString.js")),o=u(n("./imageLoader/wadors/getPixelData.js")),i=u(n("./imageLoader/wadors/metaDataManager.js")),s=u(n("./imageLoader/wadors/loadImage.js")),l=u(n("./imageLoader/wadors/register.js"));function u(e){return e&&e.__esModule?e:{default:e}}t.default={metaData:{getNumberString:a.getNumberString,getNumberValue:a.getNumberValue,getNumberValues:a.getNumberValues,getValue:a.getValue,metaDataProvider:a.metaDataProvider},findIndexOfString:r.default,getPixelData:o.default,loadImage:s.default,metaDataManager:i.default,register:l.default}},"./imageLoader/wadors/loadImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTransferSyntaxForContentType=s;var a=i(n("./imageLoader/wadors/metaDataManager.js")),r=i(n("./imageLoader/wadors/getPixelData.js")),o=i(n("./imageLoader/createImage.js"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e){var t="1.2.840.10008.1.2";return e&&e.split(";").forEach(function(e){var n=e.split("=");2===n.length&&"transfer-syntax"===n[0].trim()&&(t=n[1].trim()||t)}),t}t.default=function(e,t){var n=(new Date).getTime(),i=e.substring(7);return{promise:new Promise(function(l,u){if(void 0===a.default.get(e)){var d=new Error("no metadata for imageId "+e);return u(d)}(0,r.default)(i,e,'multipart/related; type="application/octet-stream"').then(function(a){var r=s(a.contentType);(0,o.default)(e,a.imageFrame.pixelData,r,t).then(function(e){var t=(new Date).getTime();e.loadTimeInMS=t-n,l(e)},u)},u)}),cancelFn:void 0}}},"./imageLoader/wadors/metaData/getNumberString.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/wadors/metaData/getValue.js"))&&a.__esModule?a:{default:a};t.default=function(e,t,n){var a=(0,r.default)(e,t,n);if(void 0!==a)return parseFloat(a)}},"./imageLoader/wadors/metaData/getNumberValue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/wadors/metaData/getValue.js"))&&a.__esModule?a:{default:a};t.default=function(e,t){var n=(0,r.default)(e,t);if(void 0!==n)return parseFloat(n)}},"./imageLoader/wadors/metaData/getNumberValues.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&e.Value&&!(t&&e.Value.length<t)){for(var n=[],a=0;a<e.Value.length;a++)n.push(parseFloat(e.Value[a]));return n}}},"./imageLoader/wadors/metaData/getValue.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return t=t||0,e&&e.Value?e.Value.length<=t?n:e.Value[t]:n}},"./imageLoader/wadors/metaData/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadors/metaData/getNumberString.js");Object.defineProperty(t,"getNumberString",{enumerable:!0,get:function(){return l(a).default}});var r=n("./imageLoader/wadors/metaData/getNumberValue.js");Object.defineProperty(t,"getNumberValue",{enumerable:!0,get:function(){return l(r).default}});var o=n("./imageLoader/wadors/metaData/getNumberValues.js");Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return l(o).default}});var i=n("./imageLoader/wadors/metaData/getValue.js");Object.defineProperty(t,"getValue",{enumerable:!0,get:function(){return l(i).default}});var s=n("./imageLoader/wadors/metaData/metaDataProvider.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return l(s).default}})},"./imageLoader/wadors/metaData/metaDataProvider.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n("./externalModules.js")),r=l(n("./imageLoader/wadors/metaData/getNumberValues.js")),o=l(n("./imageLoader/wadors/metaData/getValue.js")),i=l(n("./imageLoader/wadors/metaData/getNumberValue.js")),s=l(n("./imageLoader/wadors/metaDataManager.js"));function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var n=a.default.dicomParser,l=s.default.get(t);if(l){if("generalSeriesModule"===e)return{modality:(0,o.default)(l["00080060"]),seriesInstanceUID:(0,o.default)(l["0020000e"]),seriesNumber:(0,i.default)(l["00200011"]),studyInstanceUID:(0,o.default)(l["0020000d"]),seriesDate:n.parseDA((0,o.default)(l["00080021"])),seriesTime:n.parseTM((0,o.default)(l["00080031"],0,""))};if("patientStudyModule"===e)return{patientAge:(0,i.default)(l["00101010"]),patientSize:(0,i.default)(l["00101020"]),patientWeight:(0,i.default)(l["00101030"])};if("imagePlaneModule"===e){var u=(0,r.default)(l["00200037"],6),d=(0,r.default)(l["00200032"],3),c=(0,r.default)(l["00280030"],2),f=1,h=1;c&&(h=c[0],f=c[1]);var m=null,g=null;return u&&(m=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])],g=[parseFloat(u[3]),parseFloat(u[4]),parseFloat(u[5])]),{frameOfReferenceUID:(0,o.default)(l["00200052"]),rows:(0,i.default)(l["00280010"]),columns:(0,i.default)(l["00280011"]),imageOrientationPatient:u,rowCosines:m,columnCosines:g,imagePositionPatient:d,sliceThickness:(0,i.default)(l["00180050"]),sliceLocation:(0,i.default)(l["00201041"]),pixelSpacing:c,rowPixelSpacing:h,columnPixelSpacing:f}}if("imagePixelModule"===e)return{samplesPerPixel:(0,i.default)(l["00280002"]),photometricInterpretation:(0,o.default)(l["00280004"]),rows:(0,i.default)(l["00280010"]),columns:(0,i.default)(l["00280011"]),bitsAllocated:(0,i.default)(l["00280100"]),bitsStored:(0,i.default)(l["00280101"]),highBit:(0,o.default)(l["00280102"]),pixelRepresentation:(0,i.default)(l["00280103"]),planarConfiguration:(0,i.default)(l["00280006"]),pixelAspectRatio:(0,o.default)(l["00280034"]),smallestPixelValue:(0,i.default)(l["00280106"]),largestPixelValue:(0,i.default)(l["00280107"]),redPaletteColorLookupTableDescriptor:(0,r.default)(l["00281101"]),greenPaletteColorLookupTableDescriptor:(0,r.default)(l["00281102"]),bluePaletteColorLookupTableDescriptor:(0,r.default)(l["00281103"]),redPaletteColorLookupTableData:(0,r.default)(l["00281201"]),greenPaletteColorLookupTableData:(0,r.default)(l["00281202"]),bluePaletteColorLookupTableData:(0,r.default)(l["00281203"])};if("voiLutModule"===e)return{windowCenter:(0,r.default)(l["00281050"],1),windowWidth:(0,r.default)(l["00281051"],1)};if("modalityLutModule"===e)return{rescaleIntercept:(0,i.default)(l["00281052"]),rescaleSlope:(0,i.default)(l["00281053"]),rescaleType:(0,o.default)(l["00281054"])};if("sopCommonModule"===e)return{sopClassUID:(0,o.default)(l["00080016"]),sopInstanceUID:(0,o.default)(l["00080018"])};if("petIsotopeModule"===e){var p=(0,o.default)(l["00540016"]);if(void 0===p)return;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:n.parseTM((0,o.default)(p["00181072"],0,"")),radionuclideTotalDose:(0,i.default)(p["00181074"]),radionuclideHalfLife:(0,i.default)(p["00181075"])}}}}}},"./imageLoader/wadors/metaDataManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.default={add:function(e,t){a[e]=t},get:function(e){return a[e]},remove:function(e){a[e]=void 0},purge:function(){a=[]}}},"./imageLoader/wadors/register.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("wadors",r.default),e.metaData.addProvider(o.metaDataProvider)};var a,r=(a=n("./imageLoader/wadors/loadImage.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/wadors/metaData/index.js")},"./imageLoader/wadouri/dataSetCacheManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInfo=u;var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a},o=n("./imageLoader/internal/index.js"),i=0,s={},l={};function u(){return{cacheSizeInBytes:i,numberOfDataSetsCached:Object.keys(s).length}}t.default={isLoaded:function(e){return void 0!==s[e]},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.xhrRequest,n=arguments[2],a=r.default.cornerstone,d=r.default.dicomParser;if(s[e])return new Promise(function(t){s[e].cacheCount++,t(s[e].dataSet)});if(l[e])return l[e].cacheCount++,l[e];var c=t(e,n),f=new Promise(function(t,n){c.then(function(r){var o=new Uint8Array(r),l=void 0;try{l=d.parseDicom(o)}catch(c){return n(c)}s[e]={dataSet:l,cacheCount:f.cacheCount},i+=l.byteArray.length,t(l),a.triggerEvent(a.events,"datasetscachechanged",{uri:e,action:"loaded",cacheInfo:u()})},n).then(function(){delete l[e]},function(){delete l[e]})});return f.cacheCount=1,l[e]=f,f},unload:function(e){var t=r.default.cornerstone;s[e]&&(s[e].cacheCount--,0===s[e].cacheCount&&(i-=s[e].dataSet.byteArray.length,delete s[e],t.triggerEvent(t.events,"datasetscachechanged",{uri:e,action:"unloaded",cacheInfo:u()})))},getInfo:u,purge:function(){s={},l={}},get:function(e){if(s[e])return s[e].dataSet}}},"./imageLoader/wadouri/fileManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.default={add:function(e){return"dicomfile:"+(a.push(e)-1)},get:function(e){return a[e]},remove:function(e){a[e]=void 0},purge:function(){a=[]}}},"./imageLoader/wadouri/getEncapsulatedImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=r.default.dicomParser;if(e.elements.x7fe00010&&e.elements.x7fe00010.basicOffsetTable.length)return n.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t);if(function(e){return e.intString("x00280008")!==e.elements.x7fe00010.fragments.length}(e)){var a=n.createJPEGBasicOffsetTable(e,e.elements.x7fe00010);return n.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t,a)}return n.readEncapsulatedPixelDataFromFragments(e,e.elements.x7fe00010,t)};var a,r=(a=n("./externalModules.js"))&&a.__esModule?a:{default:a}},"./imageLoader/wadouri/getPixelData.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n("./imageLoader/wadouri/getEncapsulatedImageFrame.js")),r=o(n("./imageLoader/wadouri/getUncompressedImageFrame.js"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.elements.x7fe00010||e.elements.x7fe00008;return n?n.encapsulatedPixelData?(0,a.default)(e,t):(0,r.default)(e,t):null}},"./imageLoader/wadouri/getUncompressedImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=(a=n("./imageLoader/wadouri/unpackBinaryFrame.js"))&&a.__esModule?a:{default:a};t.default=function(e,t){var n=e.elements.x7fe00010||e.elements.x7fe00008,a=e.uint16("x00280100"),o=e.uint16("x00280010"),i=e.uint16("x00280011"),s=e.uint16("x00280002"),l=n.dataOffset,u=o*i*s,d=void 0;if(8===a){if((d=l+t*u)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,u)}if(16===a){if((d=l+t*u*2)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,2*u)}if(1===a){if((d=l+t*u*.125)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return(0,r.default)(e.byteArray,d,u)}if(32===a){if((d=l+t*u*4)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,4*u)}throw new Error("unsupported pixel format")}},"./imageLoader/wadouri/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadouri/metaData/index.js"),r=h(n("./imageLoader/wadouri/dataSetCacheManager.js")),o=h(n("./imageLoader/wadouri/fileManager.js")),i=h(n("./imageLoader/wadouri/getEncapsulatedImageFrame.js")),s=h(n("./imageLoader/wadouri/getUncompressedImageFrame.js")),l=h(n("./imageLoader/wadouri/loadFileRequest.js")),u=n("./imageLoader/wadouri/loadImage.js"),d=h(n("./imageLoader/wadouri/parseImageId.js")),c=h(n("./imageLoader/wadouri/unpackBinaryFrame.js")),f=h(n("./imageLoader/wadouri/register.js"));function h(e){return e&&e.__esModule?e:{default:e}}t.default={metaData:{getImagePixelModule:a.getImagePixelModule,getLUTs:a.getLUTs,getModalityLUTOutputPixelRepresentation:a.getModalityLUTOutputPixelRepresentation,getNumberValues:a.getNumberValues,metaDataProvider:a.metaDataProvider},dataSetCacheManager:r.default,fileManager:o.default,getEncapsulatedImageFrame:i.default,getUncompressedImageFrame:s.default,loadFileRequest:l.default,loadImageFromPromise:u.loadImageFromPromise,getLoaderForScheme:u.getLoaderForScheme,loadImage:u.loadImage,parseImageId:d.default,unpackBinaryFrame:c.default,register:f.default}},"./imageLoader/wadouri/loadFileRequest.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n("./imageLoader/wadouri/parseImageId.js")),r=o(n("./imageLoader/wadouri/fileManager.js"));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=(0,a.default)(e),n=parseInt(t.url,10),o=r.default.get(n);return new Promise(function(e,t){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.onerror=t,n.readAsArrayBuffer(o)})}},"./imageLoader/wadouri/loadImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadImage=t.getLoaderForScheme=t.loadImageFromPromise=void 0;var a=u(n("./imageLoader/createImage.js")),r=u(n("./imageLoader/wadouri/parseImageId.js")),o=u(n("./imageLoader/wadouri/dataSetCacheManager.js")),i=u(n("./imageLoader/wadouri/loadFileRequest.js")),s=u(n("./imageLoader/wadouri/getPixelData.js")),l=n("./imageLoader/internal/index.js");function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){e.decache=function(){var e=(0,r.default)(t);o.default.unload(e.url)}}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments[3],o=arguments[4],i=arguments[5],l=(new Date).getTime(),u={cancelFn:void 0};return u.promise=new Promise(function(c,f){e.then(function(e){var h=(0,s.default)(e,n),m=e.string("x00020010"),g=(new Date).getTime(),p=(0,a.default)(t,h,m,o);d(u,t),p.then(function(t){t.data=e,t.sharedCacheKey=r;var n=(new Date).getTime();t.loadTimeInMS=g-l,t.totalTimeInMS=n-l,void 0!==i&&void 0!==i.imageDoneCallback&&i.imageDoneCallback(t),c(t)},function(t){f({error:t,dataSet:e})})},function(e){f({error:e})})}),u}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments[3],o=arguments[4],i=(new Date).getTime(),l=new Promise(function(l,u){var d=(new Date).getTime(),c=void 0;try{var f=(0,s.default)(e,n),h=e.string("x00020010");c=(0,a.default)(t,f,h,o)}catch(m){return void u({error:m,dataSet:e})}c.then(function(t){t.data=e,t.sharedCacheKey=r;var n=(new Date).getTime();t.loadTimeInMS=d-i,t.totalTimeInMS=n-i,l(t)},u)});return{promise:l,cancelFn:void 0}}function h(e){return"dicomweb"===e||"wadouri"===e?l.xhrRequest:"dicomfile"===e?i.default:void 0}t.loadImageFromPromise=c,t.getLoaderForScheme=h,t.loadImage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,r.default)(e),a=t.loader;if(void 0===a&&(a=h(n.scheme)),o.default.isLoaded(n.url)){var i=o.default.get(n.url,a,e);return f(i,e,n.frame,n.url,t)}var s=o.default.load(n.url,a,e);return c(s,e,n.frame,n.url,t)}},"./imageLoader/wadouri/metaData/getImagePixelModule.js":function(e,t,n){"use strict";function a(e,t){if(e.elements[t]&&6===e.elements[t].length)return[e.uint16(t,0),e.uint16(t,1),e.uint16(t,2)]}function r(e,t,n){for(var a=[],r=e.elements[t],o=0;o<n[0];o++)a[o]=16===n[2]?e.uint16(t,o):e.byteArray[o+r.dataOffset];return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={samplesPerPixel:e.uint16("x00280002"),photometricInterpretation:e.string("x00280004"),rows:e.uint16("x00280010"),columns:e.uint16("x00280011"),bitsAllocated:e.uint16("x00280100"),bitsStored:e.uint16("x00280101"),highBit:e.uint16("x00280102"),pixelRepresentation:e.uint16("x00280103"),planarConfiguration:e.uint16("x00280006"),pixelAspectRatio:e.string("x00280034")};return function(e,t){0===e.uint16("x00280103")?(t.smallestPixelValue=e.uint16("x00280106"),t.largestPixelValue=e.uint16("x00280107")):(t.smallestPixelValue=e.int16("x00280106"),t.largestPixelValue=e.int16("x00280107"))}(e,t),"PALETTE COLOR"===t.photometricInterpretation&&e.elements.x00281101&&function(e,t){t.redPaletteColorLookupTableDescriptor=a(e,"x00281101"),t.greenPaletteColorLookupTableDescriptor=a(e,"x00281102"),t.bluePaletteColorLookupTableDescriptor=a(e,"x00281103"),0===t.redPaletteColorLookupTableDescriptor[0]&&(t.redPaletteColorLookupTableDescriptor[0]=65536,t.greenPaletteColorLookupTableDescriptor[0]=65536,t.bluePaletteColorLookupTableDescriptor[0]=65536);var n=e.elements.x00281201.length===t.redPaletteColorLookupTableDescriptor[0]?8:16;t.redPaletteColorLookupTableDescriptor[2]!==n&&(t.redPaletteColorLookupTableDescriptor[2]=n,t.greenPaletteColorLookupTableDescriptor[2]=n,t.bluePaletteColorLookupTableDescriptor[2]=n),t.redPaletteColorLookupTableData=r(e,"x00281201",t.redPaletteColorLookupTableDescriptor),t.greenPaletteColorLookupTableData=r(e,"x00281202",t.greenPaletteColorLookupTableDescriptor),t.bluePaletteColorLookupTableData=r(e,"x00281203",t.bluePaletteColorLookupTableDescriptor)}(e,t),t}},"./imageLoader/wadouri/metaData/getLUTs.js":function(e,t,n){"use strict";function a(e,t){var n=t.uint16("x00283002",0);0===n&&(n=65535);for(var a={id:"1",firstValueMapped:0===e?t.uint16("x00283002",1):t.int16("x00283002",1),numBitsPerEntry:t.uint16("x00283002",2),lut:[]},r=0;r<n;r++)a.lut[r]=0===e?t.uint16("x00283006",r):t.int16("x00283006",r);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t&&t.items.length){for(var n=[],r=0;r<t.items.length;r++){var o=a(e,t.items[r].dataSet);o&&n.push(o)}return n}}},"./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.string("x00080016");if("1.2.840.10008.5.1.4.1.1.2"===t||"1.2.840.10008.5.1.4.1.1.2.1"===t)return 1;var n=e.floatString("x00281052"),a=e.floatString("x00281053");return void 0!==n&&void 0!==a?function(e){var t=e.uint16("x00280103"),n=e.uint16("x00280101");return 0===t?0:-1<<n-1}(e)*a+n<0?1:0:e.elements.x00283000&&e.elements.x00283000.length>0?0:e.uint16("x00280103")}},"./imageLoader/wadouri/metaData/getNumberValues.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var a=[],r=e.string(t);if(r){var o=r.split("\\");if(!(n&&o.length<n)){for(var i=0;i<o.length;i++)a.push(parseFloat(o[i]));return a}}}},"./imageLoader/wadouri/metaData/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/wadouri/metaData/getImagePixelModule.js");Object.defineProperty(t,"getImagePixelModule",{enumerable:!0,get:function(){return l(a).default}});var r=n("./imageLoader/wadouri/metaData/getLUTs.js");Object.defineProperty(t,"getLUTs",{enumerable:!0,get:function(){return l(r).default}});var o=n("./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js");Object.defineProperty(t,"getModalityLUTOutputPixelRepresentation",{enumerable:!0,get:function(){return l(o).default}});var i=n("./imageLoader/wadouri/metaData/getNumberValues.js");Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return l(i).default}});var s=n("./imageLoader/wadouri/metaData/metaDataProvider.js");function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return l(s).default}})},"./imageLoader/wadouri/metaData/metaDataProvider.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n("./externalModules.js")),r=d(n("./imageLoader/wadouri/metaData/getNumberValues.js")),o=d(n("./imageLoader/wadouri/parseImageId.js")),i=d(n("./imageLoader/wadouri/dataSetCacheManager.js")),s=d(n("./imageLoader/wadouri/metaData/getImagePixelModule.js")),l=d(n("./imageLoader/wadouri/metaData/getLUTs.js")),u=d(n("./imageLoader/wadouri/metaData/getModalityLUTOutputPixelRepresentation.js"));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var n=a.default.dicomParser,d=(0,o.default)(t),c=i.default.get(d.url);if(c){if("generalSeriesModule"===e)return{modality:c.string("x00080060"),seriesInstanceUID:c.string("x0020000e"),seriesNumber:c.intString("x00200011"),studyInstanceUID:c.string("x0020000d"),seriesDate:n.parseDA(c.string("x00080021")),seriesTime:n.parseTM(c.string("x00080031")||"")};if("patientStudyModule"===e)return{patientAge:c.intString("x00101010"),patientSize:c.floatString("x00101020"),patientWeight:c.floatString("x00101030")};if("imagePlaneModule"===e){var f=(0,r.default)(c,"x00200037",6),h=(0,r.default)(c,"x00200032",3),m=(0,r.default)(c,"x00280030",2),g=1,p=1;m&&(p=m[0],g=m[1]);var v=null,b=null;return f&&(v=[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2])],b=[parseFloat(f[3]),parseFloat(f[4]),parseFloat(f[5])]),{frameOfReferenceUID:c.string("x00200052"),rows:c.uint16("x00280010"),columns:c.uint16("x00280011"),imageOrientationPatient:f,rowCosines:v,columnCosines:b,imagePositionPatient:h,sliceThickness:c.floatString("x00180050"),sliceLocation:c.floatString("x00201041"),pixelSpacing:m,rowPixelSpacing:p,columnPixelSpacing:g}}if("imagePixelModule"===e)return(0,s.default)(c);if("modalityLutModule"===e)return{rescaleIntercept:c.floatString("x00281052"),rescaleSlope:c.floatString("x00281053"),rescaleType:c.string("x00281054"),modalityLUTSequence:(0,l.default)(c.uint16("x00280103"),c.elements.x00283000)};if("voiLutModule"===e){var y=(0,u.default)(c);return{windowCenter:(0,r.default)(c,"x00281050",1),windowWidth:(0,r.default)(c,"x00281051",1),voiLUTSequence:(0,l.default)(y,c.elements.x00283010)}}if("sopCommonModule"===e)return{sopClassUID:c.string("x00080016"),sopInstanceUID:c.string("x00080018")};if("petIsotopeModule"===e){var x=c.elements.x00540016;if(void 0===x)return;var w=x.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:n.parseTM(w.string("x00181072")||""),radionuclideTotalDose:w.floatString("x00181074"),radionuclideHalfLife:w.floatString("x00181075")}}}}}},"./imageLoader/wadouri/parseImageId.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.indexOf(":"),n=e.substring(t+1),a=n.indexOf("frame="),r=void 0;if(-1!==a){var o=n.substr(a+6);r=parseInt(o,10),n=n.substr(0,a-1)}return{scheme:e.substr(0,t),url:n,frame:r}}},"./imageLoader/wadouri/register.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("dicomweb",a.loadImage),e.registerImageLoader("wadouri",a.loadImage),e.registerImageLoader("dicomfile",a.loadImage),e.metaData.addProvider(r.metaDataProvider)};var a=n("./imageLoader/wadouri/loadImage.js"),r=n("./imageLoader/wadouri/metaData/index.js")},"./imageLoader/wadouri/unpackBinaryFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var a=new Uint8Array(n),r=0;r<n;r++){var o=Math.floor(r/8);a[r]=e[o+t]&1<<r%8?1:0}return a}},"./imageLoader/webWorkerManager.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("./imageLoader/internal/options.js"),r=0,o=[],i=[],s=(0,a.getOptions)(),l={maxWebWorkers:navigator.hardwareConcurrency||1,startWebWorkersOnDemand:!0,webWorkerPath:"../../dist/cornerstoneWADOImageLoaderWebWorker.js",webWorkerTaskPaths:[],taskConfiguration:{decodeTask:{loadCodecsOnStartup:!0,initializeCodecsOnStartup:!1,codecsPath:"../dist/cornerstoneWADOImageLoaderCodecs.js",usePDFJS:!1,strict:s.strict}}},u=void 0,d={maxWebWorkers:0,numWebWorkers:0,numTasksQueued:0,numTasksExecuting:0,numTasksCompleted:0,totalTaskTimeInMS:0,totalTimeDelayedInMS:0};function c(){if(o.length){for(var e=0;e<i.length;e++)if("ready"===i[e].status){i[e].status="busy";var t=o.shift();t.start=(new Date).getTime();var n=(new Date).getTime();return d.totalTimeDelayedInMS+=n-t.added,i[e].task=t,i[e].worker.postMessage({taskType:t.taskType,workerIndex:e,data:t.data},t.transferList),void d.numTasksExecuting++}i.length<u.maxWebWorkers&&h()}}function f(e){if("initialize"===e.data.taskType)i[e.data.workerIndex].status="ready",c();else{var t=i[e.data.workerIndex].task.start;i[e.data.workerIndex].task.deferred.resolve(e.data.result),i[e.data.workerIndex].task=void 0,d.numTasksExecuting--,i[e.data.workerIndex].status="ready",d.numTasksCompleted++;var n=(new Date).getTime();d.totalTaskTimeInMS+=n-t,c()}}function h(){if(!(i.length>=u.maxWebWorkers)){var e=new Worker(u.webWorkerPath);i.push({worker:e,status:"initializing"}),e.addEventListener("message",f),e.postMessage({taskType:"initialize",workerIndex:i.length-1,config:u})}}function m(e){if(e=e||l,u)throw new Error("WebWorkerManager already initialized");if((u=e).maxWebWorkers=u.maxWebWorkers||navigator.hardwareConcurrency||1,!u.startWebWorkersOnDemand)for(var t=0;t<u.maxWebWorkers;t++)h()}t.default={initialize:m,loadWebWorkerTask:function(e,t){u.webWorkerTaskPaths.push(e),t&&(u.taskConfiguration=Object.assign(u.taskConfiguration,t));for(var n=0;n<i.length;n++)i[n].worker.postMessage({taskType:"loadWebWorkerTask",workerIndex:i.length-1,sourcePath:e,config:u})},addTask:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments[3];u||m();var i={},s=new Promise(function(e,t){i={resolve:e,reject:t}}),l=void 0;for(l=0;l<o.length&&!(o[l].priority<n);l++);var d=r++;return o.splice(l,0,{taskId:d,taskType:e,status:"ready",added:(new Date).getTime(),data:t,deferred:i,priority:n,transferList:a}),c(),{taskId:d,promise:s}},getStatistics:function(){return d.maxWebWorkers=u.maxWebWorkers,d.numWebWorkers=i.length,d.numTasksQueued=o.length,d},setTaskPriority:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<o.length;n++)if(o[n].taskId===e){var a=o.splice(n,1)[0];for(a.priority=t,n=0;n<o.length&&!(o[n].priority<t);n++);return o.splice(n,0,a),!0}return!1},cancelTask:function(e,t){for(var n=0;n<o.length;n++)if(o[n].taskId===e)return o.splice(n,1).deferred.reject(t),!0;return!1}}},"./shared/calculateMinMax.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,r.default)(e.pixelData),a=!(o(e.smallestPixelValue)&&o(e.largestPixelValue));!0!==t||a?(e.smallestPixelValue=n.min,e.largestPixelValue=n.max):(e.smallestPixelValue!==n.min&&console.warn("Image smallestPixelValue tag is incorrect. Rendering performance will suffer considerably."),e.largestPixelValue!==n.max&&console.warn("Image largestPixelValue tag is incorrect. Rendering performance will suffer considerably."))};var a,r=(a=n("./shared/getMinMax.js"))&&a.__esModule?a:{default:a};function o(e){return"number"==typeof e}},"./shared/decodeImageFrame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n("./shared/decoders/decodeLittleEndian.js")),r=d(n("./shared/decoders/decodeBigEndian.js")),o=d(n("./shared/decoders/decodeRLE.js")),i=d(n("./shared/decoders/decodeJPEGBaseline.js")),s=d(n("./shared/decoders/decodeJPEGLossless.js")),l=d(n("./shared/decoders/decodeJPEGLS.js")),u=d(n("./shared/decoders/decodeJPEG2000.js"));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n,d,c){var f=(new Date).getTime();if("1.2.840.10008.1.2"===t)e=(0,a.default)(e,n);else if("1.2.840.10008.1.2.1"===t)e=(0,a.default)(e,n);else if("1.2.840.10008.1.2.2"===t)e=(0,r.default)(e,n);else if("1.2.840.10008.1.2.1.99"===t)e=(0,a.default)(e,n);else if("1.2.840.10008.1.2.5"===t)e=(0,o.default)(e,n);else if("1.2.840.10008.1.2.4.50"===t)e=(0,i.default)(e,n);else if("1.2.840.10008.1.2.4.51"===t)e=(0,i.default)(e,n);else if("1.2.840.10008.1.2.4.57"===t)e=(0,s.default)(e,n);else if("1.2.840.10008.1.2.4.70"===t)e=(0,s.default)(e,n);else if("1.2.840.10008.1.2.4.80"===t)e=(0,l.default)(e,n);else if("1.2.840.10008.1.2.4.81"===t)e=(0,l.default)(e,n);else if("1.2.840.10008.1.2.4.90"===t)e=(0,u.default)(e,n,d,c);else{if("1.2.840.10008.1.2.4.91"!==t)throw new Error("no decoder for transfer syntax "+t);e=(0,u.default)(e,n,d,c)}var h=void 0!==e.pixelRepresentation&&1===e.pixelRepresentation,m=h&&void 0!==e.bitsStored?32-e.bitsStored:void 0;if(h&&void 0!==m)for(var g=0;g<e.pixelData.length;g++)e.pixelData[g]=e.pixelData[g]<<m>>m;var p=(new Date).getTime();return e.decodeTimeInMS=p-f,e}},"./shared/decoders/decodeBigEndian.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(16===e.bitsAllocated){var n=t.buffer,a=t.byteOffset,r=t.length;a%2&&(n=n.slice(a),a=0),e.pixelData=0===e.pixelRepresentation?new Uint16Array(n,a,r/2):new Int16Array(n,a,r/2);for(var o=0;o<e.pixelData.length;o++)e.pixelData[o]=(255&(i=e.pixelData[o]))<<8|i>>8&255}else 8===e.bitsAllocated&&(e.pixelData=t);var i;return e}},"./shared/decoders/decodeJPEG2000.js":function(e,t,n){"use strict";function a(e,t){var n=new JpxImage;n.parse(t);var a=n.tiles.length;if(1!==a)throw new Error("JPEG2000 decoder returned a tileCount of "+a+", when 1 is expected");return e.columns=n.width,e.rows=n.height,e.pixelData=n.tiles[0].items,e}Object.defineProperty(t,"__esModule",{value:!0});var r=void 0;function o(e,t){var n=function(e,t,n){var a=r._malloc(e.length);r.writeArrayToMemory(e,a);var o=r._malloc(4),i=r._malloc(4),s=r._malloc(4),l=r._malloc(4),u=r._malloc(4),d=(new Date).getTime();if(0!==r.ccall("jp2_decode","number",["number","number","number","number","number","number","number"],[a,e.length,o,i,s,l,u]))return console.log("[opj_decode] decoding failed!"),r._free(a),r._free(r.getValue(o,"*")),r._free(s),r._free(l),r._free(i),void r._free(u);var c=r.getValue(o,"*"),f={length:r.getValue(i,"i32"),sx:r.getValue(s,"i32"),sy:r.getValue(l,"i32"),nbChannels:r.getValue(u,"i32"),perf_timetodecode:void 0,pixelData:void 0},h=f.sx*f.sy*f.nbChannels,m=new Int32Array(r.HEAP32.buffer,c,h);if(1===t)if(Uint8Array.from)f.pixelData=Uint8Array.from(m);else{f.pixelData=new Uint8Array(h);for(var g=0;g<h;g++)f.pixelData[g]=m[g]}else if(n)if(Int16Array.from)f.pixelData=Int16Array.from(m);else{f.pixelData=new Int16Array(h);for(var p=0;p<h;p++)f.pixelData[p]=m[p]}else if(Uint16Array.from)f.pixelData=Uint16Array.from(m);else{f.pixelData=new Uint16Array(h);for(var v=0;v<h;v++)f.pixelData[v]=m[v]}var b=(new Date).getTime();return f.perf_timetodecode=b-d,r._free(a),r._free(o),r._free(c),r._free(i),r._free(s),r._free(l),r._free(u),f}(t,e.bitsAllocated<=8?1:2,1===e.pixelRepresentation);return e.columns=n.sx,e.rows=n.sy,e.pixelData=n.pixelData,n.nbChannels>1&&(e.photometricInterpretation="RGB"),e}function i(e){if(!e.usePDFJS&&"undefined"==typeof OpenJPEG)throw new Error("OpenJPEG decoder not loaded");if(!(r||(r=OpenJPEG())&&r._jp2_decode))throw new Error("OpenJPEG failed to initialize")}t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i(n),r.usePDFJS||n.usePDFJS?a(e,t):o(e,t)},t.initializeJPEG2000=i},"./shared/decoders/decodeJPEGBaseline.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof JpegImage)throw new Error("No JPEG Baseline decoder loaded");var n=new JpegImage;return n.parse(t),n.colorTransform=!1,8===e.bitsAllocated?(e.pixelData=n.getData(e.columns,e.rows),e):16===e.bitsAllocated?(e.pixelData=n.getData16(e.columns,e.rows),e):void 0}},"./shared/decoders/decodeJPEGLS.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=void 0;function r(){if("undefined"==typeof CharLS)throw new Error("No JPEG-LS decoder loaded");if(!(a||(a=CharLS())&&a._jpegls_decode))throw new Error("JPEG-LS failed to initialize")}t.default=function(e,t){r();var n=function(e,t){var n=a._malloc(e.length);a.writeArrayToMemory(e,n);var r=a._malloc(4),o=a._malloc(4),i=a._malloc(4),s=a._malloc(4),l=a._malloc(4),u=a._malloc(4),d=a._malloc(4),c=a._malloc(4),f=a._malloc(4),h={result:a.ccall("jpegls_decode","number",["number","number","number","number","number","number","number","number","number","number","number"],[n,e.length,r,o,i,s,l,u,c,d,f]),width:a.getValue(i,"i32"),height:a.getValue(s,"i32"),bitsPerSample:a.getValue(l,"i32"),stride:a.getValue(u,"i32"),components:a.getValue(c,"i32"),allowedLossyError:a.getValue(d,"i32"),interleaveMode:a.getValue(f,"i32"),pixelData:void 0},m=a.getValue(r,"*");return h.bitsPerSample<=8?(h.pixelData=new Uint8Array(h.width*h.height*h.components),h.pixelData.set(new Uint8Array(a.HEAP8.buffer,m,h.pixelData.length))):t?(h.pixelData=new Int16Array(h.width*h.height*h.components),h.pixelData.set(new Int16Array(a.HEAP16.buffer,m,h.pixelData.length))):(h.pixelData=new Uint16Array(h.width*h.height*h.components),h.pixelData.set(new Uint16Array(a.HEAP16.buffer,m,h.pixelData.length))),a._free(n),a._free(m),a._free(r),a._free(o),a._free(i),a._free(s),a._free(l),a._free(u),a._free(c),a._free(f),h}(t,1===e.pixelRepresentation);if(0!==n.result&&6!==n.result)throw new Error("JPEG-LS decoder failed to decode frame (error code "+n.result+")");return e.columns=n.width,e.rows=n.height,e.pixelData=n.pixelData,e},t.initializeJPEGLS=r},"./shared/decoders/decodeJPEGLossless.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof jpeg||void 0===jpeg.lossless||void 0===jpeg.lossless.Decoder)throw new Error("No JPEG Lossless decoder loaded");var n=e.bitsAllocated<=8?1:2,a=t.buffer,r=(new jpeg.lossless.Decoder).decode(a,t.byteOffset,t.length,n);return 0===e.pixelRepresentation?16===e.bitsAllocated?(e.pixelData=new Uint16Array(r.buffer),e):(e.pixelData=new Uint8Array(r.buffer),e):(e.pixelData=new Int16Array(r.buffer),e)}},"./shared/decoders/decodeLittleEndian.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.buffer,a=t.byteOffset,r=t.length;return 16===e.bitsAllocated?(a%2&&(n=n.slice(a),a=0),e.pixelData=0===e.pixelRepresentation?new Uint16Array(n,a,r/2):new Int16Array(n,a,r/2)):8===e.bitsAllocated||1===e.bitsAllocated?e.pixelData=t:32===e.bitsAllocated&&(a%2&&(n=n.slice(a),a=0),e.pixelData=new Float32Array(n,a,r/4)),e}},"./shared/decoders/decodeRLE.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(8===e.bitsAllocated)return e.planarConfiguration?function(e,t){for(var n=t,a=e.rows*e.columns,r=new ArrayBuffer(a*e.samplesPerPixel),o=new DataView(n.buffer,n.byteOffset),i=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(r),l=0,u=o.getInt32(0,!0),d=0;d<u;++d){l=d*a;var c=o.getInt32(4*(d+1),!0),f=o.getInt32(4*(d+2),!0);0===f&&(f=n.length);for(var h=a*u;c<f;){var m=i[c++];if(m>=0&&m<=127)for(var g=0;g<m+1&&l<h;++g)s[l]=i[c++],l++;else if(m<=-1&&m>=-127)for(var p=i[c++],v=0;v<1-m&&l<h;++v)s[l]=p,l++}}return e.pixelData=new Uint8Array(r),e}(e,t):function(e,t){for(var n=t,a=e.rows*e.columns,r=new ArrayBuffer(a*e.samplesPerPixel),o=new DataView(n.buffer,n.byteOffset),i=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(r),l=0,u=o.getInt32(0,!0),d=0;d<u;++d){l=d;var c=o.getInt32(4*(d+1),!0),f=o.getInt32(4*(d+2),!0);0===f&&(f=n.length);for(var h=a*u;c<f;){var m=i[c++];if(m>=0&&m<=127)for(var g=0;g<m+1&&l<h;++g)s[l]=i[c++],l+=e.samplesPerPixel;else if(m<=-1&&m>=-127)for(var p=i[c++],v=0;v<1-m&&l<h;++v)s[l]=p,l+=e.samplesPerPixel}}return e.pixelData=new Uint8Array(r),e}(e,t);if(16===e.bitsAllocated)return function(e,t){for(var n=t,a=e.rows*e.columns,r=new ArrayBuffer(a*e.samplesPerPixel*2),o=new DataView(n.buffer,n.byteOffset),i=new Int8Array(n.buffer,n.byteOffset),s=new Int8Array(r),l=o.getInt32(0,!0),u=0;u<l;++u){var d=0,c=0===u?1:0,f=o.getInt32(4*(u+1),!0),h=o.getInt32(4*(u+2),!0);for(0===h&&(h=n.length);f<h;){var m=i[f++];if(m>=0&&m<=127)for(var g=0;g<m+1&&d<a;++g)s[2*d+c]=i[f++],d++;else if(m<=-1&&m>=-127)for(var p=i[f++],v=0;v<1-m&&d<a;++v)s[2*d+c]=p,d++}}return e.pixelData=0===e.pixelRepresentation?new Uint16Array(r):new Int16Array(r),e}(e,t);throw new Error("unsupported pixel format for RLE")}},"./shared/getMinMax.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e[0],n=e[0],a=void 0,r=e.length,o=1;o<r;o++)a=e[o],t=Math.min(t,a),n=Math.max(n,a);return{min:t,max:n}}},"./version.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="2.1.4"}})});